require(["ta/rollupAmdShim"],function(a){a.install(["mixins/Events","utils/browserutils","api-mod","overlays/Overlay","overlays/utils","overlays/ajaxUtil","overlays/options/closeOnDocClick","overlays/options/closeOnChildClick","overlays/options/closeOnSourceClick","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnMouseOut","overlays/options/closeOnMouseAway","overlays/options/closeOnScroll","overlays/options/closeOnEscape","overlays/options/closeOnEvent","overlays/options/closeOnTaEvent","overlays/options/closeOnTargetEvent","overlays/options/closeOnLegacyOverlay","overlays/options/fireEventOnWindowshadeClick","overlays/options/hoverDelay","overlays/options/storeOverlayOnElement","overlays/options/fadeInOut","overlays/options/highlightElement","overlays/options/repositionOnEvent","overlays/options/repositionOnTaEvent","overlays/options/autoReposition","overlays/options/autosizePage","overlays/options/keepInDom","overlays/options/matchWidth","overlays/options/maxWidth","overlays/options/minWidth","overlays/options/ajax","overlays/options/centerArrowOnSrcElement","overlays/options/closeOnTargetChildClick","overlays/position","overlays/styles/modal","overlays/styles/popover","overlays/styles/tooltip","overlays/styles/windowshade","overlays/styles/dropdown","overlays/styles/notification","overlays/uiOverlay"],["ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"uiOverlays",files:{"js-amd":{src:{mixins:{Events:1},utils:{browserutils:1},"api-mod":1,overlays:{ajaxUtil:1,uiOverlay:1,utils:1,options:{closeOnTargetChildClick:1,keepInDom:1,autoReposition:1,closeOnTaEvent:1,ajax:1,closeOnDocClick:1,closeOnMouseOut:1,closeOnSourceClick:1,centerArrowOnSrcElement:1,fadeInOut:1,highlightElement:1,storeOverlayOnElement:1,autosizePage:1,closeOnScroll:1,maxWidth:1,closeOnWindowshadeClick:1,closeOnEscape:1,closeOnMouseAway:1,minWidth:1,closeOnLegacyOverlay:1,closeOnChildClick:1,closeOnTargetEvent:1,matchWidth:1,repositionOnEvent:1,fireEventOnWindowshadeClick:1,closeOnEvent:1,repositionOnTaEvent:1,hoverDelay:1},styles:{notification:1,popover:1,tooltip:1,windowshade:1,dropdown:1,modal:1},position:1,Overlay:1}}}},_:{baseUrl:"/"}})};define("mixins/Events",["vanillajs"],function(b){var a=function(){this.events={};Array.prototype.slice.call(arguments).forEach(function(c){this.events[c]=[]},this)};a.create=(function(){function c(d){return a.apply(this,d)}c.prototype=a.prototype;return function(){return new c(arguments)}}());a.extend=function(d,e){var c=Object.create(a.prototype);c.delegate=d;a.apply(c,e);return c};a.prototype.on=a.prototype.addListener=function(d,c){if(this.events[d]!==undefined){this.events[d].push(c)}else{if(this.delegate){this.delegate.on(d,c)}else{this.events[d]=[c]}}return this};a.prototype.off=a.prototype.removeListener=function(e,d){if(this.events[e]!==undefined){if(d){var c=this.events[e].indexOf(d);if(c>=0){this.events[e].splice(c,1)}}else{this.events[e].length=0}}else{if(this.delegate){this.delegate.removeListener(e,d)}}return this};a.prototype.removeAllListeners=function(d){if(d&&this.events[d]!==undefined){this.events[d].length=0}else{if(!d){for(var c in this.events){if(this.events.hasOwnProperty(c)){this.events[c].length=0}}if(this.delegate&&this.delegate.removeAllListeners){this.delegate.removeAllListeners()}}else{if(this.delegate&&this.delegate.removeAllListeners){this.delegate.removeAllListeners(d)}}}};a.prototype.hasListeners=function(c){if(c){if(this.events.hasOwnProperty(c)){return this.events[c].length>0}if(this.delegate&&this.delegate.hasListeners){return this.delegate.hasListeners(c)}}return false};a.prototype.emit=function(e,d){if(this.events[e]){var c=Array.prototype.slice.call(arguments,1);this.events[e].slice(0).forEach(function(g){if(g){try{g.apply(this,c)}catch(i){if(typeof i==="string"){i=new Error(i)}var h="Error in event handler for "+e;if(require.defined("ta/util/Error")){require("ta/util/Error").record(i,h)}else{var f=require.defined("ta")&&require("ta");if(f&&f.log&&f.log.error){f.log.error(i,h)}else{if(f&&f.m&&f.m.recordJSError){f.m.recordJSError([i,h])}else{if(typeof console!="undefined"){(console.error||console.log)(h,i)}}}}}}},this)}else{if(this.delegate&&this.delegate.emit){this.delegate.emit.apply(delegate,arguments)}}return this};return a});define("utils/browserutils",["vanillajs"],function(e){var d={},b=window.navigator?window.navigator.userAgent.toLowerCase():"",a=window.navigator?window.navigator.platform.toLowerCase():"",c=b.match(/(opera|ie|firefox|chrome|trident|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],f=c[1]=="ie"&&document.documentMode;if(c[1]==="trident"){c[1]="ie";c[2]=parseInt(c[2],10)+4}d.name=(c[1]=="version")?c[3]:c[1];d.version=f||parseFloat((c[1]=="opera"&&c[4])?c[4]:c[2]);d.Platform={name:b.match(/ip(?:ad|od|hone)/)?"ios":(b.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]};d[d.name]=true;d[d.name+parseInt(d.version,10)]=true;d.Platform[d.Platform.name]=true;return d});define("api-mod",["lib/jquery-amd","utils/browserutils","utils/throttle","utils/stopevent","utils/form-to-json"],function($,browser,throttle,stopEvent,formToJson){var exports={};exports.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=null;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split(".");var n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null};exports.bind=function(fn,obj){return Function.prototype.bind.apply(fn,Array.prototype.slice.call(arguments,1))};exports.bindAll=function(obj,_funcs_){if(arguments.length>1){Array.prototype.slice.call(arguments,1).forEach(function(name){obj[name]=this.bind(obj[name],obj)},this)}else{for(var name in obj){if(obj.hasOwnProperty(name)){obj[name]=this.bind(obj[name],obj)}}}return obj};exports.inDocument=function(elmt){elmt=exports.find(elmt);return !!elmt.parentNode&&elmt.parentNode.nodeType!==11};exports.addEvent=function(elmt,type,fn){$(elmt).on(type,fn)};exports.fireEvent=function(elmt,type,args){$(elmt).trigger(type,args)};exports.removeEvent=function(elmt,type,fn){$(elmt).off(type,fn)};exports.removePropertyEvent=function(elmt,type,fn){if(type.substr(0,2)!=="on"){type="on"+type}var property=elmt.getAttribute(type);if(!property){return}var newVal;var escFn=fn.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");newVal=property.replace(new RegExp(escFn+"\\s*\\([^)]*\\);?|(ta\\.call|requireCallLast|requireCallIfReady)\\s*\\(\\s*['\"]\\s*"+escFn+"[^)]*\\);?"),"");elmt[type]=newVal.trim()};exports.store=function(elmt,key,value){$(elmt).data(key,value)};exports.retrieve=function(elmt,key){return $(elmt).data(key)};exports.getSize=function(elmt){elmt=exports.find(elmt);if(!elmt){return null}if(/^(?:body|html)$/i.test(elmt.tagName)||elmt===window||elmt===document){var win=(!document.compatMode||document.compatMode==="CSS1Compat")?document.body.parentNode:document.body;return{x:win.clientWidth,y:win.clientHeight}}return{x:elmt.offsetWidth,y:elmt.offsetHeight}};exports.getPosition=function(elmt,relativeTo){relativeTo=$(relativeTo);elmt=$(elmt);if(relativeTo.length){var refOff=relativeTo.offset();var eltOff=elmt.offset();return{left:eltOff.left-refOff.left,top:eltOff.top-refOff.top}}else{return elmt.offset()}};exports.getCoords=function(elmt){elmt=exports.find(elmt);if(!elmt){return null}var size=this.getSize(elmt);var position=this.getPosition(elmt);return{top:position.top,left:position.left,bottom:position.top+size.y,right:position.left+size.x,height:size.y,width:size.x}};exports.getOffsetParent=function(elmt){return $(elmt).offsetParent().get(0)};exports.getParent=function(elmt,className){elmt=exports.find(elmt);if(!elmt){return null}if(className){for(;elmt&&elmt.tagName!="html";elmt=elmt.parentNode){if(exports.hasClass(elmt,className)){return elmt}}return null}else{return elmt.parentNode}};exports.elementOrParentMatches=function(elmt,matcher){if(matcher){for(;elmt;elmt=elmt.parentElement){if(matcher(elmt)){return true}}}return false};exports.containsElement=function(parentElement,childElement){parentElement=exports.find(parentElement);childElement=exports.find(childElement);if(!parentElement||!childElement){return false}while(childElement!=null){if(childElement===parentElement){return true}childElement=childElement.parentElement}return false};exports.checkBrowser=function(_args_){var args=Array.prototype.slice.call(arguments);return args.some(function(b){return !!browser[b]})};exports.containsEvent=function(elmt,evnt){elmt=exports.find(elmt);if(!evnt||!elmt){return false}var x=evnt.pageX,y=evnt.pageY;var s=this.getCoords(elmt);if("fixed"===$(this.getOffsetParent(elmt)||elmt).css("position")||typeof x==="undefined"||typeof y==="undefined"){x=evnt.clientX;y=evnt.clientY}return(y>=s.top&&y<=s.bottom&&x>=s.left&&x<=s.right)};exports.select=function(arg1,arg2){var args=Array.prototype.slice.call(arguments);var context=args.length>1&&(("string"===typeof args[0])?args.pop():args.shift())||document;var selector=args.shift();try{return $(selector,context).get()}catch(e){return[]}};exports.addClass=function(elmt,className){$(elmt).addClass(className)};exports.removeClass=function(elmt,className){$(elmt).removeClass(className)};exports.toggleClass=function(elmt,className,state){$(elmt).toggleClass(className,state)};exports.hasClass=function(elmt,className){return elmt&&$(elmt).hasClass(className)};exports.destroy=function(elmt){$(elmt).remove().get()};exports.find=function(selector,elmt){try{return $(selector,elmt||document)[0]}catch(e){}};exports.scrollTop=function(){var supportPageOffset=window.pageYOffset!==undefined;var isCSS1Compat=((document.compatMode||"")==="CSS1Compat");return supportPageOffset?window.pageYOffset:isCSS1Compat?document.documentElement.scrollTop:document.body.scrollTop};exports.scrollLeft=function(){var supportPageOffset=window.pageXOffset!==undefined;var isCSS1Compat=((document.compatMode||"")==="CSS1Compat");return supportPageOffset?window.pageXOffset:isCSS1Compat?document.documentElement.scrollLeft:document.body.scrollLeft};exports.createElement=function(tag,attributes){var el=document.createElement(tag);attributes&&$(el).attr(attributes);return el};exports.isElement=function(obj){if(typeof HTMLElement==="object"){return obj instanceof HTMLElement}return obj&&typeof obj==="object"&&obj.nodeType===1&&typeof obj.nodeName==="string"};exports.isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};exports.adopt=function(parentElt,_children_){$(parentElt).append(Array.prototype.slice.call(arguments,1))};exports.setStyle=function(elmt,property,value){$(elmt).css(property,value)};exports.stopEvent=stopEvent;exports.mixin=function(target,_mixins_){Array.prototype.slice.call(arguments,1).forEach(function(mixin){for(var prop in mixin){target[prop]=mixin[prop]}},target);return target};exports.merge=function(target,_mixins_){var fromList=Array.prototype.slice.call(arguments,1);for(var i=0,len=fromList.length;i<len;i++){for(var prop in fromList[i]){if(fromList[i].hasOwnProperty(prop)){target[prop]=fromList[i][prop]}}}return target};exports.getFormData=function(form){return formToJson($(form).get(0))};exports.toFormQueryString=function(obj){var qslist=[];if(obj&&obj.nodeName==="FORM"){obj=exports.getFormData(obj)}for(var key in obj){if(obj.hasOwnProperty(key)){var val=obj[key];if(val&&typeof(val)==="object"){for(var i=0;val.length&&i<val.length;++i){var subval=val[i];subval=typeof(subval)==="object"?"":String(subval);qslist.push(encodeURIComponent(key)+"="+encodeURIComponent(subval))}}else{qslist.push(encodeURIComponent(key)+"="+encodeURIComponent(String(val)))}}}return qslist.join("&")};exports.toArray=function(thing){if(typeof thing.length!=="number"){return[thing]}return Array.prototype.slice.call(thing)};exports.throttled=throttle;exports.forceReflow=function(elmt){$(elmt).each(function(idx,elt){elt.offsetWidth})};exports.stripTags=function(str,tag,contents){tag=tag||"";var regstr=contents?"<"+tag+"(?!\\w)[^>]*>([\\s\\S]*?)</"+tag+"(?!\\w)>":"</?"+tag+"([^>]+)?>";return str.replace(new RegExp(regstr,"gi"),"")};return exports});define("overlays/Overlay",["vanillajs","api-mod","mixins/Events","overlays/utils"],function(e,d,c,b){var a=function(h,f){this.sourceElement=h;this.domParent=document.body;this.container=null;this.contentElement=null;d.mixin(this,new c("show","hide","destroy","positionDirty","hover"));d.bindAll(this,"show","hide","destroy");var f=(f&&Object.prototype.toString.call(f)==="[object Array]"?f:Array.prototype.slice.call(arguments,1));for(var g=0;g<f.length;g++){f[g]&&f[g].call(this)}};a.prototype.isOpen=function(){return d.inDocument(this.container)};a.prototype.show=function(){if(d.inDocument(this.container)){return this}this.domParent.appendChild(this.container);this.container.overlay=this;this.emit("append");this.emit("show");return this};a.prototype.hide=function(f){if(!d.inDocument(this.container)){return this}delete this.container.overlay;this.domParent.removeChild(this.container);this.emit("hide",{trigger:f});return this};a.prototype.destroy=function(f){this.hide(f);this.emit("destroy",{trigger:f});this.sourceElement=null;this.contentElement=null;return this};a.prototype.reposition=function(){this.emit("positionDirty");return this};a.prototype.updateContent=function(f){this.contentElement.innerHTML="";b.injectContentWithDataAttrs(this.contentElement,this.sourceElement,f);return this.reposition()};return a});define("overlays/utils",["vanillajs","overlays/loading-spinner","api-mod"],function(c,d,b){var a={};a.arrowDir={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"right",rightEvenInRtl:"left",bottomRight:"top",bottomLeft:"top"};a.arrowDirRtl={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"left",rightEvenInRtl:"right",bottomRight:"top",bottomLeft:"top"};a.getArrowDir=function(k,i,e){var h=(b.hasClass(document.body,"rtl")?a.arrowDirRtl:a.arrowDir);if(k==="wideside"&&i&&e){var g=b.getSize(i);var f=b.getPosition(i);var j=b.getSize(e);return f.left>(j.x-f.left-g.x)?h.left:h.right}return h[k]};a.injectContent=function(f,g,i,e,h){if(b.isElement(i)){b.adopt(f,i)}else{if(e){i=b.find(e,g);b.removeClass(i,"hidden");b.adopt(f,i)}else{if(h){i=b.find(h);i&&(f.innerHTML+=i.innerHTML)}else{f.innerHTML+=i}}}};a.injectContentWithDataAttrs=function(f,g,i,e,h){i=i||(g&&g.getAttribute("data-content"))||"";e=e||(g&&g.getAttribute("data-element"))||"";h=h||(g&&g.getAttribute("data-element-copy"))||"";a.injectContent(f,g,i,e,h)};a.parseOffsets=function(e){if(!e||!e.length){return{x:0,y:0}}return{x:e[0]&&parseInt(e[0],10)||0,y:e[1]&&parseInt(e[1],10)||0}};a.loadingSpinnerHtml=d;return a});define("overlays/ajaxUtil",["vanillajs","ta","utils/object/shallow-copy","utils/AjaxData","mixins/Events","overlays/loading-spinner","utils/resourceLoader"],function(o,h,m,d,j,b,n){var c={};var q=10;var e=[];var k={};var g=q;var a=false;var s;var r=b();function i(y,u){var t=[];var x;for(x in u){t.push(x)}t.sort();var v=y;var z=v.indexOf("?")>=0?"&":"?";for(var w=0;w<t.length;++w){x=t[w];v+=z+encodeURIComponent(x)+"="+encodeURIComponent(String(u[x]));z="&"}return v}function p(){var t=0;var u={};var x=[];for(var w=e.length-1;w>=0;--w){var v=e[w];var y=k[v];if(y&&!u[v]){if(y.hasClients()||(++t<=q)){u[v]=y;x.push(v)}}}x.reverse();k=u;e=x;g=e.length+q;return e}function l(H,B){var J=this;var u=new d({dataType:"html",ajaxFunc:B.ajaxFunc});var C=new j("update","data-targetEvent");var t=B.loadingContent||r;var D=false;var L=!!B.sendTravelInfo;var A=void (0);var v=t;var G=u.dataVersion;var x=[];var K=0;var y;var E;function F(){var O=h.page.datesToQueryString("STAYDATES");if(O&&s!==O){s=O;p();for(var M=e.length-1;M>=0;--M){var N=k[e[M]];if(N.needsTravelInfo){N.invalidate()}}}}function I(S,O,Q,P,M,N){P=P&&h.page&&h.page.usingUnifiedDates;if(P){var R=h.page.datesToQueryString("STAYDATES");if(R){O+="&"+R}if(!a){a=true;s=R;h.page.on("dateSelected",F)}}if(M>1){if(M>20){return}O+="&reqNum="+M;if(!(N>=0)){N=2000}}else{N=0}if(!Q){S.refresh("GET",O,void (0),N)}else{S.refresh("POST",O,Q,N)}n.load(y,function(){E=true;w()})}function w(){if(u.isBusy()||!E){if(A){clearTimeout(A)}A=void (0);return}if(!u.data){if(u.dataVersion!==0){if(!J.error||J.error!==u.error){J.error=u.error||"no content";A=A||setTimeout(z,0)}}else{if(G!==0){v=t;G=u.dataVersion;x=[];if(C.hasListeners("update")){A=A||setTimeout(z,0)}}}return}if(G===u.dataVersion){return}try{var P=document.createElement("div");P.innerHTML=u.data;var N=D;var M=document.head||document.getElementsByTagName("head")[0];x=[];if(!B.noScript){Array.prototype.forEach.call(P.querySelectorAll("script"),function(Q){if(N){var R=document.createElement("script");R.setAttribute("type","text/javascript");if(Q.src){R.src=Q.src}if(Q.text){R.text=Q.text}R.setAttribute("data-rup",Q.getAttribute("data-rup"));M.appendChild(R);if(!Q.src){M.removeChild(R)}}Q.parentNode.removeChild(Q)})}Array.prototype.forEach.call(P.querySelectorAll("style"),function(Q){if(N){M.appendChild(Q)}else{Q.parentNode.removeChild(Q)}});Array.prototype.forEach.call(P.querySelectorAll("[data-targetEvent]"),function(Q){x.push(Q);Q.parentNode.removeChild(Q)});if(N){D=false;c[B.inlineResourceId]=true}v=P.innerHTML;G=u.dataVersion;u.data=void (0)}catch(O){J.error="invalid HTML"}A=A||setTimeout(z,0)}function z(){var M=!C.hasListeners("update");var R;A=void (0);J.data=v;J.dataVersion=G;C.emit("update");while((R=x.shift())){var Q=R.getAttribute("data-targetEvent");if(Q==="repoll-required"){if(M){x=[];J.data=v=t;J.dataVersion=G=0;return}if(!(++K>1)){K=2}var N=Number(R.getAttribute("data-delay"));I(u,H,B.reqParams,L,K,N)}else{if(Q==="offerClickTrackingTree"){try{var O=require("commerce/impression-tracker");if(O){O.onTrackingTreeElement(R)}}catch(P){}}else{C.emit("data-targetEvent",Q,R)}}}}this.error=void (0);this.loadingData=t;this.data=v;this.dataVersion=G;this.needsTravelInfo=L;this.on=C.on.bind(C);this.off=C.off.bind(C);this.removeListener=C.removeListener.bind(C);this.init=function(){u.on("update",w.bind(this))};this.isBusy=function(){return u.isBusy()||A};this.isDone=function(){return !u.isBusy()&&!A};this.invalidate=function(){u.clear();K=0;if(this.hasClients()){I(u,H,B.reqParams,L,0,0)}};this.hasClients=function(){return(C.hasListeners("update"))};this.load=function(){if(u.isBusy()){return}else{if(u.dataVersion!==0){setTimeout(function(){C.emit("update")},1);return}}var T=B.reqParams;var R=!B.isWidget||!B.inlineResourceId||!c[B.inlineResourceId];if(R){var Q=[];var S=[];var N=document.head||document.getElementsByTagName("head")[0];var P;var O=document.head.querySelectorAll('link[type="text/css"][rel=stylesheet][data-rup]');for(var M=0;M<O.length;M++){P=O[M].getAttribute("data-rup");if(P){Q.push(P)}}O=document.querySelectorAll("script[data-rup]");for(M=0;M<O.length;M++){P=O[M].getAttribute("data-rup");if(P){S.push(P)}}D=true;T=(T?m(T):{});T.haveJses=String(S);T.haveCsses=String(Q);if(B.isWidget){T.Action="install"}}y=B.resources;K=0;I(u,H,T,L,0,0)}}function f(v,u){var w=i(v,u.reqParams);if(w.length<128){v=w;u.reqParams=void (0)}var t=k[w];if(!t){t=new l(v,u);t.init();if(!u.noCache){k[w]=t}}if(!u.noCache){e.push(w);if(e.length>g){p()}}return t}return{loadData:function(u,t){!t&&(t={});var v=f(u,t);v.load();return v},loadOverlayWidget:function(w,u){var t="/OverlayWidgetAjax?Mode="+w;if(typeof(crPageServlet)==="string"){t+="&metaReferer="+encodeURIComponent(crPageServlet)}u=(u?m(u):{});u.inlineResourceId=w;u.isWidget=true;var v=f(t,u);v.load();return v},cleanCache:p}});define("overlays/options/closeOnDocClick",["vanillajs","api-mod"],function(e,d){function b(f){if(this.sourceElement&&d.containsElement(this.sourceElement,f.target)){return}if(d.containsElement(this.container,f.target)){return}if(f.target&&(f.target.tagName==="option"||d.hasClass(f.target,"ui_dropdown")||d.getParent(f.target,"ui_dropdown"))){return}if(d.checkBrowser("ie")&&f.target&&f.target.tagName=="select"&&d.containsEvent(f.target,f)&&d.select(this.container,"input").indexOf(f.target)){return}this.hide("doc-click")}function a(f){return function(){var g=d.bind(b,this);this.on("show",function(){setTimeout((function(){if(this.isOpen()){d.addEvent(document,"click",g);f&&d.addEvent(document,"touchstart",g)}}).bind(this),1)}).on("hide",function(){d.removeEvent(document,"click",g);f&&d.removeEvent(document,"touchstart",g)})}}var c=a(true);c.withoutTouchEvents=a(false);return c});define("overlays/options/closeOnChildClick",["vanillajs","api-mod"],function(e,d){function b(f){if(d.containsElement(this.container,f.target)){this.hide("child-click")}}function a(f){return function(){var g=d.bind(b,this);this.on("show",function(){d.addEvent(this.domParent,"click",g);f&&d.addEvent(this.domParent,"touchstart",g)}).on("hide",function(){d.removeEvent(this.domParent,"click",g);f&&d.removeEvent(this.domParent,"touchstart",g)})}}var c=a(true);c.withoutTouchEvents=a(false);return c});define("overlays/options/closeOnSourceClick",["vanillajs","api-mod"],function(e,d){function b(f){if(d.containsElement(this.sourceElement,f.target)){this.hide("source-click")}}function a(f){return function(){var h=b.bind(this);var g=(function(i){setTimeout(i.bind(this),1)}).bind(this);this.on("show",g.bind(undefined,function(){d.addEvent(this.sourceElement,"click",h);f&&d.addEvent(this.sourceElement,"touchstart",h)})).on("hide",g.bind(undefined,function(){d.removeEvent(this.sourceElement,"click",h);f&&d.removeEvent(this.sourceElement,"touchstart",h)}))}}var c=a(true);c.withoutTouchEvents=a(false);return c});define("overlays/options/closeOnWindowshadeClick",["vanillajs","api-mod"],function(a,b){return function(){var c=this;b.addEvent(this.shade,"click",function(){c.hide("windowshade")})}});define("overlays/options/closeOnMouseOut",["vanillajs","api-mod"],function(d,c){function a(e){if(c.containsElement(this.sourceElement,e.relatedTarget)){return}if(c.containsElement(this.container,e.relatedTarget)){return}this.hide()}var b=function(){var e=c.bind(a,this);this.on("show",function(){c.addEvent(this.sourceElement,"mouseout",e);c.addEvent(this.container,"mouseout",e)}).on("hide",function(){c.removeEvent(this.sourceElement,"mouseout",e);c.removeEvent(this.container,"mouseout",e)})};return b});define("overlays/options/closeOnMouseAway",["vanillajs","api-mod","ta"],function(f,e,b){function c(n,l){var h=n.right<=l.left;var g=n.left>=l.right;var i=n.top>=l.bottom;var p=n.bottom<=l.top;if(h||g){var k=h?"left":"right";var j=h?"right":"left";return[[n[k],n.top],[l[k],l.top],[l[j],l.top],[l[j],l.bottom],[l[k],l.bottom],[n[k],n.bottom]]}else{if(i||p){var o=i?"bottom":"top";var m=i?"top":"bottom";return[[n.right,n[o]],[l.right,l[o]],[l.right,l[m]],[l.left,l[m]],[l.left,l[o]],[n.left,n[o]]]}else{return null}}}function d(t,g){if(!g){return false}var s=t[0],r=t[1];var l=false;for(var o=0,n=g.length-1;o<g.length;n=o++){var q=g[o][0],m=g[o][1];var p=g[n][0],k=g[n][1];var h=((m>r)!=(k>r))&&(s<(p-q)*(r-m)/(k-m)+q);if(h){l=!l}}return l}function a(j){var g=j.relatedTarget||j.target;if(!this.sourceElement){return false}if(e.containsElement(this.sourceElement,g)||e.containsElement(this.container,g)){return true}var i=c(e.getCoords(this.sourceElement),e.getCoords(this.container));var h=d([j.clientX+e.scrollLeft(),j.clientY+e.scrollTop()],i);if(!h){this.hide()}return h}return function(){var h=(function(j){b.throttle(a.bind(this,j),"closeOnMouseMove",100,500)}).bind(this);var i=(function(){e.removeEvent(this.sourceElement,"mouseout",g);e.removeEvent(this.container,"mouseout",g)}).bind(this);var g=(function(j){if(a.call(this,j)){i();e.addEvent(window,"mousemove",h)}else{e.removeEvent(window,"mousemove",h)}}).bind(this);this.on("show",function(){e.addEvent(this.sourceElement,"mouseout",g);e.addEvent(this.container,"mouseout",g)}).on("hide",function(){i();e.removeEvent(window,"mousemove",h)})}});define("overlays/options/closeOnScroll",["vanillajs","api-mod"],function(c,b){var a=function(){this.on("show",function(){b.addEvent(window,"scroll",this.hide)}).on("hide",function(){b.removeEvent(window,"scroll",this.hide)})};return a});define("overlays/options/closeOnEscape",["vanillajs","api-mod"],function(d,b){function c(e){if(e.keyCode===27){e.preventDefault();this.hide("escape")}}var a=function(){var e=b.bind(c,this);this.on("show",function(){b.addEvent(document,"keydown",e)}).on("hide",function(){b.removeEvent(document,"keydown",e)})};return a});define("overlays/options/closeOnEvent",["vanillajs","api-mod"],function(c,b){function a(){this.hide("on-event")}return function(d){return function(){var e=b.bind(a,this);this.on("show",function(){b.addEvent(this.domParent,d,e)}).on("hide",function(){b.removeEvent(this.domParent,d,e)})}}});define("overlays/options/closeOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(c,a){function b(){this.hide("on-event")}return function(d){return function(){var e=b.bind(this);this.on("show",function(){a.on(d,e)}).on("hide",function(){a.off(d,e)})}}});define("overlays/options/closeOnTargetEvent",["vanillajs","api-mod"],function(c,b){function a(){this.hide("on-event")}return function(e,d){return function(){var g=d.splice?d:[d];var f=a.bind(this);this.on("show",function(){g.forEach(function(h){b.addEvent(e,h,f)})}).on("hide",function(){g.forEach(function(h){b.removeEvent(e,h,f)})})}}});define("overlays/options/closeOnLegacyOverlay",["vanillajs","ta/Core/TA.Event"],function(b,a){return function(){a.on("onOverlayShow",this.hide.bind(this))}});define("overlays/options/fireEventOnWindowshadeClick",["vanillajs","api-mod"],function(c,b){var a=function(d){return function(){b.addEvent(this.shade,"click",function(){b.fireEvent(document,d,{})})}};return a});define("overlays/options/hoverDelay",["vanillajs","api-mod"],function(c,b){var a=function(d,e){return function(){var f=b.bind(function(){this.hoverTimer=setTimeout(this.show,d)},this);var g=b.bind(function(){clearTimeout(this.hoverTimer)},this);b.addEvent(this.sourceElement,"mouseover",f);b.addEvent(this.sourceElement,"mouseout",g);e&&f()}};return a});define("overlays/options/storeOverlayOnElement",["vanillajs","api-mod"],function(c,b){var a=function(){if(this.sourceElement){b.store(this.sourceElement,"overlay",this)}};return a});define("overlays/options/fadeInOut",["vanillajs","api-mod"],function(c,a){var d={fade_none:0,fade_short:250,fade_normal:500,fade_long:1000};var b="fade_in";return function(f,e){return function(){if(!f||!(f in d)){return}a.addClass(this.container,f);var h=d[f];var g=a.bind(this.show,this);var i=a.bind(this.hide,this);var j=null;this.show=function(){g&&g();setTimeout((function(){a.addClass(this.container,b)}).bind(this),0);clearTimeout(j);if(e){j=setTimeout(a.bind(this.hide,this),h+e)}};this.hide=function(){a.removeClass(this.container,b);clearTimeout(j);j=setTimeout(function(){i&&i()},h)};a.bindAll(this,"show","hide")}}});define("overlays/options/highlightElement",["vanillajs","api-mod"],function(c,b){var a=function(){this.on("show",function(){b.addClass(this.sourceElement,"highlight")}).on("hide",function(){b.removeClass(this.sourceElement,"highlight")})};return a});define("overlays/options/repositionOnEvent",["vanillajs","api-mod"],function(a,b){function c(){this.emit("positionDirty")}return function(e,d){return function(){var g=d.splice?d:[d];var f=b.bind(c,this);this.on("show",function(){g.forEach(function(h){b.addEvent(e,h,f)})}).on("hide",function(){g.forEach(function(h){b.removeEvent(e,h,f)})})}}});define("overlays/options/repositionOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(b,a){return function(c){return function(){var d=this.emit.bind(this,"positionDirty");this.on("show",function(){a.on(c,d)}).on("hide",function(){a.off(c,d)})}}});define("overlays/options/autoReposition",["vanillajs","overlays/options/repositionOnEvent"],function(a,b){return b(window,["resize","scroll"])});define("overlays/options/autosizePage",["lib/jquery-amd","api-mod"],function(b,a){return function(d,c){return function(){this.domParent=b("<div></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,overflow:"auto"})[0];function e(){var g=a.getCoords(this.container);var f=a.getSize(window);this._scrollTop||(this._scrollTop=a.scrollTop());b(document.body).css("overflow","hidden");if(g.height+d*2>f.y){b(this.container).css({top:d,marginTop:0})}window.scrollTo(0,0)}this.on("append",function(){b(document.body).append(this.domParent)});this.on("show",e);this.on("positionDirty",e);this.on("hide",function(){b(document.body).css("overflow","auto");b(this.domParent).remove();window.scrollTo(0,this._scrollTop);delete this._scrollTop})}}});define("overlays/options/keepInDom",["vanillajs","api-mod"],function(c,b){var a="";return function(){this.show=function(){if(b.inDocument(this.container)){this.container.style.display=a;b.removeClass(this.container,"hidden")}else{this.domParent.appendChild(this.container)}this.emit("show");return this};this.hide=function(d){if(b.inDocument(this.container)){if(this.container.style.display!="none"){a=this.container.style.display||"";this.container.style.display="none"}if(!b.hasClass(this.container,"hidden")){b.addClass(this.container,"hidden")}this.emit("hide",{trigger:d})}return this}}});define("overlays/options/matchWidth",["vanillajs","api-mod"],function(c,b){var a=function(e){function d(){if(this.container&&e){b.setStyle(this.container,"width",b.getSize(e).x+"px");this.emit("positionDirty")}}return function(){this.on("show",b.bind(d,this))}};return a});define("overlays/options/maxWidth",["vanillajs"],function(b){var a=function(c){function d(){this.container.style.maxWidth=c+"px";this.emit("positionDirty")}return function(){this.on("show",d.bind(this))}};return a});define("overlays/options/minWidth",["vanillajs"],function(b){var a=function(c){function d(){this.container.style.minWidth=c+"px";this.emit("positionDirty")}return function(){this.on("show",d.bind(this))}};return a});define("overlays/options/ajax",["vanillajs","overlays/ajaxUtil"],function(d,b){function a(e){return e&&e.match(/^((https?:)?(\/\/)?([\da-z\.\-\u00a1-\uffff]+)\.([a-z\.\u00a1-\uffff]{2,6}))?(\/[\w]+)*(\?[\/\w\.+%=\-#&\/!\u00a1-\uffff]+)?$/)}function c(f,e){if(!e){e={}}function g(){if(this.sourceElement){f=f||this.sourceElement.getAttribute("data-url");if(e.noCache===undefined){e.noCache=this.sourceElement.getAttribute("data-ajaxNoCache")}if(!e.resources){e.resources=this.sourceElement.getAttribute("data-resources");if(e.resources){e.resources=e.resources.replace(/[\[\]]/g,"").split(/[ ,]+/)}}}if(!f){return}var j;var m=0;var l=(function(){if(j.dataVersion!==m){this.contentElement.innerHTML=j.data;m=j.dataVersion;if(require.defined("ta/prwidgets")){require("ta/prwidgets").initWidgets(this.contentElement)}}this.reposition();setTimeout(this.reposition.bind(this),1);this.emit("contentLoaded",j.error)}).bind(this);var k;var i=(function(){if(k==f){this.reposition();return}j&&j.invalidate();k=f;j=b.loadData(f,e);this.contentElement.innerHTML=j.data;this.reposition();m=j.dataVersion;if(require.defined("ta/prwidgets")){require("ta/prwidgets").initWidgets(this.contentElement)}j.on("update",l);j.on("data-targetEvent",h)}).bind(this);var h=this.emit.bind(this,"data-targetEvent");this.on("show",i);this.on("hide",function(){if(j){j.off("update",l);j.off("data-targetEvent",h);j=void (0)}});var n=this.updateContent;this.updateContent=function(o){if(!o){f="";o=this.sourceElement.getAttribute("data-url");return o?this.updateContent(o):n.apply(this,arguments)}if(!a(o)){f="";return n.apply(this,arguments)}f=o;if(this.isOpen()){i()}return this}}return g}return c});define("overlays/options/centerArrowOnSrcElement",["vanillajs","api-mod"],function(c,b){var a=function(f,d,g){function e(){f=f||this.sourceElement;if(this.container&&f&&this.arrow){var h=b.getCoords(this.container),j=b.getCoords(f),l=j.left+j.width/2,i=j.top+j.height/2,k=b.getSize(this.arrow).x/2;if(d==null){d=true}if(g==null){g=false}if(d){var n=Math.max(k,Math.min(h.width-k,l-h.left));b.setStyle(this.arrow,"left",n+"px");b.setStyle(this.arrow,"right","auto");b.setStyle(this.arrow,"margin","0 0 0 -"+k+"px")}if(g){var m=Math.max(k,Math.min(h.height-k,i-h.top));b.setStyle(this.arrow,"top",m+"px")}}}return function(){this.on("show",b.bind(e,this));this.on("positionDirty",b.bind(e,this))}};return a});define("overlays/options/closeOnTargetChildClick",["vanillajs","api-mod"],function(b,a){return function(c){return function(){var d=a.bind(function(){this.hide("target-child-click")},this);var e;this.on("show",function(){e=a.find(c);if(e){a.addEvent(e,"click",d)}}).on("hide",function(){if(e){a.removeEvent(e,"click",d)}})}}});define("overlays/position",["vanillajs","api-mod","overlays/utils"],function(i,h,f){function d(o,n,m,l){return function(p,r,q){return function(){function s(){var y=h.getSize(this.arrow)||{x:0,y:0},z=a(p,this.sourceElement),u=(z?h.getSize(z):{x:0,y:0}),w=(z?h.getPosition(z):{left:0,top:0}),B=h.getSize(this.domParent),v=f.parseOffsets(k(p)),x=!z||r||g(this.sourceElement);this.container.style.position=x&&!q?"fixed":"absolute";var t=h.getSize(this.container);if(z&&z.getAttribute("data-anchorWidth")){if(h.hasClass(document.body,"rtl")){w.left+=u.x;u.x=Number(z.getAttribute("data-anchorWidth"));w.left-=u.x}else{u.x=Number(z.getAttribute("data-anchorWidth"))}}var A=(function(C,E,D,F){if(typeof C==="function"){var G=Math.floor(C(t,y,u,w,B,x))+E;if(this.domParent===document.body){G=Math.max(G,D);G=Math.min(G,F)}return G+"px"}else{return"auto"}}).bind(this);if(o&&n&&m&&l){this.container.style.position="fixed"}this.container.style.left=A(o,v.x,0,Math.max(B.x-t.x,0));this.container.style.right=A(m,v.x,0,Math.max(B.x-t.x,0));this.container.style.top=A(n,v.y,-Number.MAX_VALUE,Number.MAX_VALUE);this.container.style.bottom=A(l,v.y,-Number.MAX_VALUE,Number.MAX_VALUE)}this.on("show",s);this.on("positionDirty",s);this.reposition=s.bind(this)}}}function b(l,m){return function(){return function(){function n(){var o=h.getSize(this.container);this.container.style.position="fixed";if(l){if(h.hasClass(document.body,"rtl")){this.container.style.right="50%";this.container.style.marginRight=-o.x/2+"px"}else{this.container.style.left="50%";this.container.style.marginLeft=-o.x/2+"px"}}if(m){this.container.style.top="50%";this.container.style.marginTop=-o.y/2+"px"}}this.on("show",n);this.on("positionDirty",n)}}}function j(){return function(){return function(){function l(){h.addClass(this.container,"cssCentered")}this.on("show",l);this.on("positionDirty",l)}}}function a(m,l){if(!m||!m.length||!isNaN(m[0])){return l}return l&&h.find(m[0],l)}function k(l){if(!l||!l.length||!isNaN(l[0])){return l}return l.slice(1)}function g(l){while(l){if(l==document.body){return false}if(l.style.position){return l.style.position=="fixed"}if(l.currentStyle&&l.currentStyle.position==="fixed"){return true}if(window.getComputedStyle&&getComputedStyle(l).getPropertyValue("position")==="fixed"){return true}l=l.parentNode}return false}var e={};e.above=d(function(q,n,l,m,p,o){return m.left+(l.x/2)-(q.x/2)-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top-q.y-n.y-(o?h.scrollTop():0)});e.below=d(function(q,n,l,m,p,o){return m.left+(l.x/2)-(q.x/2)-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)});e.bottomRight=d(function(q,n,l,m,p,o){return m.left-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)});e.bottomLeft=d(null,function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)},function(q,n,l,m,p,o){return p.x-(m.left+l.x)+(o?h.scrollLeft():0)});e.left=d(function(q,n,l,m,p,o){return m.left-q.x-n.x-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?h.scrollTop():0)});e.right=d(function(q,n,l,m,p,o){return m.left+l.x+n.x-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?h.scrollTop():0)});e.wideside=d(function(q,n,l,m,p,o){if(m.left>(p.x-m.left-l.x)){return m.left-q.x-n.x-(o?h.scrollLeft():0)}else{return m.left+l.x+n.x-(o?h.scrollLeft():0)}},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?h.scrollTop():0)});e.center=d(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return(p.y/2)-(q.y/2)+(o?0:h.scrollTop())});e.centerBelow=d(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)});e.topCenter=d(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return 0});e.topLeft=d(null,function(q,n,l,m,p,o){return m.top-q.y-n.y-(o?h.scrollTop():0)},function(q,n,l,m,p,o){return p.x-(m.left+l.x)+(o?h.scrollLeft():0)});e.movingCenter=b(true,true);e.movingCenterX=b(true,false);e.movingCenterY=b(false,true);e.cssCentered=j();e.absolute=d(function(){return 0},function(){return 0});e.framed=d(function(){return 0},function(){return 0},function(){return 0},function(){return 0});e.offScreen=d(function(){return -10000},function(){return -10000});e.noop=function(){return function(){}};e.rightEvenInRtl=e.right;e.leftEvenInRtl=e.left;if(typeof(document)!="undefined"&&h.hasClass(document.body,"rtl")){e.left=e.rightEvenInRtl;e.right=e.leftEvenInRtl;var c=e.bottomRight;e.bottomRight=e.bottomLeft;e.bottomLeft=c}return e});define("overlays/styles/modal",["vanillajs","api-mod"],function(d,b){function c(f,h,i,e,g){this.container=b.createElement(g||"span",{"class":"ui_overlay ui_modal "+h});if(i){this.header=b.createElement("div",{"class":"header_text"});this.header.innerHTML=i;this.container.appendChild(this.header)}if(e){this.subheader=b.createElement("div",{"class":"subheader_text"});this.subheader.innerHTML=e;this.container.appendChild(this.subheader)}this.inner=b.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner;this.close=b.createElement("div",{"class":"ui_close_x"});this.container.appendChild(this.close)}var a=function(i,g,f,k,e,j,h){f=f||(i&&i.getAttribute("data-modal"))||"";k=k||(i&&i.getAttribute("data-header"))||"";e=e||(i&&i.getAttribute("data-subheader"))||"";return function(){c.call(this,g,f,k,e,h);this.updateContent(j);b.addEvent(this.close,"click",b.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return a});define("overlays/styles/popover",["api-mod","lib/jquery-amd","overlays/utils"],function(c,e,a){function d(f,g,h){this.container=c.createElement("span",{"class":"ui_overlay ui_popover arrow_"+a.getArrowDir(f,this.sourceElement,this.domParent)+" "+g,style:h});this.arrow=c.createElement("div",{"class":"arrow"});this.container.appendChild(this.arrow);this.header=c.createElement("div",{"class":"header_text"});this.container.appendChild(this.header);this.inner=c.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner;this.close=c.createElement("div",{"class":"ui_close_x"});this.container.appendChild(this.close)}var b=function(j,g,f,m,l){j=e(j);f=f||j.attr("data-popover")||"";m=m||j.attr("data-header")||"";l=l||j.attr("data-content")||"";var i=j.attr("data-style")||"";var k=j.attr("data-header-element");var h=j.attr("data-header-copy");return function(){d.call(this,g,f,i);this.updateContent(l);if(m){a.injectContent(this.header,j,m,k,h)}c.addEvent(this.close,"click",c.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return b});define("overlays/styles/tooltip",["vanillajs","api-mod","overlays/utils"],function(e,c,a){function d(g,h,f){this.container=c.createElement(f||"span",{"class":"ui_overlay ui_tooltip arrow_"+a.getArrowDir(g,this.sourceElement,this.domParent)+" "+h});this.arrow=c.createElement("div",{"class":"arrow"});this.container.appendChild(this.arrow);this.inner=c.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner}var b=function(i,h,g,j,f){g=g||i.getAttribute("data-tooltip");return function(){d.call(this,h,g,f);this.updateContent(j)}};return b});define("overlays/styles/windowshade",["vanillajs","api-mod"],function(c,b){var a=function(d){return function(){this.shade=b.createElement("div",{"class":"ui_backdrop "+(d||"dark")});this.on("show",function(){this.domParent.appendChild(this.shade)});var e=this.hide;this.hide=function(){if(b.inDocument(this.shade)){this.domParent.removeChild(this.shade)}e.apply(this,arguments)}}};return a});define("overlays/styles/dropdown",["vanillajs","api-mod"],function(d,b){function c(f,g,h,e){this.container=b.createElement(e||"span",{"class":"ui_overlay ui_dropdown "+g,style:h});this.contentElement=this.container}var a=function(i,h,g,k,f,e){g=g||i.getAttribute("data-dropdown")||"";var j=f||i.getAttribute("style")||"";return function(){c.call(this,h,g,j,e);this.updateContent(k)}};return a});define("overlays/styles/notification",["vanillajs","api-mod"],function(j,i){var m="ui_notification_container",e=2000,g=10000;function k(q,p){this.container=i.createElement("div",{"class":"ui_overlay ui_notification "+q});this.icon=i.createElement("span",{"class":"ui_icon main_icon "+p});this.container.appendChild(this.icon);this.close=i.createElement("span",{"class":"ui_icon times close"});this.container.appendChild(this.close);this.inner=i.createElement("div",{"class":"message"});this.container.appendChild(this.inner);this.contentElement=this.inner}function h(q){var p=i.find("."+m);if(!p){p=document.createElement("div");p.className=m;document.body.appendChild(p)}q.domParent=p;p.appendChild(q.container);o(q);a(q)}function d(p){l(p);o(p);i.addEvent(p.container,"mouseleave",function q(){i.removeEvent(p.container,"mouseleave",q);a(p)});p.emit("hover")}function o(p){i.removeClass(p.container,"hidden");p.container.clientHeight;i.removeClass(p.container,"transparent")}function c(p){i.addClass(p.container,"transparent");l(p);p.__hideTimer=setTimeout(i.bind(f,null,p),e)}function a(p){l(p);p.__transitionOutTimer=setTimeout(c.bind(null,p),g)}function l(p){p.__transitionOutTimer&&clearTimeout(p.__transitionOutTimer);p.__hideTimer&&clearTimeout(p.__hideTimer)}function f(p,q){p.hide(q)}function b(p){p.on("show",i.bind(h,null,p));i.addEvent(p.container,"click",i.bind(f,null,p,"click"));i.addEvent(p.container,"mouseenter",i.bind(d,null,p))}var n=function(q,p,s,r){p=p||(q&&q.getAttribute("data-modal"))||"";r=r||(q&&q.getAttribute("data-icon"))||"";return function(){k.call(this,p,r);this.updateContent(s);b(this)}};return n});define("overlays/uiOverlay",["vanillajs","api-mod"],function(d,b){var c={tooltip:{defaultPosition:"above",defaultFade:"fade_short"},popover:{defaultPosition:"below",defaultFade:"fade_short"},modal:{defaultPosition:"center",defaultFixed:true,defaultFade:"fade_short"},dropdown:{defaultPosition:"below"},notification:{}};var e={};var a=function(s,i){s=s||window.event;i=i||s.target||s.srcElement;var n=s&&s.type;if(n){b.removePropertyEvent(i,n,"uiOverlay")}if(s){b.stopEvent(s)}var j=(i.getAttribute("data-position")||"").split(" ").filter(function(t){return !!t.length});var p=j.shift();var q=["overlays/Overlay","overlays/position"];var k;for(var h in c){if(i.hasAttribute("data-"+h)){p=p||c[h].defaultPosition;q.push("overlays/styles/"+h);k=true;break}}var r=i.getAttribute("data-options")||"";if(!k&&require.defined("ta/util/Error")){var g="uiOverlay: no style. class="+i.className+", id="+i.id;[].forEach.call(i.attributes,function(t){if(/^data-/.test(t.name)){g+=", "+t.name+"="+t.value}});require("ta/util/Error").record(null,g);return}q.push(i.hasAttribute("data-windowshade")?"overlays/styles/windowshade":null);var f=false;if(i.hasAttribute("data-defer")){f=parseInt(i.getAttribute("data-defer"))}q.push(f?"overlays/options/hoverDelay":null);q.push(i.hasAttribute("data-fade")?"overlays/options/fadeInOut":null);q.push(i.getAttribute("data-url")?"overlays/options/ajax":null);q.push(i.hasAttribute("data-close-event")?"overlays/options/closeOnEvent":null);q.push(i.hasAttribute("data-maxWidth")?"overlays/options/maxWidth":null);q.push(i.hasAttribute("data-close-child")?"overlays/options/closeOnTargetChildClick":null);q.push("overlays/options/storeOverlayOnElement");if(r){q=q.concat(r.split(" ").map(function(t){return"overlays/options/"+t}))}if(i.hasAttribute("data-tooltip")){if(n==="click"){q.push("overlays/options/closeOnDocClick")}else{if(n==="mouseover"){if(r.indexOf("closeOnMouseAway")<0){q.push("overlays/options/closeOnMouseOut")}}}}else{if(i.hasAttribute("data-dropdown")){if(n==="click"){q.push("overlays/options/closeOnDocClick");q.push("overlays/options/closeOnSourceClick")}else{if(n==="mouseover"){q.push("overlays/options/closeOnMouseAway")}}}}var m;if(i.hasAttribute("data-unique")){m=i.getAttribute("data-unique");if(m&&(m in e)){var l=e[m];l.sourceElement=i;l.updateContent();!f&&l.show();if(i.hasAttribute("data-callback")){var o=b.fn(i.getAttribute("data-callback"));o&&o(l)}return}}if(require.defined("ta/util/Error")){q.forEach(function(t){if(t&&!require.defined(t)){require("ta/util/Error").record(null,"uiOverlay: ["+t+"] dependency missing")}})}require(q,function(t,v,H,w,G,C,u,B,A,z){var E=[H(i,p),p&&v[p](j,c[h].defaultFixed),w&&w(i.getAttribute("data-windowshade")),G&&G(f,true),C&&C(c[h].defaultFade),u&&u(),B&&B(i.getAttribute("data-close-event")),A&&A(i.getAttribute("data-maxWidth")),z&&z(i.getAttribute("data-close-child"))],x=Array.prototype.slice.call(arguments,9),y=new t(i,E.concat(x));var F=function(){b.select(".ui_tooltip").forEach(function(I){if(I.overlay&&I.overlay!=y){I.overlay.hide()}});y.show()};if(n){!f&&b.addEvent(i,n,function(I){F();b.stopEvent(I)});y.on("destroy",function(){b.removeEvent(i,n,y.show)})}if(m){e[m]=y;y.on("destroy",function(){delete e[m]})}!f&&F();if(i.hasAttribute("data-callback")){var D=b.fn(i.getAttribute("data-callback"));D&&D(y)}});return false};return a});window.uiOverlay=function(){var a=arguments;require(["overlays/uiOverlay"],function(b){b.apply(null,a)})};var ta=window.ta||{};var define;ta.rollupAmdShim=ta.rollupAmdShim||(function(){var l={};var r={};var a={};var q=[];var p=null;var n={ta:ta};var e=null;var j=null;var d=function(x){var y=console&&(console.error||console.log);y&&y.apply(console,arguments)};function o(B,A){var C,y,F,E;for(C=0;B&&B.length&&C<B.length;++C){l[B[C]]=true}for(C=0;A&&A.length&&C<A.length;++C){r[A[C]]=true}if(typeof define!=="undefined"&&define.isDummyDefine){var z=define.pendingDefinitions;if(z&&z.length){for(C=0;C<z.length;C++){y=z[C];i.apply(null,y)}}define=null}if(typeof require!=="undefined"&&require.isDummyRequire){var D=require.pendingRequirements;if(D&&D.length){for(C=0;C<D.length;C++){F=D[C];m.apply(null,F)}}var x=require.pendingConfigs;if(x&&x.length){for(C=0;C<x.length;C++){E=x[C];m.config.apply(null,E)}}require=null}if((typeof define!=="function")||!define.isTaRollupShim){if(typeof define==="function"){e=define}else{e=null}define=i}if((typeof require!=="function")||!require.isTaRollupShim){if(typeof require==="function"){j=require}else{j=null}require=m}}function i(y,C,D,x){var z,B;var A=[];if(typeof y==="string"&&typeof C==="object"&&typeof D==="function"){if(n.hasOwnProperty(y)||(a[y]&&a[y].deps)){return}B=c(C,A);if(B){z=D.apply(null,B);h(y,z)}else{s(A,{deps:C,cb:D,defname:y},i.depLoader)}}else{if(e){return e(y,C,D,x)}else{d("invalid args for AMD define: "+typeof(y)+", "+typeof(C)+", "+typeof(D))}}}i.amd=true;i.isTaRollupShim=true;i.depLoader=function(){};i.depLoader.isDefault=true;function m(x,D,y,C){var A=null;if(typeof x==="string"&&typeof D!=="function"){try{A=c([x]);if(!A&&j){A=[j(x,D,y,C)]}}catch(B){}if(!A){throw w(x)}return A[0]}else{if(typeof x==="object"&&typeof D==="function"){var z=[];A=c(x,z);if(A){D.apply(null,A)}else{s(z,{deps:x,cb:D,eb:(typeof y==="function"&&y)},i.depLoader)}}else{if(j){return j(x,D,y,C)}else{d("invalid args for AMD require: "+typeof(x)+", "+typeof(D)+". Expected either a string-literal singular dependency (i.e. synchronous) or an array of dependencies with a callback function (i.e. async).")}}}}m.isTaRollupShim=true;m.undef=function(x){delete n[x]};m.config=function(){if(j&&j.config){j.config.apply(j,arguments)}};m.defined=function(x){if(n.hasOwnProperty(x)){return true}if(a.hasOwnProperty(x)){return false}return j&&j.defined&&j.defined(x)};m.parsed=function(x){if(n.hasOwnProperty(x)){return true}return(a[x]&&a[x].deps)};m.specified=function(x){if(n.hasOwnProperty(x)||a[x]){return true}return j&&j.specified&&j.specified(x)};function c(D,y){var A,x,B,z;var C=[];for(A=0;A<D.length;++A){x=D[A];z=null;if(x){if(n.hasOwnProperty(x)){z=n[x];C.push(z)}else{if(r[x]){B=x.split("/");if(B[0]==="underscore"){B[0]="_"}for(z=window;B.length>1&&z;z=z[B.shift()]){}if(B.length>0&&z){z=z[B[0]]||z[B[0].toLowerCase()]}if(z){n[x]=z;C.push(z)}else{y.push(x)}}else{if(y){y.push(x)}}}}else{C.push(null)}}if(C.length!==D.length){return}return C}function w(x){var D,y,E,z;var C="Missing immediately required dependency: "+x;for(D=0;D<10;D++){var B=a[x];if(!B){C+=" (not specified)";break}if(B.error){C+=" ("+B.error+")";break}x=null;z=B.deps;if(z){for(y=0;y<z.length;y++){E=z[y];if(!n.hasOwnProperty(E)){x=E;break}}}if(!x){break}C+=" -> "+x}var A=new Error(C);if(window.IS_DEBUG&&console.error){console.error(A)}return A}function s(H,B,I){var C=[];var G=[];var z=[];var K;var L;var x;var y;var A,J,F;B.deps=B.deps||[];if(B.defname){y=a[B.defname];a[B.defname]=B;if(y&&y!==B&&y.needers&&y.needers.length){B.needers=(y.needers||[]).concat(B.needers||[])}}for(var A=0;A<H.length;A++){K=H[A];J=K.lastIndexOf("!");if(J>=0){C.push(K.substring(0,J));G.push(K.substring(J+1))}else{C.push(null);G.push(K)}}C=c(C,z);if(!C){return s(z,B)}for(var A=0;A<H.length;A++){L=C[A];x=a[H[A]];if(!x&&!n.hasOwnProperty(H[A])){x={defname:H[A]};a[H[A]]=x;var E=f(x);var M=k(x);E.error=M;try{if(L){L.load(G[A],m,E,{})}else{if(I){I(G[A],m,E,{})}else{if(j&&!j.taVer){j([x.defname],E,M)}else{throw new Error("no loader for AMD module '"+x.defname+"'")}}}F=true}catch(D){B.error=D;M(D)}}}B.need=0;for(var A=0;A<H.length;A++){K=H[A];x=a[K];if(x&&!n.hasOwnProperty(K)&&!x.error){x.needers=x.needers||[];x.needers.push(B);B.need+=1}}if(!B.need&&F){q.push(B);if(!p){p=setTimeout(b,0)}}}function b(){var z,D,C,y,x;p=-1;while(q.length>0){var A=q.shift();if(!A){continue}try{if(A.error){if(A.defname){g(A.defname)}continue}C=[];x=typeof A.deps=="string"?[A.deps]:A.deps;D=c(x||[],C);if(C.length>0){s(C,A);continue}y=null;if(A.cb){y=A.cb.apply(null,D)}A.deps=[];A.cb=null;if(A.defname){h(A.defname,y)}}catch(B){d("Error propagating dependency resolutions: ",B)}}p=null}function f(x){return function(y){if(x.defname){h(x.defname,y)}}}function k(x){return function(y){if(x.defname){x.error="Error loading '"+x.defname+"': "+y;d(x.error);x.need=0;x.deps=[];g(x.defname)}}}function h(A,B){if(n[A]){return}var C=a[A];n[A]=B;delete a[A];if(l[A]){var y=A.split("/");var D=ta;var z;if(y[0]==="ta"){y.shift()}while(y.length>1){z=y.shift();if(!D[z]){D[z]={}}D=D[z]}if(y.length>0){z=y.shift();if(!(z in D||z.toLowerCase() in D)){D[z]=B;D[z.toLowerCase()]=B}}}if(e){e(A,[],v(B))}if(C){while(C.needers&&C.needers.length>0){var x=C.needers.shift();x.need-=1;if(!x.need){q.push(x)}}}if(q.length&&!p){p=setTimeout(b,0)}}function g(z){var B=a[z];if(B){var y=B.eb;B.deps=null;B.cb=null;B.eb=null;if(!B.error){B.error="Error loading '"+B.defname+"'"}while(B.needers&&B.needers.length>0){var x=B.needers.shift();x.error="failed to load dependency '"+z+"' of '"+x.defname+"'";if(x.need>0){x.need=0;q.push(x)}if(window.IS_DEBUG&&console.error){console.error(x.error)}}if(y!=null){try{y(B.error)}catch(A){}}}if(q.length&&!p){p=setTimeout(b,0)}}function v(y){return function(){return y}}function t(){var B,z,x,A=[],y=[];if(!a){return}if(p){setTimeout(t,0);return}for(B in a){if(a.hasOwnProperty(B)){z=a[B];if(z.deps&&z.deps.length){for(x=0;x<z.deps.length;x++){if(z.deps[x]&&z.deps[x].indexOf("trjs!")!==-1){A.push(z.deps[x])}}c(A,y);if(y.length===0){continue}}d("Load event fired but we have not loaded '"+z.defname+"'"+(z.deps&&z.deps.length?" due to missing dependencies: "+y:""))}}}if(window.addEventListener){window.addEventListener("load",t)}else{if(window.attachEvent){window.attachEvent("onload",t)}}var u={install:o};u.install();h("ta/rollupAmdShim",u);return u})();require(["ta/rollupAmdShim"],function(a){a.install(["servlets/search","ta/prwidgets","ta/util/Object","ta/common/behavior/ScrollAd","ta/common/Repoll"],["ta","ta","ta","ta","ta","ta","ta","ta","ta","ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-search",files:{"js-amd":{src:{servlets:{search:1}}},js3:{src:{ta:{common:{Repoll:1,behavior:{ScrollAd:1}},util:{Object:1},prwidgets:1}}}},_:{baseUrl:"/"}})};define("vanillajs",[],function(){return{}});define("lib/jquery-amd",[],function(){return window.Zepto||ta.jquery||window.jQuery});define("ns-exporter",["vanillajs"],function(b){function a(d){if(!d){if(require.defined("ta/util/Error")){require("ta/util/Error").record(null,"Using ns-exporter:exportTo without a namespace")}return null}if(typeof d=="string"){var c=window;if(!c.ta){ta={}}d.split(".").forEach(function(e){if(!c[e]){c[e]={}}c=c[e]});d=c}return d}return{exportTo:function(e,d){d=a(d);if(!d){return false}for(var c in e){if(e.hasOwnProperty(c)){d[c]=e[c]}}return true},createNs:function(d,c,e){c=a(c);if(!c){return false}c[e]=d}}});define("ta/util/Object",["vanillajs","ns-exporter"],function(b,c){var a={};a.typeOf=function(d){return Object.prototype.toString.call(d).match(/(\w+)\]$/)[1].toLowerCase()};a.merge=function(j){for(var e=1;e<arguments.length;e++){var g=arguments[e];if(!g){continue}j||(j=(a.typeOf(g)==="array")?[]:{});for(var d in g){var h=g[d];if(g.hasOwnProperty(d)&&a.typeOf(h)!=="undefined"){var f=a.typeOf(h);if(f==="string"||f==="number"||f==="boolean"||f==="function"||h===null){j[d]=h;continue}j[d]=a.merge(j[d],h)}}}return j};c.exportTo(a,"ta.util");return a});define("ta/Core/TA.Store",["vanillajs","ns-exporter","ta/util/Object"],function(c,e,a){var d={};var b={};b.store=function(f,g){d[f]=g;return g};b.retrieve=function(f){return d[f]};b.has=function(f){return typeof(d[f])!="undefined"};b.retrieveOrStore=function(f,g){var h=d[f];if(typeof(h)=="undefined"){d[f]=g;h=g}return h};b.remove=function(f){var g=d[f];delete d[f];return g};b.keep=function(h,i){var f=b.retrieve(h),g;if(f){g=f instanceof Array?f:[f]}else{g=[]}if(i instanceof Array){i.forEach(function(j){if(!g.contains(j)){g.push(j)}})}else{g.push(i)}b.store(h,g)};b.merge=function(f,g){b.store(f,a.merge(b.retrieve(f)||{},g))};b.asInt=function(g,f){var h=parseInt(b.retrieve(g));return isNaN(h)?(f||0):h};b.asFloat=function(h,g){var i=parseFloat(b.retrieve(h));return isNaN(i)?(g||0):i};b.executeCallbacks=function(g){if(b.has(g)){var h=b.retrieve(g);if(!h instanceof Array){return}for(var f=0;f<h.length;f++){h[f]()}}};e.exportTo(b,"ta");return b});define("purify",["vanillajs"],function(c){function b(e,d){if(!e){return e}if(a(e)){if(window.IS_DEBUG){console.error("You're using a jQuery object where you shouldn't. Check the stack trace and fix it!")}return d&&e.length>1?e.get():e.get(0)}return e.forEach&&(e.length<=1||!d)?e[0]:e}function a(d){return !!(d.animate&&d.get&&d.eq&&d.each)}return b});define("ta/Core/TA.Record",["vanillajs","ns-exporter","ta/Core/TA.Store","purify"],function(v,g,d,R){var F={};var H={};var L=[];var Q=8;var b="impressionTrackingTree";var f=0,h=1,p=2;var j=[];var G=60;var K=function(aa){return typeof aa==="function"};var B=function(){var ab=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],ad;if(window.XMLHttpRequest){ad=new XMLHttpRequest()}else{for(var aa=0;aa<ab.length;aa++){try{ad=new ActiveXObject(ab[aa]);break}catch(ac){}}}return ad};var n=function(aa,ab){try{if(!aa||typeof ab!=="object"){return}if(window.JSON&&JSON.stringify){var ac=JSON.stringify(ab);if(ac&&ac.length<100000){j.push([aa,ac]);if(j.length>G){j.shift()}}}}catch(ad){}};var u=function(af,ab,ag){if(!af||typeof ab!=="object"){E(new Error("postUrl/dataObj is null/empty/undefined"),"TA.Record _simpleAjaxPost",null,arguments);if(ag){ag()}return}var ac;if(typeof Request!=="undefined"&&window.MooTools){ac={url:af,method:"post",data:ab};if(ag){ac.onComplete=ag;ac.timeout=3000}var ad=new Request(ac).send();n(af,ab);return ad}else{if(typeof Zepto!=="undefined"&&Zepto&&K(Zepto.ajax)){ac={type:"POST",url:af,data:ab,error:function(aj,ah){var ai=/InvalidTrackingTreeException/;if(window.IS_DEBUG&&new RegExp(ai).exec(aj.response)){var ak=/Caused by:\s(.*)\n/;alert("TRACKING ERROR DETECTED\n"+new RegExp(ak).exec(aj.response)[1])}E(new Error("XHR error, errorType = "+ah),"TA.Record _simpleAjaxPost",null,arguments)}};if(ag){ac.complete=ag;ac.timeout=3000}Zepto.ajax(ac)}else{if(typeof jQuery=="function"){ac={url:af,type:"POST",data:ab};if(ag){ac.complete=ag;ac.timeout=3000}jQuery.ajax(ac)}else{var aa=B(),ae=i(ab);aa.open("POST",af,false);aa.setRequestHeader("Content-type","application/x-www-form-urlencoded");aa.send(ae)}}}n(af,ab)};var E=function(){if(require.defined("ta/util/Error")){require("ta/util/Error").record.apply(this,arguments)}else{if(ta&&ta.m&&K(ta.m.recordJSError)){ta.m.recordJSError(arguments)}}};var C=function(aa){if(typeof aa=="undefined"||aa==null){return""}if(typeof aa!=="string"){aa=aa.toString()}return aa.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*")};var Z=function(ad){var aa=[];for(var ab in ad){var ac=ad[ab];aa.push(C(ab)+"."+C(ac))}return aa.join("*")};var z=function(aa){if(typeof aa=="undefined"||aa===null){return""}if(typeof aa!=="string"){aa=aa.toString()}return aa.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*").replace(/\~/g,"!~")};var t=function(ad){var aa=[];for(var ab in ad){var ac=ad[ab];aa.push(z(ab)+"."+z(ac))}return aa.join("*")};var r=function(aa){var ab=/(https?:\/\/[^\/]+)?\/([^#.?-]*)/;var ac=ab.exec(aa);if(ac){if(typeof ac[2]!="undefined"){return(ac[2])?ac[2]:"Home"}}return null};var V=function(){var aa=F.getPageData();if(aa&&aa.url){return aa.url.substring(1)}else{var ab=/\/([^-]*)/.exec(window.location.pathname);return ab?ab[1]:null}};var W=function(ac,aa,ad){var ab=new RegExp("(-"+aa+"([0-9]+))|([?&]"+ad+"=([0-9]+))");var ae=ab.exec(ac);if(ae){if(typeof ae[2]!="undefined"){return ae[2]}if(typeof ae[4]!="undefined"){return ae[4]}}return null};var M=function(aa){return W(aa,"d","detail")||W(aa,"g","geo")};var O=function(aa){var ab=document.cookie.match("(?:^|;)\\s*"+aa+"=([^;]*)");if(ab){ab=ab[1];if(ab.indexOf("%1%")===0){ab=ab.substring(3)}return decodeURIComponent(ab)}return false};var s=function(ad,ae,ab){try{var aa;if(ab.encode){ae=encodeURIComponent(ae)}if(ab.domain){ae+="; domain="+ab.domain}if(ab.path){ae+="; path="+ab.path}if(ab.duration){aa=new Date();aa.setTime(aa.getTime()+ab.duration*1000);ae+="; expires="+aa.toGMTString()}if(ab.secure){ae+="; secure"}document.cookie=ad+"="+ae}catch(ac){E(ac,"_setCookieInSeconds",null,arguments)}};var Y=function(){if(ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")){return ta.m.store.get("bookingSessionId")}return null};var D=function(){var aa=false;if(typeof ta.userLoggedIn==="boolean"){if(typeof ta.userSecurelyLoggedIn==="boolean"){aa=ta.userLoggedIn?(ta.userSecurelyLoggedIn?p:h):f}else{aa=ta.userLoggedIn}}return aa};var T=function(ad,ab){var aa={gac:ad[1],gaa:ad[2],gal:ad[3],gav:ad[4],gani:ad[5],gass:V(),gasl:M(document.location.href),gads:r(ab),gadl:M(ab),gapu:ta.uid,gams:D()},ac=Y();if(!aa.gass){throw new Error("Src servlet undefined, gac:"+aa.gac+", gaa:"+aa.gaa+", gal:"+aa.gal)}if(!aa.gads){throw new Error("Dst servlet undefined. gac:"+aa.gac+", gaa:"+aa.gaa+", gal:"+aa.gal)}if(d.has("gatt")){aa.gatt=d.retrieve("gatt")}if(ac){aa.bsid=ac}s("EVT",Z(aa),{domain:cookieDomain,duration:5,encode:true,path:"/"})};var U=function(ad){if(!ad||!ad.className||!ad.firstChild){return false}var ac=new RegExp("\\b"+b+"\\b"),aa=ad.firstChild.nodeType,ab=ad.firstChild.nodeValue;return ac.test(ad.className)&&aa===Q&&ab!==""};var k=function(){};if(require.defined("page-model")){require(["page-model"],function(aa){var ac=aa.session;var ab=ac.analyticsInfo;if(ab){d.keep("partials.pageProperties",ab.pagePropertyStringForCurrentPageview);d.store("gaMemberState",ab.memberState);if(ac.analyticsInfo&&require.defined("ta/Core/TA.Prerender")){require("ta/Core/TA.Prerender")._init(true)}}k=function(){if(ab){L.push(JSON.parse(ab.jsonForCurrentPageview))}k=function(){}}})}F.getPageData=function(){k();return L[L.length-1]};F.pushPageData=function(aa){k();if(aa){L.push(aa)}};F.popPageData=function(){k();return L.pop()};F._GARecordRequest=function(af,ad){var ab={gac:af[1],gaa:af[2],gal:af[3],gav:af[4],gani:af[5],gass:V(),gasl:M(document.location.href),gapu:ta.uid,gams:D()},ae=Y(),aa;if(ad){ab.gacl=ad}if(d.has("gatt")){ab.gatt=d.retrieve("gatt")}if(ae){ab.bsid=ae}var ac;try{if(d.retrieve("batch_garecord")){ac=require("utils/BatchRequest")}else{if(ta.m&&ta.m.batch_garecord_mobile){ac=require("mobile/lite/batch-request")}}}catch(ag){}if(ac){aa={get:function(){ac.queue("/GARecord",ab)}}}else{aa={get:function(){setTimeout(function(){var ah=new XMLHttpRequest();ah.open("GET","/GARecord?"+i(ab),true);ah.send(null)},1)}}}n("/GARecord",ab);return aa};var i=function(ab){var ac=[];for(var aa in ab){ac.push(encodeURIComponent(aa)+"="+encodeURIComponent(ab[aa]))}return ac.join("&")};H.urlArgLookup=function(ad,aa){var ac=new RegExp("[\\?&]"+ad+"=(\\w+)");var ab=ac.exec(aa);if(ab&&typeof ab[1]!="undefined"){return ab[1]}return null};F._validatedTrackEventArray=function(ac,ae,aa,ad,ab){if(ac&&typeof ac!="string"){ac=ac.toString()}if(ae&&typeof ae!="string"){ae=ae.toString()}if(aa&&typeof aa!="string"){aa=aa.toString()}if(!ad){ad=0}else{if(typeof ad!="number"){ad=parseFloat(ad);if(isNaN(ad)){ad=0}}}if(typeof ab!="boolean"){ab=(ab===true)}return["_trackEvent",ac,ae,aa,ad,ab]};F._toEvtParams=function(ac){try{var aa={gac:ac.module,gaa:ac.action,gal:ac.context,gav:ac.value,gani:ac.noninteraction};aa.gass=V();aa.gasl=M(document.location.href);aa.gapu=ta.uid;aa.gams=D();return aa}catch(ab){E(ab,"analytics._toEvtParams",null,ac)}};F._trackEventAfterAjax=function(ab){try{H.trackDMPBehavior(ab.module,ab.action,ab.context,ab.value,ab.noninteraction)}catch(aa){E(aa,"analytics._trackEventAfterAjax",null,ab)}};H.getEventPathOptions=function(af,ac,ab){try{var ae=w(ab,af);if(!ae){E(null,"ta.getEventPathOptions - invalid element",null,arguments);return}var aa=J(ae);if(ac){aa.noninteraction=ac}return aa}catch(ad){E(ad,"ta.getEventPathOptions",null,arguments)}};F._trackEventPathAfterAjax=function(aa){try{H.trackEventOnPage(aa.category,aa.action,aa.label,aa.value,aa.noninteraction)}catch(ab){E(ab,"analytics._trackEventPathAfterAjax",null,arguments)}};H.trackPhysicalCommerce=function(ac,ab,af,aa){try{var ad=F._validatedTrackEventArray(ac,"Commerce-Physical",ab,af,false);F._GARecordRequest(ad,aa).get()}catch(ae){E(ae,"ta.trackPhysicalCommerce",null,arguments)}};H.trackAttemptedCommerce=function(ab,aa,ad){try{H.trackDMPBehavior(ab,aa,ad,null,null)}catch(ac){E(ac,"ta.trackAttemptedCommerce",null,arguments)}};H.trackPhysicalAndAttemptedCommerce=function(ac,ab,ad,ae,aa){H.trackPhysicalCommerce(ac,ab,ae,aa);H.trackAttemptedCommerce(ac,ab,ad,ae)};H.trackImpressionEventOnPage=function(ab,ad,aa,ac){ab=ab||"";ad=ad||"";aa=aa||"";ac=ac||0;H.trackEventOnPage(ab,ad,aa,ac,true)};H.trackEventOnPage=function(ab,af,aa,ae,ad){try{var ac=F._validatedTrackEventArray(ab,af,aa,ae,ad);F._GARecordRequest(ac).get();H.trackDMPBehavior(ab,af,aa,ae,ad)}catch(ag){E(ag,"ta.trackEventOnPage",null,arguments)}};H.trackCommerceClickForInsight=function(af){if(!d.retrieve("insight_profile_commerce_clicks_from_data_attributes.enabled")){return}try{var ai,ab,ag,aa,ad,aj,ac,ae;ai=af.getAttribute("data-offerauthor");ab=af.getAttribute("data-locationId");ag=af.getAttribute("data-pernight");ad=ta.meta.link.getUrlFromClickElem(af);aj=ta.popups.PopUtil.extractSlotFromCommerceUrl(ad);aa=M(document.location.href);ac={};ac.providerName=""+ai;ac.clickLocId=""+ab;ac.price=""+ag;ac.slot=""+aj;ac.pageLocId=""+aa;ae=JSON.stringify(ac);H.trackEventOnPage("InsightEvent","InsightCommerceClick",ae)}catch(ah){E(ah,"ta.trackCommerceClickForInsight",null,arguments)}};H.trackEventOnPageOnce=function(ae,ag,ac,ad){var aa="eventsAlreadyTracked",af;if(ifdefNN(ta)&&ifdefNN(ta.m)&&ifdefNN(ta.m.store)){af=ta.m.store.get(aa)}else{af=d.retrieve(aa)}if(!af){af={};if(ifdefNN(ta)&&ifdefNN(ta.m)&&ifdefNN(ta.m.store)){ta.m.store.add(aa,af)}else{d.store(aa,af)}}var ab=ae+"|"+ag+"|"+ac;if(!af[ab]){H.trackEventOnPage(ae,ag,ac,0,ad);af[ab]=true}};H.trackDMPBehavior=function(ab,ae,aa,ad,ac){try{if(ta.common&&ta.common.dmp&&ta.common.dmp.isEnabled()){ta.common.dmp.sendGABehavior(ab,ae,aa,ad,ac)}}catch(af){E(af,"Error adding and sending GARecord behavior to DMP")}};H.setEvtCookie=function(ac,af,ab,ae,aa){try{var ad=F._validatedTrackEventArray(ac,af,ab,ae,false);T(ad,aa);if(ta.common&&ta.common.dmp&&ta.common.dmp.isEnabled()){ta.common.dmp.sendEventBehavior(ac,af,ab,ae,S())}}catch(ag){E(ag,"ta.setEvtCookie",null,arguments)}};var x=function(ac){var ab;try{ab=O("MEVT")||"";if(ab.length>0){ab+="~"}ab+=t(ac);if(ab.length>1024){throw"MEVT Cookie is full"}s("MEVT",ab,{domain:cookieDomain,duration:5,encode:true})}catch(aa){E(aa,"_appendMevtCookie",null,arguments);return false}return true};var m="trk";var a=m.length;var P="etk";var q=/^([A-Z]{1,2}:)?[A-Za-z_0-9\-\.]+$/;var S=function(){var aa=(typeof event!="undefined")?event:window.event;if(aa){return aa.target||aa.srcElement}return document.activeElement};F.getCommentTrackingPath=function(aa,ab){return w(aa,ab)};var w=function(ag,ai){ag=R(ag);if(!ag){ag=S();if(!ag){E(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments);return null}}if(ag.nodeType!=1){return null}var al=[];if(ai&&typeof ai=="string"&&ai!==""){if(q.test(ai)){if(ai.substring(0,2)=="P:"){al.push(ai.substring(2));return al}else{al.push(ai)}}}if(typeof ag.previousSibling==="undefined"){E(null,"_getCommentTrackingPath - browser does not support previousSibling",null,arguments);return al}LOOP_PARENT_NODES:for(var ad=ag;ad!=document.body;ad=ad.parentNode){if(ad==null){E(null,"_getCommentTrackingPath - LOOP_PARENT_NODES got unexpected null node",null,arguments);break}var aj=0;for(var aa=ad.previousSibling;aa!=null;aa=aa.previousSibling){if(aa.nodeType==Q){var ac=aa.nodeValue;if(ac==P){aj++;continue}if(ac.substring(0,a)!=m){continue}if(aj>0){aj--;continue}var af=ac.substring(a).split("/");if(!af){E(null,'ta._getCommentTrackingPath - cannot split context class: "'+ac+'"',null,arguments)}for(var ak=af.length-1;ak>=0;ak--){var ab=af[ak];var ah=q.exec(ab);if(!ah){E(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+af[ak]+'"',null,arguments);continue}if(ah[1]=="P:"){var ae=ah[0].substring(2);al.push(ae);break LOOP_PARENT_NODES}else{al.push(ah[0])}}}}}return al};var J=function(ac){if(ac.length===0){return null}var aa={action:ac[0],label:"",value:"1",category:ac[ac.length-1]};ac.shift();for(var ab=ac.length-2;ab>=0;ab--){aa.label+=ac[ab];if(ab>0){aa.label+="/"}if(ac[ab].substring(0,2)=="N:"){aa.value=ac[ab].substring(2)}}if(aa.label===""){aa.label="Unknown"}return aa};H.trk=function(ae,ag,ad,ab){ad=R(ad);try{var ai=ad?ad.getAttribute("data-trk-path"):null;if(ai){ai=ai.replace("P:","");ai=ai.split("/");ai.reverse()}else{ai=w(ad,ae);if(!ai||!ai.length){var ac="";if(ad){if(ad.outerHTML){var ah=document.createTextNode(ad.outerHTML);var aa=document.createElement("div");aa.appendChild(ah);ac=aa.innerHTML.substring(0,100)}else{if(ad.nodeName){ac=ad.nodeName}else{ac+=ad}}}else{if(ad===undefined){ac="undefined"}else{if(ad===null){ac="null"}}}if(!ae){if(ai===null){ae="null path"}else{if(ai===undefined){ae="undefined path"}else{if(ai.hasOwnProperty("length")){if(ai.length===0){ae="empty path"}else{ae=ai.join(",")}}else{ae="path: "+ai}}}}E(null,"ta.trk - invalid element for "+ae+" from "+ac,null,arguments);return}}H.trkWithPath(ai,ag,ab)}catch(af){E(af,"ta.trk",null,arguments)}};H.trkWithPath=function(af,ad,ae){try{if(!af||!af.length){E(null,"ta.trkWithPath - no path in arguments",null,arguments);return}if(ae&&ae.length>0&&af.length&&af.splice){for(var ab=ae.length-1;ab>=0;ab--){if(typeof(ae[ab])==="string"){af.splice(1,0,ae[ab])}}}var aa=J(af);H.trackEventOnPage(aa.category,aa.action,aa.label,aa.value,ad)}catch(ac){E(ac,"ta.trkWithPath - "+ac,null,arguments)}};H.trkImpTree=function(ab,ad){try{if(!U(ab)){E(null,"ta.trkImpTree called with invalid trackTreeElem!",null,arguments);if(ad){ad()}return}var aa=ab.firstChild.nodeValue;o(aa,ad)}catch(ac){E(ac,"ta.trkImpTree",null,arguments);if(ad){ad()}}};H.recordImpression=function(aa,ac){if(!aa){if(ac){ac()}return}try{o(I(aa),ac)}catch(ab){E(ab,"ta.recordImpression",null,arguments);if(ac){ac()}}};var A="<!--";var y="-->";var I=function(aa){var ab=aa.indexOf(A),ac=0,ad=aa.indexOf(y);if(ab!==-1){ac=ab+A.length}if(ad===-1){ad=aa.length}return aa.substring(ac,ad)};F.stripCommentsFromTree=I;var l="\\";var c="/";F.appendAscendTokens=function(ab){var ad=0,ac=0,aa=0;for(ad=0;ad<ab.length;ad++){if(ab[ad]===c){aa++}else{if(ab[ad]===l){ac=ad+1;while(ac<ab.length&&ab[ac]===l){aa--;ad=ac;ac++}}}}if(aa>0){for(ad=0;ad<aa;ad++){ab+=l}}return ab};var o=function(aa,ac){var ab={tTreeStr:aa&&aa.trim(),tTreeUid:ta.uid&&ta.uid.trim(),tTreeLastReferrer:window.location.href,tTreeIsMemberSignedIn:D()};if(ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")){ab.bsid=ta.m.store.get("bookingSessionId")}if(!ab.tTreeStr){E(new Error("tTreeStr is null/undefined/empty."),"ta._sendTreeImpression",null)}else{if(!ab.tTreeUid){E(new Error("tTreeUid is null/undefined/empty."),"ta._sendTreeImpression",null)}}u("/ImpressionRecord",ab,ac)};H.setEvtCookieAndPath=function(af,aa,ac){try{if(!ac){ac=S()}var ae=w(ac,af);if(!ae){E(null,"ta.setEvtCookieAndPath - invalid element for "+af,null,arguments);return}var ab=J(ae);if(!aa){while(ac.nodeName!="A"){if(ac==document.body){break}ac=ac.parentNode}aa=ac.href;if(!aa){E(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments);return}}H.setEvtCookie(ab.category,ab.action,ab.label,ab.value,aa)}catch(ad){E(ad,"ta.setEvtCookieAndPath",null,arguments)}};H.recordPageview=function(ab,ae){if(!ab){return}var aa=r(ab),ad="/PageviewRecord",ac=ae?ae:{};if(aa){ac.servletName=aa;u(ad,ac)}};H.recordTabView=function(af,ab,ae){if(!af||!ab){return}var aa=af+"-"+ab,ad="/PageviewRecord",ac=ae?ae:{};if(aa){ac.servletName=aa;u(ad,ac)}};H.resetPageDataUrl=function(){var aa=F.getPageData();if(aa){aa.url=""}};H.trackEngagementClick=function(aa,ab){if(!aa||!ab){E(new Error("object/selectionFunction is null/undefined"),"ta.trackEngagementClick",null,arguments);return}if(!K(ab)){E(new Error("passed variable selectionFunction is not a function"),"ta.trackEngagementClick",null,ab);return}ab(aa)};H.placementNodeSelectorTracker=function(ag){if(!ag||!ag.element||!ag.type){E(new Error("object/element/type is null/undefined"),"ta.placementNodeSelectorTracker",null,ag);return}var al=ag.element;var af=ag.type;var ah;var ac;var ao;var an;var ab;var ak;var ad=F.getCommentTrackingPath(al);af=af+"_Click";if(!ad){E(new Error("trackTreePath is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);return}if(ad.length<1){E(new Error("trackTreePath is missing information"),"ta.placementNodeSelectorTracker",null,arguments);return}ah=ad[ad.length-1];if(!ah){E(new Error("placement is null/undefined"),"ta.placementNodeSelectorTracker",null,ad);return}for(ak=ad.length-1;ak>=0;ak--){ab=ad[ak];if(!ab){continue}if(ab.indexOf("N:")===0){ac=ab;break}}if(ah==="HH_MainList"||ah==="Maps_MetaBlock"){ac="N:1"}else{if(!ac){E(new Error("positionNode is null/undefined"),"ta.placementNodeSelectorTracker",null,ad);return}}ao=ac.split(":");if(ao&&ao.length===2){an=ao[1]}else{E(new Error("positionSplit appears to be incorrect"),"ta.placementNodeSelectorTracker",null,arguments);return}if(!an){E(new Error("position is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);return}var aj=parseInt(an,10);if(isNaN(aj)){E(new Error("position is not a number"),"ta.placementNodeSelectorTracker",null,an);return}var aq=X(ah);if(aq===-1){return}an=aj+aq;ah=e(ah);if(ah==="hotels_slot_x"){var ap=document.getElementById("slotXListingWrap");if(ap){var aa=ap.getAttribute("data-prodAttr");var am=parseInt(ap.getAttribute("data-prodId"),10);H.trackEventOnPage(ah,af,aa,am+1)}return}var ae;var ai=document.querySelectorAll(".ui_tab_bar .ui_tab.selected");if(ai.length===1){ai=ai[0];ae=ai.getAttribute("data-currentSort")}H.trackEventOnPage(ah,af,ae,an)};var e=function(aa){if(!aa){return aa}if(V()!=="Hotels"){return"Clicks_"+aa}var ab;if(aa==="Hotels_MainList"||aa==="Hotels_MainList_Sponsored"){ab="Clicks_"+aa}else{if(aa==="hotels_list_short_cells2"){ab="Clicks_Hotels_MainList"}else{if(aa==="sponsored_coupon_listing"){ab="Clicks_Hotels_MainList_Sponsored"}else{if(aa==="DesktopSlotX"||aa==="MobileSlotX"||aa==="Hotels_SlotX_Sponsored"){return"hotels_slot_x"}}}}if(document.getElementById("sponsoredCouponListingWrap")&&ab==="Clicks_Hotels_MainList"){ab+="_Sponsored"}ab+=(ta.widgets.calendar.getCheckRatesData())?"_PostDates":"_PreDates";return ab};var X=function(ad){if(!ad){E(new Error("placement is null/undefined"),"ta._shiftOrdinalsWithSponsoredPlacement",null,ad);return -1}if(V()!=="Hotels"){return 0}var ab=0;var af=d.retrieve("hac.offset");if(af&&af>0){ab=af}if(!document.getElementById("sponsoredCouponListingWrap")){return ab}var ac=document.querySelector("#HAC_RESULTS .pageNumbers .current");var aa;if(ac){var ae=ac.getAttribute("data-page-number");aa=parseInt(ae,10);if(isNaN(aa)||!aa){E(new Error("pageNumber is not a number"),"ta._shiftOrdinalsWithSponsoredPlacement",null,ae);return -1}}if(ad==="hotels_list_short_cells2"||ad==="Hotels_MainList"){ab+=aa;return ab}if(af&&af>0&&(ad==="sponsored_coupon_listing"||ad==="Hotels_MainList_Sponsored")){ab+=(aa-1)}return ab};H.getRecentTARecords=function(){return j};H.addTypeAheadMevt=function(aa){aa.t="ta";return x(aa)};H.addGARecordMevt=function(ad,ae,ac,ai,ab){try{var aa=F._validatedTrackEventArray(ad,ae,ac,ai,false),ah={t:"ga",gac:aa[1],gaa:aa[2],gal:aa[3],gav:aa[4],gani:aa[5],gass:V(),gasl:M(document.location.href),gads:r(ab),gadl:M(ab),gapu:ta.uid,gams:D()},af=Y();if(!ah.gass){throw new Error("Src servlet undefined, gac:"+ah.gac+", gaa:"+ah.gaa+", gal:"+ah.gal)}if(!ah.gads){throw new Error("Dst servlet undefined. gac:"+ah.gac+", gaa:"+ah.gaa+", gal:"+ah.gal)}if(d.has("gatt")){ah.gatt=d.retrieve("gatt")}if(af){ah.bsid=af}x(ah);if(ta.common&&ta.common.dmp&&ta.common.dmp.isEnabled()){ta.common.dmp.sendEventBehavior(ad,ae,ac,ai,S())}}catch(ag){E(ag,"ta.addGARecordMevt",null,arguments)}};g.createNs(F,"ta","analytics");g.exportTo(H,"ta");var N={};g.exportTo(F,N);g.exportTo(H,N);return N});define("utils/ajax",["lib/jquery-amd","ta/Core/TA.Record","api-mod"],function($,taRecord,api){return function(url,options){if(!url.substr){options=url}var newOpts=$.extend({},options,{dataFilter:function(data,type){if(type=="json"){data=data.replace(/^\s*while\s*\([^)]*\);?/,"")}options&&options.dataFilter&&options.dataFilter.call(this,data,type);return data}});newOpts.xhrFields=newOpts.xhrFields||{};newOpts.xhrFields.withCredentials=true;if(api.isElement(newOpts.data)){newOpts.data=api.getFormData(newOpts.data)}var trackEvent=newOpts.trackEvent;if(trackEvent){$.extend(newOpts,taRecord._toEvtParams(trackEvent));newOpts.complete=function(){taRecord._trackEventAfterAjax(trackEvent);options&&options.complete&&options.complete.apply(this,arguments)}}if(newOpts.evalScripts){newOpts.success=function(data,status,xhr){if(data&&data.substr){var dom,scripts;if($.parseHTML){dom=$($.parseHTML(data,document,true));scripts=dom.filter("script").add(dom.find("script"))}else{dom=$("<div>"+data+"</div>");scripts=dom.find("script")}scripts.each(function(idx,script){if(script.innerHTML){if(window.execScript){window.execScript(script.innerHTML)}else{if(window.eval){window.eval(script.innerHTML)}else{var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.text=script.innerHTML;document.head.appendChild(scriptObj);document.head.removeChild(scriptObj)}}}})}options&&options.success&&options.success.apply(this,arguments)}}return url.substr?$.ajax(url,newOpts):$.ajax(newOpts)}});define("ta/util/Error",["vanillajs","api-mod","utils/ajax","ns-exporter","mixins/Events"],function(g,e,m,n,p){var c={};var d=new p("error","beforeSend");var f=3000;var l="unset";var j=false;var a=0;c.record=function(J,s,C,D,y){var E=require("ta/util/Cookie");if(!J){J=new Error("Stub error to build stack.")}if(j||a>9){return}a++;j=true;var A=false;try{A=document.body.className.match(/\bjs_logging\b/)}catch(M){}if(!A){j=false;return}if(IS_DEBUG&&console.error){console.error("JS_ERROR_RECORD: "+s,J)}var P=true;if(D&&D.hasOwnProperty("error_script")&&!o(D.error_script)&&!q(D.error_script)){P=false}var x={};var O=false;try{if(C||window.event){O=(C||event).target;x.eTarg=this.getSelectorString(O)}}catch(B){}if(typeof(debugCacheKey)!="undefined"){x.key=debugCacheKey}var r=window.pageServlet;if(!r){r="unknown"}x.servlet=r;if(!y||typeof y!="string"){y="ERROR"}if(!P){y="WARN";x.warnReason="externalError"}else{if(!IS_DEBUG&&a>1){y="WARN";x.warnReason="notFirstJSError"}}var R={extraInfoError:"Problem storing extra info"};var w={};try{var v="";var u="";if(O){if(typeof O.id!=="function"){v=O.id}u=O.className}var K="";if(typeof serverPool!="undefined"&&serverPool){K=serverPool}var G="";if(window.MooTools){G+="MooTools "}if(require.defined("lib/jquery-amd")){G+="jQuery "}w={TARGET_ID:v,TARGET_CLASS:u,PAGE_UID:ta.uid,INTERNAL_JS:h(),CLIENT_POOL:K,COOKIES_ENABLED:E.canSet(),JS_LIBS:G};if(!P){w.INTERNAL_ERROR="false"}if(a>1){w.PRIOR_JS_PAGE_ERRORS=a-1}}catch(L){D=R}x.xInfo=i(w,D);try{x.eUrl=window.location.href}catch(B){}var z="No Error";try{if(J){if(Object.prototype.toString.call(J)===Object.prototype.toString.call(new Error)){z=J.name+"-"+J.message}else{if(typeof J==="object"){z="non-Error object "+Object.prototype.toString.call(J)+" passed, sample properties - ";var Q=0;for(var t in J){if(J.hasOwnProperty(t)){z+=t.substring(0,30)+": "+(J[t]&&J[t].toString?J[t].toString().substring(0,20):J[t])+", ";if(++Q>4){break}}}}else{z="non-Object error passed: "+(""+J).substring(0,30)}}z=z.replace(/[\r\n]/g,"")}}catch(B){}x.eMsg=z;var I="";try{I=k(s).substring(0,150);x.eBlk=I}catch(B){}try{if(I.indexOf("window.onerror")!=0){var N=b(J);if(N){x.eStak=N}}}catch(B){}try{d.emit("beforeSend",x)}catch(B){}x.eLogLevel=y;try{m({url:"/JSErrorRecord",data:x,method:"POST"})}catch(M){x={eBlk:"JSErrorRecord Error",servlet:r,eLogLevel:"ERROR",eMsg:"no error retrieved"};m({url:"/JSErrorRecord",data:x})}j=false;if(window.IS_DEBUG){(window.ERRORS||(window.ERRORS=[])).push(x);if(J&&y==="ERROR"&&false){throw J}}d.emit("error",z,s,y);if(l=="unset"){l=E.readRaw("JS_ERROR_HANDLING")}if(l){if(l.match(/alert/)){var F="";for(var H in x){if(x.hasOwnProperty(H)){F=F+H+": "+x[H]+"\n"}}window.alert(F)}if(l.match(/console/)){if(window.console){console.error(x)}}}};c.ajaxFailure=function(t,s,r){c.record(null,t,null,e.merge({status:s.status},r))};c.on=d.on.bind(d);c.off=d.off.bind(d);function i(z,r){var w="_extraInfoError_:Problem storing extra info.";var y={};var A="";try{if(Array.isArray(r)||(Object.prototype.toString.call(r)==="[object Arguments]")){var t={};for(var v=0;v<r.length;v++){var s=r[v];var x=typeof s;if(x==="string"||x==="number"||x==="boolean"){t[v]=s}else{t[v]=x}}r=t}e.merge(y,z,r)}catch(u){y=z}try{A=JSON.stringify(y);if(A){if(A.length>f){A=A.substring(0,f)}return A.replace(/[\r\n]/g,"")}}catch(u){}return w}function k(r){if(typeof r!="undefined"&&r!==null){return r.toString().replace(/[\r\n]/g,"")}return"null or undefined"}function b(x){var y="";if(x&&x.stack&&x.stack.substr){var z=x.stack.split("\n");z=z.map(function(D){var C=D.lastIndexOf("/");if(C>0){D=D.substr(C+1)}return D});return z.join()}try{if(arguments&&arguments.callee){var A=[];var s=arguments.callee.caller;s=s.caller;var v=0;while(s&&v++<20){var t=s.toString();if(t.match(/onErrorFunc/)){s=s.caller;continue}var r=t.length;var u=r>100?100:r;var B=t.substring(0,u);B=B.replace(/(\n|\r|\'|\")/g,"");B+="::";A.push(B);s=s.caller}return A.join(" ")}}catch(w){y="-arguments.callee issue"}return"none"+y}function h(){var r="";[].forEach.call(document.getElementsByTagName("script"),function(u){var t=u.src;if(o(t)){var s=r==""?"":", ";t=t.substring(t.indexOf("/js")+1);r=r+s+t}});if(r.length>f){r=r.substring(0,f)}return r}function o(r){if(!r||!r.indexOf){return false}var s=window.CDNHOST||"";if(window.IS_DEBUG&&s==""){return r.match(/(js3\/|js\/)/)!=null}else{return r.indexOf(s)==0}}function q(s){if(!s||!s.indexOf){return false}var r="noPage";try{r=window.location.href}catch(t){}return s===r}n.createNs(c,"ta.util","error");return c});define("utils/resourceLoader",["vanillajs"],function(c){var d={};var a={};function e(){var i,k,f;this.load=function(q,m,r){if(typeof m==="function"){r=m;m={}}i=0;k=b(q||null);r=r||function(){};m=m||{};f=m.serial;if(k.length==0){setTimeout(r,1)}else{if(f){var p=k.slice();var o;var n=function(s){o=o&&s;if(p.length==0){r&&r(o)}else{l(n,m.forceType,p.shift())}};n()}else{k.forEach(l.bind(null,r,m.forceType))}}};function g(){try{if(navigator.userAgent.match(/ Safari[/]/)&&!navigator.userAgent.match(/ Chrom/)&&navigator.userAgent.match(/ Version\/5\./)){return false}var n=navigator.userAgent.match(/\ AppleWebKit\/(\d+)\.(\d+)/);if(n){n.shift();var m=parseInt(n[0]),o=parseInt(n[1]);if(m<535||(m==535&&o<23)){return false}}return"onload" in document.createElement("link")}catch(p){return false}}function j(m,o,n){i++;(i==k.length||f)&&o(n);if(n){if(require.defined("ta/util/Error")){require("ta/util/Error").record(new Error(m),"utils/resourceLoader: failed to load file ["+m+"]")}}else{d[m]=1}}function h(m){if(m.match(/\.css$/)){return"css"}else{if(m.match(/\.js$/)){return"js"}}return""}function l(t,r,o){var q=r||h(o);if(q){var s,p,m;if(q=="css"){s=document.createElement("link");s.rel="stylesheet";s.type="text/css";m="href";p=g()}else{if(q=="js"){s=document.createElement("script");s.type="text/javascript";m="src";p="onload" in s}}if(p){s.onload=j.bind(null,o,t,false);if("onerror" in s){s.onerror=function(){if(a[o]){j(o,t,true)}else{a[o]=true;l(t,r,o)}}}}else{j(o,t,false)}s[m]=o;var n=document.getElementsByTagName("head")[0];n.appendChild(s)}else{if(require.defined("ta/util/Error")){require("ta/util/Error").record(new Error(o),"utils/resourceLoader: unknown file type for ["+o+"]")}j(o,t,true)}}}function b(h){var g=[];var f=function(i){if(i&&!(i in d)){if(i&&i.splice){i.forEach(f)}else{g.push(i)}}};f(h);return g}return{Loader:e,load:function(g,f,h){if(typeof f==="function"){h=f;f={}}(new e()).load(g,f,h)},loaded:function(f){return b(f).length==0}}});define("ta/Core/TA.Load",["vanillajs","ns-exporter","ta/Core/TA.Store","utils/resourceLoader"],function(c,d,f,b){var a={};a.load=function(i,n,m){var l=false;var j=e(i);if(j){l=VERSION_MAP[j]}var h=function(){var o=f.remove(g);o&&o.forEach(function(p){if(p){p()}})};if(l){var g=j+"_callback";if(f.has(g)){var k=f.retrieve(g);k.push(n);f.store(g,k)}else{f.store(g,[function(){delete VERSION_MAP[j];if(n){n()}}]);if(typeof l==="object"){b.load(l,{serial:true,forceType:"js"},h)}else{b.load(l,{forceType:"js"},h)}}}else{if(m&&b.loaded(l)){h();n&&n()}}return l};a.loadInOrder=function(g,h){b.load(g,{serial:true},h)};function e(k){if(typeof k!="string"||!VERSION_MAP){return}var i=false;if(VERSION_MAP[k]){i=k}else{if(VERSION_MAP[k+".js"]){i=k+".js"}else{var g=k.split(".");var h=0;while(g&&g.length>1&&h<10){g=g.slice(0,-1);var j=g.join("-")+".js";if(j&&VERSION_MAP[j]){i=j;break}h++}}}return i}d.exportTo(a,ta);return a});define("ta/Core/TA.Event",["vanillajs","ta/util/Error","ta/Core/TA.Load","ns-exporter","ta/Core/TA.Store"],function(vanilla,taError,taLoad,nsExporter,taStore){var exports={};var _eventListeners={};exports.call=function(funcName,evnt,elmt){if(evnt==null){if(IS_DEBUG){alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);")}return false}if(funcName==null){if(IS_DEBUG){alert("ta.call of undefined function")}return false}var func=funcName;if(typeof(funcName)==="function"){funcName="<func>"}else{if(!/^ta\.[\w\d\.]+$/.test(funcName)){if(IS_DEBUG){alert("Invalid function name. Must be of the form: ta.namespace.Class.function")}return false}}var e=evnt||window.event;["stopPropagation","preventDefault"].forEach(function(name){if(!e[name]){e[name]=function(){}}});if(!e.stop){e.stop=function(){e.preventDefault();e.stopPropagation()}}if(!elmt){elmt=e.target||e.srcElement}if(!elmt){taError.record(null,"ta.call re-wrap fail (non-DOM element) - "+funcName,evnt,{elmtArg:taError.describe({none:"none"}),funcName:funcName})}var argSet=arguments;var args=Array.prototype.slice.call(argSet,3);args.splice(0,0,e,elmt);try{args.unshift({callback:_ta_call_defer,evt:e});args.unshift(func);return exports.run.apply(null,args)}catch(_ex){taError.record(_ex,"ta.call - "+funcName,evnt)}return false};var _ta_call_defer=function(func,options){if(options){delete (options.evt)}exports.run.apply(null,arguments)};exports.run=function(func,options){var argSet=arguments,args=Array.prototype.slice.call(argSet,2);try{var fn=exports.fn(func);if(typeof fn=="function"){var retVal=fn.apply(window,Array.prototype.slice.call(args));if(options&&options.onComplete){var completeFun=exports.fn(options.onComplete);if(completeFun){completeFun(retVal)}}return retVal}else{if(options&&options.evt){if(options.evt.stopPropagation){options.evt.stopPropagation()}else{options.evt.cancelBubble=true}if(options.evt.preventDefault){options.evt.preventDefault()}else{options.evt.returnValue=false}}}var callback=options&&options.callback;taLoad.load(func,(callback||exports.run).pass(arguments))}catch(_ex){taError.record(_ex,"ta.run - "+func)}return false};exports.on=function(name,f){var v=_eventListeners[name];if(!v){v=_eventListeners[name]=[]}v.push(f)};exports.fireEvent=function(name,_varargs_){var args=Array.prototype.slice.call(arguments),listeners=_eventListeners[name];args.shift();if(listeners){listeners.slice(0).forEach(function(callback){try{callback.apply(null,args)}catch(e){}})}};exports.off=function(name,f){if(f){var v=_eventListeners[name],index;if(v instanceof Array){index=v.indexOf(f);if(index>=0){v.splice(index,1)}}}else{delete _eventListeners[name]}};function QueueTimer(evtName,after){var m_timer=0;var m_totalTime=0;var m_data=[];var m_start=0;var m_done=false;this.start=function(){m_timer&&clearTimeout(m_timer);m_start=Date.now()};this.end=function(name){var now=Date.now();var duration=now-m_start;m_totalTime+=duration;var out=""+duration+"ms ["+(name||"")+"]";var outEvt=evtName+(after?"-after":"");if(m_done){console.error("Straggler for "+outEvt+": "+out)}else{m_data.push(out);m_timer=setTimeout(function(){console.error("Timing for "+outEvt+": "+m_totalTime+"ms\n"+m_data.sort(function(a,b){return parseInt(a)-parseInt(b)}).join("\n"));m_done=true},2000)}}}var OneTimeFunctionQueue=function(evtName,after,runNow){var _queue=[];var _runNow=!!runNow;var _timing;var _execFn=function(fn,name){_timing&&_timing.start();try{fn()}catch(_ex){try{taError.record(_ex,"OneTimeFunctionQueue "+evtName+(after?"-after":"")+(name?"-"+name:""))}catch(ignore){}}_timing&&_timing.end(name)};var _runQueuedFunctions=function(){_queue.sort(function(a,b){return(a.priority-b.priority)||(a.subpriority-b.subpriority)});if(after){var delay=1;_queue.forEach(function(item){setTimeout(_execFn.bind(null,item.func,item.name),delay++)})}else{_queue.forEach(function(item){_execFn(item.func,item.name)})}_queue=[]};if(evtName!=null){function onListener(){_runNow=true;_runQueuedFunctions()}if(window.addEventListener){window.addEventListener(evtName,onListener,false)}else{if(window.attachEvent){if(evtName=="DOMContentLoaded"){window.attachEvent("onload",onListener)}else{if(evtName=="load"){window.attachEvent("on"+evtName,function(){setTimeout(onListener,1)})}else{window.attachEvent("on"+evtName,onListener)}}}}}this.addToQueue=function(fn,priority,name){if(!fn){taError.record(null,"addToQueue for "+evtName+" queue - no function");return}if(typeof priority==="string"){name=priority;priority=false}if(_runNow){_execFn(fn,name)}else{priority=priority||(100+_queue.length);_queue.push({func:fn,priority:priority,name:name,subpriority:_queue.length})}};this.executeQueue=function(){_runQueuedFunctions()}};var loaded=typeof document!=="undefined"?document.readyState==="complete":false;var ready=(typeof document!=="undefined"?document.readyState==="interactive":false)||loaded;var _readyQ=new OneTimeFunctionQueue("DOMContentLoaded",false,ready);var _loadQ=new OneTimeFunctionQueue("load",false,loaded);var _afterLoadQ=new OneTimeFunctionQueue("load",true);if(!ready){_loadQ.addToQueue(function(){_readyQ.executeQueue()},-999999999,"checkReadyQueue")}_loadQ.addToQueue(function(){_afterLoadQ.executeQueue()},999999999,"afterLoadQueue");exports.queueForReady=function(fn,priority,name){_readyQ.addToQueue(fn,priority,name)};exports.queueForLoad=function(fn,priority,name){_loadQ.addToQueue(fn,priority,name)};exports.queueForAfterLoad=function(fn,name){_afterLoadQ.addToQueue(fn,0,name)};exports.hasEventListener=function(name){return !!(_eventListeners[name])};exports.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=false;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null};exports.fireClick=function(node){if(document.createEvent){var evt=document.createEvent("MouseEvents");evt.initEvent("click",true,false);node.dispatchEvent(evt)}else{if(document.createEventObject){node.fireEvent("onclick")}else{if(typeof node.onclick==="function"){node.onclick()}}}};nsExporter.exportTo(exports,ta);return exports});define("ta/util/Date",["vanillajs","ns-exporter"],function(b,c){var a={};a.MS_IN_DAY=1000*60*60*24;a.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];a.HOUR_CONST=12;a.THAI_BUDDHIST_YEAR_OFFSET=543;a.MAX_STAY_DURATION_DAYS=30;a.MAX_VR_DURATION_DAYS=183;a.MAX_DAYS_BEFORE_RETURN_FLIGHT=330;a.inDateSet=function(f,e){if((f==null)||(e==null)){return false}var h=e.length;for(var g=0;g<h;g++){var j=e[g];if(j.length){var k=j[0].getTime();var d=j[1].getTime();if((k<=f.getTime())&&(d>=f.getTime())){return true}}else{if(f.getTime()==j.getTime()){return true}}}return false};a.rangesIntersect=function(d,e){return Math.max(d[0].getTime(),e[0].getTime())<=Math.min(d[1].getTime(),e[1].getTime())};a.getDaysInRange=function(e,d){return Math.round((d.getTime()-e.getTime())/a.MS_IN_DAY)+1};a.getLastDayOfMonth=function(d){var e=new Date();if(d){e=new Date(d.getTime())}e=new Date(a.normalize(e));e.setDate(1);e.setMonth(e.getMonth()+1);e.setDate(0);return e.getDate()};a.getDaysApart=function(f,e){var d=24*60*60*1000;if(f&&e){return Math.round(Math.abs((f.getTime()-e.getTime())/(d)))}return 0};a.inSameMonth=function(e,d){return(e!=null)&&(d!=null)&&(e.getMonth()==d.getMonth())&&(e.getYear()==d.getYear())};a.normalize=function(d){return d.setHours(a.HOUR_CONST,0,0,0)};a.create=function(g,e,f){return new Date(g,e,f,a.HOUR_CONST)};c.exportTo(a,"ta.util.date");return a});define("mixins/page-dates/Utils",["vanillajs"],function(e){function g(i){var h=String(i);return(h.length===1?"0":"")+h}function a(h){return h.getFullYear()+"_"+g(h.getMonth()+1)+"_"+g(h.getDate())}function d(i){if(!i){return null}var h=i.split("-");return new Date(parseInt(h[0],10),parseInt(h[1],10)-1,parseInt(h[2],10))}function f(h){return Object.prototype.toString.call(h)==="[object Date]"}function b(j,i){if((!j||!i)&&[j,i].every(f)){return false}var k=new Date(j.getTime());var h=new Date(i.getTime());k.setHours(0,0,0,0);h.setHours(0,0,0,0);return k.getTime()===h.getTime()}function c(j,i){var h;while(j&&j!==document.body){h=j.querySelector("[data-dateType="+i+"]");if(h){return h}j=j.parentNode}return null}return{pad:g,dateToIso:a,fromString:d,compareDatesNoTime:b,findClosestDatepicker:c}});define("mixins/page-dates/DateTypeStore",[],function(){var d="zu";var e={CHECKIN:{queryString:null,pathString:null},CHECKOUT:{queryString:null,pathString:null},STAYDATES:{children:["CHECKIN","CHECKOUT"],queryString:"staydates",pathString:d+"s"},EATERY:{queryString:"eaterydate",pathString:d+"r"},DEPARTURE:{queryString:null,pathString:null},RETURN:{queryString:null,pathString:null},ROUNDTRIP:{children:["DEPARTURE","RETURN"],queryString:"roundtrip",pathString:d+"t"},ONEWAYFLIGHT:{queryString:"oneway",pathString:d+"o"},LEG_1:{queryString:"leg1date",pathString:d+"1"},LEG_2:{queryString:"leg2date",pathString:d+"2"},LEG_3:{queryString:"leg3date",pathString:d+"3"},ATTRACTION:{queryString:"attrdate",pathString:d+"a"}};function c(g){var f=b(g);if(f.length==0){return g}return e[f[0]].children[0]}function a(g){var f=b(g);if(f.length==0){return g}var h=e[f[0]];return h.children[h.children.length-1]}function b(g){var f=[];for(var h in e){if(!e.hasOwnProperty(h)){continue}if(e[h].children&&e[h].children.indexOf(g)>=0){f.push(h)}}return f}e.isChildDateType=function(f){return b(f).length>0};e.getParents=b;e.isHotelDateType=function(f){return b(f).indexOf("STAYDATES")>=0};e.isRoundTripDateType=function(f){return b(f).indexOf("ROUNDTRIP")>=0};e.isStartDateType=function(g){var f=b(g);if(f.length==0){return false}return e[f[0]].children.indexOf(g)==0};e.isEndDateType=function(g){var f=b(g);if(f.length==0){return false}var h=e[f[0]];return h.children.indexOf(g)==h.children.length-1};e.getStartDate=function(g){var f=c(g);if(f==null){return ta.page.getDates(g)[0]}return ta.page.getDates(f)[0]};e.getEndDate=function(f){var g=a(f);if(g==null){return ta.page.getDates(f)[0]}return ta.page.getDates(g)[0]};e.flattenType=function(f){var g=e[f];if(!g){return[]}if(!g.children){return[f]}return g.children.slice(0)};e.getCorrespondingDateType=function(f){switch(f){case"CHECKIN":return"CHECKOUT";case"CHECKOUT":return"CHECKIN";case"DEPARTURE":return"RETURN";case"RETURN":return"DEPARTURE";default:return null}};return e});define("mixins/page-dates/Base",["vanillajs","ta","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore"],function(j,g,f,a){function d(k){return k instanceof Date&&!isNaN(k.getTime())}function e(k){if(!a[k]){throw"Invalid date type: "+k}}function c(l){var k=[];for(var m in a){if(!a.hasOwnProperty(m)){continue}if(a[m].children&&a[m].children.indexOf(l)>=0){k.push(m)}}return k}function b(n,l){var o=a[n],p="";if(o.children){for(var m=0,k=o.children.length;m<k;m++){if(l[o.children[m]]==="_"){return"_"}p+=(m>0?"_":"")+f.dateToIso(l[o.children[m]])}}else{if(l[n]==="_"){return"_"}else{p+=f.dateToIso(l[n])}}return p}function i(n,l){var o=a[n];if(o.children){for(var m=0,k=o.children.length;m<k;m++){if(l[o.children[m]]!=="_"){return false}}return true}else{if(l[n]==="_"){return true}}return false}var h=function(k){var m={};var l={};(function(){var o,n;if(k){for(n in k){o=f.fromString(k[n]);if(k.hasOwnProperty(n)&&a[n]&&d(o)){m[n]=o}}}})();this.hasDates=function(p){e(p);if(a[p].children){for(var o=0,n=a[p].children.length;o<n;o++){if(!g.page.hasDates(a[p].children[o])){return false}}return true}return !!m[p]&&m[p]!=="_"};this.hasUserSetDates=function(n){if(a[n].children){return a[n].children.reduce(function(o,p){return o||!!l[p]},false)}return !!l[n]};this.getDates=function(p){var q=[];e(p);if(a[p].children){for(var o=0,n=a[p].children.length;o<n;o++){q.push(m[a[p].children[o]])}}else{q.push(m[p])}for(var o in q){if(q[o]==="_"){q[o]=null}}return q};this.setDates=function(p,r){e(p);if(!Array.isArray(r)){r=[r]}r=r.map(function(s){return s instanceof Date?new Date(s.getFullYear(),s.getMonth(),s.getDate()):"_"});if(a[p].children){if(a[p].children.length!==r.length){throw"Incorrect number of dates for date type "+p}for(var o=0,n=a[p].children.length;o<n;o++){var q=a[p].children[o];m[q]=r[o];l[q]=true}}else{if(r.length!==1){throw"Incorrect number of dates for date type "+p}m[p]=r[0]}l[p]=true};this.clearDates=function(p){if(!p){m={};return}e(p);if(a[p].children){for(var o=0,n=a[p].children.length;o<n;o++){m[a[p].children[o]]="_"}}else{m[p]="_"}};this.datesToQueryString=function(n){var o=a[n];e(n);if(!o.queryString){throw"Cannot generate query-string for DateType "+n}if(!g.page.hasDates(n)&&!i(n,m)){return""}if(!g.page.hasUserSetDates(n)){return""}return o.queryString+"="+b(n,m)};this.datesToQueryPath=function(n){var o=a[n];e(n);if(!o.pathString){throw"Cannot generate path-string for DateType "+n}if(!g.page.hasDates(n)&&!i(n,m)){return""}if(!g.page.hasUserSetDates(n)){return""}return o.pathString+b(n,m)};this.datesToQueryJson=function(o){var p=a[o],n={};e(o);if(!p.queryString){throw"Cannot generate query json for DateType "+o}if(!g.page.hasDates(o)&&!i(o,m)){return{}}if(!g.page.hasUserSetDates(o)&&o!=="EATERY"){return{}}n[p.queryString]=b(o,m);return n}};h.prototype.onDatesSelected=function(p,n,o){var m=c(n);if(!g.page||!g.page.emit){return}g.page.emit&&g.page.emit("dateSelected",p,n,o);for(var l=0,k=m.length;l<k;l++){if(g.page.hasDates(m[l])){g.page.emit&&g.page.emit("dateSelected",p,m[l],g.page.getDates(m[l]))}}};h.prototype.usingUnifiedDates=true;return h});define("calendars/CalendarDate",["vanillajs"],function(b){function a(c){c=c||new Date();this.date=new Date(c.getFullYear(),c.getMonth(),c.getDate())}a.prototype={constructor:a,daysInMonth:function(){return new Date(this.year(),this.month()+1,0).getDate()},eachDayInMonth:function(e){for(var c=1,d=this.daysInMonth();c<=d;c++){e(new a(new Date(this.year(),this.month(),c)))}},thisMonth:function(){return new a(new Date(this.year(),this.month(),1))},nextMonth:function(){return this.relativeMonth(1)},previousMonth:function(){return this.relativeMonth(-1)},relativeMonth:function(c){return new a(new Date(this.year(),this.month()+c,1))},relativeDay:function(c){return new a(new Date(this.year(),this.month(),this.day()+c))},year:function(){return this.date.getFullYear()},month:function(){return this.date.getMonth()},day:function(){return this.date.getDate()},dayOfWeek:function(){return this.date.getDay()},firstDayOfMonth:function(){return new Date(this.year(),this.month(),1).getDay()},inRange:function(c,d){if(!c||!d){return false}return this.compare(c)>0&&this.compare(d)<0},compare:function(d){var f=["getFullYear","getMonth","getDate"],g;for(var e=0,c=f.length;e<c;e++){g=f[e];if(this.date[g]()<d.date[g]()){return -1}if(this.date[g]()>d.date[g]()){return 1}}return 0},daysTo:function(c){return Math.ceil((c.date.getTime()-this.date.getTime())/(1000*60*60*24))},toString:function(){return this.year()+"-"+this.month()+"-"+this.day()}};a.fromString=function(d){var c=d.split("-");return new a(new Date(c[0],c[1],c[2]))};return a});define("ta/util/I18N",["vanillajs","ns-exporter"],function(b,c){var a={};a.isRtl=function(){return !!document.body.className.match(/\brtl\b/)};c.exportTo(a,"ta.util.i18n");return a});define("ta/util/Deferred",["vanillajs","ns-exporter"],function(e,j){var k=["success","failure","always","progress"];var b={resolved:["success","always"],rejected:["failure","always"]};var g=function(){};function l(i){g.prototype[i]=function(n,m){return a(this,i,m?n.bind(m):n)}}for(var c=0;c<k.length;c++){l(k[c])}g.prototype.then=function(m,n){var i=this.success(m);return n?i.failure(n):i};var h=function(o){var i="pending";var n=new g();n.queue=[];n.args=null;n.aplus=(typeof o==="boolean")&&o;n.status=function(){return i};var m={notify:function(){if(d(i)){throw new Error("Promise has already been fulfilled.")}var q=Array.prototype.slice.call(arguments);var s,r,p;for(r=0,p=n.queue.length;r<p;r++){s=n.queue[r];if(s.hook==="progress"){s.callback.apply(null,q)}}return n},resolve:function(){if(d(i)){throw new Error("Promise has already been fulfilled.")}i="resolved";n.args=Array.prototype.slice.call(arguments);return f(n)},reject:function(){if(d(i)){throw new Error("Promise has already been fulfilled.")}i="rejected";n.args=Array.prototype.slice.call(arguments);return f(n)},isFulfilled:function(){return d(i)},promise:function(){return n}};return m};var d=function(i){return i==="resolved"||i==="rejected"};var a=function(m,i,n){if(m.fwd){return a(m.fwd,i,n)}m.queue.push({hook:i,callback:n});return f(m)};var f=function(n){if(n.fwd){return f(n.fwd)}var m,i;while(d(n.status())&&(m=n.queue.shift())){if(~b[n.status()].indexOf(m.hook)){i=m.callback.apply(null,n.args);if(i instanceof g){i.queue=i.queue.concat(n.queue.splice(0));n=n.fwd=i}else{if(i&&n.aplus){n.args=[i]}}}}return n};j.createNs(h,"ta.util","Deferred");return h});define("ta/Core/TA.Dust",["vanillajs","ns-exporter","ta/util/Error","ta/util/Deferred","ta/Core/TA.Store"],function(d,g,a,e,b){var c={};var f=null;var h=function(){if(f!=null){return f}try{f=JSON.parse(b.retrieve("DUST_GLOBAL"));return f}catch(j){}if(typeof window!=="undefined"&&window.DUST_GLOBAL){return window.DUST_GLOBAL}if(require.defined("page-model")){return require("page-model").DUST_GLOBAL}return{}};c.render=function(l,n,j,p){var m=h(),o=typeof j=="string"?document.querySelector(j):j,k=dust.makeBase(m).rebase(n);if(!o||!l||!m.LOCALE||!dust){return false}dust.render(i(l),k,function(r,q){if(q){o.innerHTML=q}else{if(r){a.record(r,"Error rendering dust template "+l)}}if(p){p(n)}});return true};c.renderToString=function(l,n){var m=h(),j=dust.makeBase(m).rebase(n),k=e(true);if(!l||!m.LOCALE||!dust){k.reject("Missing dependencies");return k.promise()}dust.render(i(l),j,function(p,o){if(o){k.resolve(o)}else{if(p){a.record(p,"Error rendering dust template "+l);k.reject(p)}}});return k.promise()};var i=function(j){var k=j.replace(/\//g,"_").replace(".dust",""),l=h().LOCALE;return l+k};g.exportTo(c,"ta.dust");return c});define("calendars/DesktopStayDates",["vanillajs","ta","api-mod","overlays/Overlay","overlays/styles/modal","overlays/styles/popover","overlays/position","overlays/options/closeOnDocClick","overlays/options/repositionOnEvent","overlays/options/repositionOnTaEvent","overlays/options/storeOverlayOnElement","calendars/CalendarDate","overlays/options/closeOnTaEvent","overlays/options/centerArrowOnSrcElement","ta/util/I18N","ta/Core/TA.Dust","ta/util/Deferred","ta/util/Date","mixins/page-dates/DateTypeStore"],function(x,f,e,C,h,v,m,K,r,p,k,q,D,w,L,G,j,F,y){var d="calendars/desktop_stay-dates/calendar.dust",B="calendars/desktop_stay-dates/month.dust",E=300,I=!!window.TransitionEvent;var o,z;var i=543;function n(N,O){var M=[],U,S=false,R=c(O.dateType);N.eachDayInMonth(function(X){var W=!S&&X.compare(O.today)===0;S=S||W;var V=O.startDate&&X.compare(O.startDate)===0;M.push({label:X.day(),date:a(X,O)?null:X.toString(),today:W,start:!R&&V,end:O.endDate&&X.compare(O.endDate)===0,selected:(R)?V:X.inRange(O.startDate,O.endDate)})});U=N.firstDayOfMonth()-jsGlobalDayOffset;U+=U<0?7:0;for(var P=0;P<U;P++){M.unshift({label:"&nbsp;"})}var T=N.year();if(O.thaiOffset===true){T=T+i}var Q=f.i18n?f.i18n.formatDate("yearmonth_abbr",new Date(T,N.month())):jsGlobalMonths[N.month()]+" "+T;return{dayLabels:jsGlobalDaysShort,days:M,header:Q}}function A(N){var M=[n(N.currentMonth,N),n(N.currentMonth.nextMonth(),N)];return{incomplete:N.incomplete,months:M,showPrices:N.showPrices,hsxHDv4:N.hsxHDv4,didCreateDefaultDates:N.didCreateDefaultDates,calendarPopupDirection:N.calendarPopupDirection,defaultOpen:N.defaultOpen,declutterControl:N.declutterControl}}function J(O){var M=new q(),N={availableDates:O.availableDates,excludedDates:O.excludedDates,startDate:O.startDate&&new q(O.startDate),endDate:O.endDate&&new q(O.endDate),today:M,thisMonth:M.thisMonth(),incomplete:O.incomplete,dateType:O.dateType,minEnabledDate:O.minEnabledDate||M,maxEnabledDate:O.maxEnabledDate||M.relativeDay(330),maxStayLength:O.maxStayLength||F.MAX_STAY_DURATION_DAYS,thaiOffset:O.thaiOffset,hsxHDv4:O.hsxHDv4,didCreateDefaultDates:O.didCreateDefaultDates,calendarPopupDirection:O.calendarPopupDirection,defaultOpen:O.defaultOpen,declutterControl:O.declutterControl,className:O.className||null};N.currentMonth=t(N);return N}function t(N){var O;if(N.dateType==="RETURN"&&N.endDate){var M=!!N.startDate?N.startDate.thisMonth():N.thisMonth();O=(M.compare(N.endDate.previousMonth())<0)?N.endDate.previousMonth():M}else{if(N.startDate){O=N.startDate.thisMonth()}else{if(N.endDate){O=N.endDate.previousMonth();if(N.thisMonth.compare(O)>0){O=N.thisMonth}}else{O=N.thisMonth}}}return O}function a(S,N){var U=N.today,M=N.startDate,R=N.dateType,P=N.minEnabledDate,V=N.maxEnabledDate,T=N.maxStayLength,W=N.availableDates,O=N.excludedDates;if(!l(R)){if(W){for(var Q=0;Q<W.length;Q++){if((new q(S.date)).compare(new q(W[Q]))==0){return false}}return true}if(O){for(var Q=0;Q<O.length;Q++){if((new q(S.date)).compare(new q(O[Q]))==0){return true}}}}if(P&&P.compare(S)>0){return true}if(l(R)&&M&&M.daysTo(S)>T){return true}if(V&&V.compare(S)<0){return true}return false}function b(P,O,M){var S=2,N=P>0?S:-1,R=O.currentMonth.relativeMonth(N),Q=L.isRtl()?"dsdc-scroll-right":"dsdc-scroll-left";if(R.compare(O.minEnabledDate.thisMonth())<0){return}if(R.compare(O.maxEnabledDate.thisMonth())>0){return}z=true;G.renderToString(B,{month:n(R,O)}).then(function(V){var T=e.find(".dsdc-months",M),U=document.createElement("div");U.innerHTML=V;if(P<0){e.addClass(T,"dsdc-no-anim");T.insertBefore(U.firstChild,T.firstChild);e.addClass(T,Q);e.forceReflow(T);e.removeClass(T,"dsdc-no-anim")}else{T.appendChild(U.firstChild)}if(P<0){e.removeClass(T,Q)}else{e.addClass(T,Q)}setTimeout(function(){if(P<0){T.removeChild(T.lastChild)}else{e.addClass(T,"dsdc-no-anim");T.removeChild(T.firstChild);e.removeClass(T,Q);e.forceReflow(T);e.removeClass(T,"dsdc-no-anim")}z=false},I?E:0);O.currentMonth=O.currentMonth.relativeMonth(P);H(O)})}function H(N,M){if(N.currentMonth.compare(N.minEnabledDate.thisMonth())<=0){e.addClass(e.find(".dsdc-prev",M),"dsdc-inactive")}else{e.removeClass(e.find(".dsdc-prev",M),"dsdc-inactive")}if(N.currentMonth.relativeMonth(1).compare(N.maxEnabledDate.thisMonth())>=0){e.addClass(e.find(".dsdc-next",M),"dsdc-inactive")}else{e.removeClass(e.find(".dsdc-next",M),"dsdc-inactive")}}function g(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){window.getSelection().removeAllRanges()}}}function s(N,O,M,P){P=P||window.event;if(!P||!P.target||z){return}var Q=P.target.className;if(Q.indexOf("dsdc-next")>=0){b(1,O,M)}else{if(Q.indexOf("dsdc-prev")>=0){b(-1,O,M)}else{if(P.target.getAttribute("data-date")){N.resolve([q.fromString(P.target.getAttribute("data-date")).date]);o&&o.hide()}}}g();return false}function u(N){var M=N.defaultOpen=="openAsPopover"?"":"no_x";if(N.declutterControl){M="no_x"}var O=M+" no_padding date_picker_modal "+(window.isTabletOnFullSite?"tablet":"desktop");if(N.className){O=O+" "+N.className}if(!N){return O}return O}function l(M){return y.isChildDateType(M)&&!y.isStartDateType(M)&&!y.isRoundTripDateType(M)}function c(M){return !y.isChildDateType(M)}return{open:function(P,O){if(o){o.destroy()}var M=j(true),N=J(O);G.renderToString(d,A(N)).then(function(R){var Q=[h(P,"below",u(N),null,null,R),m.bottomRight(),K,k,r(window,"date_bar_docked"),r(window,"date_bar_undocked"),D("dualSearchTypeaheadOpen")];o=new C(P,Q);o.on("hide",function(){if(!M.isFulfilled()){M.reject()}o=null});o.show();H(N,o.container);e.addEvent(o.container,"click",s.bind(null,M,N,o.container))});return M.promise()},openInline:function(S,Q,N){var O=f.util.Deferred(true),P=J(Q),M=N.getElement(".innerCalendarWrapper");M.destroy();M=new Element("div",{"class":"innerCalendarWrapper"});N.adopt(M);P.showPrices=!f.page.hasDates("STAYDATES");var R=function(){M.hide();if(!O.isFulfilled()){O.reject()}};f.dust.renderToString(d,A(P)).then(function(T){M.innerHTML=T;H(P,M);f.addEvent(M,"click",f.bind(s,null,O,P,M));f.addEvent(f.find(".update_results_button",M),"click",function(){S.addClass("greenFocus")});f.addEvent(f.find(".dsdc-close-x",M),"click",R)});return O.promise()},openInContainer:function(T,R,O){var P=j(true),Q=J(R),N=e.getParent(O,"calendarFlyout"),M=e.find(".innerCalendarWrapper",O),S=O.overlay;e.destroy(M);M=document.createElement("div");M.className="innerCalendarWrapper";O.appendChild(M);if(S){S.on("hide",function(){if(!P.isFulfilled()){P.reject()}})}G.renderToString(d,A(Q)).then(function(U){M.innerHTML=U;H(Q,M);e.addEvent(M,"click",s.bind(null,P,Q,M))});N.deferred=P;return P.promise()},closeCalendar:function(){if(o){o.destroy()}},openAsPopover:function(P,O){if(o){o.destroy()}var M=j(true),N=J(O);G.renderToString(d,A(N)).then(function(X){var Z=R(N);var S=e.find("#PHOTO_ALBUM_META");if(S&&S.contains(P)){Z="below"}var T=e.find(".trip_search");var aa=e.find(".ui_icon.calendar",P);if(T){Z="below"}var U=Q(Z);var Y=Z=="left"||Z=="right";var V=true;if(Y){V=false}var W=[v(P,Z,u(N),null,X),U,w(aa,V,!V),K,k,r(window,["resize","date_bar_docked"]),p("showingCookieConsentBanner"),p("makeTextFitResizedText"),D("dualSearchTypeaheadOpen")];o=new C(P,W);o.on("hide",function(){if(!M.isFulfilled()){M.reject()}o=null});e.addEvent(e.find(".dsdc-close-x",o.container),"click",function(){o.hide()});e.addEvent(e.find(".dsdc-wrapper .ui_close_x",o.container),"click",function(){o.hide()});o.show();H(N,o.container);e.addEvent(o.container,"click",s.bind(null,M,N,o.container))});function Q(S){if(typeof m[S]=="function"&&S!="below"){return m[S]([0,0])}else{return m.bottomRight([-16,-8])}}function R(S){if(!S||!S.calendarPopupDirection||S.calendarPopupDirection==""){return"below"}return S.calendarPopupDirection}return M.promise()}}});define("mixins/page-dates/Validator",["vanillajs","ta","mixins/page-dates/DateTypeStore","calendars/CalendarDate","ta/util/Date"],function(h,f,b,k,e){var j={STAYDATES:[d,i,g(e.MAX_STAY_DURATION_DAYS)],ROUNDTRIP:[d]};function d(m){if(!b[m].children||!f.page.hasDates(m)){return true}var l=b[m].children;var n=f.page.getDates(m);return(b.isStartDateType(l[0])&&b.isEndDateType(l[1])&&n[0]<=n[1])||(b.isEndDateType(l[0])&&b.isStartDateType(l[1])&&n[1]<=n[0])}function i(l){if(!b[l].children||!f.page.hasDates(l)){return true}var m=f.page.getDates(l);return m[0].getTime()!==m[1].getTime()}function g(l){return function(m){if(!b[m].children||!f.page.hasDates(m)){return true}return a.apply(null,f.page.getDates(m))<=l}}function a(o,n){var m=o instanceof k?o:new k(o);var l=n instanceof k?n:new k(n);return Math.abs(m.daysTo(l))}var c={validate:function(m){var l=j[m];if(!l||l.length==0){return true}return !l.some(function(n){return !n(m)})}};return c});define("mixins/page-dates/Desktop",["vanillajs","ta","api-mod","ta/Core/TA.Event","ta/Core/TA.Store","ta/util/Date","mixins/page-dates/Base","calendars/DesktopStayDates","calendars/CalendarDate","mixins/page-dates/Utils","ta/util/Date","mixins/page-dates/DateTypeStore","mixins/page-dates/Validator"],function(D,g,e,d,h,c,n,p,u,G,J,E,q){var x=!!(g&&g.widgets&&g.widgets.calendar&&!g.widgets.calendar.isShim),N=false,O=false,j=p.open,B=false,A=null,I=null,C=J.MAX_STAY_DURATION_DAYS,F=false,v=false,b=false,k=false,z=null,r="open",t=false,M=false,a=null,l=null,f=null,L=null,H=false,P=false;function s(S,T){if(E.isHotelDateType(S)||E.isRoundTripDateType(S)){var R={startDate:E.getStartDate(S),endDate:E.getEndDate(S),incomplete:!g.page.hasDates("STAYDATES"),dateType:S,thaiOffset:B,maxStayLength:C,autoSelectDates:F,hsxHDv4:v,calendarBarDisabled:b,didCreateDefaultDates:k,calendarPopupDirection:z,defaultOpen:r,declutterControl:M,supportsPrePopWithDefaultDates:H,supportsPrePopWithNoDates:P};var Q=h.retrieve("multiDP.minCheckInDate")||A;if(Q){R.minEnabledDate=new u(G.fromString(Q))}if(I){R.maxEnabledDate=new u(G.fromString(I))}if(T){R.calendarPopupDirection=T}return R}return{startDate:E.getStartDate(S),incomplete:!g.page.hasDates(S),dateType:S,thaiOffset:B,autoSelectDates:F,hsxHDv4:v,calendarBarDisabled:b,didCreateDefaultDates:k,calendarPopupDirection:z,defaultOpen:r,declutterControl:M,availableDates:a,excludedDates:l,minEnabledDate:f&&new u(G.fromString(f)),maxEnabledDate:L&&new u(G.fromString(L)),supportsPrePopWithDefaultDates:H,supportsPrePopWithNoDates:P}}function i(S){var U=S.getAttribute("data-dateType");var W;var R=void (0);var Q=void (0);var X=S;if(E.getCorrespondingDateType(U)==null){return null}W="[data-dateType="+E.getCorrespondingDateType(U)+"]";if(window&&window.pageServlet&&(window.pageServlet=="HotelHighlight"||window.pageServlet=="SmartDeals")){for(var T=0;T<3&&!Q;T++){S=S.parentNode;if(!S){return null}Q=S.getAttribute("data-pickerIndex")}var V=document.querySelector("[data-pickerIndex='"+Q+"']");return g.find(W,V)}for(var T=0;T<3&&!R;T++){S=S.parentNode;if(!S){return null}R=e.find(W,S)}if(R==null&&E.isStartDateType(U)){X.setAttribute("data-dateType",E.getCorrespondingDateType(U));return X}return R}function y(Q){E.getParents(Q).forEach(function(R){if(!q.validate(R)){E[R].children.filter(function(S){return S!==Q}).forEach(function(S){g.page.clearDates(S);g.page.emit("dateSelected",null,S,[null])})}})}function m(){if(!g.widgets.calendar||g.widgets.calendar.isShim){return}var R=g.page.getDates("CHECKIN")[0],Q=g.page.getDates("CHECKOUT")[0];if(g.page.hasDates("CHECKIN")){g.widgets.calendar.setPageInDate(c.create(R.getFullYear(),R.getMonth(),R.getDate()),true)}else{g.widgets.calendar.clearPageInDate(true)}if(g.page.hasDates("CHECKOUT")){g.widgets.calendar.setPageOutDate(c.create(Q.getFullYear(),Q.getMonth(),Q.getDate()),true)}else{g.widgets.calendar.clearPageOutDate(true)}g.widgets.calendar.syncAllDatePickers()}function w(R,S,T){if(R==null){return}var Q=R.getAttribute("data-trackingContext");if(!Q){Q=R.getAttribute("data-dateType")}if(T||!g.page.hasDates(R.getAttribute("data-dateType"))){Q+="|PRE"}else{Q+="|CHANGE"}g.trackEventOnPage("DATEPICKER",S,Q)}function o(T,U,S,Q){var V="START";if(S==="STAYDATES"||!Q||Q[0]==null){return}if((S==="CHECKIN"||S==="CHECKOUT")&&g.page.hasDates("STAYDATES")){V="SELECT";if(U){var R;if(t){R=k?"default_dated_to_manually_dated":"manually_dated_to_manually_dated"}else{R="undated_to_manually_dated"}g.trackEventOnPage("DATEPICKER",R);k=false;t=true}}w(U,V,T)}var K=function(R,Q){e.mixin(this,new n(R));if(Q){B=Q.thaiOffset||B;N=Q.autoAdvance||N;O=Q.popCheckInFirst||O;j=p[Q.defaultOpen]||j;A=Q.minCheckIn;I=Q.maxCheckOut;C=Q.maxStayLength||J.MAX_STAY_DURATION_DAYS;F=Q.autoSelectDates;v=Q.hsxHDv4;b=Q.calendarBarDisabled;k=Q.didCreateDefaultDates;z=Q.calendarPopupDirection;r=Q.defaultOpen;M=Q.declutterControl;a=Q.availableDates;l=Q.excludedDates;f=Q.minEnabledDate;L=Q.maxEnabledDate;H=Q.supportsPrePopWithDefaultDates;P=Q.supportsPrePopWithNoDates}};K.prototype.gatherDates=function(V,X,R,T){if(O&&V&&V.getAttribute("data-dateType")==="CHECKOUT"&&!g.page.hasDates("CHECKIN")&&!g.page.hasDates("CHECKOUT")){V=i(V)}var S=V?V.getAttribute("data-dateType"):"UNKNOWN",U=o.bind(null,!g.page.hasDates(S));if(V&&e.hasClass(V,"focused")){return}e.addClass(V,"focused");w(V,"OPEN");g.page.on("dateSelected",U);var Q=j;if(X){Q=T?p.openInline:p.openInContainer}var W=V?V.getAttribute("data-popup-direction-override"):null;return Q.call(null,V,s(S,W),X).then(function(Z){h.store("enteredDatesInPreDates",!g.page.hasDates("STAYDATES"));e.removeClass(V,"focused");e.removeClass(V,"greenFocus");g.page.pushDates(V,S,Z,R);g.page.removeListener("dateSelected",U);var Y=g.page.hasDates("STAYDATES");if(Y&&!R){d.fireEvent("onCalendarRangeSelect")}if(T&&Y){X.getElement(".innerCalendarWrapper").hide()}},function(){e.removeClass(V,"focused");e.removeClass(V,"greenFocus");g.page.removeListener("dateSelected",U);if(T&&g.page.hasDates("STAYDATES")){X.getElement(".innerCalendarWrapper").hide()}})};K.prototype.checkIfCalendarShouldPrePop=function(S){if(!S){return}t=g.page.hasDates("STAYDATES");var Q=g.localStorage.get("calendarHasBeenPoppedDueToDefaultDates")||false;var R=S.getAttribute("data-didCreateDefaultDates")=="true"&&H&&!Q;var T=R||(!t&&P);if(T){g.page.gatherDates(S);g.trackEventOnPage("User_Arrived_Predates");if(R){g.trackEventOnPage("DATEPICKER","undated_to_default_dated");g.localStorage.set("calendarHasBeenPoppedDueToDefaultDates",true)}}};K.prototype.gatherDatesNear=function(R){var Q=G.findClosestDatepicker(R,"CHECKIN");if(Q){g.page.gatherDates(Q)}};K.prototype.pushDates=function(T,R,S,Q){g.page.setDates(R,S);y(R);x&&m();g.page.onDatesSelected(T,R,S,Q)};return K});define("mixins/mixin",["vanillajs"],function(a){return function(e){var c=Array.prototype.slice.call(arguments,1),b,f;for(var d in c){if(!c.hasOwnProperty(d)){continue}b=c[d];for(f in b){e[f]=b[f]}}return e}});define("utils/asdf-encoder",["ns-exporter","vanillajs"],function(b){var a={};a.getOffset=function(d){if(d>=97&&d<=122){return d-61}if(d>=65&&d<=90){return d-55}if(d>=48&&d<=71){return d-48}return -1};a.asdf=function(f){var j={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],q:[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],x:[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],z:[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]};var e="";for(var d=0;d<f.length;d++){var k=f.charAt(d);var g=k;if(j[k]&&d+1<f.length){d++;g+=f.charAt(d)}else{k=""}var h=getOffset(f.charCodeAt(d));if(h<0||typeof j[k][h]=="String"){e+=g}else{e+=j[k][h]}}return e};b.exportTo(a,window);return a});define("utils/urlutils",["vanillajs","utils/asdf-encoder"],function(e,c){var d=window.asdf||((global&&global.asdf)?global.asdf:c.asdf);function f(l,j,m){var k=new RegExp("(-"+j+"([0-9]+))|([?&]"+m+"=([0-9]+))");var n=k.exec(l);if(n){if(typeof n[2]!=="undefined"){return Number(n[2])}if(typeof n[4]!=="undefined"){return Number(n[4])}}return void (0)}function h(j){return f(j,"d","detail")||f(j,"g","geo")}function i(l){var k={};var o=l.split("#")[0].split("?")[1]||"";var n=o.split("&");for(var m=0;m<n.length;m++){var j=n[m].split("=");if(j[0]){k[decodeURIComponent(j[0])]=decodeURIComponent(j[1])}}return k}function b(l){var k=[];for(var j in l){if(l.hasOwnProperty(j)){k.push(encodeURIComponent(j)+"="+encodeURIComponent(l[j]))}}return k.join("&")}function a(j){return location.protocol+"//"+location.hostname+j}function g(j){j=j||"";if(j.indexOf("http")===-1){j=a(j)}return j.replace("http://","https://")}return{asdf:d,getUrlArgNumeric:f,getUrlPageLoc:h,getUrlQueryArgs:i,toQueryString:b,https:g}});define("utils/stopevent",["vanillajs"],function(){return function(a){if(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}return false}});define("utils/waiton",["vanillajs"],function(){return function(d,g,b){var f=0,e=null,a=false;if(!d||d.length==0){g();return}function c(){if(--f<=0&&!a){e&&clearTimeout(e);a=true;g()}}d.forEach(function(h){f++;h(c)});if(b>0){e=setTimeout(function(){f=0;c()},b)}}});define("commerce/offerclick",["ta","mixins/mixin","mixins/Events","utils/urlutils","utils/stopevent","utils/waiton","vanillajs"],function(e,j,h,s,p,q){var m=new RegExp("(&|\\?)from=[^&]*");var o=new RegExp("(&|\\?)ob=[^&]*");var r=[];var b=null;function n(u){if(typeof(u)!=="string"){return u}var t=s.asdf(u.trim()).replace(/&amp;/g,"&");if(typeof window!=="undefined"&&window.crPageServlet){t=t.replace(m,"$1from=HotelDateSearch_"+crPageServlet)}if(typeof document!=="undefined"&&document.location&&document.location.href){var v=s.getUrlPageLoc(document.location.href);if(v){t+="&pageLocId="+v}}var w=s.getUrlQueryArgs(t);t=t.replace(o,"");return{url:t,isBooking:(t.indexOf("/StartBooking")>=0),ttP:w.tp,ttIK:w.ik,slot:w.slot,providerName:w.p,ik:w.ik,locId:(w.d||w.geo),area:w.area,contentId:(w.src_0||w.src),trackingContext:w.btc,openBehavior:w.ob}}function d(t){if(typeof t==="function"){r.push(t)}}function i(t){if(t.openBehavior==="same_tab"){return false}if(t.isBooking&&typeof e!=="undefined"&&e.browser&&e.browser.isIE10Metro()){return false}if(typeof e=="undefined"||!e.util||!e.popups||!e.popups.PopUtil){return false}return true}function k(){try{document.domain=document.domain}catch(t){return true}return false}function l(u){u=n(u);var v=k(),t=window.open(v?u.url:"","_blank");if(!t&&typeof(Browser)!=="undefined"&&Browser.ie&&u.isBooking){if(e.util&&e.util.cookie){e.util.cookie.setPIDCookie(38822)}g(u);return}!v&&e.popups.PopUtil.redirectToUrl(t,u.url);r.forEach(function(w){w(u,function(){})});e.popups.PopUtil.pollForPartnerLoad(t,new Date(),u.providerName,u.slot)}function g(t){t=n(t);q(r.map(function(u){return u.bind(null,t)}),function(){if(typeof e!=="undefined"&&e.retrieve&&e.retrieve("ta.isIE11orHigher")){window.open(t.url,"_self",null,false)}else{window.location.href=t.url}})}function f(w,v,u,t){if(w&&!t){p(w)}u=n(u);c.emit("beforeClick",u);if(e.store&&e.retrieve&&v&&v.getAttribute("data-pernight")&&u&&u.ttIK){var x=e.retrieve("CLICK_PRICE_DOUBLE_CHECK");if(!x){x={}}x[u.ttIK]=v.getAttribute("data-pernight");e.store("CLICK_PRICE_DOUBLE_CHECK",x)}if(require.defined("ta/Core/TA.Event")){setTimeout(function(){try{require("ta/Core/TA.Event").fireEvent("metaLinkClick",v,(u.isBooking?"TripAdvisor":u.providerName),u.area,u.locId,u.contentId,"new_tab",u.slot);if(u.isBooking){require("ta/Core/TA.Event").fireEvent("ibOfferClick",v)}}catch(y){require.defined("ta/Core/TA.Error")&&require("ta/Core/TA.Error").record(y,"Commerce click tracking failed",null,{servlet:window.pageServlet,url:u.url,area:u.area})}},300)}if(b&&b(u)){return false}if(i(u)){l(u)}else{g(u)}c.emit("afterClick",u);return false}function a(t){b=t}var c={expandToken:n,clickEvent:f,registerAsyncPreclick:d,setPreClickHandler:a};return j(c,new h("beforeClick","afterClick"))});define("commerce/impression-tracker",["vanillajs","ta","ta/Core/TA.Record","ta/Core/TA.Event","commerce/offerclick"],function(h,d,e,i,k){var f={};var c=false;function a(){f={}}function m(n){if(!n){return}var p=n.getAttribute("data-ttP");if(!p){return}var o=n.getAttribute("data-ttIK");if(!o){return}b(p,o,n);if(n.getAttribute("data-ttSendNow")==="true"){j(p,o)}}function g(s,r){if(!s||!r){return void (0)}var p=f[s]||[];for(var q=0,o=p.length;q<o;q++){if(p[q].k===r){var n=p[q].v;p.splice(q,1);return n}}return void (0)}function b(q,p,o){if(!q||!p||!o){return}var n=f[q]||[];n.unshift({k:p,v:o});n.splice(3);f[q]=n}function j(q,p,n){var o=g(q,p);if(!o){return(n?n():void (0))}var r=o.innerHTML;if(r){r=r.replace("<!--","").replace("-->","").trim()}if(!r){return(n?n():void (0))}e.recordImpression(r,n)}function l(){if(c){return}k.registerAsyncPreclick(function(n,o){j(n.ttP,n.ttIK,o)});i.on("hac-could-not-complete",function(){Object.keys(f).forEach(function(n){var o=f[n];if(!o||!o[0]||!o[0].k){return}j(n,o[0].k)})});i.on("offerClickTrackingTree",m);c=true}return{init:l,clearTrackingTrees:a,onTrackingTreeElement:m}});define("servlets/search",["ta","mixins/Events","mixins/page-dates/Desktop","api-mod","commerce/impression-tracker"],function(c,a,f,e,b){var d=false;function g(h){if(!d){c.mixin(this,new a("dateSelected"));c.mixin(this,new f(h.pageDates));b.init();d=true}var i=this.onDatesSelected;this.onDatesSelected=function(o,k,n){var m=e.select(".dp_cr");var q=false;var p;if(m.length>0){for(var j=0;j<m.length;j++){if(m[j].contains(o)){q=true;p=m[j];break}}if(q&&p){var l=p.get("data-url");if(l&&l.contains("/Hotel_Review")&&c.page.hasDates("STAYDATES")){window.open(l,"_blank")}}}i(o,k,n)};return this}return{init:g}});define("amdloaders",["vanillajs"],function(){var j=[],u=[],v=[],l=[];var h=[];var d=null,B=null,E=null;var s={};var F={};var g={};var w={};var A=null;var r=false;var c=false;var i={};var q=function(G,H,I){if(!s[G]){s[G]=true;u.push(G)}h.push(function(J){if(!J&&H.parsed&&!H.parsed(G)){J=new Error("Dynamic load failed to define module '"+G+"'")}if(J&&I.error){I.error(J)}});D()};var p=function(G,H,I){if(!s[G]){s[G]=true;if(!F[G]&&!H.specified(G)){u.push(G)}}h.push(function(J){var K=H.specified(G);if(!J&&!F[G]&&!K){J=new Error("Dynamic load failed to define '"+G+"'")}if(J){if(I.error){I.error(J)}}else{if(K){H([G],I,I.error)}else{I(true)}}});D()};var a=function(G,H,I){j.push(G);h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var t=function(G,H,I){v.push(G);h.push(function(J){if(!J&&!H.specified("trhtml!"+G)){J=new Error("Dynamic load failed to define content '"+G+"'")}if(J){if(I.error){I.error(J)}}});D()};var n=function(G,H,I){if(!g[G]){g[G]=true;if(!w[G]){l.push(G)}}h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var n=function(G,H,I){if(!g[G]){g[G]=true;if(!w[G]){l.push(G)}}h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var D=function(){if(!A&&r&&!c&&(h.length||j.length||u.length||v.length||l.length)){A=setTimeout(z,0)}};var b=function(J,I){var G=J.getAttribute("data-rup");if(!G){return}var K;G=G.split(",");for(var H=0;H<G.length;H++){K=G[H].trim();if(K){I(K)}}};var x=i.getJSRollupsLoaded=function(){var I,H;var G=B;if(!G){G=[];H=document.getElementsByTagName("SCRIPT");if(H){for(I=0;I<H.length;I++){if(!H[I].hasAttribute("data-is-dust")){b(H[I],function(J){G.push(J);s[J]=true})}}}}return G};var m=i.getCSSRollupsLoaded=function(){var I,H;var G=d;if(!G){G=[];H=document.head&&document.head.getElementsByTagName("LINK");if(H){for(I=0;I<H.length;I++){b(H[I],function(J){G.push(J)})}}}return G};var e=i.getLoadedFilesParams=function(){return{haveJses:String(x()),haveCsses:String(m())}};var z=function(){A=null;if(!r||c){return}var L,J,G;var O=[],I=j,H=h,M=v,R=l;for(L=0;L<u.length;L++){G=u[L];if(G&&!F[G]&&!require.parsed(G)){O.push(G)}}h=[];j=[];u=[];v=[];l=[];if(!d){d=m()}if(!B){B=x()}if(!O.length&&!I.length&&!M.length&&!R.length){o(H);return}var K="haveJses="+encodeURIComponent(String(B))+"&haveCsses="+encodeURIComponent(String(d))+"&needJses="+encodeURIComponent(String(O))+"&needCsses="+encodeURIComponent(String(I))+"&needDusts="+encodeURIComponent(String(R));if(M.length>0){K+="&needContent="+encodeURIComponent(String(M))}if(window.pageServlet){K+="&metaReferer="+encodeURIComponent(window.pageServlet)}var U=null;try{U=new XMLHttpRequest()}catch(T){try{U=new ActiveXObject("MSXML2.XMLHTTP")}catch(S){try{U=new ActiveXObject("Microsoft.XMLHTTP")}catch(Q){throw new Error("Can't create XMLHttpRequest or similar")}}}var N=false;U.onreadystatechange=function(){if(!N&&U.readyState===4){N=true;if(U.status>=200&&U.status<=299){k(H,U.responseText)}else{o(H,new Error("XHR returned "+U.status))}}};U.open("POST","/DemandLoadAjax",true);try{U.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(P){}try{U.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(P){}try{U.setRequestHeader("Accept","text/html, */*")}catch(P){}c=true;U.send(K)};var o=function(H,G){c=false;D();if(!H.length){return}for(var I=0;I<H.length;++I){try{H[I](G)}catch(J){window.IS_DEBUG&&console.error&&console.error("Error in async callback: ",J)}}};var k=function(P,N){var M,O;var J=[];try{if(!(N&&N.substr)){throw new Error("no data returned from /DemandLoadAjax")}var G=document.createElement("DIV");G.innerHTML=N;var K=G.querySelectorAll("STYLE, LINK");var T=[];for(O=0;O<K.length;O++){T.push(K[O])}K=T;T=document.createDocumentFragment();for(O=0;O<K.length;O++){var I=K[O];b(I,function(U){d.push(U);define("trcss!"+U,[],C(H))});T.appendChild(I)}document.head.appendChild(T);K=G.getElementsByTagName("SCRIPT");var L=[];for(O=0;O<K.length;O++){var I=K[O];b(I,function(U){if(I.hasAttribute("data-is-dust")){w[U]=true}else{B.push(U);F[U]=true}});var S=document.createElement("script");S.setAttribute("type","text/javascript");S.setAttribute("data-rup",I.getAttribute("data-rup"));if(I.src){S.src=I.src;S.async=true;J.push(S)}else{if(I.text){S.text=I.text;document.head.appendChild(S);document.head.removeChild(S)}}}var H,Q;while((H=G.firstChild)){G.removeChild(H);if(H.nodeType===1){Q=H.getAttribute("data-content");if(Q){define("trhtml!"+Q,[],C(H))}}}}catch(R){M=R}if(J.length>0){y(J,P,M)}else{o(P,M)}};var C=function(G){return function(){return G}};var y=function(G,I,K){var J,H,M=0;var L=function(){if(--M===0){o(I,K)}};for(J=0;J<G.length;J++){H=G[J];if(H){H.onload=L;H.onerror=L;M+=1}}if(M<=0){o(I,K)}else{for(J=0;J<G.length;J++){H=G[J];if(H){document.head.appendChild(H)}}}};var f=function(){if(!r){r=true;if(!define.depLoader||define.depLoader.isDefault){define.depLoader=q}D()}};define("trjs",[],function(){return{load:p}});define("trcss",[],function(){return{load:a}});define("trhtml",[],function(){return{load:t}});define("trdust",[],function(){return{load:n}});if(document.addEventListener){document.addEventListener("DOMContentLoaded",f)}if(window.addEventListener){window.addEventListener("load",f)}else{if(window.attachEvent){window.attachEvent("onload",f)}}return i});define("ta/prwidgets",["vanillajs","ns-exporter","purify","amdloaders"],function(i,q,b,j){var t={};var e=define;var l=require;var m={};var s=/\bhandlerLoading *\b/g;var o;t.define=function(z,y,B,v,A){y=y.replace(/\.js$/i,"");if(Object.prototype.toString.call(v)!=="[object Array]"){v=[]}if(B&&B.length){var x=m[z];if(!x){m[z]=x={}}for(var w=0;w<B.length;w++){x[B[w]]=true}}var u="$prw/"+z+"/"+y;if(l.undef){l.undef(u)}e(u,n(z,v),function(){var C=Array.prototype.slice.apply(arguments);return function(D){if(!D[y]){D[y]=A.apply(null,h(D,v,C))}return D[y]}})};function d(u,y){var v,x;var w=this.element._prWidgetContext;if(typeof u==="string"){u=[u];v=n(w.widget.name,u);v=v[0]&&l(v[0]);v=v&&h(w,u,[v]);return v&&v[0]}u=u.slice();l(n(w.widget.name,u),function(){var z=h(w,u,arguments);y&&y.apply(null,z)})}function n(A,z,y){var x=m[A];if(!x){return[]}z=z.slice();for(var w=0;w<z.length;++w){var v=z[w];var B=v.replace(/^[a-z]+!/,"");var u=v.substring(0,v.length-B.length);if(u==="trhtml!"){}else{if(B==="widget"){z[w]=null}else{if(x[u==="trjs!"?B:v]){z[w]=u+"$prw/"+A+"/"+B}}}}return z}function h(x,z,v){var u,w;v=Array.prototype.slice.apply(v);if(z.length===0){return v}var y=m[x.widget.name];if(v.length<z.length){u=n(x.widget.name,z);while((w=v.length)<z.length){if(u[w]){v.push(l(u[w]))}else{v.push(null)}}}for(var w=0;w<z.length;++w){var A=z[w].replace(/^trjs!/,"");if(x[A]){v[w]=x[A]}else{if(y[A]&&(typeof v[w])==="function"){v[w]=v[w].call(null,x)}}}return v}t.getjs=function(v,w){var u=k(v);if(u&&(typeof w==="string")){return u.widget.require(w)}};t.initWidgets=function(u,x){var w,v;if(!u){u=document}if(typeof(u)==="string"){u=document.getElementById(u);if(!u){return}}if(!x){u=b(u,true);if(u.forEach){u.forEach(function(y){t.initWidgets(y,true)});return}}w=u.querySelectorAll(".prw_rup");for(v=0;v<w.length;v++){p(w[v])}w=u.querySelectorAll(".prw_dyn");for(v=0;v<w.length;v++){p(w[v])}};function r(u){u._prWidgetContext=this.element._prWidgetContext}function p(w){var x,C,u,y,v,B;if(!w){return}if(w._prWidgetContext){return}x=w.getAttribute("data-prwidget-init");if(typeof(x)!="string"){return}u=w.getAttribute("data-prwidget-name");if(!u){return}x=c(x);v=c(w.getAttribute("data-scriptFlags")).reduce(function(E,D){E[D]=true;return E},{});var z=x.length;B=w.getAttribute("data-prwidget-deferred");if(B){B=c(B);for(var y=0;y<B.length;y++){x.push(B[y])}}var A=m[u];if(!A){m[u]=A={}}C={};for(y=0;y<x.length;y++){A[x[y]]=true}C.widget={name:u,element:w,modules:x,flags:v,markMine:r,require:d};w._prWidgetContext=C;C.widget.require(x.slice(0,z),function(){if(w._prPendingClick){var D=w._prPendingClick;w._prPendingClick=void (0);if(D.key===o){window.setTimeout(function(){t.call.apply(t,D.args)},0)}}})}function c(u){if(typeof u!=="string"){return[]}return u.match(/[^\s,]+(\s+[^\s,]+)*/g)||[]}function k(v){var u=v._prWidgetContext;if(u){return u}for(v=v.parentNode;v&&v.hasAttribute;v=v.parentNode){u=v._prWidgetContext;if(u){return u}if(v.hasAttribute("data-prwidget-init")){break}}return}function g(v){for(var u=v;u&&u.hasAttribute;u=u.parentNode){if(u.hasAttribute("data-prwidget-init")){return u}}return void (0)}function a(u){if(u&&u.nodeName&&s.test(u.className||"")){u.className=(u.className||"").replace(s,"")}}function f(u){if(u&&u.nodeName&&!s.test(u.className||"")){u.className=(u.className||"")+" handlerLoading"}}t.getWidgetElement=function(v,u){u=u||document.body;return u.querySelector(".prw_"+v)};t.call=function(u,v,z,C){if(typeof(u)!=="string"||!v||!z){throw"ta.prwidgets.call() requires method, event, element"}var y=k(z);var w=(v&&(v.type==="click"||v.type==="submit"));if(w){v.stopPropagation&&v.stopPropagation();v.preventDefault&&v.preventDefault();o=void (0)}if(!y){if(w){var x=g(z);if(x&&!x._prWidgetContext){o={};x._prPendingClick={key:o,args:Array.prototype.slice.call(arguments,0)}}}return false}var E=u.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/);var B=E[1];E=E[2].split(".");var D=Array.prototype.slice.call(arguments,1);var A=function(G){a(z);var F=void (0);while(E.length>0&&G){F=G;G=G[E.shift()]}if(typeof(G)!=="function"){throw"ta.prwidgets.call: '"+u+"' is not a function"}G.apply(F||{},D);return false};if(y[B]){return A(y[B])}else{f(z);y.widget.require(["trjs!"+B],A)}};q.exportTo(t,"ta.prwidgets");return t});ta.servlet.SearchPage=(function(){var a={refreshLegend:true,onSuccess:null,refreshAds:true};var d=function(g){var e="searchPageScopeOverlay";var f=ta.retrieve(e);if(!f){f=ta.overlays.Factory.createSearchPageScopeSelect(g,$("GEO_SELECT_CONTENT"));f.addEvent("hide",function(){g.removeClass("show_overlay")});f.addEvent("show",function(){g.addClass("show_overlay")});f.hide();ta.store(e,f)}return f};var c=function(){var e=ta.find(".srp_content.results");if(e){e.removeClass("top-result-only")}};var b=function(){var f=document.getElements("#search_result .gptAd");var e=[];if(f.length){f.each(function(g){e.push(g.id)})}return e};ta.on("show_all_results",c);return{getFilterWaitOverlay:function(g){var f="mg s1 fatNotice";if(g){f=f+=" "+g}var e=ta.retrieve("filters.searchWaitDialog");if(!e){e=new ta.overlays.CenteredOverlay({style:f,showCloseButton:false,autoShow:false});e.inner.set("html","<b>"+JS_UpdatingYourResults+"</b>");ta.store("filters.searchWaitDialog",e)}return e},legendV3OnAjaxSuccess:function(e){if(!e){return}if(!e.refreshLegend){var i=document.getElement(".searchTab.selected");var h=ta.id(e.tabId);if(i&&h){i.removeClass("selected");h.addClass("selected")}}else{var f=new Element(ta.id("SEARCHLEGEND"));if(f){var g=f.getStyle("display");f.setStyle("display","block");setTimeout(function(){var j=new Element(ta.id("SEARCHLEGEND"));j.setStyle("display",g)},1)}}},ajax:function(i,h,k,g){var e=(g&&g.href)||h.href;var f=ta.retrieve("searchTrackingId");var j=ta.retrieve("searchRefinementId");e=ta.servlet.SearchPage._replaceOrAddParam(e,"sid="+f);e=ta.servlet.SearchPage._replaceOrAddParam(e,"rf="+j);e=ta.servlet.SearchPage._replaceOrAddParam(e,"actionType=updatePage");return ta.servlet.SearchPage._doajax(e,k,g)},showScopeOverlay:function(g,f){var e=d(f);e.show()},hideScopeOverlay:function(g,f){var e=d(f);e.hide()},selectNewScope:function(l,i,h){var g=document.getElement(".scopeChoice.selected");var e=i;if(!g||!e||g==e){return}g.removeClass("selected");e.addClass("selected");ta.servlet.SearchPage.hideScopeOverlay();var k=ta.id(h.inputID);if(k){k.set("value",h.scopeValue)}var f=ta.id(h.scopeTabID);if(f){f.set("html",h.scopeTabLabel)}var j=new Element(ta.id("SEARCH_FORM"));ta.servlet.SearchPage.ajax(l,i,"TAB",{href:"/Search?"+j.toQueryString(),onSuccess:ta.servlet.SearchPage.legendV3OnAjaxSuccess,scrollToID:"PAGE"})},onload:function(e,g){if(g&&g.length>1){g=g.replace("#","");e=e.replace(/#.*/,"");var h=g.split(",");for(var f=0;f<h.length;f++){e=ta.servlet.SearchPage._replaceOrAddParam(e,h[f])}ta.servlet.SearchPage._doajax(e,null)}},_replaceOrAddParam:function(f,e){var i=e.split("=");var k=i[0];var j=i[1];var h=new RegExp("([\\?&])("+k+"=\\w+)");var g=h.exec(f);if(g){return f.replace(h,"$1"+e)}else{return f+"&"+e}},_extractParam:function(e,i,h){var g=new RegExp("[\\?&]("+i+"=\\w+)");var f=g.exec(e);if(f){return f[1]}else{if(h){return i+"="+h}}return null},_doajax:function(f,j,g){f=f.replace(/#.*/,"");g=api.extend({},a,g);if(j){setOneTimeCookie("SRCHACT",j)}ta.servlet.SearchPage.getFilterWaitOverlay().show();var e=f.indexOf("#");if(e>0){f=f.substring(0,e)}f+="&ajax=search";var i=ta.servlet.SearchPage._extractParam(f,"ssrc","a");var k=ta.servlet.SearchPage._extractParam(f,"o","0");var h=ta.servlet.SearchPage._extractParam(f,"c","local");new Request({url:f,method:"get",evalScripts:true,onSuccess:function(l,m){var p=ta.id("SEARCH_RESULTS");p.innerHTML=l;var o=ta.id("SEARCHLEGEND");var q=ta.id("SEARCHLEGEND_NEW");if(o&&q&&g.refreshLegend){o.innerHTML=q.innerHTML}ta.servlet.SearchPage.getFilterWaitOverlay().hide();var n=ta.id(g.scrollToID?g.scrollToID:"SEARCH_PAGE_HEAD");var r=n.getTop();window.scrollTo(0,n.getTop());if(g.refreshLegend){window.location.hash=i+","+k+(h?","+h:"")}if(!ta.has("ads.gptEnabled")){injectAdsTargeted(p)}if(g.refreshAds){window.fireEvent("onUpdateSearchResults",[b()])}if(g.onSuccess){g.onSuccess(g)}ta.fireEvent("search.listRefreshed")},onFailure:function(l){ta.servlet.SearchPage.getFilterWaitOverlay().hide()}}).send();return false},recordSelection:function(e,f,l,k,m,g,i,n){var j=ta.retrieve("searchTrackingId");var h=ta.retrieve("searchRefinementId");new Request({url:"/SearchRecord",method:"post",data:{type:"selection",sid:j,ordinal:l,hitType:k,rf:h,parentID:m,locationID:g,contentID:i,userID:n,sessionId:ta.retrieve("sessionId"),searchSessionId:ta.retrieve("searchSessionId")}}).send()},recordRefinementInteraction:function(f){if(f.keyCode===9){return}if(!ta.retrieve("search_refinement_interaction")){ta.store("search_refinement_interaction",true);var e=ta.retrieve("searchTrackingId");var g=ta.retrieve("searchRefinementId");new Request({url:"/SearchRecord",method:"post",data:{type:"refInteraction",sid:e,rf:g}}).send()}},initSurvey:function(){setTimeout(function(){window.addEvent("scroll",ta.servlet.SearchPage.showSurvey)},1000)},showSurvey:function(){window.removeEvent("scroll",ta.servlet.SearchPage.showSurvey);if(ta.qualaroo&&!document.getElement(".RuleBasedPopup")){ta.qualaroo.forceDisplaySurvey("search_survey","SEARCH_SURVEY");ta.trackEventOnPage("Qualaroo_Survey","Impression",window.pageServlet,null,true)}}}}());ta.servlet.blcoupons={};ta.servlet.blcoupons.error=false;ta.servlet.blcoupons.translate=function(f,h,a,g,d,c){ta.util.cookie.setPIDCookie(16008);var b="/MachineTranslation?page=offer";if(d=="coupon"){b+="&couponId="+f}else{if(d=="announcement"){b+="&announcementId="+h}else{if(d="both"){b+="&couponId="+f+"&announcementId="+h}}}b+="&sl="+a;b+="&tl="+g;if(c){b+="&d="+c}var e=$("GT_LINK");e.style.color="gray";e.onclick=function(){};ta.servlet.blcoupons.error=false;new Request({url:b,onSuccess:function(j){var k=document.createElement("script");k.text=j;var i=document.getElementsByTagName("body")[0];i.appendChild(k)},evalScripts:true}).send()};ta.servlet.blcoupons.printIfDone=function(){if(ta.servlet.blcoupons.toTranslateCount==0){window.print()}};ta.servlet.blcoupons.logErrorIfDone=function(){if(ta.servlet.blcoupons.toTranslateCount==0&&ta.servlet.blcoupons.error){ta.servlet.blcoupons.logTranslateError()}};ta.servlet.blcoupons.initLink=function(){var a=ta.id("GT_LINK");if((typeof a!="undefined")&&a){a.style.display="block";new Request({url:"/ActionRecord?action=BLCoupons_showTranslateLink"}).send()}};ta.servlet.blcoupons.couponAnnouncementViewWithOpenSuppressMetaFocus=function(b,g,a,i,f,c,d,h,e){ta.store("suppressMetaFocus",true);ta.servlet.ShowSpecialOffer.open(b,g,a,i,f,c,d,h,e)};ta.servlet.blcoupons.couponAnnouncementViewWithOpen=function(b,g,a,e,f,c,j,h,d,k){var i="ta.servlet.ShowSpecialOffer.openOnOpen|"+b+"|"+g+"|"+a+"|"+e+"|"+f+"|"+((j!=null)?j:"")+"|"+pageServlet+"|"+h+"|"+((d!=null)?d:"");if(c==null||c==""){c=ta.servlet.blcoupons.pid}ta.util.cookie.setPIDCookie(c);if(k){i="target:"+k+"|"+i}Cookie.write("ajaxAction",i,{domain:cookieDomain,path:"/"})};ta.servlet.blcoupons.fillBoxMore=function(a,c){var b=$(a).getParent();var d=document.createElement("div");d.setAttribute("class","moreInfo");d.innerHTML=c;b.appendChild(d);$(a).toggle()};ta.servlet.blcoupons.contractBox=function(c){var b=$(c).getParent();var a=$(b).getParent().getElement(".lessInfo");a.toggle();b.toggle();new Request({url:"/ActionRecord?action=BLCoupons_ViewLess"}).send()};ta.servlet.blcoupons.expandMore=function(d,e,c,b){if(b!=null){ta.servlet.blcoupons.pid=b}var f=$(c);var a=f.getParent().getElement(".moreInfo");if(a==null){new Request({url:"/BusinessListingsCouponsAjax-g"+e+"?viewed="+d,onSuccess:function(g){ta.servlet.blcoupons.fillBoxMore(f,g)}}).send()}else{f.toggle();a.toggle()}new Request({url:"/ActionRecord?action=BLCoupons_ViewMore"}).send()};ta.servlet.blcoupons.logTranslateError=function(){new Request({url:"/ActionRecord?action=BLCoupons_GTError"}).send()};ta.servlet.blcoupons.closeHandler=function(){new Request({url:"/ActionRecord?action=BLCoupons_Close"}).send()};ta.servlet.blcoupons.loadOffer=function(b,a){ta.select('[name="OFFER_'+b+'"]').hide();ta.select('[name="OFFER_SPINNER_'+b+'"]').show();new Request.JSON({url:"/CouponAjax?act=LoadToCard&partnercode="+b+"&externalmemberid="+a,onSuccess:function(c){ta.select('[name="OFFER_SPINNER_'+b+'"]').hide();if(c.success){ta.select('[name="OFFER_ERROR_TEXT_NOT_AVAIL_'+b+'"]').hide();ta.select('[name="OFFER_ERROR_TEXT_TRY_AGAIN_'+b+'"]').hide();ta.select('[name="OFFER_ERROR_TEXT_CUSTOMER_SERVICE_'+b+'"]').hide();ta.select('[name="OFFER_SAVED_'+b+'"]').show();ta.select('[name="OFFER_REDEMPTION_'+b+'"]').show();if(ta.id("SAVED_OFFER_COUNT")){ta.id("LINK_LOADED").className="taLnk";ta.id("LINK_LOADED").onclick=function(){ta.trackEventOnPage("AMEXHUB","viewAmexCouponLoaded","",1);ta.t4b.amex.amexSyncProgram.showOfferDiv(ta.id("OFFERS_LOADED"),ta.id("LINK_LOADED"))};var d=ta.id("SAVED_OFFER_COUNT").innerHTML;d++;ta.id("SAVED_OFFER_COUNT").innerHTML=d;ta.t4b.amex.amexSyncProgram.updateLoadedOffers()}}else{if(c.error=="RCCMA035"){ta.select('[name="OFFER_'+b+'"]').show();ta.select('[name="OFFER_ERROR_TEXT_NOT_AVAIL_'+b+'"]').show()}else{if(c.error=="RCAPI900"||c.error=="RCAPI008"||c.error=="RCAPI022"){ta.select('[name="OFFER_'+b+'"]').show();ta.select('[name="OFFER_ERROR_TEXT_TRY_AGAIN_'+b+'"]').show()}else{ta.select('[name="OFFER_'+b+'"]').show();ta.select('[name="OFFER_ERROR_TEXT_CUSTOMER_SERVICE_'+b+'"]').show()}}}},onFailure:function(){ta.select('[name="OFFER_SPINNER_'+b+'"]').hide();ta.select('[name="OFFER_'+b+'"]').show();ta.select('[name="OFFER_ERROR_TEXT_TRY_AGAIN_'+b+'"]').show()}}).send()};ta.servlet.blcoupons.setBranding=function(){ta.servlet.blcoupons.initLink();var a=ta.id("GT_BRANDING");if(a&&!a.innerHTML){google.language.getBranding("GT_BRANDING")}};(function(a,e,d,f){var c=(function(j){var i=function(){return typeof(dd)!=="undefined"&&dd.commerce&&dd.commerce.checkrates},h=function(r,o,s){var p="sprite-",n=p+o,q=p+s;if(r.hasClass(n)){r.removeClass(n);r.addClass(q)}},k=function(){var n=j.retrieve("meta.chevronTracking"),p=j.retrieve("meta.chevronAction"),o=j.retrieve("meta.chevronLabel");if(n&&p){if(!o){j.trackEventOnPage(n,p)}else{j.trackEventOnPage(n,p,o)}}j.remove("meta.chevronTracking");j.remove("meta.chevronAction");j.remove("meta.chevronLabel")},g=function(r,n){var o,q,p,s;if(n!==null&&r!==null){j.commerce.meta.suppressCRArea(r);o=r.getElement(".metaDatesNotChosen");q=r.getElement(".metaDatesChosen");if(q){if(o){o.addClass("miniMetaHideHdr");o.removeClass("miniMetaShowHdr")}q.addClass("miniMetaShowHdr");q.removeClass("miniMetaHideHdr")}r.getElements(".minimalist_datepicker_wrap.hidden").each(function(t){t.removeClass("hidden")});p=r.getElement(".postShowMetaCR");if(p!=null){p.destroy()}p=r.getElement(".postShowMetaCRLB");if(p!=null){p.destroy()}p=r.getElement(".postShowMetaCRLBPCR");if(p!=null){p.destroy()}s=r.getElement("fieldset");j.commerce.meta.adoptMiniMetaElem(s,n);j.fireEvent("refreshedDOMContent",r)}},m=function(n){if(!n){return}if(n.getElement(".hacMiniComplete")&&!n.getElement(".anyOfferCompletedSuccessfully")){n.getElements(".photos_lb_update_avail").each(function(o){o.addClass("hidden")});n.getElements(".photos_lb_update_no_avail").each(function(o){o.removeClass("hidden")})}else{n.getElements(".photos_lb_update_avail").each(function(o){o.removeClass("hidden")});n.getElements(".photos_lb_update_no_avail").each(function(o){o.addClass("hidden")})}},l=function(n){n.getElements(".textLinks").each(function(o){o.addClass("hidden")});n.getElements(".maybeCheck").each(function(o){o.addClass("hidden")});n.getElements(".disclaimer").each(function(o){o.addClass("hidden")});n.getElements(".photos_lb_update_links").each(function(o){o.removeClass("hidden")});n.getElements(".taxesAndFees").each(function(o){o.addClass("hidden")});m(n)};return{updateInlineMeta:function(p,o){if(!j.widgets.calendar.hasPageDates()){j.commerce.meta.popInlineDatePicker(o,p);return}var n=j.id("CHECK_RATE");if(!n){return}},popInlineDatePicker:function(p,q){if(!q){return}var n;var o="_inm";if(p&&p.target&&p.target.getParent("#CHECK_RATES_CONT")){n=j.id("date_picker_"+q)}n=n||j.id("date_picker_"+q+o);if(n){var r=n.getParent(".date_picker_calendar_wrap");if(r&&r.onclick){r.onclick(p,r,q,o);r.fireEvent("click",p,r,q,o);(function(){try{j.retrieve("avail.data."+q+o).calendar.calendarOverlay.position()}catch(s){}}).delay(200)}}},clickMetaShowPrices:function(o){var n;o=new Event(o);if(j.page&&j.page.usingUnifiedDates){j.page.gatherDatesNear(o.target);o.stop();return}if(!j.widgets.calendar.hasPageDates()){j.widgets.calendar.setErrorStyling(o.target);return}n=a.getElement(".cr_lb_overlay");if(n&&n.overlay){n.overlay.hide()}},showLowestPriceCTA:function(t){var o=(t)?"metaLowestPriceCTAInline":"metaLowestPriceCTA";if(j.has(o)){var s=true;if(t){var w=a.getElement(".meta_rates_content");s=w&&w.style.display=="block"}if(s){var p=j.retrieve(o);if(p.hasOwnProperty("idx")){var u=(t)?"Meta_LP_CTA_Display_Inline":"Meta_LP_CTA_Display";var r=(p.idx===0)?"Not_Displayed":"Displayed";var v=p.idx+"";j.trackEventOnPage(u,r,v)}var q=(t)?"LP_CTA_INLINE":"LP_CTA";var n=j.id(q);if(n){(function(){n.fade("in")}).delay(1000)}}}},chevronHover:function(r,p,o,q){if(p&&o&&q){var n=j.id(p).getElement("."+q);if(n){n.removeClass(q);n.addClass(o)}}},chevronBlur:function(r,p,o,q){if(p&&o&&q){var n=j.id(p).getElement("."+o);if(n){n.removeClass(o);n.addClass(q)}}},hoverTopOffer:function(){var n=a.getElement(".rgba_gray_arrow_up");if(n){n.removeClass("rgba_gray_arrow_up");n.addClass("rgba_yellow_arrow_up")}},blurTopOffer:function(){var n=a.getElement(".rgba_yellow_arrow_up");if(n){n.removeClass("rgba_yellow_arrow_up");n.addClass("rgba_gray_arrow_up")}},hoverBookBtn:function(n){var o=j.id(n);h(o,"bookBtnOrangeIdle","bookBtnOrangeOver");h(o,"bookBtnGreyIdle","bookBtnGreyOver");h(o,"bookIdle","bookOver");h(o,"goIdle","goOver");h(o,"selectIdle","selectOver");h(o,"bookSmallIdle","bookSmallOver");h(o,"goSmallIdle","goSmallOver");h(o,"selectSmallIdle","selectSmallOver");h(o,"goBtnGrey","goBtnGreyOver");h(o,"goBtnOrange","goBtnOrangeOver");h(o,"chevronOrangeIdle35","chevronOrangeOver35");h(o,"chevronGreyIdle27","chevronGreyOver27");h(o,"chevronIdle_ylw","chevronHover_ylw")},blurBookBtn:function(n){var o=j.id(n);h(o,"bookBtnOrangeOver","bookBtnOrangeIdle");h(o,"bookBtnGreyOver","bookBtnGreyIdle");h(o,"bookOver","bookIdle");h(o,"goOver","goIdle");h(o,"selectOver","selectIdle");h(o,"bookSmallOver","bookSmallIdle");h(o,"goSmallOver","goSmallIdle");h(o,"selectSmallOver","selectSmallIdle");h(o,"goBtnGreyOver","goBtnGrey");h(o,"goBtnOrangeOver","goBtnOrange");h(o,"chevronOrangeOver35","chevronOrangeIdle35");h(o,"chevronGreyOver27","chevronGreyIdle27");h(o,"chevronHover_ylw","chevronIdle_ylw")},hoverSmallBookBtn:function(o){var n=j.id(o).getElement(".bookBtn");if(n==null){return}h(n,"bookBtnOrangeIdleSmall","bookBtnOrangeIdleSmallOver");h(n,"bookSmallIdle","bookSmallOver");h(n,"goSmallIdle","goSmallOver");h(n,"selectSmallIdle","selectSmallOver")},blurSmallBookBtn:function(o){var n=j.id(o).getElement(".bookBtn");if(n==null){return}h(n,"bookBtnOrangeIdleSmallOver","bookBtnOrangeIdleSmall");h(n,"bookSmallOver","bookSmallIdle");h(n,"goSmallOver","goSmallIdle");h(n,"selectSmallOver","selectSmallIdle")},providerHoverOn:function(o,u,t){var s=j.id(o);s.addClass("partnerHvr");var n=s.getElement(".price_overlay");if(n){var r=s.getElement(".perNight");var q=r.getCoordinates().width+29;n.addClass("show");if(j.util.i18n.isRtl()){n.setStyles({position:"absolute",left:q,zindex:"101"})}else{n.setStyles({position:"absolute",right:q,zindex:"101"})}}var p=o.getElement(".bookBtn");if(p){j.commerce.meta.hoverBookBtn(p)}j.store("meta.hoverProvider",u);j.store("meta.hoverProviderPosn",t)},providerHoverOff:function(o){var q=j.id(o);q.removeClass("partnerHvr");var n=q.getElement(".price_overlay");if(n){n.removeClass("show")}var p=o.getElement(".bookBtn");if(p){j.commerce.meta.blurBookBtn(p)}j.remove("meta.hoverProvider")},restoreProviderHover:function(){var n=j.retrieve("meta.hoverProvider");var r=j.retrieve("meta.hoverProviderPosn");if(n&&r){var q=j.id("PROVIDER_BLOCK");if(q){var p=q.getElements(".metaProvider");var o=q.getElement(".provider_"+n);if(p&&o&&o.hasClass("order_"+r)){p.each(function(s){j.commerce.meta.providerHoverOff(s)});j.commerce.meta.providerHoverOn(o,n,r)}}}},updateNavArea:function(n){var o=j.retrieve("ta.meta.navArea");if(!o||o.indexOf(n)<0){j.store("ta.meta.navArea",n)}},loadBestPriceXsell:function(D,G,r,q){try{if(j.retrieve("checkrates.one_second_xsell")!==true){return}var F=r&&r.isInline;var z="";var s="";var L=r&&r.isMetaLighboxV3;if(j.isHRTabs2014()&&F){return}if(L){z="meta_lightbox_v3"}var E=1000;var n="loadBestPriceXsell_numTries";var t="loadBestPriceXsell_curCancelKey";if(F){n="loadBestPriceXsellInline_numTries";t="loadBestPriceXsellInline_curCancelKey"}var K="meta.xsellTravelData";if(F){K="meta.xsellTravelDataInline"}var v=j.retrieve(K);if(q==null){q=new Date().getTime();j.store(n,0);v=j.widgets.calendar.getCheckRatesData();j.store(K,v);var w=j.id(G);if(w){w.innerHTML="";w.setStyle("height",0);w.setStyle("opacity","0");var B=j.retrieve("metaCheckRatesOverlay");B=j.id(B);if(!F&&B&&B.container&&B.container.getPosition){e.scrollTo(0,B.container.getPosition().y)}}if(F){j.commerce.meta.metaInYourMeta_resetInline()}else{j.commerce.meta.metaInYourMeta_resetLB()}}var u="loadBestPriceXsell_"+q+"_cancel";if(F){u="loadBestPriceXsellInline_"+q+"_cancel"}if(j.retrieve(u)){return}if(j.has(t)){var J=j.retrieve(t);if(J!=u){j.store(J,true)}}if(!j.has(u)){j.store(u,false);j.store(t,u)}var x=j.retrieve(n);var N=x+1;j.store(n,N);if(!v){return}var M="";if(typeof(pageServlet)!==f&&pageServlet){M=pageServlet}var C={};if(j.meta&&j.meta.update){C=j.commerce.meta.getMetaParams()}var y=Object.merge(v,{detail:D,"try":j.retrieve(n),reqNum:r.secondTry?"2":"1",type:z,isInlineRequest:F?"1":"0",openedVendors:s,origServlet:M},C);var p=Object.toQueryString(y);if(!p||!p.trim()){j.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell  - toQueryString failure",null,y);return}var o=j.retrieve("ta.meta.navArea");var A;try{A=j.commerce.meta.tracking.setTimingForNavArea(o)}catch(I){j.util.error.record(I,"problem locking timing in ta.commerce.meta.loadBestPriceXsell")}if(A){y.metaRequestTiming=A}if(j.commerce.meta.tracking.hasAnySuppressedAreas()){var H=j.commerce.meta.tracking.getSuppressedAreasAsString();if(H){y.suppressImpressionsOnComplete=H}}new Request({url:"/MetaBestPriceCrossSellAjax?"+p,evalScripts:true,onSuccess:function(P){if(j.retrieve(u)){return}var O=P.contains("xsellHacStatusReady")||P.contains("xsellHacStatusSOL")||r.secondTry;if(!O){setTimeout(function(){var R={secondTry:true,xsell:true,isInline:F,isHrRedesignTest:false,openedVendors:s};j.commerce.meta.loadBestPriceXsell(D,G,R,q)},E)}else{var Q=j.id(G);if(Q){Q.setStyle("height",0);Q.setStyle("opacity","0");Q.setContent(P);j.commerce.meta.metaInYourMeta(G,{xsell:true,inline:F})}j.store(n,0)}},onFailure:function(){j.store(n,0);j.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(I){j.util.error.record(I,"ta.commerce.meta.loadBestPriceXsell")}},loadGeoCrAutoBroadenContents:function(s,u){var A=5;var q=1000;var p="QC_Meta_Mini|GeoCheckRatesLightBox";try{var n=function(){v=false};var y=function(){s.fireEvent("close",s);s.hide()};var v=true;var x=j.id(s.inner);if(!x){throw new Error("Cannot find parent: "+s)}var r=function(E){var D=0;E.each(function(G){var F=G.getHeight();if(F>D){D=F}});E.each(function(F){F.setStyle("height",D)})};var B=j.commerce.meta.tracking.setTimingForNavArea(p);s.addEvent("close",n);var z={d:u,area:p,metaRequestTiming:B};var C=j.widgets.calendar.getCheckRatesData();if(!C){throw new Error("Cannot find dates and/or adults")}Object.merge(z,C);if(j.meta&&j.meta.update){Object.merge(z,j.commerce.meta.getMetaParams())}var t=0;var o=function(){if(!v){return}++t;z.attempt=t;new Request({url:"/GeoCrAutoBroadenAjax",data:z,method:"get",evalScripts:true,onSuccess:function(D){try{if(!v){return}var F=Elements.from(D,true);var G=F.getElement(".progress").filter(function(J){return J})[0];if(!G){j.util.error.record(null,"geo check rate malform response missing progress",null,z);y()}else{if(/\bfallbackUrl-(\S+)\b/.exec(G.className)){var I=RegExp.$1;var E=j.util.URL.getServletNameFromUrl(I);if(!E){j.util.error.record(null,"geo check rate cannot get servlet name from "+I,null,z);E="UNKNOWN"}j.setEvtCookie("MetaGeoLightBox","unload","Redirect",0,"/"+E);a.location.href=I}else{x.setStyles({overflow:"hidden",height:"auto"});x.innerHTML="";x.adopt(F);r(x.getElements("#GEO_CR_AUTO_BROADEN .recs .rec .info .distance"));r(x.getElements("#GEO_CR_AUTO_BROADEN .recs .rec .info .amenity"));if(!G.hasClass("isHacComplete")&&t<A){setTimeout(o,q)}else{x.getElements(".showUntilLast").dispose();x.getElements(".hideUntilLast").removeClass("hidden")}}}}catch(H){j.util.error.record(H,"cannot process geo check rate response",null,z);y()}},onFailure:function(D){j.util.error.record(null,"geo check rate request failed: status="+(D&&D.status),null,z);y()}}).send()};o()}catch(w){j.util.error.record(w,"cannot send geo check rate initial request");if(y){y()}}},xSellResponses:{lb_hac:false,lb_xsell:false,inline_hac:false,inline_xsell:false},metaInYourMeta_resetLB:function(){j.commerce.meta.xSellResponses.lb_hac=false;j.commerce.meta.xSellResponses.lb_xsell=false},metaInYourMeta_resetInline:function(){j.commerce.meta.xSellResponses.inline_hac=false;j.commerce.meta.xSellResponses.inline_xsell=false},hacIsBlockingXSell:function(n){var o=j.commerce.meta.xSellResponses;if(n){return o.inline_xsell}else{return o.lb_xsell}},metaInYourMeta:function(q,y){var p=y&&y.inline;var o=y&&y.xsell;var t=j.commerce.meta.xSellResponses;if(p){if(o){t.inline_xsell=true}else{t.inline_hac=true}}else{if(o){t.lb_xsell=true}else{t.lb_hac=true}}if((p&&t.inline_xsell)||(!p&&t.lb_xsell&&t.lb_hac)){var w=j.id("META_PRICE_XSELL");var v=j.id("STATE_OPT_RESPONSE");if(p){w=j.id("META_PRICE_XSELL_INLINE");v=j.id("STATE_OPT_RESPONSE_INLINE")}if(w&&w.hasClass&&!w.hasClass("hidden")){return}if(v&&v.hasClass&&!v.hasClass("hidden")){return}var x=w;var s=0;if(j.meta&&j.meta.update){s=j.meta.update.getMetaPricesCount(p)}else{if(i()){s=dd.commerce.checkrates.getMetaPricesCount(p)}}if(s==null){s=0}if(s<1&&v){x=v}var u=j.id(q);if(u){if(x){j.commerce.meta.revealBestPriceXsell(u,x,p,false)}else{var n="lA";if(p){n=n+"_Inline"}var r=j.id(n);if(r&&r.removeClass){r.removeClass("hidden")}}}}},revealBestPriceXsell:function(t,y,o,B){if(t){t=j.id(t)}if(y){y=j.id(y)}if(!t||!y){j.util.error.record(null,"revealBestPriceXsell - required elements missing");return}if(y.removeClass){y.removeClass("hidden")}var s=new Fx.Tween(t,{property:"opacity"});if(B){var q=j.retrieve("metaLeaveBehindOverlay");if(q&&q.container){var n=q.container;if(n.hasClass&&n.hasClass("hidden")&&n.removeClass){n.removeClass("hidden")}if(j.meta&&j.meta.cr){j.meta.cr.removePCR()}else{if(i()){dd.commerce.checkrates.removePCR()}}}}else{var u="META_MINI_META_MAYBE";if(o){u="META_MINI_META_MAYBE_INLINE"}var A=j.id(u);var x=true;if(A){x=false}var w="Displayed_Lightbox";if(o){w="Displayed_Inline"}var v=y.getElements(".hotelListing").length;if(v===0){v="0";w="Not_"+w}j.trackEventOnPage("Meta_State-Optimized_XSell",w,v)}var r=y.getSize().y;var z=new Fx.Tween(t,{property:"height",onComplete:function(){if(!B){s.start(0,1)}}});z.start(r);var p=j.retrieve("metaCheckRatesOverlay");if(p&&p.container&&p.closeBtn&&j.id(e).getScroll().y>p.container.getPosition().y){j.util.element.scrollIntoView(p.closeBtn)}},hideBestPriceXsell:function(r){var q=j.id(r);var o=j.id("META_PRICE_XSELL");if(!q||!o){return}var n=new Fx.Tween(q,{property:"height"});var p=new Fx.Tween(q,{property:"opacity",onComplete:function(){n.start(0);if(o.addClass){o.addClass("hidden")}}});p.start(1,0)},loadMetaAF:function(r,s,t){try{if(j.retrieve("checkrates.meta_af")!==true||j.retrieve("ta.redirectingPage")||j.retrieve("hist_price_cross_sell_hr.enabled")){return}var p="meta_af_last_request";var o=new Date().getTime();j.store(p,o);var q=1000;var x=false;var v=false;if(j.page&&j.page.usingUnifiedDates&&!j.page.hasDates("STAYDATES")){return}if((j.meta&&j.meta.update)||(e.pageServlet==="Hotel_Review")){x=j.widgets.calendar.getCheckRatesData();if(!x){return}var w={};if(j.meta&&j.meta.update){w=j.commerce.meta.getMetaParams()}v=Object.merge(x,{detail:r,reqNum:t?"2":"1",type:"af"},w,require("amdloaders").getLoadedFilesParams())}else{if(i()){return dd.commerce.checkrates.loadMetaAF(r,s,t)}else{return}}var n=Object.toQueryString(v);if(!n||!n.trim()){j.util.error.record(null,"ta.commerce.meta.loadMetaAF - toQueryString failure",null,v);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:v,evalScripts:true,onSuccess:function(D){if(j.retrieve(p)!=o){return}var E=D.contains("xsellHacStatusReady")||D.contains("xsellHacStatusSOL")||t;if(!E){setTimeout(function(){j.commerce.meta.loadMetaAF(r,s,true)},q)}else{var B=j.id(s);var y=a.getElement(".clearDates");if(B){B.show();B.setStyle("height",0);B.setStyle("opacity","0");B.setContent(D);j.prwidgets.initWidgets(B);var C=a.getElement(".tablet_desktop .mapsv2-more .clearDates");if(y&&y!=C){y.style.display="none"}var F=B.getElement(".mainList");if(F){var z=new Fx.Tween(B,{property:"opacity",onComplete:function(){j.fireEvent("refreshedDOMContent",F)}});var A=F.getSize().y;var G=new Fx.Tween(B,{property:"height",onComplete:function(){B.setStyle("height","auto");z.start(0,1)}});G.start(0,A);j.fireEvent("avaf.loaded")}}}},onFailure:function(){if(j.retrieve("ta.redirectingPage")){return}j.util.error.record(null,"ta.commerce.meta.loadMetaAF - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(u){j.util.error.record(u,"ta.commerce.meta.loadMetaAF")}},updateProvAreaFromLightBox:function(r){var o=j.retrieve("meta.baseLocationId");if(o&&r==o){var q=j.retrieve("meta.postShowMetaCR");var p=j.retrieve("meta.postShowMetaCRLB");var n=j.retrieve("meta.postShowMetaCRLBPCR");if(q&&p&&n){j.commerce.meta.updateProvArea(q,p,n);return}}if(j.widgets.calendar.datesExist()){if(j.meta&&j.meta.update){j.meta.update.request(o)}else{if(i()){dd.commerce.checkrates.checkRatesMiniMeta(null,a.getElementById("CHECK_RATE"),o,"checkrates")}}}},updateProvArea:function(x){var r=a.getElement("#CHECK_RATES_CONT.chkRates");var z=a.getElement(".ShowUserReviews #CHECK_RATES_CONT.chkRates");var q=a.getElement("#LOC_PHOTO_ALBUMS.photos_lb_update .metaCrosssell .chkRates");var v=a.getElement("#LOC_PHOTO_ALBUMS.photos_lb_update .sidebar .chkRates");var s=a.getElement("#AMENITY_LIGHTBOX.photos_lb_update .chkRates");var B=a.getElement(".similarCarousel");var A=a.getElement(".premiumTimeout");if(B&&A){var n=r.getElement("div.bc_text_content");if(n){var o=x.getChildren()[1];if(o){var w=o.clone(false);w.innerHTML=o.innerHTML;n.innerHTML="";n.adopt(w)}}}else{g(z,x)}if(q){g(q,x);l(q);var y=a.getElement(".featuredImageWrap.metaCrosssell");if(y){var t=y.getElement(".premium_offers_area");if(t){var p=t.getElements(".offer.wrap.premium");var u=y.getElement(".chkRates");if(p&&u){u.toggleClass("noOffers",p.length===0)}}}}if(v){g(v,x);l(v)}if(s){g(s,x);m(s)}if(j.has("meta.isHackathonBC")){j.commerce.meta.alignPriceBlocks();if(j.has("meta.bc.isRevisedUnavailability")){j.commerce.meta.truncateProviderNames()}}e.fireEvent("postAjaxMetaUpdate");if(x&&x.getElement(".hacMiniComplete")){k(x)}},updatePCRAreaWithMiniMeta:function(p,n){if(n==null||p==null){return}var s=p.inner;if(!s){return}j.commerce.meta.suppressCRArea(s);var q=s.getElement(".postShowMetaCRLBPCR");if(q!=null){q.destroy()}var r=s.getElement("fieldset.miniMetaContainer");var o=n.getElement(".disclaimer");if(o!=null){o.destroy()}j.commerce.meta.adoptMiniMetaElem(r,n);if(!j.widgets.calendar.datesInRange()){j.commerce.meta.showCRArea(s)}},adoptMiniMetaElem:function(p,n){if(p!=null){var q=p.getElement(".disclaimer");if(q!=null&&!q.getParentBySelector("#hover_table_display_area")){q.destroy()}var o=n.clone(false);o.innerHTML=n.innerHTML;p.adopt(o)}},miniMetaAjax:function(n,o){if(i()){dd.commerce.checkrates.miniMetaAjax(n,o)}},suppressCRArea:function(n){var o=n.getElements(".miniMetaShow");Array.each(o,function(p){p.removeClass("miniMetaShow");p.addClass("miniMetaHide")})},showCRArea:function(n){var p=n.getElement(".postShowMetaCR");if(p!=null){p.destroy()}var o=n.getElements(".miniMetaHide");Array.each(o,function(q){q.removeClass("miniMetaHide");q.addClass("miniMetaShow")})},showCurrencyPicker:function(){},selectCurrency:function(){},clearStoredMiniData:function(){if(j.retrieve("checkrates.meta_ui_post_click_prices")){j.store("meta.postShowMetaCRLBPCR",null);j.store("meta.postShowMetaCR",null);j.store("meta.postShowMetaCRLB",null)}},storeMiniData:function(o){if(j.retrieve("checkrates.meta_ui_post_click_prices")){var q=o.getElement(".postShowMetaCR");var n=o.getElement(".postShowMetaCRLBPCR");var p=o.getElement(".postShowMetaCRLB");if(q&&p&&n){j.store("meta.postShowMetaCRLBPCR",n);j.store("meta.postShowMetaCR",q);j.store("meta.postShowMetaCRLB",p)}}},providerButtonClicked:function(o){if(o&&!j.has("hotels.hasTimeoutDates")){var n="CheckIn|provider_logo";j.trackEventOnPage("DATEPICKER","OPEN",n,o);j.store("meta.datepicker_tracked",true)}},moreSitesLinkClicked:function(n){if(n&&!j.has("hotels.hasTimeoutDates")){j.trackEventOnPage("DATEPICKER","OPEN","more_sites_link",n);j.store("meta.datepicker_tracked",true)}},buildMetaHacParamObj:function(){var o={};try{var n=a.getElement("#HAC_FORM input[name=geo]");if(n&&n.value){o.geo=n.value}if(!o.geo){var t=a.getElement("#SEARCH_LHN input[name=geo]");if(t){o.geo=t.value}}var u=a.getElementById("searchAll");if(u&&u.value!="true"){var r=j.widgets.calendar.getPageInDate();if(r){o.inDay=r.getDate();o.inMonth=(r.getMonth()+1)+"/"+r.getFullYear()}var q=j.widgets.calendar.getPageOutDate();if(q){o.outDay=q.getDate();o.outMonth=(q.getMonth()+1)+"/"+q.getFullYear()}var p=j.widgets.calendar.getPageAdultsCount();if(p!=2){o.adults=p}o.searchAll="false"}}catch(s){j.util.error.record(s,"buildHACUrlParams")}return Object.toQueryString(o)},getHACCategory:function(){var o=a.getElements(".tab.selected");var p="1";if(o&&o.length&&o.length>0){var n=o[0].className.match(/cat_(\d+)/);if(n){p=n[1]}}return p},buildHACSearchData:function(){var r=j.widgets.calendar.getPageInDate();var v=j.widgets.calendar.getPageOutDate();var w=j.widgets.calendar.getPageAdultsCount();var x=a.getElementById("geo");var o;if(x==null){o=a.getElementsByName("geo");if(o&&o.length>0){x=o[0]}}var u;if(x&&x.value){u=x.value}else{if(e.modelGeoId){u=e.modelGeoId}}var q=false;var y=j.commerce.meta._padZero;var t=r?y(r.getDate()):null;var p=v?y(v.getDate()):null;var s=r?y(r.getMonth()+1)+"/"+r.getFullYear():null;var z=v?y(v.getMonth()+1)+"/"+v.getFullYear():null;var n={};n.adults=w;n.geo=u;n.searchAll=q;n.inDateOfMonth=t;n.outDateOfMonth=p;n.inMonthYear=s;n.outMonthYear=z;n.category=j.commerce.meta.getHACCategory();return n},buildMetaHACUrl:function(){var n=j.commerce.meta.buildHACSearchData();var o="/HACSearch?adults="+n.adults+"&geo="+n.geo+"&searchAll="+n.searchAll;if(n.category){o=o+"&cat="+n.category}if(n.inDateOfMonth){o=o+"&inDay="+n.inDateOfMonth}if(n.outDateOfMonth){o=o+"&outDay="+n.outDateOfMonth}if(n.inMonthYear){o=o+"&inMonth="+n.inMonthYear}if(n.outMonthYear){o=o+"&outMonth="+n.outMonthYear}var p=o+e.location.hash;return p},redirectHACSearch:function(){j.setEvtCookie("Mini_meta_LP_chevron_display","Clicked","Unavailable","","/HACSearch");e.location=j.commerce.meta.buildMetaHACUrl()},_padZero:function(n){return String("0"+n).slice(-2)},anchorToOpenTab:function(){var o=j.id("ReviewsTab");var n=j.id("MetaPricesTab");if(o&&o.hasClass("selected")){j.commerce.meta.scrollToReviews()}else{if(n&&n.hasClass("selected")){o.click();j.commerce.meta.scrollToReviews()}}},scrollToReviews:function(){var n=j.id("REVIEWS");if(n!=null){j.util.element.scrollIntoView(n)}else{j.util.error.record(null,"couldn't find reviews element on page!")}},scrollToId:function(n){if(n&&j.id(n)){j.util.element.scrollIntoView(j.id(n))}},initNoAvailCarousel:function(){try{var n=j.id("ALSO_VIEWED_LIST"),u;if(!n){return}var r=n.getElement("ul");if(!r){return}var x=r.getElements("li").length;var v=new Fx.Tween(r,{property:"left"});var o=353;var s=1;var w=n.getElement(".prev");var p=n.getElement(".next");if(!p||!w){return}var t=function(y){var B,z,A,C;if((s===1&&y<0)||(s===x&&y>0)){return}if(y<0){j.trackEventOnPage("Pager_Arrows","Scroll_Left","Mini_Carousel_Xsell")}else{if(y>0){j.trackEventOnPage("Pager_Arrows","Scroll_Right","Mini_Carousel_Xsell")}}s+=y;B=parseInt(r.getStyle("left"),10);z=o*y*-1;A=B+z;v.start(A);C=n.getElement(".paginator");if(C){if(s===1&&y<0){u="front"}else{if(s===x&&y>0){u="end"}else{u="middle"}}C.className="paginator "+u}};w.addEvent("click",function(){t(-1)});p.addEvent("click",function(){t(1)})}catch(q){j.util.error.record(q,"ta.commerce.meta.initNoAvailCarousel")}},showRemainingProviders:function(o,n){n=j.id(n);if(n){n.destroy()}j.store("checkrates.hr_bc_see_all_click",true);if(j.retrieve("ibdm_impression_tracking")){j.trk("n_more_sites",false,a.getElement(".premium_offers_area"))}a.getElements(".remaining").removeClass("remaining");j.fireEvent("remainingMetaProvidersShown")},showRemainingProviders_Flyout:function(o,n){n=j.id(n);var r=j.find(".show_remaining_providers_flyout",n)||j.find(".show_remaining_providers_flyout");var q=n.getParent(".chkRates")||a;var s=j.select(".remaining",q);try{if(r&&s.length){a.body.addEvent("click",function(t){if(n&&!t.target||!t.target.getParents().contains(n)||r.isDisplayed()){r.hide();a.body.removeEvents("click");j.select(".remaining",r).destroy()}else{s.forEach(function(u){r.adopt(u.clone())});r.show()}})}}catch(p){j.util.error.record(p,"showRemainingProviders_Flyout")}},alignPriceBlocks:function(){j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceBlock .price",true);j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceBlock .featuredText",true);j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceOutsideChevron .price",true);j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceOutsideChevron .featuredText",true);j.util.element.makeTextFitOneLine(".offer.premium .priceBlock.flag_bump .price",true);j.util.element.fitToContentsHorizontally(".offer.premium .lowest_price_folded .text",0,65);j.select(".chevron_redesign .offer.premium.unsized .loading").setStyle("display","none");j.select(".chevron_redesign .offer.premium.unsized").removeClass("unsized");j.util.element.makeSameWidth("#HR_HACKATHON_CONTENT > #HotelDateSearch .postShowMetaCR .priceBlock")},toggleBlueChevronLowestPriceCTA:function(o){if(j.retrieve("meta_guests_field_v2.CTAActivated")&&!a.getElements(".overlay").length){if(j.has("meta_guests_field_v2.CTATimer")){clearTimeout(j.remove("meta_guests_field_v2.CTATimer"))}var n=j.id("BC_LP_CTA");if(n&&n.fade){if(o){n.fade("in")}else{n.fade("out")}}}},displayBlueChevronLowestPriceCTA:function(){var p="bcMetaLowestPriceCTA",x,v,z,o,w,u,n,y,s;if(j.has(p)&&!j.has("hr_chevron_redesign")){x=j.retrieve(p);if(x.hasOwnProperty("idx")){v=(x.idx===0)?"Not_Displayed":"Displayed";z=x.idx+"";j.trackEventOnPage("BlueChevron_LP_CTA_Display",v,z)}o=j.id("BC_LP_CTA");if(o&&o.fade){(function(){o.fade("in");if(j.retrieve("meta_guests_field_v2.enabled")){j.store("meta_guests_field_v2.CTATimer",(function(){o.fade("out")}).delay(5000));j.store("meta_guests_field_v2.CTAActivated",true)}}).delay(700)}w=j.id("bc_lp_cta_text");if(w){u=w.getSize().y;if(u==12){while(w.getSize().y<=u){w.style.width=""+(w.getSize().x-1)+"px"}w.style.width=""+(w.getSize().x+1)+"px"}if(x.displayTop){n=o.parentNode.getElement(".priceBlock");o.style.position="relative";o.style.left=(345-w.getSize().x)+"px";o.style.top=""+(-n.getSize().y-22)+"px"}else{y=o.getElement(".bc_lp_cta_triangle");o.style.left="-"+(w.getSize().x+20)+"px";y.style.left=""+(w.getSize().x+10)+"px"}w.style.marginTop=""+Math.round((25-w.getSize().y)/2)+"px"}s=5800;if(j.retrieve("check_width_for_CTA_fade")){var B=a.getElement(".bc_lp_cta");var q=a.getElement(".priceBlock");if(B&&q){var r=B.getSize().x+q.getSize().x;var t=250;if((r>t)&&!x.displayTop){(function(){o.fade("out")}).delay(s)}}}else{var A=j.retrieve("fadeBcLpCTAout");if(A&&A==1&&!x.displayTop){(function(){o.fade("out")}).delay(s)}}}},truncateProviderNames:function(){var q=a.getElement(".textLink");if(!q){return}var o=q.getSize().x;var p=Math.max.apply(null,a.getElements(".textLink .price").map(function(r){return r.getParent(".moreLink")?0:r.getSize().x}));var n=o-p-28;if(j.retrieve("meta.paymentsTipText")){n=n-20}if(n>0){$$(".textLinks .providerName").each(function(r){if(r.getNext(".price")){r.setStyle("width",n)}})}},expandProvidersInline:function(p){p=j.id(p);if(!p){return}var o=p.getParent(".metaPriceInfo");if(!o){return}var q=o.getElements(".provider");if(!q){return}q.show();p.hide();if(j.retrieve("assisted_booking_desktop_entry")){var n=p.getParents();n.forEach(function(r){if(r.hasClass("metaPriceInfo")){if(j.meta&&j.meta.treeTrack&&j.meta.treeTrack.hasTrackingTree(r)){j.trk("n_more_sites",false,r)}}})}},flipHoverClass:function(o,n){if(o){o=j.id(o);var p=n+"Idle";var q=n+"Over";o&&o.toggleClass(p).toggleClass(q)}},trackHotelRatingsInfoClickInHR:function(n){n.target=n.target||n.srcElement;if(n.target&&n.target.href){j.setEvtCookie("Ratings_Info","all_hotels","",0,n.target.href)}},updateHeaderMsg:function(o,p){var n=a.getElement(o);if(p&&n){if(n.hasClass("unifiedPickers")){}else{n.innerHTML=p}}},updateHeaderDates:function(){try{if(j.widgets.calendar.hasPageDates()){var p=$$(".dateHeader.inDate");var o=$$(".dateHeader.outDate");var n=j.widgets.calendar.getDatePickerFormat("short");var s=j.widgets.calendar.getDatePickerFormat("classic");if(p){var r=j.widgets.calendar.dateToString(j.widgets.calendar.getPageInDate(),n);Array.each(p,function(u){var v=j.id(u);if(v.getParent("#meta_on_photo_viewer")){return}if(v){v.innerHTML=r}})}if(o){var q=j.widgets.calendar.dateToString(j.widgets.calendar.getPageOutDate(),s);Array.each(o,function(u){var v=j.id(u);if(v){v.innerHTML=q}})}}}catch(t){j.util.error.record(t,"ta.commerce.meta.updateHeaderDates")}},enableAdultsPicker:function(){var q=a.getElement(".adultsText");if(q){q.addClass("hide")}var o=a.getElement(".changeAdults");if(o){o.addClass("hide")}var p=a.getElement(".overlay .date_picker_adults_wrap");if(p){p.removeClass("hide")}var n=a.getElement(".overlay .showPriceButtonHide");if(n){n.removeClass("showPriceButtonHide")}j.store("meta_guests_field_v2.originalAdults",j.retrieve("date.picker.adultsCount"))},disableAdultsPicker:function(o){if(!(o&&o.container)){return}var r=o.container.getElement(".adultsText");if(r){r.removeClass("hide")}var p=o.container.getElement(".changeAdults");if(p){p.removeClass("hide")}var q=o.container.getElement(".date_picker_adults_wrap");if(q){q.addClass("hide")}var n=o.container.getElement(".showPriceButton");if(n){n.addClass("showPriceButtonHide")}},adultsGoButtonClick:function(n,q,t,p,v){var r=j.widgets.calendar.getPageInDate();var w=j.widgets.calendar.getPageOutDate();var o=r&&r.getDate&&w&&w.getDate;if(o){var x=j.widgets.calendar.getCalendarObjectKey(t,p,"out");var u=j.retrieve(x);if(u){var s=u.calendar;if(s){s.onCalendarOverlayHide();s.fireEvent("onRangeSelect",[s.crId,s.options.ext]);s.fireEvent("onSelect",[s,n])}}}else{j.overlays.Factory.simulateDatePickerClick(n,q,t,p,v)}},_hhRedirectIfNoOffers:function(){var n=a.getElements("#HotelDateSearch .offer");if(n&&!j.commerce.meta._overlayOnPage()){j.store("ta.redirectingPage",true);j.setEvtCookie("NoOffersHH","redirect","",0,"/HotelHighlight");var o=/-r\d+-/;e.location.href=e.location.href.replace("Hotel_Review-","Hotel_Review-s1-").replace("ShowUserReviews-","Hotel_Review-s1-").replace(o,"-")}},getResponseAvailability:function(n){if(!n){return false}return{anyAvailable:!!n.match(/\shacComplete\s.*\sanyOfferCompletedSuccessfully\s/g),allUnavailable:!!n.match(/\shacComplete\s.*\shacMiniOfferNotAvailable\s/g),maybeAvailable:!!n.match(/\shacComplete\s.*\shasDisplayUnavailability\s/g)}},_overlayOnPage:function(){return j.overlays&&j.overlays.getCurrent&&j.overlays.getCurrent()},hhRemoveDatePickerForErrorMessaging:function(p){if(!j.widgets.calendar.hasPageDates()){j.commerce.meta.clickMetaShowPrices(p);return}var o=j.id("GEO_CHECK_RATES_BALANCE");if(o){o.hide()}var n=a.getElement("#HLBASE .unavailHdr");if(n){n.removeClass("hidden")}},setupMiniMetaOnAccomPolling:function(n){if(!j.pages.hac.updateHACData||!j.hac.filters.updateResults){j.util.error.record(null,"setupMiniMetaOnAccomPolling bad linkage")}j.pages.hac.startHACUpdate();if(n){j.hac.filters.updateResults()}},checkRatesCreateGeoCrAutoBroadenLb:function(p,o,n){try{if(j.has("hr_to_hh_redirect_no_offers")&&e.pageServlet&&e.pageServlet!=="HotelHighlight"){if(j.widgets.calendar.hasPageDates()){j.widgets.calendar.justUpdateSessionDates(function(){j.commerce.meta._hhRedirectIfNoOffers&&j.commerce.meta._hhRedirectIfNoOffers.delay(300)})}else{j.widgets.calendar.setErrorStyling(new Event(p).target)}return}if(!j.widgets.calendar.hasPageDates()){j.commerce.meta.clickMetaShowPrices(p);return}if(o.getParent(".meta_date_wrapper")){j.trackEventOnPage("MetaGeoLightBox","open","DatePicker",0,false)}else{j.trackEventOnPage("MetaGeoLightBox","open","ShowPrices",0,false)}j.run("ta.overlays.Factory.loadGeoCrAutoBroadenOverlay",{},o,n)}catch(q){j.util.error.record(q,"ta.commerce.meta.checkRatesCreateGeoCrAutoBroadenLb cannot track/create lightbox")}},metaListingClickReporting:function(n){if(!n||!n.target){return}if(n.target.hasClass("photo_image")){j.trackEventOnPage("PRICE_SAVER","CLICK","THUMBNAIL")}else{if(n.target.nodeName==="A"&&n.target.parentNode.hasClass("review_stubs_item")){j.trackEventOnPage("PRICE_SAVER","CLICK","REVIEW")}else{if(n.target.hasClass("property_title")){j.trackEventOnPage("PRICE_SAVER","CLICK","PROPERTY_TITLE")}else{if(n.target.getParent(".metaPriceInfo")!=null){j.trackEventOnPage("PRICE_SAVER","CLICK","META")}}}}},getMetaParams:function(){return{metaReferer:e.pageServlet}},updateSessionDatesRedirect:function(n){if(j.widgets.calendar.hasPageDates()){j.widgets.calendar.justUpdateSessionDates(function(){e.location.href=n},false,true)}else{e.location.href=n}}}}(d));if(!d.commerce.meta){d.commerce.meta={}}for(var b in c){if(c.hasOwnProperty(b)){d.commerce.meta[b]=c[b]}}}(document,window,ta));ta.commerce.minimeta={ajax:{MAX_POLL_ATTEMPT:13,ALL_HAC_COMPLETE:"hotelsMeta.allHacComplete",LOCS_ON_PAGE:"hotelsMeta.locsOnPage",ATTEMPT_STORE_KEY:"hotelsMeta.ajaxNum",TIME_EXPIRED:"hotelsMeta.timeExpired",MINI_META_APPEAR_LOADING_TIMEOUT:5000,MINI_META_STOP_LOADING_TIMEOUT:60000,send:function(c,a){var b=ta.commerce.minimeta.ajax;setTimeout(function(){new Request({method:"post",url:b.getUrl(),data:b.buildPostData(a),onSuccess:function(d){var e=new Element("div",{html:d});b.updateDOM(e);if(!c&&b.shouldResubmit()){ta.commerce.minimeta.ajax.send()}b.updateAttemptNum()}}).send()},ta.commerce.meta.polling.getPollWaitTimeForPollingAttempt(ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY)))},getUrl:function(){return"/BulkMiniMetaCRAjax"},buildPostData:function(b){var a={};a.area="QC_Meta_Mini";a.returnAllOffers=true;a.detail=ta.commerce.minimeta.ajax._getLocOnPageString(b);a.action="getMiniMetaForLocations";return a},updateDOM:function(d){var a=d.getElement(".isAllHacComplete");if(a||ta.retrieve(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE)){ta.store(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE,true);var c=$$(".metaDisclaimer");if(c&&c.hasClass("hidden")){c.removeClass("hidden")}}var b=document.getElements(".listing");b.each(function(j){var i=j.id;var h=i.substring(i.indexOf("_")+1);var g=d.getElement("."+h);ta.commerce.minimeta.ajax.updateLoadingState(d);if(g){var e=g.getElement(".metaPriceInfo");var f=j.getElement(".metaPriceInfo");ta.commerce.minimeta.ajax._setPrice(e,h);ta.commerce.minimeta.ajax._setAccomType(e,h);e.replaces(f)}})},resetAjaxCall:function(){ta.remove(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE);ta.remove(ta.commerce.minimeta.ajax.LOCS_ON_PAGE);ta.remove(ta.commerce.minimeta.ajax.ATTEMPT_STORE_KEY);ta.remove(ta.commerce.minimeta.ajax.TIME_EXPIRED)},shouldResubmit:function(){if(ta.retrieve(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE)){return false}else{var a=ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY);if(!a||a<ta.commerce.minimeta.ajax.MAX_POLL_ATTEMPT-1){return true}else{return false}}},updateAttemptNum:function(){var a=ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY);if(!a){ta.store(ta.commerce.minimeta.ATTEMPT_STORE_KEY,1)}else{ta.store(ta.commerce.minimeta.ATTEMPT_STORE_KEY,a+1)}},_getLocOnPageString:function(b){var c=document.getElements(".listing");var a="";c.each(function(f){var d,e;if(ta.commerce.minimeta.ajax._isHacComplete(f)&&!b){return}e=f.id;d=e.substring(e.indexOf("_")+1);a=a+d+","});if(a===""){ta.store(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE,true)}return a},_isHacComplete:function(a){return a.getElement(".metaPriceInfo.hacComplete")},_setPrice:function(b,f){var a=b.getElement(".classicPrice");if(a){var d="classicPrice_"+f;var c=ta.retrieve(d);if(ta.retrieve("hotels.shouldHideClassicPrices")){a.hide()}else{if(c&&c!==0){var e=a.getElement(".price");e.set("html",c);a.toggleClass("hidden",false)}else{a.hide()}}}},_setAccomType:function(a,d){var c=a.getElement(".contactStr");if(c){var b="accomType_"+d;var e=ta.retrieve(b);if(!e||e=="T_HOTEL"){c.set("html",ta.retrieve("hotels.contactHotel"))}else{c.set("html",ta.retrieve("hotels.contactAccom"))}}},updateLoadingState:function(b){if(ta.retrieve(ta.commerce.minimeta.ajax.TIME_EXPIRED)){var d=b.getElements(".loading_bubbles_gry");var c=new Element("span",{"class":"sprite-visitSite"});d.each(function(f){c.clone().replaces(f)});var a=b.getElements(".loadingHeader");var e=ta.retrieve("hotels.checkSites");a.each(function(f){f.set("html",e)})}}},storeAccomDetails:function(){var b=document.getElements(".classicPrices");b.each(function(d){ta.store(d.id,d.value)});var a=document.getElements(".accomTypes");a.each(function(d){ta.store(d.id,d.value)});var c=$$(".metaDisclaimer");if(c){c.addClass("hidden")}},doMetaDateSearch:function(){if(!ta.widgets.calendar.hasPageDates()){var c=document.getElement(".metaDatePicker .date_picker_calendar_wrap");c.fireEvent("click")}else{if(ta.has("hac.filter.changed")||ta.has("meta.mini_meta_on_accommodations")){ta.hac.filters.updateResults()}else{if(!ta.retrieve("hotels.datesChanged")){ta.hac.filters.updateResults();ta.servlet.HACSearch.destroyAnimatedDateCTA()}else{var b=ta.hac.filters.buildHACUrlParamString();var a="/HACSearch?"+b+window.location.hash;window.location=a}}}},lowestPriceBookBtnHover:function(b){try{var a=document.getElement(".LowestPrice .bookBtn");if(!a){ta.util.error.record(null,"lowestPriceBookBtnHover - no button for .LowestPrice .bookBtn",null,{out:b});return}if(b){a.className=a.className.replace(/Over\b/,"Idle")}else{a.className=a.className.replace(/Idle\b/,"Over")}}catch(c){ta.util.error.record(c,"lowestPriceBookBtnHover - cannot change button hover appearance",null,{out:b})}}};ta.commerce.AvailDataWidget=new Class({Implements:[Options],options:{calendarOptions:{},argArray:[]},initialize:function(h,d,c,b,e,k){this.setOptions(k);if(h||window.event){h=new Event(h||window.event);if(h){h.stop()}}this.locId=d;this.ext=b;var j=null;if(this.ext){j="date_picker_adults_"+this.locId+this.ext}else{j="date_picker_adults_"+this.locId}this.adultField=ta.id(j);this.options.calendarOptions=Object.merge(this.options.calendarOptions,{ext:this.ext?this.ext:"",creatorElem:h&&h.target});var i=true;if(h){var g=ta.id(h.target);if(g&&(g.hasClass("out_date")||(ta.has("guests_rooms_picker_3.enabled")&&g.hasClass("outDateTrigger")))){i=false}}if(!(ta.page&&ta.page.usingUnifiedDates&&c==="adults")){this.calendar=new ta.widgets.SingleDateCalendar(this.options.calendarOptions,this.locId,e,this.options.argArray,i)}var a=ta.retrieve("adultFieldsMap");if(!a){a={}}if(this.adultField){this.adultsField=a[j];var f=this.adultField.getParent(".overlay");if(!this.adultsField||(f&&this.adultsField.parentOverlay!=f.overlay)){this.adultsField=new ta.widgets.AdultsField(this.adultField,this.locId,e,h);a[j]=this.adultsField;ta.store("adultFieldsMap",a)}}this.show(c);if(ta.widgets.calendar.trackCalendarObject){ta.widgets.calendar.trackCalendarObject(this)}},show:function(a){if(a=="calendar"&&this.calendar&&this.calendar.calendarOverlay){this.calendar.showCalendarOverlay()}else{if(a=="adults"&&this.adultsField){this.adultsField.adultsOverlay.show()}}if(ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.calendar.calendarOverlay.container){this.calendar.calendarOverlay.container.setStyle("position","fixed")}},clear:function(){if(this.adultField){if(!ta.retrieve("meta_guests_field_v2.enabled")){ta.widgets.calendar.setPageAdultsCount(2)}ta.widgets.calendar.syncAllDatePickers()}this.calendar.clear()},getState:function(d){var b=this.calendar.getState();var a={adults:"2"};if(this.adultsField){a=this.adultsField.getState()}else{if(ta.widgets.calendar.getPageAdultsCount()){a={adults:ta.widgets.calendar.getPageAdultsCount()+""}}}var c=Object.merge(b,a);if(d){return c}return Object.toQueryString(c)}});ta.widgets.AdultsField=new Class({adultsSelRegex:/.*_(\d)\s*$/,adultsExRegex:/.*_\d+_(.*)$/,initialize:function(j,c,f){this.adultsField=j;this.crId=c;this.selectionFunction=f;var k=this.adultsField.getParent(".overlay");if(k){this.parentOverlay=k.overlay}var g=ta.overlays.ACTIVATE_CLICK;if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")){g=ta.overlays.ACTIVATE_NEVER}this.guestFieldLabel=this.generateGuestFieldLabel(this.adultsField.id);this.adultsOverlay=new ta.overlays.RelativeOverlayBelow({style:"dp",showCloseButton:false,noPadding:true,autoShow:false,offsetLeft:1,activate:g,onShow:this.onAdultsShow.bind(this),onHide:this.onAdultsHide.bind(this)},this.adultsField);this.adultsField.onclick=function(){};ta.id(this.adultsField).addEvent("click",this.adultsOverlay.show);var i=ta.id(this.adultsOverlay.container).getElement(".adults_pre_selected");try{this.count=ta.retrieve("date.picker.adultsCount");if(!this.count){this.count=this.adultsSelRegex.exec(i.id)[1]}}catch(h){}if(!this.count){this.count="2"}ta.widgets.calendar.setPageAdultsCount(this.count);var a=ta.id(this.adultsOverlay.container).getElements(".option");var d=this.adultSelect.bind(this);a.each(function(m,e){var l=function(n){d.pass([e+1,m,n.event])()};ta.id(m).addEvent("click",l)});var b=this.adultsField.clientWidth;b=b+"px";ta.id(this.adultsOverlay.container).setStyles({width:b});this.optionElems=a},generateGuestFieldLabel:function(c){var b=this.adultsExRegex.exec(c);var a=ta.retrieve("open_guest_field.servletName");if(!a){a=window.pageServlet}if(!b){if(!a){return""}else{if(a=="Hotel_Review"){return"Guest_HR"}else{if(a=="Hotels"){return"Guest_Hotels"}else{if(a=="ShowUserReviews"){return"Guest_Hotels"}else{return""}}}}return"Guests"}else{if(b[1]=="pop"){return"Guest_Flyout"}else{if(b[1]=="met"){return"Guest_MetaLightbox"}else{if(b[1]=="pto"){return"Guest_HR_PhotoLightbox"}else{if(b[1]=="amo"){return"Guest_HR_AmenitiesLightbox"}else{return""}}}}}},trackGuestFieldEvent:function(b,a){try{ta.trackEventOnPage("GuestPicker",b,a)}catch(c){ta.util.error.record(c,"ta.widgets.AdultsField.trackGuestFieldEvent")}},onAdultsShow:function(){try{if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}if(ta.id("PERSISTENT_DATE_PICKER")&&this.optionElems[0]&&this.optionElems[0].getParent("div.relative")){this.optionElems[0].getParent("div.relative").setStyles({"z-index":10001})}this.keyEventListener=this.onAdultsOverlayKeyDown.bind(this);document.addEvent("keydown",this.keyEventListener);this.adultsField.blur();var a=document.getElements(".date_picker_adults_option");if(a){Array.each(a,function(d){ta.id(d).removeClass("adults_selected");ta.id(d).removeClass("adults_pre_selected")})}if(ta.id(this.adultsField).getParent("#PERSISTENT_CHECK_RATES")){var b=ta.id(this.adultsField).getCoordinates().top;if(typeof(isIPad)=="undefined"||!isIPad){b=b-window.getScrollTop()}ta.id(this.adultsOverlay.container).setStyles({position:"fixed",top:b+29,zindex:9997})}this.count=ta.retrieve("date.picker.adultsCount");if(ta.retrieve("meta_guests_field_v2.enabled")){this.optionElems[this.count-1].addClass("adults_pre_selected");this.preSelectElem=this.optionElems[this.count-1]}if(ta.retrieve("meta_guests_field_v2.trackingEnabled")){this.trackGuestFieldEvent("Open",this.guestFieldLabel)}}catch(c){ta.util.error.record(c,"ta.widgets.AdultsField.onAdultsShow")}},onAdultsHide:function(){try{if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}if(this.keyEventListener){document.removeEvent("keydown",this.keyEventListener)}}catch(a){}},onAdultsOverlayKeyDown:function(a){if(a.key=="esc"){this.adultsOverlay.hide()}},adultSelect:function(e,d,c){ta.commerce.meta.tracking.resetAllTimingLocks();ta.commerce.meta.tracking.clearSuppressedAreas();ta.commerce.meta.polling.clearAllPollingInfo();this.updateValue(e,d.innerHTML);this.adultsOverlay.hide();var b=this.guestFieldLabel+"|"+this.count;if(ta.retrieve("meta_guests_field_v2.trackingEnabled")){this.trackGuestFieldEvent("Select",b)}if(!ta.widgets.calendar.hasPageDates()){return}if(this.selectionFunction){if(this.selectionFunction===ta.widgets.calendar.launchInlineMeta){this.selectionFunction.call(this,c)}else{this.selectionFunction.call(this,this.crId,this.adultsField)}}if(ta.commerce.metajson){ta.commerce.metajson.refetchAll()}if(typeof oxapp!="undefined"&&oxapp&&oxapp.context){var a=oxapp.context.get("TravelDates");if(a){a.save()}}ta.commerce.meta.loadMetaAF(this.crId,"AV_ABOVE_FOLD_META",false);ta.widgets.calendar.trackCalendarEvent("DATEPICKER","CHANGE","GUESTS",e)},updateValue:function(a,b){this.count=a;this.adultsField.innerHTML=b;ta.widgets.calendar.setPageAdultsCount(this.count);ta.widgets.calendar.syncAllDatePickers();ta.widgets.calendar.justUpdateSessionAdults();var c=document.getElements(".adults");c.each(function(d){d.innerHTML=b})},getAdultsCount:function(){return this.count},getState:function(){return{adults:this.count+""}}});ta.commerce.meta.tracking={getTimingForNavArea:function(a){if(!a){return}var b=ta.commerce.meta.tracking.processNavArea(a);return ta.retrieve(b)},setTimingLockForNavArea:function(b,a){ta.store(b+"-LOCK",a)},isTimingLocked:function(b){var c=ta.commerce.meta.tracking.processNavArea(b);var d=ta.retrieve(c);if(!d){return false}var a=Date.now();if(a-d>=2000){ta.commerce.meta.tracking.resetTimingLockForNavArea(c);return false}return true},resetTimingLockForNavArea:function(a){var b=ta.commerce.meta.tracking.processNavArea(a);if(ta.retrieve(b+"-LOCK")){ta.remove(b+"-LOCK")}},resetAllTimingLocks:function(){var a=["QC_Meta_Inline","QC_Meta_Mini","QC_Meta_Metro","QC_Meta_Micro","QC_Meta_Lightbox"];for(var b=0;b<a.length;b++){ta.commerce.meta.tracking.resetTimingLockForNavArea(a[b])}},processNavArea:function(a){if(!a){return}if(a.indexOf("QC_Meta_Inline")===0){return"QC_Meta_Inline"}if(a.indexOf("QC_Meta_Mini")===0){return"QC_Meta_Mini"}if(a.indexOf("QC_Meta_Metro")===0){return"QC_Meta_Metro"}if(a.indexOf("QC_Meta_Micro")===0){return"QC_Meta_Micro"}if(a.indexOf("QC_Meta_Lightbox")===0){return"QC_Meta_Lightbox"}},setTimingForNavArea:function(c,b){if(!c){return}if(!b){b=Date.now()}var a=ta.commerce.meta.tracking.processNavArea(c);if(ta.commerce.meta.tracking.isTimingLocked(a)){return ta.commerce.meta.tracking.getTimingForNavArea(a)}ta.store(a,b);ta.commerce.meta.tracking.setTimingLockForNavArea(a,b);if(a=="QC_Meta_Inline"&&!ta.commerce.meta.tracking.containsSuppressedArea("QC_Meta_Mini")){ta.commerce.meta.tracking.setTimingLockForNavArea("QC_Meta_Mini",b)}return b},updateUrlWithTiming:function(b,a){if(!b||!a){return b}var c=ta.commerce.meta.tracking.setTimingForNavArea(a);if(!c){return b}if(b.contains("&metaRequestTiming=")){var d=new RegExp("(&|\\?)metaRequestTiming=[^&]*");b=b.replace(d,"&metaRequestTiming="+c)}else{b+="&metaRequestTiming="+c}return b},suppressImpressionsForArea:function(c){if(!c){return}var b=ta.commerce.meta.tracking.processNavArea(c);if(ta.commerce.meta.tracking.containsSuppressedArea(b)){return}var a=ta.retrieve("suppressed.areas");a.push(b);ta.store("suppressed.areas",a)},getSuppressedAreas:function(){var a=ta.retrieve("suppressed.areas");if(!a){a=[];ta.store("suppressed.areas",a)}return a},getSuppressedAreasAsString:function(){var b=ta.commerce.meta.tracking.getSuppressedAreas();var a="";if(b.length>0){for(var c=0;c<b.length;c++){a+=b[c]+";"}}return a},hasAnySuppressedAreas:function(){var a=ta.commerce.meta.tracking.getSuppressedAreas();return a.length>0},containsSuppressedArea:function(d){if(!d){return false}var b=ta.commerce.meta.tracking.processNavArea(d);var a=ta.commerce.meta.tracking.getSuppressedAreas();for(var c=0;c<a.length;c++){if(a[c]==b){return true}}return false},removeSuppressedArea:function(e){if(!e){return}var b=ta.commerce.meta.tracking.processNavArea(e);var f;var c;if(ta.commerce.meta.tracking.containsSuppressedArea(b)){var a=ta.commerce.meta.tracking.getSuppressedAreas();for(var d=0;d<a.length;d++){if(a[d]==b){c=d;f=true}if(f){a=ta.commerce.meta.tracking.removeElementByIndex(a,c);ta.store("suppressed.areas",a)}}}},removeElementByIndex:function(b,a){if(b&&a>=0&&a<b.length){b.splice(a,1)}return b},clearSuppressedAreas:function(){ta.store("suppressed.areas",[])},getTrackFunctionForSuggestedAccommodations:function(){var a=function(){var g=ta.widgets.calendar.getPageOutDate();var c="hotelsAccommodationGroupTracking";var f=ta.id(c);if(f){var e=f.getBoundingClientRect();if(e&&e.top>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)){var d="Hotels on Tourism";var h="Impression";var b="dated";if(g===false){b="undated"}var i=ta.has("suggestedAccommodationsIsDmoSponsored")?1:0;ta.trackEventOnPage(d,h,b,i);window.removeEvent("scroll",a)}}};return a},getTrackFunctionForSuggestedVRs:function(){var a=function(){var g=ta.widgets.calendar.getPageOutDate();var c="vrsAccommodationGroupTracking";var f=ta.id(c);if(f){var e=f.getBoundingClientRect();if(e&&e.top>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)){var d="VRs on Tourism";var h="Impression";var b="dated";if(g===false){b="undated"}var i=ta.has("suggestedAccommodationsIsDmoSponsored")?1:0;ta.trackEventOnPage(d,h,b,i);window.removeEvent("scroll",a)}}};return a}};require(["ta/rollupAmdShim"],function(a){a.install(["ta/commerce/MetaPolling","ta/meta/LinkTracking","ta/sales/metaImpressionComScoreTag","ta/sales/bwIBImpressionComscoreTag","ta/sales/metaClickComScoreTag"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-commerce-meta",files:{js3:{src:{ta:{meta:{LinkTracking:1},commerce:{MetaPolling:1},sales:{metaImpressionComScoreTag:1,bwIBImpressionComscoreTag:1,metaClickComScoreTag:1}}}}},_:{baseUrl:"/"}})};define("ta/commerce/MetaPolling",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(b,c,d){var a={setPollingAttemptForRequest:function(e,f){var g=a.getPollingMap();if(!f){f=1}g[e]=f;a.setPollingMap(g)},getPollingAttemptForRequest:function(e){if(a.isRequestBeingPolled(e)){var g=a.getPollingMap();var f=g[e];if(f){return f}}},getPollingWaitTimeForRequest:function(e){var f=a.getPollingAttemptForRequest(e);return a.getPollWaitTimeForPollingAttempt(f)},isRequestBeingPolled:function(e){var g=a.getPollingMap();var f=e&&g[e];if(f){return true}return false},incrementPollingAttemptForRequest:function(e){var g=a.getPollingMap();var f=g[e];if(f){f=f+1;g[e]=f}a.setPollingMap(g);return f},clearAllPollingInfo:function(){d.store("ta.meta.polling.map")},removePollingInfoForRequest:function(e){if(a.isRequestBeingPolled(e)){var f=a.getPollingMap();delete f[e];a.setPollingMap(f)}},getPollingMap:function(){var e=d.retrieve("ta.meta.polling.map");if(!e){e={};d.store("ta.meta.polling.map",e)}return e},setPollingMap:function(e){if(e){d.store("ta.meta.polling.map",e)}},getPollWaitTimeForPollingAttempt:function(e){if(typeOf(e)!=="number"||e<0){return 1000}switch(e){case 1:case 2:case 3:case 4:return 1000;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2000;case 11:return 5000;case 12:return 15000;default:return 30000}},getMaxPollingAttemptNumber:function(){return 13}};c.exportTo(a,"ta.commerce.meta.polling");return a});ta.commerce.meta.horizontalXSell=(function(){var k=10;var g=1000;var h=false;var c=null;var n=null;var l=null;var p=0;var f=function(q){if(q.contains("hacComplete")&&(q.contains("hacMiniOfferNotAvailable")||q.contains("hacMiniOfferUnavailable"))){return true}return false};var j=function(q){if(!a()){return false}if(!q.contains("hacMiniOfferUnavailable")){return true}return false};var e=function(t,w){try{if(ta.retrieve("ta.redirectingPage")||ta.retrieve("non_comm_hr_xsell_2014")){return}if(!w){p=0}c=new Date().getTime();var v=c;var u=ta.widgets.calendar.getCheckRatesData();if(!u){return}var r={metaReferer:window.pageServlet};var q=Object.merge(u,{detail:t,reqNum:w?"2":"1",type:"horizontal_hr"},r);var x=Object.toQueryString(q);if(!x||!x.trim()){ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - toQueryString failure",null,q);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:q,evalScripts:true,onSuccess:function(D){if(v!=c){return}var A=new Element("div",{html:D});var C=A.getElement(".xsellHacStatusReady")||A.getElement(".xsellHacStatusSOL")||w;if(ta.has("meta.full_meta_photos_v3")){D+='<div class="gap_spacer"></div>'}if(!C&&p<k){setTimeout(function(){p=p+1;e(t,true)},g)}else{var F=ta.id("HORIZONTAL_CROSS_SELL");var z=A.getElement(".metaMicro");if(F&&z){if(F.getElement(".metaMicro")){F.setContent(D)}else{F.setStyle("opacity","0");var E=new Fx.Tween(F,{property:"opacity"});F.setStyle("height",0);var B=122;var y=new Fx.Tween(F,{property:"height",onComplete:function(){F.setStyle("height","auto");F.setContent(D);E.start(0,1)}});y.start(0,B)}if(n){n()}d(true)}}},onFailure:function(){if(ta.retrieve("ta.redirectingPage")){return}ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(s){ta.util.error.record(s,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell")}};var i=function(q,r){if(!q||!q.getElement(".bc_flags")){return}var s=q.getElement(".bc_flags").className;if(j(s)){m()}else{if(f(s)){e(r,false)}}};var m=function(){var q=ta.id("HORIZONTAL_CROSS_SELL");var s=ta.id("HORIZONTAL_CROSS_SELL_LIST");var t=document.getElement("#HORIZONTAL_CROSS_SELL_LIST .lodging");if(q&&s&&t){var u=s.getSize().y;q.setStyle("height",u);var v=new Fx.Tween(s,{duration:200,property:"opacity",onComplete:function(){s.addClass("hidden");r.start(u,0).chain(function(){q.setStyle("height",0);q.innerHTML=""})}});v.start(1,0);var r=new Fx.Tween(q,{duration:"long",property:"height"});if(l){l()}d(false)}};var a=function(){return h};var d=function(q){h=q};var o=function(q){n=q};var b=function(q){l=q};return{updateHorizontalXSell:i,removeHorizontalXSell:m,isLoaded:a,setLoaded:d,setOnloadFunction:o,setOnRemoveFunction:b}}());ta.commerce.meta.horizontalXSellExtensions={putAvafBelowMap:function(){if(ta.commerce.meta.horizontalXSell.isLoaded()){return}var d=ta.id("AV_ABOVE_FOLD_META");var c=ta.id("RHS_MAP");var b=d.parentNode;if(d&&c&&b){var a=b.getElement(".bxDivider.map");if(a){b.insertBefore(a,d);b.insertBefore(c,a)}else{b.insertBefore(c,d)}}},putAvafAboveMap:function(){if(!ta.commerce.meta.horizontalXSell.isLoaded()){return}var c=ta.id("AV_ABOVE_FOLD_META"),b=ta.id("RHS_MAP"),a=c.parentNode;if(c&&b&&a){a.insertBefore(c,b)}}};if(!ta.meta){ta.meta={}}if(!ta.meta.link){ta.meta.link={}}(function(b){if(b.click){return}b.OPEN_IN_NEW_TAB="new_tab";b.OPEN_IN_SAME_TAB="same_tab";b.OPEN_IN_NEW_WINDOW="new_window";b.getUrlFromClickElem=function(s){if(!s){return null}var u=s.get("data-commerceClickData");if(!u||!u.trim||u.trim()===""||typeof asdf!=="function"){return null}u=asdf(u).replace(/&amp;/g,"&");var t=ta.retrieve("tracking.impression.key");if(s.hasClass("inlineOffer")&&t){var r=/ik=[a-zA-Z0-9]*/;u=u.replace(r,"ik="+t)}return u};b.getPartnerFromClickElem=function(s){if(!s){return null}var r=s.get("data-offerauthor");if(!r||!r.trim||r.trim()===""){return null}return r.trim()};b.animateAndClick=function(t,r){var s=r.hasClass("bookableOffer"),u=function(){b.click(t,r);var v=function(){j();ta.off("commerceClickAnimated",v)};ta.on("commerceClickAnimated",v)};ta.CommerceClickAnimation.addAnimation(u,{animateOnFocus:!s,squelchAnimation:true})};b.addToCartAndClick=function(s,r){b.click(s,r);j()};function p(){if(ta.localStorage&&ta.localStorage.enabled){ta.localStorage.set("pcb_branding_interstitial_rollout_p1.show_date",new Date())}}b.click=function(s,x){var y=ta.id(x),u,v,B,w,z,r,E,D,t,C;try{y=h(y);u=b.getUrlFromClickElem(y);if(!u){return}v=y.get("data-vendorName");B=y.get("data-offerauthor");w=y.get("data-locationId");z=b.getNavAreaFromClickElem(y);r=y.get("data-contentId");E=y.get("data-openBehavior");D=y.get("data-imageUrl");t=y.get("data-mcid");C=y.get("data-pernight");if(u&&v&&w){i(u,z,v,w,E,y,D,t,C,B)}else{m(null,"Invalid commerce click",u,z)}}catch(A){m(A,"Invalid commerce click",u,z)}setTimeout(function(){try{ta.fireEvent("metaLinkClick",y,v,z,w,r,E,ta.popups.PopUtil.extractSlotFromCommerceUrl(u))}catch(F){m(F,"Commerce click tracking failed",u,z)}},300)};b.getNavAreaFromClickElem=function(v){var u=ta.id(v),r=u.get("data-navArea"),w,s;if(!r){w=u.get("data-navAreaPre");s=u.get("data-navAreaPost");r=q(w,v,s)}if(r){r=r.replace("+","|")}if(ta.browser.isIE10Metro()){r="QC_Meta_Metro_Lightbox"}if(v.getParent("#LOC_PHOTO_ALBUMS")){if(v.getParent(".featuredImageWrap")){r=r+"|PHOTOS_LB|Featured_Reel"}else{r=r+"|PHOTOS_LB"}}else{if(v.getParent("#AMENITY_LIGHTBOX")){r=r+"|AMENITIES_LB"}}a(r);var t=r;r=k(u);if(r==null||r.indexOf("null")!=-1||r.indexOf("Unknown")!=-1){r=t}return r};b.extractPageLocId=function(r){return b.urlArgNumeric(r,"d","detail")||b.urlArgNumeric(r,"g","geo")};b.urlArgNumeric=function(t,r,u){var s=new RegExp("(-"+r+"([0-9]+))|([?&]"+u+"=([0-9]+))");var v=s.exec(t);if(v){if(typeof v[2]!="undefined"){return v[2]}if(typeof v[4]!="undefined"){return v[4]}}return null};b.photoClick=function(s,v,t,r,u){if(t.hasOwnProperty("area")){t.area=b.getPhotoNavArea(s)}require("ta/util/Doer").aimdoit(v,t,r,u)};b.getPhotoNavArea=function(r){return k(r,{"data-navArea-metaType":"Pro_Photo","data-navArea-availability":"NA"})};b.updateNavAreaInCommerceUrl=function(u,r){if(r){var s=b.getNavAreaFromClickElem(r);var t=new RegExp("(&|\\?)area=[^&]*");u=u.replace(t,"$1area="+s)}return u};function i(x,v,D,C,y,t,H,B,E,G){if(D&&D==="TripAdvisor"){p()}var J=x;var K=new RegExp("(&|\\?)area=[^&]*");J=J.replace(K,"$1area="+v);if(crPageServlet){var w=new RegExp("(&|\\?)from=[^&]*");J=J.replace(w,"$1from=HotelDateSearch_"+crPageServlet)}var s=ta.commerce.meta.tracking.setTimingForNavArea(v);if(s&&t&&!t.hasClass("bookableOffer")){if(J.contains("&metaRequestTiming=")){var u=new RegExp("(&|\\?)metaRequestTiming=[^&]*");J=J.replace(u,"&metaRequestTiming="+s)}else{J+="&metaRequestTiming="+s}}if(B){J+="&m="+B}if(E){J+="&priceShown="+E}if(G){J+="&cpn="+G}if(document.location&&document.location.href){var I=b.extractPageLocId(document.location.href);if(I){J+="&pageLocId="+I}}var A;if(J.indexOf("&tp=")<0){var z=ta.analytics.getCommentTrackingPath(t);if(z&&z.length>0){A=z.getLast();if(A&&A.indexOf(":")===-1){J+="&tp="+A;var r=d(z,J,v);if(r){J+="&gn="+r}}else{m(null,"ibdm_cc: no placement found",J,v,"WARN")}}else{m(null,"ibdm_cc: no tracking path found",J,v,"WARN")}}var F=J.indexOf("/StartBooking")>=0;if(F){l();if(crPageServlet){J=J+"&from="+crPageServlet}}if(ta.retrieve("commerce_history_injection_v2")&&!F){J="/NewWindowRedirect?url="+encodeURIComponent(J)}if(ta.has("assisted_booking_clicks_new_tab")&&y===b.OPEN_IN_NEW_TAB&&F&&ta.browser&&ta.browser.isIE10Metro()){y=b.OPEN_IN_SAME_TAB}if(ta.has("tablet_google_search_app_open_same_tab")&&/GSA\/[0-9]{2}/.test(window.navigator.userAgent)){y=b.OPEN_IN_SAME_TAB}if(F&&ta.page&&ta.page.maybeOpenInlineBooking&&ta.page.maybeOpenInlineBooking(A,C,t,null,J)){return}if(y===b.OPEN_IN_NEW_TAB){e(J,H,D,t)}else{if(y===b.OPEN_IN_SAME_TAB){c(J,t)}else{n(D,J,H)}}if(window.IS_DEBUG){ta.store("ta.lastCommerceClickUrl",J)}}function o(){try{document.domain=document.domain}catch(r){return true}return false}function d(s,v,B){var r="groups";var F="_NavCart";var D="MyCartTab";var t="V:HG-1.1";var E=-1;var A=0;var u;var z;var x=s.getLast();var C=s[s.length-2];var w;var y;if(!s){return}if(s.length<5){return}if((x.indexOf(F)!==(x.length-F.length))&&x!==D){return}if(C.indexOf(t)!==0){return}for(z=s.length-1;z>=0;z--){if(!s[z]){continue}A=0;u=s[z];if(u===r&&E===-1){w=z;for(w=z-1;w>=0;w--){u=s[w];if(u.indexOf("N:")===0){A++;if(E===-1){E=w}}}}if(E!==-1){break}}if(A>=3&&E>0){u=s[E];y=u.split(":");if(y.length===2){return y[1]}else{m(null,"ibdm_cc: no group node found",v,B,"WARN")}}}function l(){if(!ta.has("ib_qualaroo_surveys")||(window.pageServlet!=="Hotels"&&window.pageServlet!=="Hotel_Review")||!ta.qualaroo){return}try{var r=window.pageServlet!=="Hotels"?"HOTEL_REVIEW":"HOTELS",s="IB_QUALAROO_SURVEYS_"+r;ta.qualaroo.forceDisplaySurvey("force",s,false)}catch(t){ta.util.error.record(t,"Unable to display Qualaroo survey")}}b.showQualarooSurvey=l;function e(w,s,v,t){var u=o(),r=window.open(u?w:"","_blank");if(!r&&typeof(Browser)!=="undefined"&&Browser.ie&&ta.has("ta.ie_commerce_popup_block_fix")&&ta.has("assisted_booking_clicks_new_tab")&&w.indexOf("/StartBooking")>=0){if(ta.util&&ta.util.cookie){ta.util.cookie.setPIDCookie(38822)}c(w,t);return}!u&&ta.popups.PopUtil.redirectToUrl(r,w);ta.popups.PopUtil.pollForPartnerLoad(r,new Date(),v,ta.popups.PopUtil.extractSlotFromCommerceUrl(w),crPageServlet)}function c(u,s){ta.meta.treeTrack.logTrackingTreeClickEvtCookie(u,s);if(ta.meta&&ta.meta.treeTrack){var t=function(){f(u)};if(s&&s.getParentBySelector(".metaCheckRatesOverlay")!=null){ta.meta.treeTrack.logLightboxTreeImpression(t)}else{if(ta.meta.treeTrack.isInitialized()){try{ta.meta.treeTrack.logTreeImpression(t)}catch(r){ta.util.error.record(r," Error in openMetaProviderSameTab");f(u)}}else{if(ta.retrieve("allowSamePageClickWithoutTrackingTree")===true){f(u)}}}}else{f(u)}}function f(r){if(ta.retrieve("ta.isIE11orHigher")){window.open(r,"_self",null,false)}else{window.location.href=r}}function n(x,w,t){var r=x,v=ta.popups.PopUtil.getProviderWindowDims(r,true),s=1,u;if(window&&window.chrome){s=0}u={customWidth:v.customWidth,customHeight:v.customHeight,widthOffset:v.widthOffset,heightOffset:v.heightOffset,name:r,url:w,scrollbars:s,providerLogo:t};ta.popups.PopUtil.createCheckRatesWindow(u)}function a(r){var s=ta.retrieve("ta.meta.navArea");if(!s||s.indexOf(r)<0){ta.store("ta.meta.navArea",r)}}function q(r,v,s,u){var w="";if(v.getParent(".persistentCR")){w=(u)?"|PCR":"PCR"}else{if(v.getParent(".photosOverlay")||v.getParent("#LOC_PHOTO_ALBUMS")){w=(u)?"|Photo_Lightbox":"Photo_Lightbox"}else{if(v.getParent(".amenities_lightbox")){w=(u)?"|Amenities_Lightbox":"Amenities_Lightbox"}else{if(v.getParent("#CHECK_RATES_LB")){w=(u)?"|Photo_LB":"Photo_LB"}}}}w=w?"|"+w:"";r=r?r:"";w=w?w:"";s=s?s:"";var t=[r,w,s].join("|").replace("||","|").replace(/(\|$)/g,"");return t}function m(u,t,v,s,r){ta.util.error.record(u,t,null,{servlet:window.pageServlet,url:v,area:s},r)}function k(s,t){var w;var v={"data-navArea-metaType":null,"data-navArea-linkType":null,"data-navArea-availability":null,"data-navArea-placement":null};var u=4;if(t){for(w in v){if(t.hasOwnProperty(w)){v[w]=t[w];u--}}}var x=null;while(s&&u>0){for(w in v){if(v[w]===null){v[w]=s.get(w);if(v[w]!==null){if(v[w]==="@trigger"){x=s}u--}}}s=s.getParent()}while(v["data-navArea-placement"]==="@trigger"&&x){while(x&&!x.overlay){x=x.getParent()}if(x&&x.overlay.options&&x.overlay.options.trigger){x=x.overlay.options.trigger}else{x=null;v["data-navArea-placement"]="null"}while(x){v["data-navArea-placement"]=x.get&&x.get("data-navArea-placement");if(v["data-navArea-placement"]!==null){break}x=x.getParent()}}var r=[];for(w in v){r.push(v[w]?v[w]:"null")}if(window.isTabletOnFullSite){r.push(g()?"Portrait":"Landscape")}else{r.push("Desktop")}return r.join("|")}function g(){if(ta.common&&ta.common.tablet){return ta.common.tablet.isPortrait()}return window.matchMedia&&window.matchMedia("(orientation: portrait)")&&window.matchMedia("(orientation: portrait)").matches}function h(s){if(!s||s.isVisible()){return s}var u=s.get("data-locationid");var v=s.get("data-contentid");var r=".offer";if(s.hasClass("bookableOffer")){r=r+'.bookableOffer[data-locationid="'+u+'"]'}else{r=r+'[data-locationid="'+u+'"][data-contentid="'+v+'"]'}var t=document.getElement(r);if(t){return t}return s}function j(){if(!ta.NavAbandonedCart){return}ta.NavAbandonedCart.udpate()}})(ta.meta.link);define("ta/meta/LinkTracking",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Event","ta/util/Error","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Record"],function(i,h,n,j,b,m,e,f){var d={};d.setup=function(){try{j.on("metaLinkClick",l)}catch(o){b.record(o,"trouble building event - metaLinkClick")}};d.actionRecord=function(o){m("/ActionRecord?action="+o)};d.restoreCRPageServlet=function(){var o=e.retrieve("crPageServlet_orig");if(o){window.crPageServlet=o}};function l(p,q,s,r,o,x){try{g(q,s,r,x)}catch(t){try{b.record(t,"trackMetaClick failure")}catch(w){}}try{if(!p||!(p.className||"").match(/\bbookableOffer\b/)){var v=(p&&p.getAttribute("data-pernight"))||"";a(r,true,o,v)}}catch(t){try{b.record(t,"trouble loading click-out pixels")}catch(w){}}try{if(p&&e.retrieve("hotels_lists_engagement_tracking.enabled")){var u=(p.className||"").match(/\bbookableOffer\b/)?"Sherpa":"Meta";j.fireEvent("hotels_lists_engagement_tracking.fired",{type:u,element:p})}}catch(t){try{b.record(t,"problem in hotel lists engagement tracking")}catch(w){}}try{if(x!=ta.meta.link.OPEN_IN_SAME_TAB){k(p)}}catch(t){try{b.record(t,"problem in ibdmImpressionTracking")}catch(w){}}try{c(p)}catch(t){b.record(t,"problem in mapSponsorCheckRateTracking")}}function k(o){if(ta.meta&&ta.meta.treeTrack){if(h.getParent(o,"metaCheckRatesOverlay")){ta.meta.treeTrack.logLightboxTreeImpression()}else{if(ta.meta.treeTrack.isInitialized()){ta.meta.treeTrack.logTreeImpression()}}ta.meta.treeTrack.logTrackingTreeClickTrk(o)}}function a(s,q,t,o){try{var p={locId:s,isMetaCheckRates:q,contentId:t,selectedPrice:o};ta.common.ads.loadClickoutMonikers(p)}catch(r){b.record(r,"click out monikers failure (meta="+q+")")}}function g(t,p,s,r){var q="CheckRates";var u=1;f.trackPhysicalCommerce(q,p,u,s);f.trackAttemptedCommerce(q,p,t,u);var o=r?(r===ta.meta.link.OPEN_IN_NEW_TAB?"TAB_OPENED":(r===ta.meta.link.OPEN_IN_NEW_WINDOW?"WINDOW_OPENED":"SAME_TAB")):"";f.trackEventOnPage("COMMERCE_CLICK",o,(t||""))}function c(p){if(window.pageServlet&&p&&p.hasAttribute("data-provider")){var t=p.get("data-provider");var q=h.find("#mapsv2-sponsordetail");var s=(window.pageServlet=="Hotels")?"HACMap":"FloatingMap";if(window.pageServlet=="LocalMapsRedesign"){q=h.find(".overlay .skv3");s="LocalMap"}if(q&&q.hasAttribute("data-sponsor-provider")&&q.hasAttribute("data-sponsor")){var r=q.get("data-sponsor-provider");var o=q.get("data-sponsor");if(t==r){ta.trackEventOnPage(s,"sponsor_cr_sent",o)}}}}n.exportTo(d,"ta.meta.linkTracking");return d});if(!ta.meta.treeTrack){ta.meta.treeTrack={}}(function(e){var d=false;var b={hotelListSelector:null,singleHotelSelector:null,placementName:null,getImpressionString:null};var c="ibdm_impression_tracking";e.init=function(h){if(d){ta.util.error.record(null,"ta.meta.treeTrack should be initialized only once");return false}b=h;d=true};e.isInitialized=function(){return d};e.hasTrackingTree=function(h){if(!h||typeof h.previousSibling==="undefined"){return false}var i=h.previousSibling||h.nextSibling;if(i){if(f(i)){return true}return f(i.previousSibling)}return false};var f=function(i){if(i){var h=i.nodeValue;return h&&(h.contains("trk")||h.contains("etk"))}return false};e.logImpressionTreeOnPageLoad=function(){if(ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&ta.widgets.calendar.hasPageDates()&&!ta.retrieve("vrTabOnHotels")){var i=1;var k=4;var h;if(!ta.retrieve("treeTrackImpressionInProgess")){ta.store("treeTrackImpressionInProgess",true);var j=setInterval(function(){if(ta.retrieve("isTrackTreeFresh")){h=e.logTreeImpression(null,(i<k))}if(!h&&i<k){i++}else{ta.store("isTrackTreeFresh",false);ta.store("treeTrackImpressionInProgess",false);clearInterval(j)}},2000)}}};e.logTreeImpression=function(k,j){if(!ta.retrieve(c)||ta.retrieve("vrTabOnHotels")){if(k){k()}return false}if(!d){ta.util.error.record(null,"ta.meta.treeTrack.logTreeImpression called before being initialized");if(k){k()}return false}var h=a();var i=b.getImpressionString(h);if(!i&&h<=0){if(k){k()}return false}if(i&&i.indexOf("I:IllegalContext")===-1){ta.recordImpression(i,k);return true}else{if(!j){ta.util.error.record(null,"ta.meta.treeTrack.logTreeImpression called but no tracking tree html found!",null,{},"WARN")}}if(k){k()}return false};e.logLightboxTreeImpression=function(i){if(!ta.retrieve(c)){if(i){i()}return false}var h=g();if(h){ta.recordImpression(h,i);return true}if(i){i()}};var g=function(){var h=$$(".metaCheckRatesOverlay .impressionTrackingTree");if(h){return h[0].innerHTML}};e.getElmtPriceData=function(h){var i=[];if(!h){return i}var j="PP:";if(h.getAttribute("data-pernight")){j+=h.getAttribute("data-pernight")}else{j+="-1"}i.push(j);var k="PN:";if(h.getAttribute("data-offer-author")){k+=h.getAttribute("data-offer-author")}else{k+="None"}i.push(k);return i};e.logTrackingTreeClickTrk=function(h){if(!ta.retrieve(c)){return}if(e.hasTrackingTree(h)){if(h.hasClass("bookableOffer")){ta.trk("sherpa_click",false,h)}else{var i=e.getElmtPriceData(h);ta.trk("meta_click",false,h,i)}}};e.logTrackingTreeClickEvtCookie=function(i,h){if(!ta.retrieve(c)){return}if(e.hasTrackingTree(h)){if(h.hasClass("bookableOffer")){ta.setEvtCookieAndPath("sherpa_click",i,h)}else{ta.setEvtCookieAndPath("meta_click",i,h)}}};e.getElmtHeight=function(h){if(h){return h.offsetHeight}};function a(){if(!b.hotelListSelector||!b.singleHotelSelector){return 0}var i=0;var h=0;var j=document.getElements(b.hotelListSelector);j.each(function(k){k.getElements(b.singleHotelSelector).each(function(l){if(l.match(b.singleHotelSelector)){i++;if(l.isFullyVisible()){h=i}}})});return h}})(ta.meta.treeTrack);if(!ta.meta.update){ta.meta.update={}}ta.on("newInlinePageDates",function(b,a){ta.meta.update.request(b,a)});ta.on("metaOnlyUpdate",function(a){ta.meta.update.request(a,null,true)});(function(n){var b="miniMetaHacRequest_longTimeoutKey";var f="miniMetaHacRequest_appearLoadedTimeoutKey";n.request=function(z,x,y){l(z,null,0,false,y);w(z,x)};n.completeOnInitialPage=function(x){a(true,"",x)};n.buildUrl=function(F,O,M,E,V,K,G,C,D,x,y){var z=e(V),H=ta.widgets.calendar.getCheckRatesData(),W="",N="",Q="",L="",J="";if(H){W=Object.toQueryString(H)}if(E){N="&metaVersion="+E}if(ta.has("meta.baseLocationId")){Q="&baseLocId="+ta.retrieve("meta.baseLocationId")}if(ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")||ta.retrieve("checkrates.hr_bc_see_all_click")||(ta.retrieve("checkrates.hr_bc_see_all_click.lb")&&F==="MetaCheckRatesAjax")){L="&seeAllClick=true"}if(window.pageServlet){J="&imp=true&metaReferer="+window.pageServlet}var R=ta.retrieve("meta.requestFromArea");if(!R){R="";if(document.getElement("#LOC_PHOTO_ALBUMS")){R="&requestFromArea=pal"}else{if(document.getElement("#AMENITY_LIGHTBOX")){R="&requestFromArea=amo"}}ta.store("meta.requestFromArea",R)}var B="/"+F+"?detail="+O+"&"+W+"&area="+z+"&returnAllOffers=true"+J+N+Q+L+R,P=B;try{B=ta.commerce.meta.tracking.updateUrlWithTiming(B,z)}catch(U){ta.util.error.record(U,"problem updating url with timing in CheckRates.buildVarMetaHacUrl");B=P}if(ta.commerce.meta.tracking.hasAnySuppressedAreas()){var S=ta.commerce.meta.tracking.getSuppressedAreasAsString();if(S){B+="&suppressImpressionsOnComplete="+S}}if(ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")){P=B;try{B=m(B,D);if(!B){B=P}}catch(U){ta.util.error.record(U,"problem updating url with isFirstPageLoad in CheckRates.buildVarMetaHacUrl");B=P}}if(M){B+="&finalRequest=true"}if(K){B+="&numTries="+K}if(C){B+="&loadingTimeoutPassed="+C}if(x){B+="&isDateChangedRequest="+x}if(ta.maps&&ta.maps.mapsponsor){var A=ta.maps.mapsponsor.getSponsorForLocation(O);if(A){B+="&mapSponsorship="+A}}var T="ta.commerce.MetaHacOverlay.currency";if(ta.has(T)){B+="&currency="+ta.retrieve(T);ta.remove(T)}var I=ta.retrieve("booking.tracking.context");if(I){B+="&btc="+I}if(y){B+="&isMetaOnly="+y}return B};n.overlayRequest=function(R,T,Z,O,G){var Q,D="metaHacRequest_curCancelKey",I,L,E,X,A,P,M,V,y=13,U,x,C,K,F,N,H;try{if(!R){return}ta.commerce.meta.clearStoredMiniData();I=ta.widgets.calendar.getCheckRatesData();if(T==null){ta.store("meta.travelData",I);T=new Date().getTime();L=false;if(Z){if(ta.has("metaCheckRatesUpdateDivInline")){L=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}}else{if(ta.has("metaCheckRatesUpdateDiv")){L=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}}if(L&&L.removeClass){L.removeClass("hidden")}}E="metaHacRequest_"+T+"_cancel";if(ta.has(D)){X=ta.retrieve(D);if(X!=E){ta.store(X,true);ta.commerce.meta.polling.removePollingInfoForRequest(X)}}if(Z){A=document.getElement(".meta_rates_content .postShowMetaCR");if(ta.has("checkrates.mini_meta_by_percent_cpc")&&ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")){P=A.getElement(".seeMore.threshold");if(P){M=A.getElements(".postClickPrice.hide");M.each(function(aa){aa.removeClass("hide")});P.hide()}}ta.commerce.meta.updateProvArea(A)}if(!ta.has(E)){ta.store(E,false);ta.store(D,E)}if(ta.retrieve(E)===true){return}V=ta.retrieve("metaCheckRatesOverlay");if(!V&&!Z){return}Q=false;if(V){Q=V.inner}if(ta.has("metaCheckRatesUpdateDiv")){Q=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}if(Z&&ta.has("metaCheckRatesUpdateDivInline")){Q=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}}catch(W){ta.util.error.record(W,"overlayRequest setup")}if(!Q){return}try{if(ta.commerce.meta.polling.isRequestBeingPolled(E)){U=ta.commerce.meta.polling.getPollingAttemptForRequest(E);if(!U||U>y){ta.commerce.meta.polling.removePollingInfoForRequest(E);return}}else{U=1;ta.commerce.meta.polling.setPollingAttemptForRequest(E,U)}if(!Q.innerHTML.contains("hacComplete")){x=false;if(Z){x="QC_Meta_Inline"}if(!O){O=1}var J=ta.meta.update.buildUrl("MetaCheckRatesAjax",R,true,G,x,O);setTimeout(function(){new Request({url:J,onSuccess:function(aa){if(ta.retrieve(E)){return}if(ta.retrieve("metaCheckRatesOverlay")||ta.retrieve("metaCheckRatesUpdateDivInline")){Q.innerHTML=aa;ta.fireEvent("refreshedDOMContent",Q);if(ta.retrieve("checkrates.meta_ui_sk_box")){ta.commerce.meta.restoreProviderHover()}}if((ta.meta.update.getMetaPricesCount(Z)>0||U>9)&&ta.commerce.meta.hacIsBlockingXSell(Z)){if(Z){ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:false,inline:true})}else{ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:false,inline:false})}}ta.commerce.meta.polling.incrementPollingAttemptForRequest(E);ta.meta.update.overlayRequest(R,T,Z,O+1,G)},evalScripts:true}).send()},ta.commerce.meta.polling.getPollingWaitTimeForRequest(E))}else{try{ta.commerce.meta.polling.removePollingInfoForRequest(E);C=ta.id("META_HAC_DATE_HEADLINE");if(C){var Y=C.getElements(".headlineLegend");if(Y.length>=2){Y.forEach(function(aa){aa.addClass("hidden")});if(Q.getElement(".anyOfferCompletedSuccessfully")){Y[0].removeClass("hidden");ta.commerce.meta.hideBestPriceXsell("REC_CONT")}else{if(Q.getElement(".partnersAllNotAvailable")&&Y.length>2){Y[2].removeClass("hidden");if(Z){ta.commerce.meta.loadBestPriceXsell(R,"REC_CONT_INLINE",{isInline:true});ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:false,inline:true})}else{var B={isMetaLighboxV3:ta.retrieve("meta_lightbox_v3.enabled")};if(!ta.id("META_PRICE_XSELL")){ta.commerce.meta.loadBestPriceXsell(R,"REC_CONT",Object.merge(B,{isInline:false}))}ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:false,inline:false})}}else{Y[1].removeClass("hidden");ta.commerce.meta.hideBestPriceXsell("REC_CONT")}}}}if(V){ta.commerce.meta.storeMiniData(V.inner)}if(ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&Q){var S=Q.getElement(".impressionTrackingTree");if(S){ta.trkImpTree(S)}}K=i(Q);N="complete";if(Z){if(ta.id("COMHVY")){F="Mini-Meta";if(ta.find(".NotShowing .postClickPrice")){N+="_may_be_available"}else{if(ta.find("#HotelDateSearch .price .minCost")){if(ta.find(".strikeHigh")){N+="_available_lp_chevron"}else{N+="_available"}}else{N+="_unavailable"}}}else{F="Metainline"}}else{F="meta_lightbox"}if(Q.innerHTML.contains("doneNoAvailability")){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_EMPTY",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount());if((ta.id("MAYBE_BUTTONS_INLINE")&&Z)||(ta.id("MAYBE_BUTTONS")&&!Z)&&F!="Mini-Meta"){N+="|may_be_availabile"}else{if(F!="Mini-Meta"){N+="|unavailable"}}}else{ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_PRESENT",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount())}ta.trackEventOnPage(F,N,K.toString());ta.commerce.meta.showLowestPriceCTA(Z);ta.fireEvent("MetaLightboxHacComplete");H=ta.find(".overlay .skv3");if(H&&H.hasAttribute("data-sponsor")){var z=H.getAttribute("data-sponsor");ta.maps.ads.injectMetaLightBoxAd(z)}}catch(W){ta.util.error.record(W,"overlayRequest - failure in complete results block")}}}catch(W){ta.util.error.record(W,"meta HAC - ajax requests")}};n.displayRemainingProviders=function(A){try{var z=ta.id("CHECK_RATES_CONT");var y=z.getElements("li");for(var x=y.length;x--;){y[x].removeClass("hide")}A.hide();ta.store("checkrates.mini_meta_by_percent_cpc_see_all_click",true)}catch(B){ta.util.error.record(B,"displayRemainingProviders")}};n.updateCRForm=function(x){try{if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers();return}var J=ta.id("HotelDateSearch"+x);var I=ta.id("HotelDateSearch");var B=["select","input[type=checkbox]","input[type=hidden]","input[type=text]"];if(J&&I){for(var E=B.length;E--;){var z=B[E];var L=I.getElements(z);var A=J.getElements(z);for(var D=A.length;D--;){var K=A[D];var H=K.id.split("_")[0];for(var C=L.length;C--;){var G=L[C];if(G.id.contains(H)){if(z=="input[type=checkbox]"){var M=G.getParent("li");if(M&&!M.hasClass("unavailable")){var y=K.getParent("li");if(y){y.removeClass("unavailable")}}}if(z=="select"){K.selectedIndex=G.selectedIndex}else{if(z=="input[type=checkbox]"&&x!="_pop"){K.checked=G.checked}else{if(!K.id.contains("hacPid")){K.value=G.value}}}}}}}}}catch(F){ta.util.error.record(F,"updateCRForm")}};n.getMetaPricesCount=function(x){var z=0,B;var y=ta.retrieve("metaCheckRatesOverlay");var A=false;if(y){A=y.inner}if(ta.has("metaCheckRatesUpdateDiv")){A=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}if(x&&ta.has("metaCheckRatesUpdateDivInline")){A=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}if(!A){return}B=A.getChildren("#HR_HACKATHON_CONTENT .roomPrice");if(B){z=B.length}return z};function c(C){var B=ta.id("PROVIDER_BLOCK");if(!B){return}if(typeof CDNHOST!="undefined"){var A='<img class="provLoading" src="'+CDNHOST+'/img2/meta_sprites/loadingAnim.gif">';B.getElements(".rightBox").each(function(D){D.setContent(A)})}var y=B.get("html");var x=1000;var z="metaHacRequest_"+x+"_cancel";ta.remove(z);new Request({url:ta.meta.update.buildUrl("MetaCheckRatesAjax",C,true),onSuccess:function(D){B.setContent(D);ta.fireEvent("refreshedDOMContent",B);ta.meta.update.overlayRequest(C)},onFailure:function(){B.setContent(y)}}).send()}function w(y,x){if(x=="pop"){ta.store("ta.meta.request.locId",y);ta.store("ta.meta.request.placement",x);ta.run("ta.overlays.Factory.metaCheckRatesOverlay")}else{if(x=="met"||x=="solb"){if(!ta.has("meta.widget")){c(y)}}}}function i(z){var A;var B;var x=0;var y=0;z=ta.id(z);B=z.getChildren("#HR_HACKATHON_CONTENT .roomPrice");A=z.getChildren("#HR_HACKATHON_CONTENT .textLinks .offer .price");if(B){x=B.length}if(A){y=A.length}return x+y}function l(B,F,K,J,D){if(ta.retrieve("tablet_maps_v1")&&ta.retrieve("maps_v2_open")){return}if(!K){K=0}if(!J){J=false}var G="miniMetaHacRequest_curCancelKey";var E=13;if(F==null){F=new Date().getTime()}var C="miniMetaHacRequest_"+F+"_cancel";if(ta.retrieve(C)===true){return}if(ta.has(G)){var M=ta.retrieve(G);if(M!=C){ta.store(M,true);ta.commerce.meta.polling.removePollingInfoForRequest(M)}}if(!ta.has(C)){ta.store(C,false);ta.store(G,C)}var L;if(ta.commerce.meta.polling.isRequestBeingPolled(C)){L=ta.commerce.meta.polling.getPollingAttemptForRequest(C);if(!L||L>E){ta.commerce.meta.polling.removePollingInfoForRequest(C);return}}else{L=1;ta.commerce.meta.polling.setPollingAttemptForRequest(C,L)}var y=[];if(J){var I=$$("#CHECK_RATES_CONT div.premium:not(.tripConnectDemo)");for(var A=0;A<I.length;A++){var z=I[A].get("data-contentid");y.push(parseInt(z,10))}}if(K<1){var H;if(ta.has(b)){H=ta.retrieve(b);clearTimeout(Number.from(H))}if(ta.has(f)){H=ta.retrieve(f);clearTimeout(Number.from(H))}H=setTimeout(function(){u()},ta.commerce.minimeta.ajax.MINI_META_STOP_LOADING_TIMEOUT);ta.store(b,Number.from(H))}var x=ta.retrieve("hotels.datesChanged");if(x&&ta.has("hac_timezone_awareness")){n.clearDatesBumpedMessage()}new Request({url:ta.meta.update.buildUrl("MiniMetaCRAjax",B,true,null,"QC_Meta_Mini",K,y,J,C,x,D),onSuccess:function(N){a(false,N,B,F,K,J,C,x)},evalScripts:true}).send()}n.clearDatesBumpedMessage=function(){var y=ta.id("HAC_DATES_MOVED_FORWARD");var x=document.getElement("#CHECK_RATES_CONT .legend.metaDatesChosen");if(y&&x){y.dispose();x.removeClass("hidden")}};function d(x){x.getChildren().each(function(y){var z=y.getAttribute("data-targetEvent");if(z){ta.fireEvent(z,y)}})}function a(H,I,O,R,K,y,C,x){if(ta.retrieve(C)===true){return}var F,W,M,J,Z;if(H){var U=ta.select("#CHECK_RATES_CONT fieldset")[0];I=U.get("html");F=new Element("div",{html:I});W=true;M=document.getElement(".similarCarousel");J=F.getChildren()}else{F=new Element("div",{html:I});d(F);W=I.contains("hacMiniComplete");M=document.getElement(".similarCarousel");J=Elements.from(I)}if(!M||K<1){ta.commerce.meta.updateProvArea(F.getElement(".postShowMetaCR"));ta.fireEvent("miniMetaOnHRUpdate",I)}if(!document.getElement(".dropdownMiniMeta")){var A=document.getElement(".postShowMetaCR");if(A){h(I,A)}}v(I);if(ta.retrieve("hotel_review_low_price_message")&&F.getElement(".price_alert_update")){var X=document.getElement("#PRICE_ALERT_RIBBON_CONTAINER");if(X){Z=X.getElementById("PRICE_ALERT_RIBBON");if(Z){Z.destroy()}Z=F.getElement(".price_alert_update").getElement(".price_alert_ribbon");if(Z){X.innerHTML=Z.outerHTML;ta.util.element.makeTextFitOneLine("#PRICE_ALERT_RIBBON",false);var L=Z.getElement(".priceAlertText b");if(W&&L&&L.innerHTML&&L.innerHTML.length>0){ta.trackEventOnPage("hotel_review_low_price_message","Display",L.innerHTML)}}}ta.fireEvent("priceAlertRibbonUpdated")}if(W&&!I.contains("bookableOffer")){window.fireEvent("hacComplete_noBookingOffersFound")}if(W||y){if(I.contains("bookableOffer")){ta.fireEvent("hacComplete_bookingOffersFound")}}var N=ta.id("HR_META_INTERSTITIAL");if(N){var T=document.getElement("#HR_HACKATHON_CONTENT fieldset");if(T){if(K<1&&!H){ta.store("show_hr_meta_interstitial",true);window.setTimeout(function(){ta.store("show_hr_meta_interstitial",false);N.addClass("hidden");T.removeClass("hr_meta_loading_hidden")},2000);T.addClass("hr_meta_loading_hidden");var G=document.getElement("#HR_HACKATHON_CONTENT .metaExplanation");if(G){G.addClass("hidden")}N.removeClass("hidden")}else{if(!N.hasClass("hidden")&&(!ta.retrieve("show_hr_meta_interstitial")||W)){N.addClass("hidden");T.removeClass("hr_meta_loading_hidden")}}}}if(ta.has("meta.isHackathonBC")&&!ta.has("hr_unavail_xsell_flyout")){ta.commerce.meta.horizontalXSell.updateHorizontalXSell(F,O)}if(!W&&ta.has("meta.isHackathonBC")&&I.contains("firstRequest")){var D=setTimeout(function(){r(O,R,K)},ta.commerce.minimeta.ajax.MINI_META_APPEAR_LOADING_TIMEOUT);ta.store(f,Number.from(D))}if(W&&ta.has(f)){var B=ta.retrieve(f);clearTimeout(Number.from(B))}var E=".metaDatesChosen",Y=".metaDatesChosen",V=ta.retrieve("meta.bc.bestPricesForYourStay");if(!W){if(ta.has("meta.isHackathonBC")&&I.contains("anyOfferCompletedSuccessfully")){ta.commerce.meta.updateHeaderMsg(Y,V);if(ta.has("guests_rooms_picker_3.enabled")){ta.commerce.meta.updateHeaderDates()}}if(ta.has("guests_rooms_picker_4.enabled")&&ta.overlays&&ta.overlays.NumberPickerOverlay){ta.overlays.NumberPickerOverlay.updateHeaderMsg(E)}ta.commerce.meta.polling.incrementPollingAttemptForRequest(C);setTimeout(function(){l(O,R,K+1,y)},ta.commerce.meta.polling.getPollingWaitTimeForRequest(C))}else{if(ta.has("meta.isHackathonBC")){var S=V;if(I.contains("allNotAvailable")){var P=ta.id("priceNotAvailMsg");if(P){S=P.innerHTML}else{S=ta.retrieve("meta.bc.pricesTravelSitesNotAvailDates")}}ta.commerce.meta.updateHeaderMsg(Y,S);if(ta.has("guests_rooms_picker_3.enabled")){ta.commerce.meta.updateHeaderDates()}if(ta.has("guests_rooms_picker_4.enabled")&&ta.overlays&&ta.overlays.NumberPickerOverlay){ta.overlays.NumberPickerOverlay.updateHeaderMsg(E)}if(ta.retrieve("meta.full_meta_photos")){var z=document.getElement(".metaDatesChosen");if(z){if(I.contains("allNotAvailable")){z.addClass("no_offers_available")}else{z.removeClass("no_offers_available")}}}ta.commerce.meta.polling.removePollingInfoForRequest(C);ta.commerce.meta.displayBlueChevronLowestPriceCTA();ta.fireEvent("HRHacComplete");if(!y){o(R,false)}var Q=document.getElement(".similarCarousel");if(y&&Q){g(I)}if(!H){setTimeout(function(){t()},1000)}}}ta.fireEvent("onHACUpdate",I);if(W&&!ta.retrieve("hotels_to_seo_hotels_redirect")&&x&&!y&&!ta.retrieve("meta.persist.visible")&&!(I.contains("cancelRedirect"))){if(I&&I.match(/\shacComplete\s.*\shacMiniOfferNotAvailable\s/g)){ta.trackEventOnPage("NoAvailability","redirect","",0,"/HotelHighlight")}if(I&&I.match(/\shacComplete\s.*\shasDisplayUnavailability\s/g)){ta.trackEventOnPage("MaybeAvailable","redirect","",0,"/HotelHighlight")}}if(W){ta.fireEvent("HRHacAvailabilityDetermined",{availability:ta.commerce.meta.getResponseAvailability(I),loadingTimeoutPassed:y,cancelRedirect:I.contains("cancelRedirect"),datesChanged:x,hasBookableOffer:I.contains("bookableOffer")})}k(W,F);s(R,W,y)}function h(z,x){var A=new Element("div",{html:z}),y=A.getElement(".dropdownMiniMeta");if(y){y.inject(x)}}function v(z){var x=document.getElement(".rgba_flyout.dropdownMiniMeta"),A,B,y;if(x){A=new Element("div",{html:z});y=A.getElement(".dropdownMiniMeta");if(y){B=x.getElement(".inner");B.innerHTML="";y.set("class","dropdownMiniMeta");B.adopt(y)}p()}}function p(){if(ta.retrieve("dropdownMiniMeta.hover")){ta.commerce.meta.hoverTopOffer()}else{if(ta.retrieve("dropdownMiniMeta.blur")){ta.commerce.meta.blurTopOffer()}}}function r(A,y,x){var z="miniMetaHacRequest_"+y+"_cancel";j();o(y,true);l(A,new Date().getTime(),x+1,true)}function e(x){var y="";if(ta.browser.isIE10Metro()){if(x=="QC_Meta_Book_Inline"){y="QC_Meta_Metro_Inline"}else{y="QC_Meta_Metro_Lightbox"}}else{if(!x){if(ta.has("ta.meta.navArea")){y=ta.retrieve("ta.meta.navArea")}else{if(ta.retrieve("maps_v2_open")){ta.trackEventOnPage("QC_Meta_Map_Detail","map_open")}y="QC_Meta_Lightbox"}}else{y=x}}return y}function u(){var z=document.getElement("#CHECK_RATES_CONT div.hacMiniComplete");var x=document.getElement("#CHECK_RATES_CONT div.hacMiniCompleteTimeOut");if(z||x){return}var y=document.getElement("div.bc_flags");if(y){y.addClass("hacMiniCompleteTimeOut")}j();t()}function j(y){var x=y?"metaHacRequest_curCancelKey":"miniMetaHacRequest_curCancelKey";if(ta.has(x)){var z=ta.retrieve(x);ta.store(z,true);ta.commerce.meta.polling.removePollingInfoForRequest(z)}}n.cancelAllMetaCurrentQuery=function(){j(false);j(true)};function q(){var z=document.getElements("#CHECK_RATES_CONT span.textLinkLoading");var y=document.getElements("#CHECK_RATES_CONT div.loading");var x=0;if(z){x+=z.length}if(y){x+=y.length}return x}function m(x,A){var y,z;if(!x||!A){return}y=A+"_suppressCommerceImpressionState";z=ta.commerce.meta.polling.getPollingAttemptForRequest(A);if(z){if(z===1){if(ta.retrieve("meta.isFromDatesChange")){ta.remove("meta.isFromDatesChange");ta.store(y,true);x+="&isFirstPageLoad=false";return x}}else{if(ta.retrieve(y)){x+="&isFirstPageLoad=false";return x}}}return x}function o(D,G){var z=0;var E="unknown";if(G){z=ta.commerce.minimeta.ajax.MINI_META_APPEAR_LOADING_TIMEOUT;var F=q();var y=document.getElements("#CHECK_RATES_CONT div.premium");var A=document.getElements("#CHECK_RATES_CONT span.textLink");var C=0;if(y){C+=y.length}if(A){C+=A.length}var x=C-F;if(C>0){var B=Math.round((x/C)*10)*10;if(B%10===0&&B>-1&&B<101){E=""+B+"percent"}}}else{z=new Date().getTime()-D;E="100percent"}ta.trackEventOnPage("HAC","HACComplete",E,z,true)}function g(B){var A=Elements.from(B)[0];if(!A){return}var z=A.getElementsByClassName("price");var y=A.getElementsByClassName("priceBlock");var x=0;if(z){x+=z.length}if(y){x+=y.length}ta.trackEventOnPage("HAC","StateCarouselDisplayed","",x,true)}function t(){var x=q();if(x>0){ta.trackEventOnPage("HAC","HACError","LoadingAfterHACComplete",x,true)}}function k(z,x){if(z&&ta.retrieve("ibdm_impression_tracking")){var A=x.getElements(".impressionTrackingTree");if(A){var y;for(y=0;y<A.length;++y){ta.trkImpTree(A[y])}}}}function s(A,z,x){if(z||x){var B="meta.lowestPricePromotionTracking.tracked"+A;if(ta.has("meta.lowestPricePromotionTracking")&&!ta.has(B)){var y=ta.retrieve("meta.lowestPricePromotionTracking");if(y&&y.bidDifference&&y.priceDifference&&y.bidDifference>=0.43&&y.priceDifference>=10){ta.store(B,true);ta.trackEventOnPage("lowest_price_promoted_impression",y.providers,y.bidDifference+"|"+y.priceDifference)}}}}})(ta.meta.update);if(!ta.meta){ta.meta={}}if(!ta.meta.cross_sell){ta.meta.cross_sell={}}(function(e){var f=0;var b=false;var c=0;e.relatedHoverOver=function(i,g){try{if(f!==0){return}if(g===0){a()}else{d((i)?(i.target||i.srcElement):null,g)}}catch(h){ta.util.error.record(h,"also viewed - avafIn")}};e.relatedHoverOut=function(j){try{if(f!=1||!b){return}if(!j){j=window.event}if(!j){return}var g=(j.relatedTarget)?j.relatedTarget:j.toElement;var i=ta.id("ALSO_VIEWED_LIST");while(g&&g!=i&&g.nodeName!="BODY"){g=g.parentNode}if(g==i){return}clearTimeout(b);b=false;f=0}catch(h){ta.util.error.record(h,"also viewed - avafOut")}};e.relatedExpand=function(g,i){var h,k;try{ta.trk("AVAF_EXPAND_"+(i?"MORE":"LESS"),false,(g)?(g.target||g.srcElement):null);if(i){h=ta.id("hideableMore");if(!h){return}h.addClass("hidden");h=ta.id("expand_av_on_more");if(!h){return}h.removeClass("hidden");if(c===0){h.addClass("expanding");c=h.getSize().y;h.removeClass("expanding")}h.addClass("show");new Fx.Tween(h,{duration:"long",property:"height"}).start(0,c)}else{h=ta.id("expand_av_on_more");if(!h){return}new Fx.Tween(h,{duration:"long",property:"height"}).start(h.getSize().y,0).chain(function(){h.removeClass("show");h.addClass("hidden");k=ta.id("hideableMore");if(!k){return}k.removeClass("hidden")})}}catch(j){ta.util.error.record(j,"also viewed - avafMore")}};e.relatedResetStateFlag=function(){f=0};function d(h,g){try{f=1;b=setTimeout(function(){a(h)},g)}catch(i){ta.util.error.record(i,"also viewed - avafWait")}}function a(h){try{ta.trk("AVAF_HOVER_EXPAND",false,h);f=2;var g=ta.id("expand_av_on_hover");if(!g){return}g.removeClass("hidden");g.addClass("expanding");var l=g.getSize().y;g.removeClass("expanding");g.addClass("show");var k=g.getParent("#AV_ABOVE_FOLD_META");if(k){k.setStyle("height","auto")}var j=new Fx.Tween(g,{duration:"long",property:"height"});j.start(0,l)}catch(i){ta.util.error.record(i,"also viewed - avafExpand")}}})(ta.meta.cross_sell);if(!ta.meta.cr){ta.meta.cr={}}(function(b){b.updateCRCalendar=function(c){if(c.form){a(c.form)}b.updateCRFormElement(this);if(ta.id("META_UI_INLINE")){ta.meta.update.updateCRForm("_imt")}};b.findInlineCRLocationId=function(){var g=null;var h=ta.id("HotelDateSearch");if(h){var c=h.getElements("input[type=text]");for(var f=c.length;f--;){var d=c[f];var e=d.id.match(/_(\d+)/);if(e.length){g=e[1];break}}}return g};b.updateCRFormElement=function(g){try{g=ta.id(g);var o=g.get("tag").toLowerCase();if(o=="li"){g=g.getElement("input[type=checkbox]")}var h=g.id.split("_")[0],k=this.findInlineCRLocationId(),n=h+"_"+k,f=g.id,c=f.substring(f.length-4),r=[n,n+"_icr",n+"_per",n+"_imt"],j,q,d,m,p;if(this.crSyncExtensions.contains(c)){for(j=r.length;j--;){n=r[j];if(n!=f){p=ta.id(n);if(p){if(o=="li"&&c!="_pop"){p.checked=g.checked;q=g.getParent("li");if(q&&!q.hasClass("unavailable")){d=p.getParent("li");if(d){d.removeClass("unavailable")}}}else{if(o=="select"){p.selectedIndex=g.selectedIndex}else{if(o=="input"){m=n.substring(n.length-4);if(!this.crSyncExtensions.contains(m)){m=""}this.updateCRFormElement_In(k,g,c,m)}}}}}}}}catch(l){ta.util.error.record(l,"updateCRFormElement")}};b.getPropIdFromCRElement=function(d){if(d){var c=null;if(c=d.className.match(/id_(\d+)/)){return c[1]}}return null};b.removePCR=function(){var c=ta.retrieve("pcr.overlay");if(c){c.hide()}};b.availCheck=function(d){var c=ta.id("availability")&&ta.id("availability").value=="1";var f=ta.id(d).getElement(".overlaySrc");if(c&&f){var e=f.innerHTML;f.innerHTML=e.replace(/cid=(\w+_)?&amp;/,"")}};b.crSyncExtensions=["_pop","_icr","_pto","_per","_amo","_cro","_met","_imt","_pal","_inm"];function a(c){if(ta.retrieve("checkrates.datesChanged")){return}try{var d=ta.id(c);d.getElements(".unavailable").each(function(e){e.removeClass("unavailable");if(e.hasClass("js_ua_checked")){e.getElements("input").set("checked",true)}ta.meta.update.updateCRFormElement(e)});ta.store("checkrates.datesChanged",true)}catch(g){ta.util.error.record(g,"_showSuppressedProviders")}}})(ta.meta.cr);define("ta/sales/metaImpressionComScoreTag",["vanillajs","api-mod","ta/Core/TA.Event"],function(g,f,h){var e=function(m,n,o){this.providerName=m;this.vendorName=n;this.trackingPixel=o;this.alreadyTracked=false};var a=[];var i=function(n){var m=document.querySelectorAll(n);if(m.length>0){[].slice.call(m).forEach(function(o){a.forEach(function(p){k(o,p)})});a=a.filter(function(o){return !o.alreadyTracked});if(!j()){b()}}return false};var j=function(){return a.length>0};var k=function(m,n){if(((n.providerName&&m.getAttribute("data-provider")===n.providerName)||(n.providerName&&m.getAttribute("data-offer-author")===n.providerName)||(n.vendorName&&m.getAttribute("data-vendorname")===n.vendorName))&&!f.hasClass(m,"hidden")){c(n.trackingPixel);n.alreadyTracked=true}};var c=function(n){var o=n+Math.floor(Math.random()*100000);var m=document.createElement("img");m.className="tracking";m.src=o;m.height=m.width=0;document.body.appendChild(m)};var l=function(){h.on("HotelsHacComplete",d.chkHotels);h.on("HRHacComplete",d.chkHR);h.on("MicroMetaHacComplete",d.chkMicroMeta);h.on("MetaLightboxHacComplete",d.chkLightbox);h.on("MetaFetchComplete",d.chkMapDetailCard);h.on("MetaFetchComplete",d.chkSmartDeals);h.on("MapListMetaComplete",d.chkMapListCard)};var b=function(){h.off("HotelsHacComplete",d.chkHotels);h.off("HRHacComplete",d.chkHR);h.off("MicroMetaHacComplete",d.chkMicroMeta);h.off("MetaLightboxHacComplete",d.chkLightbox);h.off("MetaFetchComplete",d.chkMapDetailCard);h.off("MetaFetchComplete",d.chkSmartDeals);h.off("MapListMetaComplete",d.chkMapListCard)};var d={chkLightbox:function(){if(!j()){return}i(".overlay #PROVIDER_BLOCK .metaLbOffers .offer.premium")},chkMicroMeta:function(){if(!j()){return}i("#micro_meta_ajax .provider")},chkHotels:function(){if(!j()){return}i("#PAGE .metaPriceInfo .header")},chkMapDetailCard:function(){if(!j()){return}i(".mapsv2-detail-info .mapsv2-chevron")},chkMapListCard:function(){if(!j()){return}i(".mapsv2-listcard .mapsv2-listitem .mapsv2-dropdownfirstitem")},chkSmartDeals:function(){if(!j()){return}i("#AVAILABLEHOTELDEALS .lpContainer .offer")},chkHR:function(){if(!j()){return}i("#CHECK_RATES_CONT .offer.premium:not(.remaining):not(.noLink)")},addTrackingProvider:function(m,n,o){if(m&&m.length>0&&n&&n.length>0&&o&&o.length>0){a.push(new e(m,n,o))}},registerEvents:function(){if(a.length===0){return}l()}};return d});define("ta/sales/bwIBImpressionComscoreTag",["vanillajs","ta/Core/TA.Event"],function(k,l){var b="https://sb.scorecardresearch.com/",p="http://b.scorecardresearch.com/",a=(("https:"===document.location.protocol?b:p)+"p?c1=3&c2=6036461&c3=ALBwesternAgst15&c4=ibimpressions&c5=ibimpression&c6=&c10=1&c11=&c13=1x1&c16=gen&cj=1&ax_fwd=1&rn="),o="BestWestern",e="TripAdvisor";var f=function(){var q=a+Math.floor(Math.random()*100000);document.body.appendChild(new Element("img",{"class":"tracking",src:q,height:"0",width:"0"}))};var m=function(){f();h()};var j=function(){var q=document.querySelector(".hacComplete #META_SBS_TRACKING_DUMMY[data-provider="+o+"]");if(q){m()}};var i=function(q){if(document.querySelector(q)){m()}};var g=function(){i(".metaContent .offer.bookableOffer[data-vendorname="+e+"][data-offer-author="+o+"]")};var d=function(){i(".metaPriceInfo .header.bookableOffer[data-provider="+o+"]")};var n=function(){i("#AVAILABLEHOTELDEALS .sdBlueChevron:not(.hidden) .offer.bookableOffer[data-ibpartner="+o+"]")};var c=function(){l.on("hacComplete_bookingOffersFound",j);l.on("hacComplete_bookingOffersFound",g);l.on("HotelsHacComplete",d);l.on("BlenderHacComplete",d);l.on("MetaFetchComplete",n)};var h=function(){l.off("hacComplete_bookingOffersFound",j);l.off("hacComplete_bookingOffersFound",g);l.off("HotelsHacComplete",d);l.off("BlenderHacComplete",d);l.off("MetaFetchComplete",n)};return{registerIBImpressionTrackingEvents:c}});define("ta/sales/metaClickComScoreTag",["vanillajs","ta/util/Error","ta/Core/TA.Event"],function(h,c,i){var j=["vendorname","provider","locationid"];var g=function(p){if(!window||!window.IS_DEBUG){return}var r=document&&document.location&&document.location.pathname;if(!p){throw new Error("Click attributes are empty, pathname="+r)}for(var q=0;q<j.length;q++){if(!p[j[q]]){c.record(null,"Missing click attribute: "+j[q]+". Pathname="+r)}}};function k(p){if(p){this.providerName=p.providerName;this.vendorName=p.vendorName;this.trackingPixel=p.trackingPixel;this.brandName=p.brandName;this.locationIds=p.locationIds}if(this.vendorName&&this.trackingPixel){this.valid=true}else{this.valid=false}}var b="TripAdvisor",l="All",a=[],e=new RegExp(/\[timestamp\]/);var n=function(t){if(t&&t.dataset){g(t.dataset);for(var r=0;r<a.length;r++){var u=a[r].providerName;var w=a[r].vendorName;var v=a[r].brandName;var q=a[r].trackingPixel.replace(e,new Date().getTime());var s=a[r].locationIds;if(b===t.dataset.vendorname&&b===w){if(u===t.dataset.provider||u===l){if(!v){d(q,u,"IB")}if(v&&v===t.dataset.brandname){var p=t.dataset.locationid;if(!s||s&&p&&s.includes(p)){d(q,v,"IB")}}}}else{if(b!==t.dataset.vendorname&&b!==w&&w===t.dataset.vendorname){d(q,w,"meta")}}}}};var m=function(){return a.length};var d=function(t,q,s){var p=document.createComment("Activity name for this tag: "+q+" "+s+" click page view tag");var r=document.createElement("img");r.src=t;r.height="1";r.width="1";r.border="0";r.setAttribute("style","display:none");document.body.appendChild(p);document.body.appendChild(r)};var o=function(){i.on("metaLinkClick",f.chkMetaClick)};var f={};f.chkMetaClick=function(p){if(!m()){return}n(p)};f.addTrackingProvider=function(p){var q=new k(p);if(q&&q.valid){a.push(q)}else{throw new Error("ta.sales.metaClickTag :: Tracker invalid : "+p.trackingPixel?p.trackingPixel:"missing tracking pixel")}};f.registerEvents=function(){if(!m()){return}o()};return f});ta.servlet.GeoCheckRates={checkBoxToggle:function(b,c){var a=$(c.parentNode);if(c.checked){a.addClass("checked")}else{a.removeClass("checked")}}};(function(a,c,b,d){b=b||{};b.qualaroo=(function(){var i=["//","while(true);","while(1);","for(;;);"],g="check",h="force",o=function(q,p){if(b.log){b.log.error(q,p)}else{if(b.util&&b.util.error){b.util.error.record(q,p)}}},e=function(t,r){var q,s,p;if(!t||!r){return false}if(r!=="json"&&r!=="jsonp"){return t}for(q=0;q<i.length;q++){s=i[q];p=t.indexOf(s);if(p===0){return t.substring(s.length)}}return t},f=function(p){if(p){m("/CheckSurvey",j({key:p,action:"init"}))}else{o(null,"_initSurveyKey: No surveyKey to use as token for qualaroo survey display")}},k=function(p){if(p){m("/CheckSurvey",j({key:p,action:"set"}))}else{o(null,"_setSurveyKey: No surveyKey to use as token for qualaroo survey display")}},l=function(s,r,t,p,q){if(s&&r&&p){m("/CheckSurvey",j({key:s,action:p,name:r}),function(v){var u=JSON.parse(v),w=u&&u.display==="true";if(w){if(t){c.parent.postMessage("loadQualarooSurvey","*")}else{if(c.loadQualarooSurvey){if(c._kiq){var x={name:r};if(q){x=b.util.merge(x,q)}if(b.has("ta.qualaroo."+r)){x=b.util.merge(x,b.retrieve("ta.qualaroo."+r))}c._kiq.push(["set",x])}c.loadQualarooSurvey()}else{o(null,"_conditionallyDisplaySurvey: window.loadQualarooSurvey is not defined, can't display survey")}}}})}else{o(null,"_conditionallyDisplaySurvey: No surveyKey or surveyName or checkAction defined for qualaroo survey display")}},n=function(){if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest()}var p=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];var s=null;for(var q=0;q<p.length;q++){try{s=new ActiveXObject(p[q]);break}catch(r){}}return s},m=function(q,t,s){var p=null;try{p=n()}catch(r){o(null,"ta.qualaroo._doGet: Unable to make request in _doGet");return}if(!p){o(null,"ta.qualaroo._doGet: Unable to make request in _doGet");return}p.open("GET",q+t,true);p.onreadystatechange=function(){if(p.readyState===4&&s){s(e(p.responseText,"json"))}};p.send(null)},j=function(r){var q=[];for(var p in r){q.push(encodeURIComponent(p)+"="+encodeURIComponent(r[p]))}return"?"+q.join("&")};return{initSurvey:function(p){f(p)},cancelSurvey:function(p){k(p)},checkAndDisplaySurvey:function(q,p,r){l(q,p,r,g,null)},forceDisplaySurvey:function(q,p,s,r){l(q,p,s,h,r)}}})()})(document,window,ta);define("utils/throttle",["vanillajs"],function(){return function(d,a){var c=Date.now(),b;return function e(){if(b){clearTimeout(b);b=0}if(Date.now()-c<a){b=setTimeout(d.apply.bind(d,this,arguments),a);return}var f=d.apply(this,arguments);c=Date.now();return f}}});define("ta/common/behavior/ScrollAd",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Event","ta/Core/TA.Store","ta/util/Error","utils/throttle"],function(r,e,g,d,f,u,x){var E={};d.queueForLoad(function(){if(!f.has("ads.no_scroll_ad")){d.on("scrollingTabs_updateTabBar",y);d.on("scrollingTabs_updateTabBar",y);d.on("onHACUpdate",E.resetScrollAd);d.on("onHACUpdateComplete",E.addScrollHandler)}},"ScrollAd");var i=10,a=0,H=[0,250,600],t=null,F=null,h=15,k=h,I=null,c=null,b=false,J=null,o=null,j=1000,p=100,B=e.select(".sidebar_ad_parent"),C=B.length>0,A=1000,D=null,G=false;function z(N){if(N){var M=e.select(".iab_medRec, .iab_medRecStrict, .iab_supSky",N);if(window.pageServlet in {Hotels:1,Search:1}){for(var L=0;L<M.length;L++){var O=e.find(".gptAd:not(.inactive)",M[L]);if(O){var K=e.find(".gptAd>div>iframe",M[L]);if(K){I=e.getPosition(K).left+"px"}break}}}c=s(M);if(!c){a++}else{return e.find(".adInner",c)}}return null}function s(L){for(var K=L.length-1;K>-1;K--){if(L[K].offsetHeight>p){ta.common.ads.setAdIdThatEnablesScrolling(L[K].id);return L[K]}}return null}function v(){if(t&&c){var K=H[Math.round(t.offsetHeight/300)];if(K>0){F=K;if(document.all){c.style.zoom="1";t.style.position="static"}e.addClass(c,"reserveH");c.style.height=K+"px";b=true}}}function n(K){var N=null;for(var L=0;L<B.length;L++){var M=e.getCoords(B[L]);if(K+k>M.top&&K+k+F<M.bottom){N=B[L];break}}return N}function m(){e.removeEvent(window,"scroll",l);if(t&&c){e.removeClass(t,"scrollAd");e.removeClass(c,"reserveH");c.removeAttribute("style");t.style.left="auto"}}function q(L,K){var P=false,M=document.querySelector(L),O,N;if(M&&F!=null&&k!=null&&K!=null){N=e.getCoords(M);O=N.top;if(O!=null){P=K+F+k>O&&K<O+M.offsetHeight}}return P}function w(K){return q("#HSCS.similar_tab_rhr",K)}function y(K){if(K&&parseInt(K.height,10)){k=h+parseInt(K.height,10)}}var l=x(function(){function K(){return e.find("#EATERY_OVERVIEW_BOX")}function V(){var W=e.find(".ppr_priv_restaurant_filters");return W?e.getCoords(W).bottom:null}try{if(!J){J=e.find(".scrollAdMain")||e.find("#BODYCON .gridA .balance")||K()}if(!o){o=ta.common.ads.getSidebarElem()}if(!(t&&document.getElementById(t.id))){t=z(o);if(t){t.style.top=k+"px";v()}}if(t&&o&&J){if(a>i){if(!C){m();return}}var U=e.getCoords(J).bottom;var R=V()||e.getCoords(o).bottom;var M=R-k;var L=U-F-k;var O=U-R-F>0;var T=e.scrollTop();var N=function(){e.addClass(t,"scrollAd");if(I){t.style.left=I+"px"}};var S=function(){e.removeClass(t,"scrollAd");t.style.left="auto"};if(T<L){if(O){if(T>M&&!w(T)){N();a=0}else{S()}}else{a++}}else{if(C&&f.has("ads.contentBlocks")){if(D){var P=e.getCoords(D);if(T<P.top+k||T+k+F>P.bottom){D=n(T)}}else{D=n(T)}if(D&&D.offsetHeight>A){N()}else{S()}}else{S();if(!O){a+=i}}}}else{m()}}catch(Q){m();u.record(Q,"ta.common.scrollAd:handleScroll")}},300);E.addScrollHandler=function(){if(f.has("ads.no_scroll_ad")){return}try{setTimeout(function(){e.removeEvent(window,"scroll",l);e.addEvent(window,"scroll",l);l()},j);G=false}catch(K){u.record(K,"unable to init scrolling ad")}};E.resetScrollAd=function(){if(f.has("ads.no_scroll_ad")){return}try{if(G){return}m();t=null;F=null;c=null;J=null;o=null;b=false;a=0;G=true}catch(K){u.record(K,"error resetting scrolling ad")}};g.exportTo(E,"ta.common.scrollAd");return E});ta.servlet.HACSearch={trackEvent:function(b,d,a,c){if(ta.servlet.HACSearch&&ta.servlet.HACSearch.filter&&ta.servlet.HACSearch.filter._restoringOptions){return}ta.servlet.HACSearch._trackEventData=[b,d,a,c]},consumeTrackEvent:function(){if(!ta.has("hacFilterSaveable")){if(ta.servlet.HACSearch&&ta.servlet.HACSearch.filter&&ta.servlet.HACSearch.filter._restoringOptions){return null}}if(!ta.servlet.HACSearch._trackEventData){return null}var a=ta.servlet.HACSearch._trackEventData;delete ta.servlet.HACSearch._trackEventData;return a},mapMorphed:function(a,d){var f=ta.id(ta.retrieve("maps.container"));if(a==0){if(!d.thumbnailClickHandler){d.thumbnailClickHandler=d.morph.bind(d,1)}f.onclick=d.thumbnailClickHandler;ta.servlet.HACSearch.hideMapSponsor();ta.store("maps.returnTo",{center:d.mapCenter(),zoom:d.getZoom()});ta.id("RESULT_COUNT").setStyle("display","block");ta.id("RESET_MAP").setStyle("display","none");var c=ta.id("IN_RESET_MAP");if(c){c.setStyle("display","none")}d._reset();ta.id("MPZM_ERR").hide();ta.store("maps.moved",false)}else{if(a==1){if(!ta.has("maps.suppressHACActionRecord")){ta.store("lma",ta.servlet.HACSearch.getLoggingName()+"open")}ta.util.pending.lock("maps.nearbyStarted",function(){new Request({url:getHACFormURL(),data:getHACFormData(false).include({nearbyHac:true})}).send()});ta.id("RESULT_COUNT").setStyle("display","none");ta.servlet.HACSearch.showMapSponsor();f.onclick=null;if(ta.has("maps.returnTo")){ta.store("maps.moved",true);var b=ta.remove("maps.returnTo");d.move(b.center.lat(),b.center.lng(),b.zoom);ta.id("RESET_MAP").setStyle("display","block");var c=ta.id("IN_RESET_MAP");if(c){c.setStyle("display","block")}}var e=$$("#LEFTNAV .toggle");if(e&&e[0]){e[0].addClass("off")}}}},hideMapSponsor:function(){var b=ta.id("MAP_SPONSOR");if(b){var a=b.getElement("input[type=checkbox]");if(a&&a.checked){a.click()}b.hide()}},showMapSponsor:function(){var a=ta.id("MAP_SPONSOR");if(a){a.show()}},showMoreMapSponsor:function(f,d){var b=/sponsor_(\w+)/.exec(d.className)[1];var e=ta.id("SPR_HTLS_RHS");var c=ta.id("SPR_HTL_MORE_"+b);var a=ta.id("SPR_HTL_LESS_"+b);if(e){new Request({url:"/ActionRecord?action=sponsor_see_more"}).send();e.getElements(".list_"+b).each(function(g){g.removeClass("hide")})}if(c&&a){c.hide();a.show()}},showLessMapSponsor:function(f,d){var b=/sponsor_(\w+)/.exec(d.className)[1];var e=ta.id("SPR_HTLS_RHS");var c=ta.id("SPR_HTL_MORE_"+b);var a=ta.id("SPR_HTL_LESS_"+b);if(e){e.getElements(".list_"+b).each(function(g){g.addClass("hide")})}if(c&&a){c.show();a.hide()}},getLoggingName:function(){var a=ta.retrieve("maps.overrideLoggingName");if(a){return a}return"HACMap_"},morphBig:function(c,a){if(c){c.stop()}var b=ta.retrieve("maps.map");if(b){b.morph(1)}},mapMoved:function(a,c){var b=function(){if(ta.retrieve("map.poi.changed")){return false}return true};if(!ta.retrieve("map.multipartMove")&&ta.retrieve("maps.map")){var e=ta.retrieve("maps.map").options.minZoom;if(c<e){return}ta.store("lma",ta.servlet.HACSearch.getLoggingName()+"move");ta.store("filter.map",true);ta.id("RESET_MAP").setStyle("display","block");var d=ta.id("IN_RESET_MAP");if(d){d.setStyle("display","block")}if(b()){ta.util.pending.lock("maps.firstMove",function(){var f=$$("#HOTEL_FILTERS fieldset.nearbyCities");if(f){f.show()}ta.store("maps.userMove",true)})}ta.servlet.HACSearch.filtersChanged();ta.servlet.HACSearch.showNearbyCities()}},showNearbyCities:function(){var a=ta.id("SIDEBAR");if(a){var b=a.getElement("#nearbyCities");if(b){if(b.hasClass("hidden")){b.removeClass("hidden");ta.maps.Sidebar.openNearbyCities(null,b.getElement("#toggle_nearby_cities"))}}}},isNearbyCitiesHidden:function(){var e=document.getElement("#HOTEL_FILTERS fieldset.radius");if(e){return false}if(ta.has("hotels_auto_broaden.enabled")){return false}var c=ta.id("SIDEBAR");if(c){var f=c.getElement(".nearbyCities");if(f){if(!f.hasClass("hidden")){return false}}}var d=document.getElements("#HOTEL_FILTERS fieldset.nearbyCities input[type=checkbox]");if(!d||!(d.length)||d.length==0){d=document.getElements("#NEARBY_CITIES_BOX fieldset.nearbyCities input[type=checkbox]")}if(d){var b=false;d.each(function(g){b=b||g.checked});if(!b&&ta.has("maps.nearby")){var a=ta.retrieve("maps.nearby");b=a&&a.length>0}if(b){return false}}return true},mapReset:function(){ta.id("RESET_MAP").setStyle("display","none");var c=ta.id("IN_RESET_MAP");if(c){c.setStyle("display","none")}if(!ta.retrieve("map.leavenc")){var b=ta.retrieve("nearbycities.container");$$(b+" fieldset.nearbyCities input[type=checkbox]").each(function(d){if(d.checked){ta.servlet.HACSearch.setCheckSetChecked(d,false);checked=true}});var a=ta.id("unear");if(a){a.value=""}ta.store("lma",ta.servlet.HACSearch.getLoggingName()+"reset")}ta.servlet.HACSearch.filtersChanged()},mapZoomed:function(f,a){var e=ta.retrieve("maps.map");var g=e.options.minZoom;if(!a){a=e.getZoom()}if(a<g){var c=ta.id("MPZM_ERR");if(!c.hasClass("rdy")){ta.id(document.body).adopt(c.addClass("rdy"))}c.setStyles({left:-9999,top:-9999}).show();var d=ta.id(ta.retrieve("maps.container")).getCoordinates();var b=c.getCoordinates();c.setStyles({left:d.left+(d.width-b.width)/2,top:d.top+(d.height-b.height)/2});e.hideAllPins()}else{ta.id("MPZM_ERR").hide();e.showAllPins()}},filtersChanged:function(b,a){filtersChanged(b,a)},filtersChangedPreventDefault:function(b,a){if(b){b.preventDefault()}filtersChanged(b,a)},nameFilterChanged:function(d){d.preventDefault();var a=ta.retrieve("ta.servlet.HACSearch.nameFilterChanged.lastValue");var e=ta.id("nameContains");var b=(e&&e.value)?e.value:"";ta.servlet.HACSearch.trackEvent("Filters","PropertyNameSearch",b,0);if(e&&((e.value&&e.value!=a)||(!e.value&&a))){ta.store("ta.servlet.HACSearch.nameFilterChanged.lastValue",e.value);var c=window.pageServlet=="LocalMapsRedesign";filtersChanged(null,c)}},nameFilterReset:function(a){if(a){a.preventDefault()}ta.servlet.HACSearch.trackEvent("Filters","PropertyNameReset");var b=ta.id("nameContains");if(b&&b.value&&b.value.length>0){b.value="";ta.store("ta.servlet.HACSearch.nameFilterChanged.lastValue","");ta.servlet.HACSearch.filtersChanged()}},toggleFilter:function(m,a){var f=true;var b=window.pageServlet=="LocalMapsRedesign";ta.servlet.HACSearch.trackFilterOnClick(m,a);if(a.getParent("fieldset.hotelBrand")){var l=brandDup(a);if(l){l.checked=a.checked}}if(a.getParent("fieldset.nearbyCities")){var d=ta.id("unear");var g=ta.id("snear");var e=d&&d.value.length>0?d.value.split(","):[];var h=g&&g.value.length>0?g.value.split(","):[];if(a.checked){e.erase(a.id);h.include(a.id)}else{e.include(a.id);h.erase(a.id)}if(d){d.value=e.join(",")}if(g){g.value=h.join(",")}ta.store("lma",ta.servlet.HACSearch.getLoggingName()+"nearby");var k=a.getParent("fieldset");if(a.hasClass("default")){ta.remove("sel.nearby");k.getElements("input[type=checkbox]").each(function(n){if(!n.hasClass("default")){ta.servlet.HACSearch.setCheckSetChecked(n,false);e.include(n.id);h.erase(n.id)}})}else{var c=ta.retrieve("sel.nearby")||[];if(a.checked){c.push(a.id)}else{c.erase(a.id)}ta.store("sel.nearby",c);var j=k.getElements("input.default");if(j){if(a.checked){j.each(function(n){ta.servlet.HACSearch.setCheckSetChecked(n,false);e.include(n.id);h.erase(n.id)})}}}}else{var k=a.getParent("fieldset");if(a.hasClass("default")){k.getElements("input[type=checkbox]").each(function(n){if(!n.hasClass("default")){ta.servlet.HACSearch.setCheckSetChecked(n,false)}})}else{var j=k.getElements("input.default");if(j){if(a.checked){j.each(function(n){ta.servlet.HACSearch.setCheckSetChecked(n,false)})}else{if(!k.getElements("input[type=checkbox]").some(function(n){return n.checked})){j.each(function(n){ta.servlet.HACSearch.setCheckSetChecked(n,true)})}}}}if(k.hasClass("neibrhd")){if(a.hasClass("default")){ta.store("sel.neighborhood",[a.id])}else{var i=ta.retrieve("sel.neighborhood")||[];if(a.checked){i.push(a.id)}else{i.erase(a.id)}ta.store("sel.neighborhood",i)}if(window.pageServlet=="LocalMapsRedesign"){ta.remove("maps.keep_filters")}}if(k.hasClass("lockout")){f=false;ta.store("filter.lockout",true)}}ta.servlet.HACSearch.adjustTopValueState();if(f){ta.util.pending.waitForMore("filters",ta.servlet.HACSearch.filtersChanged,1000,[null,b])}else{ta.servlet.HACSearch.filtersChanged(null,b)}},toggleAllAvailability:function(c,a){ta.id("HOTEL_FILTERS").availability.value=a.value;ta.store("lma",ta.servlet.HACSearch.getLoggingName()+"avail");if(ta.id("HAC_FORM")!=null){ta.id("HAC_FORM").searchAll.value=(a.value=="1")}ta.servlet.HACSearch.filtersChanged();$$("input.avail_"+a.value).each(function(d){d.checked=true});var b=a.value=="1"?"0":"1";$$("input.avail_"+b).each(function(d){d.checked=false})},toggleAvailabilityAlt:function(b,a){if(/.*_(\d)$/.test(a.id)){ta.id("availability_"+RegExp.$1).click()}},updateData:function(){try{ta.servlet.HACSearch._updateData()}catch(a){ta.util.error.record(a,"ta.servlet.HACSearch.updateData")}},_updateData:function(){if(ta.has("maps.nearby")){var q=ta.remove("maps.nearby");var m=ta.retrieve("nearbycities.container");$$(m+" fieldset.nearbyCities input[type=checkbox]").each(function(t){var u=q.contains(t.id);ta.servlet.HACSearch.setCheckSetChecked(t,u);if(m==="#SIDEBAR"){updateFilterStyle(t,u)}})}var c=ta.id("map_pager");var a=ta.id("pager_top2");if(c){if(a){c=c.getElement("div.pgLinks");if(c){c.innerHTML=a.innerHTML;if(typeof behavior!="undefined"){behavior.apply(c)}}}else{c.innerHTML='<div class="pgLinks"></div>'}}var j=ta.id("mapSG");var e=ta.id("BEST_VALUE_FORM");if(j&&e){j.checked=e.sortGroup.checked;j.disabled=e.sortGroup.disabled;j.getParent().getElement("span").innerHTML=e.getElement("label.bv span").innerHTML;if(j.disabled){j.getParent().addClass("disabled")}else{j.getParent().removeClass("disabled")}}var p=ta.id("SORT_FORM");var s=ta.id("mapSortForm");if(p&&s){s.set("html",p.innerHTML)}var b=ta.id("mapRedesignSG");if(b&&e){var l=b.sortGroup;l.checked=e.sortGroup.checked;l.disabled=e.sortGroup.disabled;var g=b.getElement("span");g.innerHTML=e.getElement("label.bv span").innerHTML;if(b.sortGroup.disabled){g.addClass("disabled")}else{g.removeClass("disabled")}}var o=ta.id("resultsDateBar");var r=ta.id("mapDateBar");if(o&&r){o.getChildren("radio").each(function(u){var t=r.getElement(".avail_"+u.value);if(t){t.checked=u.checked}})}var d=ta.id("LARGE_MAP");if(d){var h=d.getElement(".showing");var i=d.getElement(".srtTools");var k=true;if(h){var f=ta.id("ACCOM_OVERVIEW");var n=h.getElement("span");if(f){f=f.getElement(".pagination .pgCount");if(f){n.innerHTML=f.innerHTML}else{n.innerHTML="0";k=false}}else{n.innerHTML="0";k=false}}if(i){if(k){i.show()}else{i.hide()}}}},updateSponsorAds:function(b,a){if(a==null){a=ta.retrieve("sponsor.active")}if(a==ta.retrieve("sponsor.ad."+b)){return}ta.store("sponsor.ad."+b,a);new Request({url:"/MapAdAjax?fromServlet="+window.pageServlet+"&t="+b+"&sponsor="+a+"&ac="+getIncrementedAdsAjaxCount(),method:"get",evalScripts:true,onSuccess:function(c,d){var e;if(b=="leader"){e=ta.id("PAGE").getElement(".iab_leaBoa");if(!e){e=new Element("div",{"class":"ad iab_leaBoa"});e.inject("MAIN","before")}if(ta.has("ads.gptEnabled")){ta.common.ads.injectAjaxAds("mapadajax",".iab_leaBoa .gptAd",true)}else{e.set("html",c);ta.common.ads.injectAdsTargeted(e)}}else{if(b=="180X150"){e=ta.id("HACMAP_AD_PARENT");if(e){e.removeClass("hidden")}if(ta.has("ads.gptEnabled")){ta.common.ads.injectAjaxAds("mapadajax","#HACMAP_AD_PARENT .gptAd",true)}else{e.set("html",c);ta.common.ads.injectAdsTargeted(e)}}}}}).send()},toggleTypeByValue:function(c,a){if(!["checkbox","radio"].contains(a.type)){return}if(!ta.has("maps.map")){return}var b=ta.retrieve("maps.map");if(a.checked){b.showType(a.value)}else{b.removeMarkersByType(a.value)}},toggleSponsor:function(f,b){ta.servlet.HACSearch.toggleTypeByValue(f,b);var e=b&&b.get("tag")=="input";if(e){var d=ta.id(b.id.replace("sidebar","thumb"));var a=ta._locationHash;if(b.checked){ta.store("addSponsorship",1);ta.store("addSponsorshipToggle","turnOn "+b.value);ta.store("addSponsorshipValue",b.value);if(ta.trackEventOnPage){ta.trackEventOnPage("dynamic_large_map","sidebar_sponsor_check",b.value)}if(d){d.checked=true}ta.servlet.HACSearch.updateSponsorStore(b.value,true)}else{ta.store("addSponsorship",0);ta.store("addSponsorshipToggle","turnOff "+b.value);ta.store("addSponsorshipValue",null);if(ta.trackEventOnPage){ta.trackEventOnPage("dynamic_large_map","sidebar_sponsor_uncheck",b.value)}if(d){d.checked=false;ta.id("STMAP_OVERLAYS").empty()}ta.servlet.HACSearch.updateSponsorStore(b.value,false)}}ta.servlet.HACSearch.filtersChanged();if(b.checked){ta.servlet.HACSearch.updateSponsorAds("leader",b.value);if(ta.retrieve("maps.is_open")){ta.servlet.HACSearch.updateSponsorAds("180X150",b.value)}ta.store("sponsor.active",b.value)}else{var c=ta.id("SPR_HTLS_RHS");if(c){c.empty()}}},updateSponsorStore:function(b,a){var c=ta.retrieve("maps.sponsors");var d=[];if(c&&c.length){c.each(function(e){if(e!=b){d.push(e)}})}if(a){d.push(b)}ta.store("maps.sponsors",d)},toggleTopValue:function(b,a){ta.id("BEST_VALUE_FORM").sortGroup.click()},updateCheckedIndices:function(e){if(isNaN(e.value)){return}var a=e.getParent("fieldset").getElement("input.checkedIndices");var d=e.getParent("fieldset").getElement("input.uncheckedIndices");var b=e.checked?d:a;if(b){b.value=b.value.split(",").erase(e.value).erase("").join(",")}var c=e.checked?a:d;if(c){c.value=c.value.split(",").include(e.value).erase("").join(",")}},setCheckSetChecked:function(b,a){if(b){b.checked=a;ta.servlet.HACSearch.updateCheckedIndices(b)}},_filterClassToTrackingLabel:function(a){if(!(a&&a.hasClass)){return null}var c={ptype:"PropertyType",radius:"SearchNearby",priceRangeList:"PricePerNight",neibrhd:"Neighborhood",travelerRatingList:"TravelerRating",hotCls:"HotelClass",amenities:"Amenities",hotelName:"PropertyName",hotelBrand:"HotelBrand",suitability:"Suitability",nearbyGeos:"NearbyGeos"};for(var b in c){if(a.hasClass(b)){return c[b]}}return null},toggleFilterExpansion:function(f,d){try{ta.call("ta.util.Toggle.siblings",f);var c=ta.id(d);var g=(c.hasClass("closed"))?"Collapse":"Expand";var a=c.getParent("fieldset");var b=ta.servlet.HACSearch._filterClassToTrackingLabel(a);ta.trackEventOnPage("Filters",g,b,0)}catch(h){ta.util.error.record(h,"ta.servlet.HACSearch.toggleFilterExpansion")}},trackFilterOnClick:function(a,f){try{if(!a||!f){return}var k=f.getParent("fieldset");var d=ta.servlet.HACSearch._filterClassToTrackingLabel(k);d=d+((f.checked)?"Checked":"Unchecked");var h=f.getSiblings("label[for="+f.id+"]");var b="";if(h){var j=h.get("text");if(j){var c=/^[^(]+/.exec(j);if(c&&c[0]){b=c[0].trim()}}}var i=(isNaN(f.value))?0:f.value;ta.servlet.HACSearch.trackEvent("Filters",d,b,f.value)}catch(g){ta.util.error.record(g,"ta.servlet.HACSearch.trackFilterOnClick")}},handleCheckSetOnClick:function(a,b){ta.servlet.HACSearch.trackFilterOnClick(a,b);ta.servlet.HACSearch.updateCheckedIndices(b);ta.servlet.HACSearch.toggleFilter(a,b)},setDealsFilter:function(){ta.store("maps.offersOnly",true);this.filtersChanged()},showAndUpdateLargeMap:function(a){if(a){a.preventDefault()}ta.servlet.HACSearch.showLargeMap();ta.servlet.HACSearch.filter.update();this.filtersChanged()},currencyOnChange:function(e,c){var a=ta.id(c);var d=a.getSelected();var b=(d&&d[0]&&d[0].text)?d[0].text:"";ta.servlet.HACSearch.trackEvent("Filters","PPNCurrency",b,a.selectedIndex);filtersChanged(e)},updateSpecialOffers:function(c){var a=ta.id("VR_SPECIAL_OFFERS_HEADER");var b=ta.select(".hotels_special_offers")[0];if(a&&b){if(c===6){ta.util.element.makeTextFitOneLine(".vrSoHeaderText");a.show();b.hide()}else{a.hide();b.show()}}},getCategoryAsNumber:function(b){if(b&&typeof b==="string"){var a=b.match(/cat_(\d+)/);if(a){return a[1]}}return b},catRadioClicked:function(g,d,f){ta.remove("keep_users_on_hotels_v2.id");ta.remove("sponsoredCouponData");ta.remove("parklanestrategy_sponsored_listing");var a;if(d.className.match(/cat_(\d+)/)){a=ta.id(d)}else{a=ta.id(d.getParent("div"))}var c=a.className.match(/cat_(\d+)/);var e=a.hasClass("disabled")||a.getElement("label.disabled");if(f){c=f}if(c){if(!e){ta.store("sel.category",c[0]);var h=c[0];ta.servlet.HACSearch.selectPropertyTypeTab("PROPTYPE_BOX",h);ta.servlet.HACSearch.selectPropertyTypeTab("PROPTYPE_BOX_LEFTNAV",h);var b={cat_1:"HOTELS",cat_2:"BB",cat_3:"OTHER",cat_6:"VR"};ta.servlet.HACSearch.trackEvent("Filters","PropertyType",b[h],0);if(ta.hac.filters.style.getVersion()>=2){ta.hac.filters.style.reset();if(a.hasClass("chkSet")){ta.hac.filters.style.visualClickTab(h)}}if(ta.hac.filters&&ta.hac.filters.changeCategory){ta.store("catChanged",true);ta.hac.filters.changeCategory(c[1])}else{filtersChanged()}}else{if(g){g.preventDefault()}}}ta.hac.filters.style.showOrHideStyleButtons()},selectPropertyTypeTab:function(b,c){try{if(!ta.id(b)){return}var a=$$("#"+b+" .tab");Array.each(a,function(e){ta.id(e).removeClass("current")});Array.each(c,function(e){var f=$$("#"+b+" ."+e)[0];f.addClass("current");var g=f.getElement("input");if(g){g.checked=true}})}catch(d){}},handleCheckSetClickOnCount:function(d,c,f){new Event(d).stop();var e=ta.id(f);ta.servlet.HACSearch.trackFilterOnClick(d,e);var a=e.getParent("fieldset").getElements("div.chkSet input");for(var b=0;b<a.length;++b){ta.servlet.HACSearch.setCheckSetChecked(ta.id(a[b]),ta.id(a[b]).id==f)}ta.servlet.HACSearch.toggleFilter(d,ta.id(f))},doMetaDateSearch:function(i,l){var c=false;if(ta.retrieve("priceFinder.noAutoRefresh")){var k=ta.find("#STATIC_DATE_PICKER_BAR .change_dates_button")||ta.find("#STATIC_DATE_PICKER_BAR .update_results_button");var h=ta.find("#STATIC_DATE_PICKER_BAR .roomsChange")||ta.find("#STATIC_DATE_PICKER_BAR .rooms-picker");c=!(l&&(l.hasClass("change_dates_button")||l.hasClass("update_results_button")||!l.getParent("#STATIC_DATE_PICKER_BAR")||(h&&!h.isVisible())));var j=ta.find("#STATIC_DATE_PICKER_BAR .unified-picker");var a=j&&j.getAttribute("data-didcreatedefaultdates")=="true";if(c&&a){c=false;j.removeAttribute("data-didcreatedefaultdates")}c&&k&&k.addClass("ready_for_update");if(k&&k.hasClass("ready_for_update")&&k.hasClass("disabled")){k.removeClass("disabled")}if(c&&l&&l.hasClass("date_picker")){var b=l.getParent(".meta_date_field");b&&b.addClass("ready_for_update")}}ta.store("priceFinder.preventHAC",c);if(ta.widgets.calendar.hasPageDates()&&!c){ta.store("priceFinder.search_dates",ta.widgets.calendar.getCheckRatesData())}if(!ta.widgets.calendar.hasPageDates()){var g=document.getElement(".metaDatePicker .date_picker_calendar_wrap");g&&g.fireEvent("click")}else{if(ta.has("hac.filter.changed")||ta.has("meta.mini_meta_on_accommodations")){ta.servlet.HACSearch.displayPostDatesLinks();var d=(window.pageServlet==="Hotels"||window.pageServlet==="HotelsList")&&window.modelLocId&&window.modelLocId!==i;if(ta.has("hotels_left_filters_redesign")&&ta.overlays&&ta.overlays.NumberPickerOverlay){ta.overlays.NumberPickerOverlay.updateHeaderMsg(".metaDatePicker");ta.overlays.NumberPickerOverlay.unhideDropdowns("#hotels_lf_rooms_guests_wrap")}if(d){ta.trackEventOnPage("INLINEDATEPICKER","SELECT","",i)}if(d&&!ta.retrieve("enteredDatesInPreDates")&&ta.retrieve("keep_users_on_hotels_v2.id")!=i){ta.remove("keep_users_on_hotels_v2.id")}!c&&window.fireEvent("hotels.datesUpdate");var f=ta.retrieve("animate_date_reformat")?ta.id("ANIMATED_DATE_CTA_REFORMAT"):ta.id("ANIMATED_DATE_CTA");f&&f.addClass("hidden");if(d&&ta.retrieve("enteredDatesInPreDates")){if(l&&!l.getParent("#sponsoredCouponListing")){ta.store("keep_users_on_hotels_v2.id",i);ta.servlet.HACSearch.scrollToHighlightHotel();ta.id("highlightHotelContent")&&ta.id("highlightHotelContent").addClass("hidden")}!c&&ta.widgets.calendar.justUpdateSessionDates(function(){ta.hac.filters.updateResultsFromDateSearch();ta.store("datesChanged",true)},false,true);var e=ta.id("property_"+i);if(e&&e.href&&!(ta.page&&ta.page.usingUnifiedDates)){ta.popups.PopUtil.attemptOpenUrlNewTab(e.href)}}else{!c&&ta.widgets.calendar.justUpdateSessionDates(function(){ta.hac.filters.updateResultsFromDateSearch();ta.store("datesChanged",true)})}}else{if(ta.retrieve("hotels.datesChanged")){updateResults(true);ta.servlet.HACSearch.destroyAnimatedDateCTA()}else{ta.widgets.calendar.justUpdateSessionDates(function(){window.location=ta.commerce.meta.buildMetaHACUrl()},true)}}}if(ta.retrieve("meta.trackShowPriceButton")){ta.trackEventOnPage("DATEPICKER","SearchButton","");ta.store("meta.trackShowPriceButton",false)}},scrollToHighlightHotel:function(){var c=ta.id("highlightHotelContentWrap");if(c){var b=c.getPosition().y;var d=ta.id("ACCOM_OVERVIEW");if(d){b-=d.getStyle("padding-top").toInt()}var a=ta.id("PERSISTENT_DATE_PICKER");if(a){b-=a.getHeight()}window.scrollTo(0,b)}},doDateSearch:function(c,a){if(ta.servlet.HACSearch.areDateFieldsSet()){if(ta.id("HOTEL_FILTERS")!=null){ta.id("HOTEL_FILTERS").availability.value="0"}ta.id("searchAll").value="false";ta.servlet.HACSearch.filter.update()}ta.servlet.HACSearch.adjustTopValueState();var d=ta.id("xnear_conditional");if(d){ta.store("xnear_conditional",d.value)}ta.remove("maps.keep_filters");updateResults(true);var b=ta.id("findFlights");if(b&&b.checked){if(ta.popups.FlightSearch){try{ta.popups.FlightSearch.popFlightSearch()}catch(f){}}}},areDateFieldsSet:function(){var a=ta.id("HAC_FORM");var b=false;if(a){a.getElements(".cal input[type=text]").each(function(c){if(c.value==JS_DateFormat){b|=true}})}return !b},showLargeMap:function(b,a){try{if(b){b.preventDefault()}if(ta.has("sponsor.active")&&a&&(a.get("tag")=="a"||a.get("tag")=="span"||a.get("tag")=="img")){ta.store("sponsor.record_map_open")}$$(".hacMapAdPixelHolder").each(function(d){ta.servlet.HACSearch._downloadTrackPixel(d)});if(ta.has("sponsor.active")){ta.servlet.HACSearch.updateSponsorAds("180X150")}ta.servlet.HACSearch.loadOrShowLargeMap(true);if(typeof autoCloseWindowShade!="undefined"){autoCloseWindowShade()}}catch(c){ta.util.error.record(c,"ta.servlet.HACSearch.showLargeMap")}},_isMapLoaded:function(){return ta.has("maps.map")||ta.has("maps.create_called")},loadOrShowLargeMap:function(e){window.windowShade=false;ta.store("maps.is_open",true);if(ta.retrieve("moveResultSummary")){var b=ta.id("HAC_SMRY");var d=ta.id("LARGE_MAP");if(b&&d){b.inject(d,"before")}}if(e){ta.servlet.HACSearch.filter.update()}if(ta.id("SMALL_MAP")){ta.id("SMALL_MAP").setStyle("display","none")}if(ta.id("SPR_HTLS_RHS")){ta.id("SPR_HTLS_RHS").setStyle("display","block")}$$("#LARGE_MAP .sponsorTrkHolder").each(function(g){ta.servlet.HACSearch._downloadTrackPixel(g)});var c=ta.id("LARGE_MAP");if(ta.retrieve("maps.is_open")){showTitlePins()}if(!ta.servlet.HACSearch._isMapLoaded()){ta.store("maps.create_called",true);ta.store("maps.landmarks",[]);if(ta.has("sponsor.record_map_open")){ta.remove("sponsor.record_map_open");new Request({url:"/ActionRecord?action=sponsor_hacmap_open"}).send()}if(!ta.has("maps.suppressHACActionRecord")){ta.store("lma",ta.servlet.HACSearch.getLoggingName()+"open")}ta.util.load.LocalSearch();var a=function(){ta.store("maps.callback","ta.servlet.HACSearch.createMapCaller");ta.util.load.maps();c.setStyle("display","block");ta.servlet.HACSearch.showMapSponsor();ta.servlet.HACSearch.updateSponsorAds("180X150")};if(ta.maps.Map){a()}else{ta.load("ta-maps.js",a)}}else{if(!ta.has("maps.landmarks")){ta.store("maps.landmarks",[])}if(ta.has("map.delayedLoc")){ta.maps.Sidebar._addLocationCallback(ta.retrieve("map.delayedLoc.point"),ta.retrieve("map.delayedLoc.data"))}c.setStyle("display","block");ta.servlet.HACSearch.showMapSponsor();ta.servlet.HACSearch.updateSponsorAds("180X150")}var f=ta.retrieve("maps.map");if(f){f.checkResize()}},sidebarType:{attractions:2,restaurants:3},updateMapsSidebarInput:function(b){if(isNaN(b)){return}var a=ta.retrieve("zft")||[];if(!a.contains(b)){a.push(b);ta.store("zft",a)}},createMapCaller:function(){ta.store("maps.postcreate",function(r){try{var d=ta._locationHash;var g=false;if(d.has("bc_restaurants")||ta.has("maps.restaurants")){ta.remove("maps.restaurants");var h=ta.id("sidebar_restaurants");if(h){h.checked=true;ta.servlet.HACSearch.updateMapsSidebarInput(ta.servlet.HACSearch.sidebarType.restaurants);g=true}}if(d.has("bc_attractions")||ta.has("maps.attractions")){ta.remove("maps.attractions");var i=ta.id("sidebar_attractions");if(i){i.checked=true;ta.servlet.HACSearch.updateMapsSidebarInput(ta.servlet.HACSearch.sidebarType.attractions);g=true}}try{var b=ta.retrieve("thDataObj");if(b){var l;if(b.coords){var a=b.coords.split(",");l=new ta.maps.Location(a[0],a[1])}ta.servlet.HACSearch.reconcileLocations(true);ta.maps.Sidebar.addLocation(null,null,l,b,false)}}catch(p){ta.util.error.record(p,"maps post create - type ahead")}var j=ta.id("offersOnly");if(j&&ta.has("maps.offersOnly")){j.checked=true;g=true}try{if(d.has("airports")||ta.has("hac.map.airports")){var n=d.get("airports")?d.has("airports"):ta.retrieve("hac.map.airports");var k=ta.id("toggle_airports");if(k&&!k.hasClass("on")){ta.maps.Sidebar.toggleAirports(null,ta.id("toggle_airports"),true)}if(n){n.each(function(e){var t=ta.id("airport_"+e);if(t){t.checked=true;ta.maps.Sidebar.togglePOI(null,t,true)}})}g=true}}catch(p){ta.util.error.record(p,"maps post create - load airports")}var o=ta.remove("maps.address_search_deferred");if(o){o()}else{var q=ta.remove("maps.poi_search_deferred");if(q&&q.length&&q.length>3){q[0](q[1],q[2],q[3])}}if(ta.has("maps.actionrecord")){var f=ta.remove("maps.actionrecord");new Request({url:f}).send()}if(ta.has("map.delayedLoc")){ta.maps.Sidebar._addLocationCallback(ta.retrieve("map.delayedLoc.point"),ta.retrieve("map.delayedLoc.data"))}if(d.has("mt")){r.setMapType(d.get("mt"))}if(window.pageServlet=="LocalMapsRedesign"){if(!ta.has("maps.sponsors")){var c=[];var m=document.getElements("input[id*=sidebar_sponsor_]");if(m&&m.length){m.each(function(e){if(e.checked){c.push(e.value)}})}ta.store("maps.sponsors",c)}}else{ta.servlet.HACSearch.updateMapSponsors()}if(d.has("mc")&&d.has("mz")){var s=d.get("mc").split(",");r.move(parseFloat(s[0]),parseFloat(s[1]),parseInt(d.get("mz")));r.checkResize();ta.servlet.HACSearch.mapZoomed();ta.store("maps.moved",true)}else{if(g){ta.servlet.HACSearch.filtersChanged()}}}catch(p){ta.util.error.record(p,"hac map postcreate")}});ta.util.pending.waitForFn("mapfactory","ta.maps.Factory.createMap");return},hideLargeMap:function(g,f,e){var c=ta.id("LARGE_MAP");var d=ta.id("SMALL_MAP");if(c&&d){c.setStyle("display","none");d.setStyle("display","block");if(ta.id("SPR_HTLS_RHS")){ta.id("SPR_HTLS_RHS").setStyle("display","none")}ta.servlet.HACSearch.hideMapSponsor();if(ta.retrieve("addSponsorship")==1){ta.servlet.HACSearch.updateSponsorAds("180X150",ta.retrieve("addSponsorshipValue"))}if(!e){ta.servlet.HACSearch.filter.update()}hideTitlePins();if(ta.retrieve("moveResultSummary")){var a=ta.id("HAC_SMRY");var b=ta.id("HAC_RESULTS");if(a&&b){a.inject(b,"before")}}}},clearDates:function(c,b){var a=ta.id("searchAll").value;ta.id("searchAll").value=true;if(a=="trueButShow"){ta.servlet.HACSearch.clearDateFields()}else{ta.run("ta.overlays.Factory.showUpdatingMessage");updateResults(true)}},clearDateFields:function(){var a=ta.id("checkIn").form;if(a.calendar){a.calendar.clearFields()}ta.servlet.HACSearch.hideClearDates()},restoreDateFields:function(){var a=ta.id("checkIn").form;if(!a.calendar){new ta.overlays.PairedCalendar(a)}a.calendar.updateFields();ta.servlet.HACSearch.showClearDates()},hideClearDates:function(){$$("#HAC_SMRY .smry .hvrIE6").each(function(a){a.setStyle("display","none")});$$("#HAC_DATES .smry .hvrIE6").each(function(a){a.setStyle("display","none")})},showClearDates:function(){$$("#HAC_SMRY .smry .hvrIE6").each(function(a){a.setStyle("display","inline")});$$("#HAC_DATES .smry .hvrIE6").each(function(a){a.setStyle("display","inline")})},showAllTopValue:function(b,a){b.preventDefault();if(ta.id("BEST_VALUE_FORM")){ta.id("BEST_VALUE_FORM").sortGroup.checked=true;bestValueChanged()}ta.servlet.HACSearch.filtersChanged()},adjustTopValueState:function(){var a=ta.remove("topvalue.state");if(a){if(ta.id("BEST_VALUE_FORM")){ta.id("BEST_VALUE_FORM").sortGroup.checked=true;bestValueChanged()}}},tabClicked:function(d,b){if(b.tagName!="H2"){b=b.getParent("H2")}if(b.className.match(/current/)){return}var a=b.className.match(/cat_(\d+)/);var c=b.hasClass("disabled");if(a){d.preventDefault();if(!c){ta.store("sel.category",a[0]);filtersChanged();ta.id(b.getParent()).getElements(".tab").each(function(e){e.removeClass("current")});b.addClass("current")}}},changeOffset:function(b,a,c){new Event(b).preventDefault();ta.store("hacform.data",{o:"a"+c});filtersChanged()},_getMiniMapAddress:function(){if(ta.id("add_location_input_filter")){return ta.id("add_location_input_filter").value}return ta.id("SMALL_MAP_ADDRESS").getFirst().address.value},_setMiniMapAddress:function(a){if(ta.id("add_location_input_filter")){if(a!=map_enteraddress){ta.id("add_location_input_filter").value=a}}ta.id("SMALL_MAP_ADDRESS").getFirst().address.value=a},updateFilterLocation:function(a){ta.store("locationfilter.locval",a)},focusLocationFilter:function(c,a){var b=ta.id("add_location_input_filter");if(b){b.value=""}},_doBlurLocationFilter:function(){if(!ta.remove("locationfilter.skipblur")){var a=ta.id("add_location_input_filter");if(a&&ta.has("locationfilter.locval")){ta.store("locationfilter.oldlocval",a.value);a.value=ta.retrieve("locationfilter.locval")}}},blurLocationFilter:function(b,a){ta.servlet.HACSearch._doBlurLocationFilter.delay(200)},onFilterSubmit:function(b,a){ta.store("locationfilter.skipblur",true);ta.servlet.HACSearch.onMiniMapAddressSubmit(b,a,true)},onMiniMapAddressSubmit:function(c,b,a){new Event(c).stop();ta.run("ta.overlays.Factory.showFilterWaitOverlay",{},true);if(a){ta.store("filter_address_lookup.callback",ta.servlet.HACSearch._onMiniMapAddressSubmitReady);ta.servlet.HACSearch.onMiniMapAddressSearch(c,b,true)}else{ta.servlet.HACSearch._onMiniMapAddressSubmitReady(true)}},_onMiniMapAddressSubmitReady:function(f){var b=!f;var e=ta.id("SMALL_MAP_ADDRESS").getFirst();var d=e.action;ta.servlet.HACSearch.reconcileLocations(false);var a=ta.servlet.HACSearch._getMiniMapAddress();if(a!=""&&a!=map_enteraddress){ta.servlet.HACSearch.filter.setOption("bc_address",a)}if(b){ta.servlet.HACSearch.filter.setOption("poi",ta.retrieve("map.poi"));ta.servlet.HACSearch.filter.setOption("newPoi",ta.retrieve("map.poi.changed"));var c=ta.id("distance");if(c){ta.servlet.HACSearch.filter.setOption("distance",c.options[c.selectedIndex].value)}}ta.setEvtCookie("static_map","poi_search_go_click","","",getHACFormURL()+ta.servlet.HACSearch.buildHACUrlParamString());updateResultsFromForm();return false},onSelectLocationTypeAhead:function(a,i,d,k){var c=i?i.name:null;var j=i?i.type:null;var g=i?i.value:null;var l=i?i.coords:null;var b=i?i.url:null;var m;if(l){var h=l.split(",");m=new ta.maps.Location(h[0],h[1])}if(g){var e={name:c,type:j,url:b,value:g,coords:l};ta.store("thDataObj",e)}if(a.hasClass("vrAddress")){var f="VR_TAB_MAP_SEARCH";var n="&geo="+modelGeoId+"&detail="+modelLocId}else{f="LocTypeAhead_sel_"+j;n=""}new Request({url:"/ActionRecord?action="+f+n}).send();ta.servlet.HACSearch.reconcileLocations(!k);return ta.maps.Sidebar.addLocation(null,d,m,i,k)},onSelectLocationTypeAheadFilter:function(a,c,b){ta.servlet.HACSearch.reconcileFilterLocation();ta.servlet.HACSearch.onSelectLocationTypeAheadSmallMap(a,c,b,true)},onSelectLocationTypeAheadSmallMap:function(a,i,e,l){var c=i?i.name:null;var j=i?i.type:null;var g=i?i.value:null;var k=i?i.coords:null;var b=i?i.url:null;var d=ta.id("SMALL_MAP_ADDRESS").getFirst();var f=ta.servlet.HACSearch.buildHACUrlParamString();if(g){ta.servlet.HACSearch.filter.setOption("th_name",c);ta.servlet.HACSearch.filter.setOption("th_type",j);ta.servlet.HACSearch.filter.setOption("th_value",g);ta.servlet.HACSearch.filter.setOption("th_coords",k);ta.servlet.HACSearch.filter.setOption("th_url",b);ta.servlet.HACSearch.filter.setOption("poi",k);ta.servlet.HACSearch.filter.setOption("newPoi",1);if(l){var h=ta.id("distance");if(h){ta.servlet.HACSearch.filter.setOption("distance",h.options[h.selectedIndex].value)}}}if(ta.setEvtCookie){ta.setEvtCookie("static_map","poi_search","","",getHACFormURL()+f)}ta.servlet.HACSearch.reconcileLocations(false);new Request({url:"/ActionRecord?action=LocTypeAhead_sel_"+j}).send();document.location.href=getHACFormURL()+f+"#"+ta._locationHash.asString()},_doAddressSearch:function(){try{var a=ta.servlet.HACSearch._getMiniMapAddress();var b=ta.id("add_location_input");if(b){b.value=a}var c=ta.id("add_location_input_filter");if(c){c.value=a}ta.maps.Sidebar.addLocation();ta.servlet.HACSearch._setMiniMapAddress(map_enteraddress)}catch(d){ta.util.error.record(d,"ta.servlet.HACSearch.doAddressSearch")}},reconcileLocations:function(a){var d=ta.id("add_location_input");var c=ta.id("small_location_input");var b=ta.id("add_location_input_filter");if(a&&d&&b){b.value=d.value}else{if(c&&b){b.value=c.value}}},clearLocation:function(b,a){var c=ta.id("IN_RESET_MAP");if(c){c.setStyle("display","none")}ta.maps.Sidebar.clearLocation()},reconcileFilterLocation:function(d,a){var b=ta.id("add_location_input_filter");var c=ta.id("small_location_input");var e=ta.id("add_location_input");if(b&&c){c.value=b.value}if(b&&e){e.value=b.value}},onFilterLocation:function(b,a){ta.store("locationfilter.skipblur",true);ta.servlet.HACSearch.reconcileFilterLocation();ta.store("filter_address_lookup.callback",ta.servlet.HACSearch.filtersChanged);ta.servlet.HACSearch.onMiniMapAddressSearch(b,a,true)},onMiniMapAddressSearch:function(c,b,a){ta.servlet.HACSearch.reconcileLocations(false);if(!a){if(!ta.servlet.HACSearch._isMapLoaded()){ta.store("maps.address_search_deferred",ta.servlet.HACSearch._doAddressSearch)}else{ta.servlet.HACSearch._doAddressSearch()}ta.servlet.HACSearch.showLargeMap(c,b)}else{ta.remove("map.delayedLoc");if(!ta.servlet.HACSearch._isMapLoaded()){ta.store("maps.address_search_deferred",ta.servlet.HACSearch._doFilterAddressLookup);ta.util.pending.waitForFile("createmap","ta-maps.js",function(){ta.store("maps.callback","ta.servlet.HACSearch.createMapCaller");ta.util.load.maps()})}else{ta.servlet.HACSearch._doFilterAddressLookup()}}},_doFilterAddressLookup:function(){var d=ta.retrieve("maps.map");var b=ta.id("add_location_input_filter").value;if(!d||!b||b==""){ta.servlet.HACSearch._onFilterAddressLookup(null)}ta.store("maps.address",b);var c=new ta.maps.Geocoder();var a=d.mapBounds();c.setViewport(a);c.getLatLng(b,ta.servlet.HACSearch._onFilterAddressLookup,null)},_onFilterAddressLookup:function(b,c){if(b==null){ta.servlet.HACSearch._addressLookupError(map_addressnotfound);return}ta.remove("thDataObj");ta.store("map.delayedLoc",true);ta.store("map.delayedLoc.point",b);ta.store("map.delayedLoc.data",null);ta.store("map.poi.changed",true);ta.store("map.poi",b.toUrlValue());var d=ta.retrieve("maps.map");if(!d){return}var a=d.mapCenter();var f=new ta.maps.Location(a.lat(),a.lng());var e=f.distanceFrom(b)/1609.344;if(e>100){ta.servlet.HACSearch._addressLookupError(map_addressnotfound);return}ta.servlet.HACSearch.updateFilterLocation(ta.id("add_location_input_filter").value);ta.servlet.HACSearch._clearLookupError();var g=ta.remove("filter_address_lookup.callback");if(g){g()}},_clearLookupError:function(){var a=ta.id("SMALL_MAP_ADDRESS_FILTER");if(a){a.removeClass("hlLookupErr")}},_addressLookupError:function(d){if(ta.retrieve("isDaoDao")){var b=ta.retrieve("daodao.showAddressLookupErr");if(ta.retrieve("daodao.showAddressLookupErr")){b();return}}var a=ta.id("SMALL_MAP_ADDRESS_FILTER");if(a){a.addClass("hlLookupErr")}var c=ta.retrieve("addresslookupoverlay");if(!c){overly=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,zIndex:"996",activate:ta.overlays.ACTIVATE_NEVER,style:"errOverlay"},"LOCATION_FILTER");ta.store("addresslookupoverlay",overly)}var e=ta.id("LOCATION_FILTER_ERR");if(e){e.set("html",d)}overly.show()},showMapTeaser:function(){var b=ta.id("LOC_SEARCH_MAP_TEASER");var a=ta.id("SMALL_MAP");if(b&&a&&a.style.display!="none"){b.removeClass("hidden")}},hideMapTeaser:function(){var b=ta.id("LOC_SEARCH_MAP_TEASER");var a=ta.id("LARGE_MAP");if(b&&a&&a.style.display!="none"){b.addClass("hidden")}},onMapAddressFocus:function(c,b,a){try{if(a&&b.value.trim()==b.defaultValue.trim()){b.value="";ta.id(b).removeClass("unfocused")}else{if(!a&&b.value==""){b.value=b.defaultValue;ta.id(b).addClass("unfocused")}}}catch(d){}},onLargeMapAddressFocus:function(d,b){var a=ta.id("add_location_input");if(a){a.value="";a.removeClass("unfocused")}var c=ta.id("add_location_input_filter");if(c){c.value="";c.removeClass("unfocused")}},onLargeMapAddressBlur:function(d,b){var a=ta.id("add_location_input");if(a&&a.value.length==0){a.value=map_enteraddress;a.addClass("unfocused")}var c=ta.id("add_location_input_filter");if(c&&a.value.length==0){c.value="";c.addClass("unfocused")}},_downloadTrackPixel:function(a){if(a){var c="http://"+a.get("text").trim();var b=ta.id(document.createElement("img")).inject(a.empty());b.src=c;a.className=""}},changeCategory:function(e,c,d,b){var g=[];var f=ta.id("PROPTYPE_BOX");if(!f){f=document.getElement("#HOTEL_FILTERS .ptype")}if(f){g.push(f)}var a=ta.id("PROPTYPE_BOX_LEFTNAV");if(a){g.push(a)}g.each(function(n){var l=n.getElements(".tab");for(var m=0;m<l.length;++m){var j=l[m];var h=j.getElement("input");var k=j.hasClass("cat_"+d);if(h){h.checked=k}if(k){j.addClass("current")}else{j.removeClass("current")}}});ta.store("sel.category","cat_"+d);if(ta.hac.filters.style.getVersion()>=2){ta.hac.filters.style.visualClickTab("cat_"+d)}if(!b){filtersChanged()}},clearFilters:function(b,a){clearFilters();ta.servlet.HACSearch.selectNearby(b,a,false,false)},selectNearby:function(e,c,b,a){var d=ta.retrieve("nearbycities.container");$$(d+" fieldset.nearbyCities input[type=checkbox]").each(function(f){if(f.checked!=b){if(b&&f.id=="near_0"||!b){ta.servlet.HACSearch.setCheckSetChecked(f,b)}else{if(b){ta.servlet.HACSearch.setCheckSetChecked(f,false)}}}});if(!a){filtersChanged()}},handleAddressDistanceChanged:function(c,a){var b=ta.id("TAB_FILTER_CONTROLS");var d=ta.id("add_location_input_filter");if(b&&d&&d.value!=""){ta.servlet.HACSearch.filtersChanged()}},buildCurrencyHash:function(h,f,b,e,a,c,g){var d=ta.retrieve("ta.currencyHash");if(!d){d={}}d[h]={min:f,max:b,selMin:e,selMax:a,steps:c,maxAllInclusive:g};ta.store("ta.currencyHash")},buildWeeklyCurrencyHash:function(g,e,b,d,a,c,f){var h=ta.retrieve("ta.weekCurrencyHash");if(!h){h={}}h[g]={min:e,max:b,selMin:d,selMax:a,steps:c,maxAllInclusive:f};ta.store("ta.weekCurrencyHash")},updateSponsoredPins:function(){var a=ta.id("STMAP_DATA");var b=ta.id("STMAP_OVERLAYS");if(a&&b){b.empty();b.innerHTML=a.innerHTML;a.empty()}},updateMapSponsorList:function(){var b=ta.id("SPONSOR_LIST");var a=ta.id("SPR_HTLS_RHS");if(b&&a){a.innerHTML=b.innerHTML;b.destroy()}},hacPostProcessing:function(){ta.servlet.HACSearch.updateSponsoredPins();ta.servlet.HACSearch.updateMapSponsorList()},hacPageLoad:function(){ta.servlet.HACSearch.updateSponsoredPins();ta.servlet.HACSearch.updateMapSponsorList();var a=$$("#TAB_FILTER_CONTROLS .scrollable");a.each(function(d){var c=null;d.getElements("input[type=checkbox]").each(function(h){if(c==null&&h.checked){c=h}});if(c!=null){var g=c.getPosition();var f=d.getSize();var e=d.getPosition();var b=g.y-e.y;if(b>(f.y-5)){d.scrollTo(0,b)}}})},mapOnHotelReview:function(a){try{var b="ta.maps.Factory.createFloatMap";if(!a){a=5196}ta.util.cookie.setPIDCookie(a);Cookie.write("ajaxAction",b,{domain:cookieDomain,path:"/"})}catch(c){ta.util.error.record(c,"hac.mapOnHotelReview",null,{pid:a})}},buildHACUrlParamObj:function(){var c={};try{var a=document.getElement("#HAC_FORM input[name=geo]");if(a&&a.value){c.geo=a.value}if(!c.geo){var d=document.getElement("#SEARCH_LHN input[name=geo]");if(d){c.geo=d.value}}var b=document.getElementById("searchAll");if(b&&b.value!="true"){var j=document.getElementById("inDay");if(j&&j.value){c.inDay=j.value}var k=document.getElementById("inMonth");if(k&&k.value){c.inMonth=k.value}var f=document.getElementById("outDay");if(f&&f.value){c.outDay=f.value}var h=document.getElementById("outMonth");if(h&&h.value){c.outMonth=h.value}var i=document.getElementById("adults");if(i&&i.value&&i.value!="2"){c.adults=i.value}c.searchAll="false"}if(ta.has("useHotelsFilterState")){Array.each(ta.select("#HOTEL_FILTERS input[type=checkbox]"),function(e){if(e.checked){c[e.name]=e.value}})}}catch(g){ta.util.error.record(g,"buildHACUrlParams")}return c},buildHACUrlParamString:function(){var a=ta.servlet.HACSearch.buildHACUrlParamObj();return Object.toQueryString(a)},updateMapSponsors:function(e){var c=ta.retrieve("maps.sponsors");[["#POI_MARKERS","*[id*=sidebar_sponsor_]"],["#SMALL_MAP .sprChecks",".chkSet input"]].each(function(f){var g=document.getElement(f[0]);if(g){var h=g.getElements(f[1]);h.each(function(i){i.checked=false});if(c&&c.length&&ta.pages&&ta.pages.hac){c.each(function(i){var l=ta.pages.hac.sponsors[i];if(l){var k=ta.id(l);if(k){k.checked=true}var j=ta.id(l.replace("sidebar","thumb"));if(j){j.checked=true}}})}}});if(e){var b=ta.retrieve("sponsor.active");var d=true;if(!c||!c.length){return}if(b){c.each(function(f){if(f==b){d=false}})}if(d){var a=c[0];if(a){ta.servlet.HACSearch.updateSponsorAds("leader",a);if(ta.retrieve("maps.is_open")){ta.servlet.HACSearch.updateSponsorAds("180X150",a)}else{ta.servlet.HACSearch.updateSponsorAds("234X60",a)}ta.store("sponsor.active",a)}}}},click:function(b){var c=b;if(Browser.ie){c.click()}else{if(document.createEvent){var a=document.createEvent("MouseEvents");a.initEvent("click",true,false);c.dispatchEvent(a)}else{if(document.createEventObject){c.fireEvent("onClick")}}}},loadAnimatedDateCTA:function(){var f=ta.retrieve("animate_date_reformat")?ta.id("ANIMATED_DATE_CTA_REFORMAT"):ta.id("ANIMATED_DATE_CTA");var d=null;var a=ta.util.i18n.isRtl();if(f){ta.util.element.makeTextFitOneLine("#ANIMATED_DATE_CTA_REFORMAT .msg");var b=f.getPrevious(".date_picker_calendar_wrap")||f.getParent(".date_control_wrapper")||f.getPrevious(".meta_date_wrapper");if(ta.retrieve("animate_date_reformat")){d=f.getPrevious(".show_prices_button")}var g=a?"right":"left";var c=new Fx.Morph(f,{duration:"short",transition:"linear",display:"inline-block"});var h={};h.opacity=[0,1];h[g]=[40,0];f.removeClass("hidden");f.show();var e=b.isVisible()&&b.getSize().x>0;setTimeout(function(){if(e){c.start(h)}else{ta.servlet.HACSearch.loadAnimatedDateCTA()}},1000)}var i=ta.id("CLEAR_DATES");if(i){i.addClass("hidden")}},destroyAnimatedDateCTA:function(a,i){var e=ta.retrieve("animate_date_reformat")?ta.id("ANIMATED_DATE_CTA_REFORMAT"):ta.id("ANIMATED_DATE_CTA");var d=null;if(e){var b=e.getPrevious(".date_picker_calendar_wrap")||e.getParent(".date_control_wrapper")||e.getPrevious(".meta_date_wrapper");if(ta.retrieve("animate_date_reformat")){d=e.getPrevious(".show_prices_button")}if(b){var f=ta.util.i18n.isRtl()?"right":"left";var c=new Fx.Morph(e,{duration:(a!=false?0:"short"),transition:"linear",onComplete:function(){if(typeof i=="function"){i()}}});var g={};g.opacity=[1,0];g[f]=[40,0];c.start(g)}var h=ta.id("CLEAR_DATES");if(h){h.removeClass("hidden")}}},displayPostDatesLinks:function(){var a=document.getElement(".clear_dates_button")||document.getElement(".clearDates");var i=document.getElement(".clear_dates_wrapper")||document.getElement(".clearDatesWrapper");var f=document.getElement(".show_prices_button");var b=document.getElement(".change_dates_button");var g=document.getElement(".date_picker_post_dates");var e=document.getElement(".date_picker_pre_dates");var h=ta.retrieve("animate_date_reformat")?ta.id("ANIMATED_DATE_CTA_REFORMAT"):ta.id("ANIMATED_DATE_CTA");var j=ta.id("PRICE_MSG_HOTELS");var c=ta.id("LOWEST_PRICE_ACCOMMODATION_CATEGORIES");if(e){e.hide()}if(g){g.show()}if(b){b.show()}if(a){a.show()}if(i){i.show()}if(f){f.hide()}if(h){ta.servlet.HACSearch.destroyAnimatedDateCTA()}if(j){j.hide()}if(c){c.hide()}if(ta.p13n&&ta.p13n.wizard){if(ta.retrieve("last_minute_pricelow_sort_default.enabled")&&document.querySelectorAll("[data-currentsort=priceLow]").length>0&&ta.p13n.wizard.changeSort){ta.p13n.wizard.changeSort(this,null,"priceLow",true)}else{if(ta.retrieve("hsx_smart_deals_featured_sort_default.enabled")){ta.p13n.wizard.changeSort(this,null,"featured",true)}else{if(ta.retrieve("hotels_recommended_sort_default.enabled")&&ta.p13n.wizard.changeSort){ta.p13n.wizard.changeSort(this,null,"recommended",true)}else{if(ta.p13n.wizard.showAvailabilitySort){ta.p13n.wizard.showAvailabilitySort(this,null)}}}}}if(ta.retrieve("meta.mini_meta_on_accommodations")){var d=document.getElement(".rgba_flyout.gray.overlay .roundOuterClose");if(d){d.fireEvent("click")}}ta.fireEvent("refreshedDOMContent",ta.id("STATIC_DATE_PICKER_BAR"))},showPersistentFilters:function(){var c=ta.retrieve("persistentFiltersOverlay");if(!c){return}var a=ta.retrieve("ta.filters.overlaySet");var b=window.getScroll().y>=window.getSize().y;var f=300;var e=new Fx.Tween(c.container,{duration:f,transition:"bounce:out"});var d=function(){Object.each(a,function(h){if(c.visible&&h.visible){h.hide()}});ta.store("ta.filters.overlaySet",{});ta.widgets.calendar.closeCalendarWidgets()};if(!c.visible&&b){d();c.show();e.start("top",0);ta.store("persistentFilters.showing",true);if(!ta.has("persistentFilters.tracked")){var g="";if(!ta.widgets.calendar.hasPageDates()){g="no_dates"}else{if(ta.has("hacFilterSaveable")){if(ta.retrieve("hacFilterSaveable").isSelected()){g="selected_filter"}else{g="filters_displayed"}}}ta.trackEventOnPage("Meta_HAC_Filter_Persistent_Bar","display",g);ta.store("persistentFilters.tracked",true)}}else{if(c.visible&&!b){d();e.start("top",-60);setTimeout(function(){c.hide()},f);ta.remove("persistentFilters.showing")}}if(c.visible){Object.each(a,function(h){if(c.visible&&h.visible){h.position()}})}},selectOffersTab:function(){var b=ta.retrieve("sel.category");var a=1;if(typeof b!="undefined"){a=parseInt(b.match(/\d+$/)[0])}var c="/Offers-g"+modelGeoId;if(a!=1){c+="-c"+a}window.location.href=c},trackQuickLookHover:function(a){if(!ta.has("hoveredOverHotelIcon")){ta.trackEventOnPage("QuickLook","displayed","QuickLookIdle");ta.store("hoveredOverHotelIcon",true)}if(a&&!ta.has("hoveredOverQuickLook")){ta.trackEventOnPage("QuickLook","displayed","QuickLookHover");ta.store("hoveredOverQuickLook",true)}},trackQuickLookClickBypass:function(b,a){if(!ta.has("clickedOnHotelIcon")){ta.setEvtCookie("QuickLook","clicked","QuickLookBypass",0,a);ta.store("clickedOnHotelIcon",true)}b.stopPropagation();return false},trackQuickLookClickView:function(b,a){if(!ta.has("clickedOnQuickLook")){ta.setEvtCookie("QuickLook","clicked","QuickLookView",0,a);ta.store("clickedOnQuickLook",true)}b.stopPropagation();return false},trackQuickLookClickWrapper:function(b,c,d){var a=document.getElement(".photo_booking #"+c);if(a){if(a.containsEvent(new Event(d))){ta.servlet.HACSearch.trackQuickLookClickView(d,b)}else{ta.servlet.HACSearch.trackQuickLookClickBypass(d,b)}d.stopPropagation();return false}},trackWhenVisible:function(h,c,f,b,e,d){if(!h){return}var g=ta.retrieve("hacsearch.visTrackStats");if(!g){g={};ta.store("hacsearch.visTrackStats",{});window.addEvent("scroll",ta.servlet.HACSearch.checkTrackedVisibility);ta.queueForLoad(ta.servlet.HACSearch.checkTrackedVisibility,"HACSearch Visibility Tracking")}if(g[h]!=="done"){var a=ta.retrieveOrStore("hacsearch.visTrackActions",{});a[h]=function(){ta.trackEventOnPage(c,f,b,e,d)}}},checkTrackedVisibility:function(){var b=ta.retrieve("hacsearch.visTrackStats");if(!b){return}var f=ta.retrieveOrStore("hacsearch.visTrackActions",{});for(var e in f){var d=f[e];if(b[e]==="done"||typeof(d)!="function"){delete f[e];continue}if(!document.getElementById(e)){continue}var a=ta.id(e);if(!a||!a.isVisible()){continue}var g=a.offsetTop;var i=a.offsetHeight;while(a.offsetParent){a=a.offsetParent;g+=a.offsetTop}var h=window.pageYOffset||document.documentElement.scrollTop;var c=window.innerHeight||document.documentElement.clientHeight;if(g>=h&&(g+i)<=(h+c)){delete f[e];b[e]="done";d()}}},scrollIntoView:function(b,a,c){ta.util.element.scrollIntoView(ta.id(c))},datesBumped:function(a){ta.store("hac.dateBumped",a);var b=document.getElementById("HAC_DATES_MOVED_FORWARD");if(a=="NONE"){ta.servlet.HACSearch.clearDateFieldHighlighting()}else{if(a=="IN"&&b){ta.servlet.HACSearch.highlightInDateField(true)}else{if(a=="OUT"&&b){ta.servlet.HACSearch.highlightOutDateField(true)}else{if(b){ta.servlet.HACSearch.highlightInDateField(true);ta.servlet.HACSearch.highlightOutDateField(true)}}}}},clearDateFieldHighlighting:function(){ta.servlet.HACSearch.highlightInDateField(false);ta.servlet.HACSearch.highlightOutDateField(false)},highlightInDateField:function(a){var b=document.getElement(".filterControls .metaDatePicker .check_in .date_picker_calendar_wrap.dual_date.no_cpu.moreProminent");if(!b){b=document.getElement("#CHECK_RATES_CONT .meta_date_wrapper .date_picker_calendar_wrap.dual_date.no_cpu")}ta.servlet.HACSearch.highlightDateFieldHelper(b,a)},highlightOutDateField:function(b){var a=document.getElement(".filterControls .metaDatePicker .check_out .date_picker_calendar_wrap.dual_date.no_cpu.moreProminent");if(!a){a=document.getElement("#CHECK_RATES_CONT .meta_date_wrapper .date_picker_calendar_wrap.dual_date.no_cpu.out_date")}ta.servlet.HACSearch.highlightDateFieldHelper(a,b)},highlightDateFieldHelper:function(b,a){if(b){if(a){b.addClass("attention")}else{b.removeClass("attention")}}},toggleRecentReviews:function(){var a=$("recent_reviews_in_geo"),d=a.getChildren(".recent_review_item"),e,c;for(var b=0;b<d.length;++b){e=d[b].getChildren(".recent_review_text")[0];if(ifdefNN(e)){c=e.getChildren(".toggle")[0];if(ifdefNN(c)){c.toggleClass("off")}}}}};(function(a,d,b,e){var c=(function(){var g=function(){return b.select("#p13n_PROPTYPE_BOX .tab")},f=function(){var h=[];g().forEach(function(i){if(i.hasClass("current")){h.push(i.getAttribute("data-category"))}});return h};return{isEnabled:function(){return b.retrieve("multiSelectEnabled")},selectedCategoryNumbers:function(){return f()},selectedCategoriesString:function(){return f().join(",")},updateCategoryCurrentState:function(h){var h=f();g().forEach(function(i){i.toggleClass("current",h.contains(i.getAttribute("data-category")))})},showCategoryTags:function(){var h=f();b.select(".jfy_tag_style.jfy_cloud.categoryTag").forEach(function(j){var i=j.getAttribute("data-category");if(h.contains(i)&&!(i==1&&h.length==1)){j.addClass("selected")}else{j.removeClass("selected")}});b.HotelsCheckboxFilters.updateTagCloudClass()},resetCategories:function(){var h=f();if(h.length==1&&h[0]==1){return}g().forEach(function(i){i.toggleClass("current",i.getAttribute("data-category")==1)});b.store("meta.isFromChangeCategory",true);b.HotelsCheckboxFilters.updateTagCloudClass()}}}());b.servlet.HACSearch.multiSelect=c}(document,window,ta));define("utils/object/set-props",["vanillajs"],function(){return function a(c,d){for(var b in d){if(d.hasOwnProperty(b)){c[b]=d[b]}}return c}});define("utils/object/shallow-copy",["utils/object/set-props","vanillajs"],function(b){return function a(e){var c;if(typeof(e)!=="object"||e===null){return e}if(e.constructor===Array){c=[];for(var d=0;d<e.length;++d){c.push(e[d])}}else{c=b({},e)}return c}});define("utils/objutils",["utils/object/set-props","utils/object/shallow-copy","vanillajs"],function(r,t){var l=function(y){return y};var k=function(y){return true};var b=function(y){return false};if(typeof(Object.freeze)==="function"){l=Object.freeze.bind(Object);b=Object.isFrozen.bind(Object);k=Object.isFrozen.bind(Object)}function w(){var G,z,x,y,D,E,C=arguments[0]||{},B=1,A=arguments.length,F=false;if(typeof C==="boolean"){F=C;C=arguments[B]||{};B++}if(typeof C!=="object"&&!a(C)){C={}}for(;B<A;B++){if((G=arguments[B])!=null){for(z in G){x=C[z];y=G[z];if(C===y){continue}if(F&&y&&(p(y)||(D=j(y)))){if(D){D=false;E=x&&j(x)?x:[]}else{E=x&&p(x)?x:{}}C[z]=w(F,E,y)}else{if(y!==undefined){C[z]=y}}}}}return C}function u(y){if(typeof(y)!=="object"||y===null||k(y)){return y}for(var x in y){if(y.hasOwnProperty(x)){y[x]=u(y[x])}}return l(y)}function s(y){if(typeof(y)!=="object"||y===null){return y}for(var x in y){if(y.hasOwnProperty(x)){var z=y[x];if(z===null){delete y[x]}else{s(z)}}}return y}function d(A){var y;if(typeof(A)!=="object"||A===null){return A}if(A.constructor===Array){y=[];for(var z=0;z<A.length;++z){y.push(d(A[z]))}}else{y={};for(var x in A){if(A.hasOwnProperty(x)){y[x]=d(A[x])}}}return l(y)}function f(A){var y;if(typeof(A)!=="object"||A===null){return A}if(A.constructor===Array){y=[];for(var z=0;z<A.length;++z){y.push(f(A[z]))}}else{y={};for(var x in A){if(A.hasOwnProperty(x)){y[x]=f(A[x])}}}return y}function n(A){var y;if(typeof(A)!=="object"||A===null){return A}y=A;if(A.constructor===Array){if(b(A)){y=[];y.length=A.length}for(var z=0;z<A.length;++z){y[z]=n(A[z])}}else{if(b(A)){y={}}for(var x in A){if(A.hasOwnProperty(x)){y[x]=n(A[x])}}}return y}function c(z,y){if(z!==y){if(z){if(!y||(z.length!==y.length)){return false}for(var x=0;x<z.length;x++){if(z[x]!==y[x]){return false}}}else{return !y}}return true}function h(A,z){if(A!==z){if(A){if(!z){return false}if(j(A)&&j(z)){return c(A,z)}var y=Object.keys(A);if(!c(y,Object.keys(z))){return false}for(var x=0;x<y.length;x++){if(A[y[x]]!==z[y[x]]){return false}}}else{return !z}}return true}function g(y,A){var x={};var z,B;for(z=0;z<y.length;++z){B=y[z];x[B[A]]=B}return x}function m(z,y){var x=z[y];if(!(x||z.propertyIsEnumerable(y))){throw"missing property: "+y}return x}function i(z,x){for(var y in z){if(z.hasOwnProperty(y)&&!x(z,z[y])){delete z[y]}}return z}function j(x){if(Array.isArray){return Array.isArray(x)}return Object.prototype.toString.call(x)==="[object Array]"}function v(A,y,z){var x;if(y){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(y,A,z)}x=y.length;z=z?z<0?Math.max(0,x+z):z:0;for(;z<x;z++){if(z in y&&y[z]===A){return z}}}return -1}function a(x){var y={};return x&&y.toString.call(x)==="[object Function]"}function p(z){var y,x;if(!z||Object.prototype.toString.call(z)!=="[object Object]"){return false}y=Object.getPrototypeOf(z);if(!y){return true}x=Object.hasOwnProperty.call(y,"constructor")&&y.constructor;return typeof x==="function"&&Object.toString.call(x)===Object.toString.call(Object)}function o(z){var y=[];for(var x in z){if(z.hasOwnProperty(x)){y.push(x)}}return y}function q(y,z){for(var x in y){if(y.hasOwnProperty(x)){if(z(y[x],x,y)){return y[x]}}}}function e(C,D,z){var y,A=0,B=C.length,x=B===undefined||a(C);if(z){if(x){for(y in C){if(D.apply(C[y],z)===false){break}}}else{for(;A<B;){if(D.apply(C[A++],z)===false){break}}}}else{if(x){for(y in C){if(D.call(C[y],y,C[y])===false){break}}}else{for(;A<B;){if(D.call(C[A],A,C[A++])===false){break}}}}return C}return{setProps:r,deepFreeze:u,deepFreezeCopy:d,unfreezeForDust:n,undefineNulls:s,shallowCopy:t,deepCopy:f,shallowEquals:h,index:g,need:m,filterProps:i,keys:o,isArray:j,inArray:v,isFunction:a,isPlainObject:p,each:e,extend:w,find:q}});define("ta/common/Repoll",["vanillajs","ta","utils/objutils","api-mod","ta/util/Error","utils/ajax","ta/Core/TA.Event"],function(f,c,b,e,a,h,d){var g=function(o){o=o||{};var H,i,J=1,B=0,t=null,p="POST",E=false,y={},m={},s=null,N=!!o.evaluateScripts,A=o.placement||"page";var w=function(P){if(P){return decodeURIComponent(P.replace(/\+/g," "))}else{return P}};var L=function(Q){var T,S;H=Q.split("#")[0];i=H.split("?")[0];y={};T=H.split("?")[1]||"";S=T.split("&");for(var R=0;R<S.length;R++){var P=S[R].split("=");if(P[0]){y[decodeURIComponent(P[0])]=w(P[1])}}};var M=function(P){x(!!P,[])};var k=function(P,Q){if(u(y,P)){x(true,Q)}};var l=function(P){if(u(y,P)){J=0}};var O=function(){return y};var I=function(P,Q){u(m,P||{});x(true,Q)};var u=function(T,S){if(!S){return false}var U=false,R=Object.keys(S||{});for(var Q=R.length-1;Q>=0;Q--){var P=R[Q];if(T[P]!==S[P]){U=true}T[P]=S[P]}return U};var z=function(){x(false)};var K=function(P){p=P};var n=function(){return !!(t||E)};var D=function(){return J};var F=function(P){N=P?true:false};var C=function(){return N};var x=function(P,S){var R;if(P&&!E){s={}}if(S&&s){if(typeof(S)==="string"){s[S]=true}else{b.each(S,function(U,T){s[T]=true})}}else{s=null}if(E){if(!P||J===0){return}}if(P){J=0}var Q=q();if(Q>=0){E=true;R=++B;window.setTimeout(function(){r(R)},Q)}else{d.fireEvent("hac-could-not-complete");G()}};var r=function(S){if(t||!E||S!==B){return}var P=++J;var Q=b.extend({},y,m);var R=null;Q.reqNum=P;if(s){R=[];b.each(s,function(U,T){if(T){R.push(U)}});Q.changeSet=R.toString()}E=false;t=h({method:p,url:i,data:e.toFormQueryString(Q),dataType:"html",cache:false,evalScripts:C(),success:j,error:G})};function v(R){if(!R){return}var P=R.querySelectorAll("[data-targetEvent]");if(!P){return}var T;try{T=Array.prototype.slice.call(P)}catch(S){T=[];for(var Q=0;Q<P.length;Q++){T.push(P[Q])}}T.forEach(function(U){var W=U.getAttribute("data-targetEvent");if(W){try{d.fireEvent(W,U)}catch(V){a.record(V,{errorMessage:"ERROR in handler for "+W})}}})}var j=function(Q){var R=document.createElement("div");R.innerHTML=Q;var P=E;t=null;m={};s=(s?{}:null);v(R);if(A==="page"){if(!R.querySelector('[data-targetEvent="'+A+'-repoll-not-done"]')){d.fireEvent(window,"MetaFetchComplete")}}t=null;if(P){r(++B)}};var G=function(){var P=E;t=null;if(P){r(++B)}else{d.fireEvent(A+"-repoll-failed")}};function q(){switch(J||0){case 0:return 10;case 1:case 2:case 3:case 4:return 1000;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2000;case 11:return 5000;case 12:return 9000;case 13:return 10000;case 14:return 11000;case 15:return 12000;default:return -1}}c.on(A+"-repoll-not-done",z);L(o.pageUrl||window.location.href);return{setMethod:K,setPageUrl:L,repoll:M,getAjaxParams:O,setAjaxParams:k,setAjaxParamsNoPoll:l,setOneTimeParams:I,setNotDone:z,isUpdatePending:n,getLastRequestNum:D,setScriptsEval:F,isScriptsEvalEnabled:C,fireTargetEvents:v}};return g});require(["ta/p13n/placements"],function(a){var b=a.define.bind(a,"search_dp_bar","handlers",["handlers"]);b(["placement","api-mod"],function(e,g){var j=ta.id(e.id),f=ta.id("SRP_CLEAR_DATES");function k(){g.select(".date_picker_modal").forEach(function(l){if(l){g.destroy(l);g.select(".unified-picker.focused").forEach(function(m){if(m){g.removeClass(m,"focused")}})}})}function d(){var m=ta.id(e.id);var n=ta.id("srp_header_bar_wrap");if(m&&n){var l=g.scrollTop();if(!g.hasClass(n,"fixed")&&l>g.getPosition(n).top){g.addClass(n,"fixed");k()}else{if(g.hasClass(n,"fixed")&&l<=g.getCoords(m).bottom-g.getSize(n).y){g.removeClass(n,"fixed");k()}}}}g.addEvent(window,"scroll",d);function i(){var n=ta.id("SRP_CLEAR_DATES_LINK"),l=ta.id("SRP_SHOW_PRICES"),m=ta.id("SRP_CHANGE_DATES");if(ta.page.hasDates("STAYDATES")&&l&&g.hasClass(m,"hidden")){g.removeClass(m,"hidden");g.removeClass(n,"hidden");g.addClass(l,"hidden")}}function c(){var l=ta.id("h");if(g.hasClass(l,"selected")){g.addClass(j,"nothidden")}else{g.removeClass(j,"nothidden")}}function h(){if(ta.page.hasDates("STAYDATES")){ta.page.clearDates("STAYDATES")}ta.commerce.meta.polling.removePollingInfoForRequest("srp_commerce");ta.widgets.calendar.justUpdateSessionDates(function(){ta.common.search.loadSRPlacement(false);e.requestAJAXPlacement(function m(n){j.innerHTML=n;if(ta.prwidgets){ta.prwidgets.initWidgets(e.id)}},function l(){},{})})}ta.page.on("dateSelected",i);ta.on("srp_filter_selected",c);window.addEvent("domready",c);return{clearDates:h}})});define("mixins/page-dates/picker-autopopper",["ta","mixins/page-dates/DateTypeStore","vanillajs"],function(c,d){function a(e){while(e){if(e===document){return true}e=e.parentNode}return false}function b(e){c.page.on("dateSelected",function f(j,i,h){if(!a(e)){c.page.off("dateSelected",f);return}if(!e.contains(j)){return}var g=d.getCorrespondingDateType(i);if(!g){return}if(!c.page.hasDates(g)){setTimeout(c.page.gatherDates.bind(c.page,e.querySelector('[data-datetype="'+g+'"]')))}})}return{apply:b}});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"datepickers_desktop_horizontal_styleguide_icon","handlers",["handlers"]);b(["widget","vanillajs","api-mod","ta/Core/TA.Event","mixins/page-dates/picker-autopopper"],function(e,j,h,k,i){var d=h.find("[data-datetype=CHECKIN]",e.element),g=h.find("[data-datetype=CHECKOUT]",e.element);function f(p,o){var n,m=p.getAttribute("data-dateFormat")||ta.widgets.calendar.getDatePickerFormat("classic");if(!o){n=p.getAttribute("data-emptyText")}else{n=ta.widgets.calendar.dateToString(o,m)}h.find(".picker-inner .picker-label",p).firstChild.nodeValue=n}function l(o,n,m){if(!h.inDocument(e.element)){ta.page.removeListener("dateSelected",l);d=null;g=null;return}if(n==="CHECKIN"){f(d,m[0])}else{if(n==="CHECKOUT"){f(g,m[0])}else{if(n==="STAYDATES"){f(d,m[0]);f(g,m[1])}}}}function c(p,o){if(!p){return}var m=p.getParent(".calendarFlyout");if(m){var n=m.deferred,q=m.getElement(".calendarWrapper");if(n&&q){n.reject();ta.page.gatherDates(p,q,o);return}}ta.page.gatherDates(p,null,o)}k.queueForLoad(function(){ta.page.on("dateSelected",l);i.apply(e.element)},"datepicker widget handlers");return{onDatePickerClick:c}})});require(["ta/p13n/placements"],function(a){var b=a.define.bind(a,"search_filters","handlers",["handlers"]);b(["placement"],function(f){var j=null;var d=function(o,n){n=new Element(n);if(!n||n.hasClass("selected")){return}var m=n.getParent(".filterWrap");var p=m&&m.hasClass("distance");if(p){i(o,n);ta.trackEventOnPage("SRP_Distance",o)}else{e(o,n,"REF",0)}};var c=function(p,n){var m=f&&f.id&&ta.id(f.id),o=m&&m.getElement(".filterWrap."+n);p=p||window.event;p&&p.stopPropagation&&p.stopPropagation();if(o&&!o.getParent(".top-result-only")){o.toggleClass("collapsed")}};var l=ta.find(".distance.filterWrap",ta.id(f.id));var e=function(t,w,n,o,v){var p=ta.id(f.id).getElement(l?".resultWithCnt .filter.selected":".filter.selected");var m=w?w.getParent():null;p&&p.removeClass("selected");w&&w.addClass("selected");v&&v.addClass("selected");if(!v){v=ta.id(f.id).getElement(".distance .filter.selected")}var s="";if(l){var u=ta.find(".distance .filterContent.km",ta.id(f.id));var r=u?"50km":"25mil";s=v?v.id:r}if(!m||m.hasClass("community")){k(false)}else{k(true)}var q=ta.retrieve("pid");if(q){ta.util.action.recordPid(q)}ta.fireEvent("search.update_results",{filterCode:t,distCode:s,action:"REF",offset:o});ta.fireEvent("srp_filter_selected")};var k=function(n){var m=ta.id(f.id).getElement(".distance.filterWrap");if(m){m.toggleClass("collapsed",!n);ta.select(".filter",m).toggleClass("enabled",n).toggleClass("disabled",!n)}};var i=function(p,o){var m=ta.id(f.id).getElement(".resultWithCnt .filter.selected");var n=ta.id(f.id).getElement(".distance .filter.selected");n&&n.removeClass("selected");o.addClass("selected");ta.fireEvent("srp_distance_filter_selected");ta.fireEvent("search.update_results",{filterCode:m.id,distCode:p,action:"REF",offset:0})};var h=function(){var m=window.location.hash;var n=ta.common.search.extractParam(m,"ssrc",null);var p=ta.common.search.extractParam(m,"o",null);var s=ta.find(".distance .filterContent.km",ta.id(f.id));var r=s?"50km":"25mil";var q=ta.common.search.extractParam(m,"dist",l?r:"");if((n&&n!="a")||(p&&p!=0)||(q&&q!=r)){n=n||"a";var u=ta.id(f.id).getElement(".filter#"+n);var t;q&&(t=ta.id(q));e(n,u,null,p,t)}else{if(q&&q==r){var o=ta.id(r);o&&o.addClass("selected")}}};var g=function(){var q=ta.id("SEARCH_FILTERS_COLUMN");var o=q&&q.getElements(".iab_medRec .gptAd");var n=q&&q.getElements(".iab_supSky .gptAd");if(q&&o&&o.length&&n&&n.length){var p=q.getSize();var m=p&&p.x<300;if(m){n.each(function(r){r.removeClass("inactive")});o.each(function(r){r.addClass("inactive")});return n}else{o.each(function(r){r.removeClass("inactive")});n.each(function(r){r.addClass("inactive")});return o}}return null};ta.queueForReady(function(){j=g()});ta.queueForLoad(function(){if(j){j.each(function(m){ta.common.ads.queueForInjection([m.id])})}});window.addEvent("domready",h);(function(){var m=null;window.addEvent("resize",function(){j=g();if(j){j.each(function(n){n.hide()})}clearTimeout(m);m=window.setTimeout(function(){if(j){ta.common.scrollAd.resetScrollAd();ta.common.ads.setAdIdThatEnablesScrolling();j.each(function(n){ta.common.ads.queueForInjection([n.id])});j.each(function(n){n.show()})}},1000)})})();return{filterSelected:d,toggleExpandableFilter:c}})});require(["ta/p13n/placements"],function(a){var b=a.define.bind(a,"search_results","handlers",["handlers"]);b(["placement","commerce/offerclick"],function(i,f){var q=function(s,r){var t=s.target||s.srcElement;if(!t||(t+"").indexOf("http")!==0){window.open(r,"_blank")}};var k=function(r,u,v,w,s,t){new Request({url:"/SearchRecord",method:"post",data:{type:"selection",sid:ta.retrieve("searchTrackingId"),ordinal:r+1,hitType:u,rf:ta.retrieve("searchRefinementId"),parentID:v,locationID:w,contentID:s,userID:t,sessionId:ta.retrieve("sessionId"),searchSessionId:ta.retrieve("searchSessionId")}}).send()};var l=function(){var s=document.getElements("#search_result .gptAd");var r=[];if(s.length){s.each(function(t){r.push(t.id)})}return r};var h=function(t){var u=t&&t.filter;var y=t&&t.dist;var w=t&&t.action;var x=(t&&t.offset)||0;var s=ta.common.search.buildSearchHref(u,w,x,y);if(w){setOneTimeCookie("SRCHACT",w)}var r=new Date().getMilliseconds();ta.store("search_results_refresh_timestamp",r);ta.fireEvent("search.refreshingList");var v=new Request({url:s,method:"get",evalScripts:true,onSuccess:function(F,G){if(ta.find(".debug_block",ta.id(i.id))){setTimeout(e,2000)}if(r===ta.retrieve("search_results_refresh_timestamp")){var z=ta.id(i.id);var B=Elements.from(F).getChildren();z.empty();z.adopt(B);var J=z.getElementById("scope")&&z.getElementById("scope").get("value")||1;window.fireEvent("onUpdateSearchResults",[l()]);ta.fireEvent("search.listRefreshed",{scope:J,filter:u});if(ta.prwidgets){ta.prwidgets.initWidgets(i.id)}var E=/"updated_count">(.*?)<\/div\>/;var D=E.exec(F);var C=D?D[1]:0;var I=ta.find(".error-message",ta.id(i.id));if(C&&!I){var H=ta.find(".filter.enabled.selected .count",ta.id("SEARCH_FILTERS_COLUMN"));var A="("+C+")";H&&H.set("text",A)}if(ta.retrieve("commerce_on_srp")){ta.common.search.loadSRPlacement(false)}}},onFailure:function(z){if(r===ta.retrieve("search_results_refresh_timestamp")){setTimeout(function(){v.send()},1000)}}}).send();return false};var m=function(s){console.log("selectedTerm",s);var t=ta.find(".debug_input",ta.id(i.id));var r="";t&&(r=t.value);s&&(r=s);ta.localStorage&&ta.localStorage.enabled&&ta.localStorage.setSessionKey("debug-extra-field",r);location.reload()};var j=function(s){var z="reviews.body:.*PerFieldSimilarity";var w="reviews.title:.*PerFieldSimilarity";var t="name.analyzed:.*PerFieldSimilarity";var v="log2p.*page_views_i";var r="log10.*reviews_count_i";var x={"Search word similarity in reviews body":z,"Search word similarity in reviews title":w,"Search word similarity in name":t,"Log of page views times a factor":v,"Log of review count times a factor":r};for(var y in x){var u=new Element("option",{value:x[y],text:y});s&&s.grab(u)}};var e=function(){var s=ta.select(".debug_info",ta.id(i.id));var y=ta.find(".debug_input",ta.id(i.id));var x=ta.select(".debug_result",ta.id(i.id));var u="";var B={};var C=ta.find(".debug_select",ta.id(i.id));var N=function(Q){if(isNaN(Q)){return 0}return Math.round((Math.pow(10,Q)-2)*1000)};var D=function(Q){if(isNaN(Q)||Q<0.31){return 0}else{return Math.round(Math.pow(10,Q)-2)}};ta.localStorage&&ta.localStorage.enabled&&(u=ta.localStorage.getSessionKey("debug-extra-field"));var K=/DEFAULT_DEBUG_REGEX/;try{K=new RegExp(u,"i")}catch(O){}if(!s||!y||!C){return}for(var J=0;J<s.length;++J){var v=x[J].getElement(".matched_terms");var r=x[J].getElement(".explanation");var A=x[J].getElement(".optional_field");var z=false;var H=s[J].get("text");var G=JSON.parse(H);if(!G){continue}for(var F=0;F<G.length;++F){var M=G[F].description;var P=G[F].value;var t=/^[\w]+/;var E=t.exec(M);B[M]="";if(!z&&M=="_score: "){z=true;var I=new Element("span",{text:P,"class":"explanation_entry"});r&&r.grab(I)}if(K.test(M)){A&&(A.innerHTML+=(M+" <b>"+P+"</b> "));if(u=="log10.*reviews_count_i"){A.innerHTML+="</br> =========> Which is about <b>"+D(P)+"</b> reviews"}if(u=="log2p.*page_views_i"){A.innerHTML+="</br> =========> Which is about <b>"+N(P)+"</b> page views"}}if(M=="matched term"){var w=new Element("span",{text:P,"class":"term_entry"});v&&v.grab(w)}}}var L=Object.keys(B).sort();C.innerHTML="";j(C);C.value=u;y.value=u};var p=function(r){h({filter:r.filterCode,dist:r.distCode,offset:r.offset,action:r.action})};var o=function(r){h({offset:r,action:"PG"})};var n=function(r,s){if(s==="STAYDATES"){ta.widgets.calendar.justUpdateSessionDates(function(){ta.common.search.loadSRPlacement(true)})}};var d=function(v){var u=ta.id(i.id);u.innerHTML=v.content.innerHTML;var t=u.getElementById("scope").get("value");if(ta.prwidgets){ta.prwidgets.initWidgets(i.id)}window.fireEvent("srp_hac_update_complete",[l()]);var r=document.getElements(".js_buildProviderRHS");if(r&&r.length>0&&ready){for(var s=0;s<r.length;s++){if(r[s].getElement(".loading_bubbles_gry")){r[s].innerHTML='<span class="sprite-visitSite"></span>'}}}};var g=function(u){if(!u){return}var t=ta.id("search_result");if(!t){return}t.innerHTML=u.innerHTML;if(ta.prwidgets){ta.prwidgets.initWidgets(i.id)}window.fireEvent("srp_hac_update_complete",[l()]);var r=document.getElements(".js_buildProviderRHS");if(r&&r.length>0&&ready){for(var s=0;s<r.length;s++){if(r[s].getElement(".loading_bubbles_gry")){r[s].innerHTML='<span class="sprite-visitSite"></span>'}}}};var c=function(r){r=r||window.event;r&&r.stopPropagation&&r.stopPropagation();ta.fireEvent("show_all_results")};ta.on("search.update_results",p);ta.page.on("dateSelected",n);ta.on("srp_hac_update",d);ta.on("update-"+i.name,g);if(ta.find(".debug_block",ta.id(i.id))){window.addEvent("domready",e)}return{loadURLIfNotLink:q,recordSelection:k,pageSelected:o,addDebugTerm:m,showAllResults:c}})});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"meta_hsx_hd_double_column_commerce","handlers",["handlers"]);b(["widget"],function(d){function c(){ta.trackEventOnPage("hotels_textlink_dropdown","viewall_click")}return{track:c}})});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"meta_small_show_prices_button","handlers",["handlers"]);b(["widget"],function(d){function c(k,j,i,h,f,g){k.stopPropagation();var e="ABS:HotelCheckRates-d"+i+"?src="+h;if(f){e+="&fromServlet="+f}if(g){e+="&Action="+g}return ta.call("ta.overlays.Factory.relRightRemoteHLB_optionalDelay_showArrow",k,j,e)}return{calendarOverlay:c}})});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"meta_search_lowest_price_promotion","handlers",["handlers"]);b(["widget"],function(d){function c(){ta.trackEventOnPage("hotels_textlink_dropdown","viewall_click")}return{track:c}})});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"common_base_dropdown","handlers",["handlers"]);b(["widget","ta/Core/TA.Record"],function(d,e){function c(f){f&&e.trackEventOnPage(f,"viewall_click")}return{track:c}})});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"meta_view_all_text_links","handlers",["handlers"]);b(["widget","commerce/offerclick"],function(d,e){function c(h,g){var f=g.getAttribute("data-clickToken");e.clickEvent(h,g,f)}return{clickOffer:c}})});define("overlays/options/pinnable",["vanillajs","api-mod","ta/Core/TA.Event"],function(c,b,a){return function(){var g=this;var d;this.pinned=false;function e(){if(g.pinned&&b.inDocument(g.container)&&!d){d=b.createElement("div",{"class":"ui_backdrop dark"});d.setAttribute("style","z-index:499");b.addEvent(d,"click",function(){g.hide()});g.domParent.appendChild(d)}}function f(){g.pinned=true;e()}this.pin=f;this.on("show",function(){e();a.on(g.sourceElement,"click",f)});this.on("hide",function(){if(d){g.domParent.removeChild(d);d=void (0);a.off(g.sourceElement,"click",f)}})}});define("overlays/widgetoverlays",["vanillajs","ta","api-mod","overlays/Overlay","overlays/styles/popover","overlays/styles/modal","overlays/styles/dropdown","overlays/styles/windowshade","overlays/position","overlays/options/ajax","overlays/options/pinnable","overlays/options/closeOnWindowshadeClick","overlays/options/repositionOnEvent"],function(p,h,n,g,t,b,a,v,f,r,m,o,e){function s(y,z){var x=y.prwidget_ovl||(y.prwidget_ovl={key:z});if(x.key!==z){if(x.showtimer){clearTimeout(x.showtimer);delete x.showtimer}if(x.overlay){x.overlay.destroy();delete x.overlay}x.key=z}return x}function k(){var z=this;var y=z.prwidget_ovl;if(!y){return}if(y.showtimer){clearTimeout(y.showtimer);delete y.showtimer}if(h.page&&h.page.usingUnifiedDates&&n.find(".ui_modal.date_picker_modal",document.body)){return}var x=y.overlay;if(x&&!x.pinned&&!x.prw_leaveTimer){x.prw_leaveTimer=setTimeout(function(){x.pinned||x.hide()},250)}}function w(){var x=this;if(x){x.prw_entered=true;if(x.prw_leaveTimer){clearTimeout(x.prw_leaveTimer);delete x.prw_leaveTimer}}}function i(){if(h.page&&h.page.usingUnifiedDates&&n.find(".ui_modal.date_picker_modal",document.body)){return}var x=this;if(x&&!x.pinned&&!x.prw_leaveTimer){x.prw_leaveTimer=setTimeout(function(){x.pinned||x.hide()},250)}}function d(z,A){var y=!z.pinned&&w.bind(z);var B=!z.pinned&&i.bind(z);var x=function(){y&&n.removeEvent(z.container,"mouseenter",y);B&&n.removeEvent(z.container,"mouseleave",B);z.off("hide",x);delete A.overlay};y&&n.addEvent(z.container,"mouseenter",y);B&&n.addEvent(z.container,"mouseleave",B);z.on("hide",x)}function j(z,y){var x=y.url||"/OverlayWidgetAjax?Mode="+encodeURIComponent(z);if(typeof(crPageServlet)==="string"){x+="&metaReferer="+encodeURIComponent(crPageServlet)}return x}function q(A,E,K,L,M){var y=s(A,K);if(y.showtimer){clearTimeout(y.showtimer);delete y.showtimer}if(y.overlay){return}var C=(M.position||"wideside").split(" ").filter(function(N){return !!N.length});var J=C.shift();if(J==="wideside"){try{var z=n.getPosition(A).x;var B=n.getSize(A).x;var G=n.getSize(document.body).x;J=(z>(G-z-B)?"leftEvenInRtl":"rightEvenInRtl")}catch(I){J="right"}}var D=M.classes|"";var x=j(K,M);M.reqParams=L;M.inlineResourceId=K;M.isWidget=true;var H=[t(A,J,D,""),r(x,M),f[J](C,false),m];if(M.mixins&&M.mixins.length>0){H.push.apply(H,M.mixins)}var F=new g(A,H);if(E==="click"){F.pin()}F.show();y.overlay=F;d(F,y)}function l(C,y,B){B=B||{};var D=(B.position||"center").trim().split(" ")[0];var A=j(C,B);B.reqParams=y;B.inlineResourceId=C;B.isWidget=true;var x=[b(null,null,B.classes),r(A,B),f[D](void (0),true),v(),o,e(window,"resize")];if(B.mixins&&B.mixins.length>0){x.push.apply(x,B.mixins)}var z=new g(null,x);z.show();return z}function u(D,A,C,x,y){D=D||window.event;A=A||D.currentTarget;var B=(D&&D.type)||"click";if(D){n.stopEvent(D)}var z=s(A,C);if(B==="click"){if(!z.overlay){q(A,B,C,x,y)}}else{if(z.overlay){if(z.overlay.prw_leaveTimer){clearTimeout(z.overlay.prw_leaveTimer);delete z.overlay.prw_leaveTimer}return false}if(z.showtimer){return false}if(!z.hasLeaveHandler){n.removeEvent(A,"mouseleave",k);n.addEvent(A,"mouseleave",k);z.hasLeaveHandler=true}z.showtimer=setTimeout(function(){q(A,B,C,x,y)},y.delay||300)}return false}function c(E,y,C,D,F){E=E||window.event;y=y||E.currentTarget;if(E){n.stopEvent(E)}F=F||{};var B=(F.position||"below").trim().split(" ")[0];var x=j(C,F);F.reqParams=D;F.inlineResourceId=C;F.isWidget=true;var A=[a(y,B,F.classes,null,F.containerStyles,F.elementType||"div"),r(x,F),f[B](void (0),true)];if(F.mixins&&F.mixins.length>0){A.push.apply(A,F.mixins)}var z=new g(y,A);z.show();return z}return{triggerFlyout:u,showLightbox:l,showDropdown:c}});define("ta/Core/TA.LocalStorage",["vanillajs","ta/util/Error","ns-exporter"],function(q,g,w){var x=false,i="taLsTest",h="1",n="TALocalStorageCurrentSessionId",k=false,l="session-",j=false,A=[];var r=function(){return !!(k||j)};var s=function(e){if(!r()){g.record(null,"Accessing localStorage session cookie before session logic intialized: "+e);return false}return true};var m=function(e){return b(e,"value")};var t=function(e){return b(e,"now")};var b=function(E,G){if(!G){return null}try{var F=JSON.parse(x.getItem(E)||"0"),I;if(!F){return null}if(F.ttl&&F.ttl+F.now<new Date().getTime()){x.removeItem(E);return null}if(!F.hasOwnProperty(G)){return null}x.setItem("512",F[G]);I=x.getItem("512");x.removeItem("512");return I}catch(H){}return null};var y=function(E){try{var F=JSON.parse(x.getItem(E)||"0"),H;if(!F){return null}if(F.ttl&&F.ttl+F.now<new Date().getTime()){x.removeItem(E);return null}return F.value}catch(G){}return null};var D=function(E){try{x.removeItem(E)}catch(F){}};var C=function(E){try{var G=x.getItem(E);if(G!==null&&G!==undefined){return true}}catch(F){}return false};var a=function(F,G,E){try{x.setItem(F,JSON.stringify({ttl:E||0,now:new Date().getTime(),value:G}))}catch(H){}};var o=function(E){j=true;if(!E){g.record(null,"Attempting to initialize localStorage with invalid sesion key: "+E);return false}if(!v()){return false}k=m(n);if(!k||k!=E){k=E;a(n,k);var e=m("latestPageServlet");if(e){a("sessionEntryServlet",e)}d();if(C(n)&&require.defined("ta/Core/TA.Store")){require("ta/Core/TA.Store").store("isFirstSessionPageView",true)}}};var d=function(){try{var G=l+k;var E=new RegExp("^"+l);if(x.length){for(var F=0;F<x.length;F++){var I=x.key(F);try{if(E.test(I)&&I!=G){D(I)}}catch(H){}}}}catch(J){}};var v=function(){try{if(x&&x.setItem){x.setItem(i,h);var F=x.getItem(i)!=h;x.removeItem(i);if(F){x=false}return !!x}}catch(E){}return false};var f=function(E){try{x.setItem("session-"+k,JSON.stringify(E))}catch(F){}};var p=function(){try{var E=x.getItem("session-"+k);if(E){return JSON.parse(E)}}catch(F){}return{}};var c=function(e){A.push(e)};var B={enabled:v(),get:m,getObject:y,set:a,remove:D,has:C,getTimeStamp:t,updateSessionId:o,onSessionStorageChange:c,canUseSession:r,getSessionKey:function(E){if(!s(E)){return null}var e=p();if(e){return e[E]}return null},setSessionKey:function(E,F){if(!s(E)){return}var e=p();if(!e){e={}}e[E]=F;f(e)},removeSessionKey:function(E){if(!s(E)){return}var e=p();if(!e){return}delete e[E];f(e)},hasSessionKey:function(E){if(!s(E)){return false}var e=p();if(e){var F=e[E];if(F!==null&&F!==undefined){return true}}return false},setStorage:function(e){x=e;B.enabled=v()}};if(typeof window!=="undefined"){var z=false;try{z=window.localStorage}catch(u){}B.setStorage(z);(function(){function e(G){G=G||window.event;if(k&&(!G.key||G.key==="session-"+k)){for(var F=0,E=A.length;F<E;F++){A[F](G)}}}if(window.addEventListener){window.addEventListener("storage",e,false)}else{if(window.attachEvent){window.attachEvent("onstorage",e)}}})()}w.createNs(B,"ta","localStorage");return B});define("xsell/metaLightbox",["vanillajs","ta","api-mod","overlays/widgetoverlays","overlays/options/closeOnTaEvent","ta/Core/TA.LocalStorage","ta/Core/TA.Record"],function(j,d,i,c,b,o,f){var n="xsell_metaLightbox_init",h="track_xsell_metaligtbox_opened";function g(q,t,r){function s(){if(!i.inDocument(q.container)){return}var u=(d.page&&d.page.hasDates&&d.page.hasDates("STAYDATES"))||(d.widgets&&d.widgets.calendar&&d.widgets.calendar.hasPageDates());if(!u){return}q.hide();setTimeout(function(){k(t,r)},0)}q.on("show",function(){if(d.page&&d.page.usingUnifiedDates){d.page.on("dateSelected",s)}else{d.on("newInlinePageDates",s)}});q.on("hide",function(){if(d.page&&d.page.usingUnifiedDates){d.page.off("dateSelected",s)}else{d.off("newInlinePageDates",s)}})}function m(t,q,u,s){if(!t||(t.type!=="click"&&t.type!=="mouseenter"&&t.type!=="mouseover")){return}var r=(d.page&&d.page.hasDates&&d.page.hasDates("STAYDATES"))||(d.widgets&&d.widgets.calendar&&d.widgets.calendar.hasPageDates());if(t.type==="click"){i.stopEvent(t)}if(r){if(t.type==="click"){k(u,s)}}else{c.triggerFlyout(t,q,"DATE_SEARCH_FLYOUT",{locationId:String(u)},{mixins:[function(){g(this,u,s)}]})}return false}function l(q){return o.enabled&&!!o.getSessionKey(q+h)}function e(q){o.enabled&&o.setSessionKey(q+h,true)}function a(q){if(!q||l(q)){return}f.trackEventOnPage(q,"meta_LB_in_view");e(q)}function p(s,q,t,r){if(q[n]){return}q[n]=true;i.addEvent(q,"click",function(u){m(u||window.event,this,t,r)});i.addEvent(q,"mouseenter",function(u){m(u||window.event,this,t,r)});if(s){m(s,q,t,r)}}function k(t,s,r){if(!d.page||!d.page.usingUnifiedDates){d.overlays.Factory.metaCheckRatesOverlay_allProviders(t,null);return}var u={locationId:String(t)};if(r&&typeof(r.mapSponsorship)==="string"){u.mapSponsorship=r.mapSponsorship}var q=[b("ibOfferClick")];c.showLightbox("HOTEL_META_LIGHTBOX",u,{sendTravelInfo:true,classes:"no_padding hotel_meta_lightbox",mixins:q});a(s)}return{initShowPricesButton:p,showMetaLightbox:k}});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"meta_short_cell_sbs_meta","handlers",["handlers"]);b(["widget","xsell/metaLightbox","commerce/offerclick"],function(i,m,f){var h=false;var e=ta.retrieve(i.name+"_shared");if(!e){h=true;e={overlays:{}};ta.store(i.name+"_shared",e)}function k(r){var q=Array.prototype.slice.call(arguments,1);if(ta.retrieve("hotels_placements_short_cells.overlaysCss")&&!ta.retrieve("hotels_placements_short_cells.overlaysCssAsset")){ta.store("hotels_placements_short_cells.overlaysCssAsset",ta.css(ta.retrieve("hotels_placements_short_cells.overlaysCss"),{onLoad:function(){r.apply(null,q)}}));return true}}function p(){ta.select(".dropdown_meta_postdates .list_button").removeClass("expanded");window.removeEvent("click",p)}function g(r,q){q.parentElement.click();q.toggleClass("expanded");if(q.hasClass("expanded")){window.addEvent("click",p);uiOverlay(r,q)}else{window.removeEvent("click",p)}}function j(){if(!ta.id("PAGE").hasClass("map_expanded")){return}ta.select(".metaLocationInfo").each(function(y){var r;var A=0;var q=0;var s;var z=0;var t=0;var w=ta.find(".listing_title",y);var x=0;var v=0;var u=ta.util.i18n.isRtl();r=ta.find(".photo_booking",y);s=ta.find(".dropdown_meta_postdates",y);A=r?r.getWidth():0;q=r?r.offsetLeft:0;t=s?s.getWidth():0;z=s?s.offsetLeft:0;if(u){v=w.getStyle("padding-left").toInt();x=q-z-t-2*v}else{v=w.getStyle("padding-right").toInt();x=z-q-A-2*v}if(x>0){w&&w.setStyle("max-width",x+"px")}})}function o(s,q,r){if(!q||!r){return}ta.trackEventOnPage("hotels_textlink_dropdown","viewall_click");return m.showMetaLightbox(r)}function n(t){if(ta.retrieve("metaCheckRatesOverlay")){var q=ta.retrieve("metaCheckRatesOverlay");if(q){var u=q.container.getAttribute("data-locationid");if(u){var v=ta.id("hotel_"+u);if(v){var s=v.getElement(".property_details");if(s){q.options.positionSource=s;if(q.visible){q.position();if(t){d(q)}var r=v.getElement(".seeAll");if(r){r.addClass("on")}}}}else{c()}}}}}function c(){if(ta.retrieve("metaCheckRatesOverlay")){ta.retrieve("metaCheckRatesOverlay").hideNow()}ta.remove("metaCheckRatesOverlay")}function d(v){if(!v){return}var r=v.container;if(r){var z=r.getAttribute("data-locationid");if(z){var y=ta.id("hotel_"+z);if(y){var t=r.getCoordinates(),q=t.top+t.height,w=y.getCoordinates().top,A=window.getScroll().y,s=A+window.getHeight(),x=ta.id("PERSISTENT_DATE_PICKER"),u=x&&x.getHeight();if(s<q&&(A+u)<w){if(Fx&&Fx.Scroll){new Fx.Scroll(window).start(0,w-u)}else{window.scrollTo(0,w-u)}}}}}}function l(s,r){var q=r.getAttribute("data-clickToken");f.clickEvent(s,r,q)}if(h){ta.queueForLoad(function(){ta.on("onHotelsListUpdate",n)},"initialize "+i.name)}if(ta.find("body").hasClass("h_map_side_by_side")){ta.on("inlineMapExpanded",j);ta.on("onHACUpdateComplete",j)}return{openDealsFlyout:o,onNarrowArrowClicked:g,clickOffer:l}})});