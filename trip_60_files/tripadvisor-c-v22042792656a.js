var ta=window.ta||{};var define;ta.rollupAmdShim=ta.rollupAmdShim||(function(){var l={};var r={};var a={};var q=[];var p=null;var n={ta:ta};var e=null;var j=null;var d=function(x){var y=console&&(console.error||console.log);y&&y.apply(console,arguments)};function o(B,A){var C,y,F,E;for(C=0;B&&B.length&&C<B.length;++C){l[B[C]]=true}for(C=0;A&&A.length&&C<A.length;++C){r[A[C]]=true}if(typeof define!=="undefined"&&define.isDummyDefine){var z=define.pendingDefinitions;if(z&&z.length){for(C=0;C<z.length;C++){y=z[C];i.apply(null,y)}}define=null}if(typeof require!=="undefined"&&require.isDummyRequire){var D=require.pendingRequirements;if(D&&D.length){for(C=0;C<D.length;C++){F=D[C];m.apply(null,F)}}var x=require.pendingConfigs;if(x&&x.length){for(C=0;C<x.length;C++){E=x[C];m.config.apply(null,E)}}require=null}if((typeof define!=="function")||!define.isTaRollupShim){if(typeof define==="function"){e=define}else{e=null}define=i}if((typeof require!=="function")||!require.isTaRollupShim){if(typeof require==="function"){j=require}else{j=null}require=m}}function i(y,C,D,x){var z,B;var A=[];if(typeof y==="string"&&typeof C==="object"&&typeof D==="function"){if(n.hasOwnProperty(y)||(a[y]&&a[y].deps)){return}B=c(C,A);if(B){z=D.apply(null,B);h(y,z)}else{s(A,{deps:C,cb:D,defname:y},i.depLoader)}}else{if(e){return e(y,C,D,x)}else{d("invalid args for AMD define: "+typeof(y)+", "+typeof(C)+", "+typeof(D))}}}i.amd=true;i.isTaRollupShim=true;i.depLoader=function(){};i.depLoader.isDefault=true;function m(x,D,y,C){var A=null;if(typeof x==="string"&&typeof D!=="function"){try{A=c([x]);if(!A&&j){A=[j(x,D,y,C)]}}catch(B){}if(!A){throw w(x)}return A[0]}else{if(typeof x==="object"&&typeof D==="function"){var z=[];A=c(x,z);if(A){D.apply(null,A)}else{s(z,{deps:x,cb:D,eb:(typeof y==="function"&&y)},i.depLoader)}}else{if(j){return j(x,D,y,C)}else{d("invalid args for AMD require: "+typeof(x)+", "+typeof(D)+". Expected either a string-literal singular dependency (i.e. synchronous) or an array of dependencies with a callback function (i.e. async).")}}}}m.isTaRollupShim=true;m.undef=function(x){delete n[x]};m.config=function(){if(j&&j.config){j.config.apply(j,arguments)}};m.defined=function(x){if(n.hasOwnProperty(x)){return true}if(a.hasOwnProperty(x)){return false}return j&&j.defined&&j.defined(x)};m.parsed=function(x){if(n.hasOwnProperty(x)){return true}return(a[x]&&a[x].deps)};m.specified=function(x){if(n.hasOwnProperty(x)||a[x]){return true}return j&&j.specified&&j.specified(x)};function c(D,y){var A,x,B,z;var C=[];for(A=0;A<D.length;++A){x=D[A];z=null;if(x){if(n.hasOwnProperty(x)){z=n[x];C.push(z)}else{if(r[x]){B=x.split("/");if(B[0]==="underscore"){B[0]="_"}for(z=window;B.length>1&&z;z=z[B.shift()]){}if(B.length>0&&z){z=z[B[0]]||z[B[0].toLowerCase()]}if(z){n[x]=z;C.push(z)}else{y.push(x)}}else{if(y){y.push(x)}}}}else{C.push(null)}}if(C.length!==D.length){return}return C}function w(x){var D,y,E,z;var C="Missing immediately required dependency: "+x;for(D=0;D<10;D++){var B=a[x];if(!B){C+=" (not specified)";break}if(B.error){C+=" ("+B.error+")";break}x=null;z=B.deps;if(z){for(y=0;y<z.length;y++){E=z[y];if(!n.hasOwnProperty(E)){x=E;break}}}if(!x){break}C+=" -> "+x}var A=new Error(C);if(window.IS_DEBUG&&console.error){console.error(A)}return A}function s(H,B,I){var C=[];var G=[];var z=[];var K;var L;var x;var y;var A,J,F;B.deps=B.deps||[];if(B.defname){y=a[B.defname];a[B.defname]=B;if(y&&y!==B&&y.needers&&y.needers.length){B.needers=(y.needers||[]).concat(B.needers||[])}}for(var A=0;A<H.length;A++){K=H[A];J=K.lastIndexOf("!");if(J>=0){C.push(K.substring(0,J));G.push(K.substring(J+1))}else{C.push(null);G.push(K)}}C=c(C,z);if(!C){return s(z,B)}for(var A=0;A<H.length;A++){L=C[A];x=a[H[A]];if(!x&&!n.hasOwnProperty(H[A])){x={defname:H[A]};a[H[A]]=x;var E=f(x);var M=k(x);E.error=M;try{if(L){L.load(G[A],m,E,{})}else{if(I){I(G[A],m,E,{})}else{if(j&&!j.taVer){j([x.defname],E,M)}else{throw new Error("no loader for AMD module '"+x.defname+"'")}}}F=true}catch(D){B.error=D;M(D)}}}B.need=0;for(var A=0;A<H.length;A++){K=H[A];x=a[K];if(x&&!n.hasOwnProperty(K)&&!x.error){x.needers=x.needers||[];x.needers.push(B);B.need+=1}}if(!B.need&&F){q.push(B);if(!p){p=setTimeout(b,0)}}}function b(){var z,D,C,y,x;p=-1;while(q.length>0){var A=q.shift();if(!A){continue}try{if(A.error){if(A.defname){g(A.defname)}continue}C=[];x=typeof A.deps=="string"?[A.deps]:A.deps;D=c(x||[],C);if(C.length>0){s(C,A);continue}y=null;if(A.cb){y=A.cb.apply(null,D)}A.deps=[];A.cb=null;if(A.defname){h(A.defname,y)}}catch(B){d("Error propagating dependency resolutions: ",B)}}p=null}function f(x){return function(y){if(x.defname){h(x.defname,y)}}}function k(x){return function(y){if(x.defname){x.error="Error loading '"+x.defname+"': "+y;d(x.error);x.need=0;x.deps=[];g(x.defname)}}}function h(A,B){if(n[A]){return}var C=a[A];n[A]=B;delete a[A];if(l[A]){var y=A.split("/");var D=ta;var z;if(y[0]==="ta"){y.shift()}while(y.length>1){z=y.shift();if(!D[z]){D[z]={}}D=D[z]}if(y.length>0){z=y.shift();if(!(z in D||z.toLowerCase() in D)){D[z]=B;D[z.toLowerCase()]=B}}}if(e){e(A,[],v(B))}if(C){while(C.needers&&C.needers.length>0){var x=C.needers.shift();x.need-=1;if(!x.need){q.push(x)}}}if(q.length&&!p){p=setTimeout(b,0)}}function g(z){var B=a[z];if(B){var y=B.eb;B.deps=null;B.cb=null;B.eb=null;if(!B.error){B.error="Error loading '"+B.defname+"'"}while(B.needers&&B.needers.length>0){var x=B.needers.shift();x.error="failed to load dependency '"+z+"' of '"+x.defname+"'";if(x.need>0){x.need=0;q.push(x)}if(window.IS_DEBUG&&console.error){console.error(x.error)}}if(y!=null){try{y(B.error)}catch(A){}}}if(q.length&&!p){p=setTimeout(b,0)}}function v(y){return function(){return y}}function t(){var B,z,x,A=[],y=[];if(!a){return}if(p){setTimeout(t,0);return}for(B in a){if(a.hasOwnProperty(B)){z=a[B];if(z.deps&&z.deps.length){for(x=0;x<z.deps.length;x++){if(z.deps[x]&&z.deps[x].indexOf("trjs!")!==-1){A.push(z.deps[x])}}c(A,y);if(y.length===0){continue}}d("Load event fired but we have not loaded '"+z.defname+"'"+(z.deps&&z.deps.length?" due to missing dependencies: "+y:""))}}}if(window.addEventListener){window.addEventListener("load",t)}else{if(window.attachEvent){window.attachEvent("onload",t)}}var u={install:o};u.install();h("ta/rollupAmdShim",u);return u})();require(["ta/rollupAmdShim"],function(a){a.install(["amdloaders","ta/Core/TA.Store","utils/store","ta/Core/TA.Load","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Error","ta/Core/TA.LocalStorage","ta/Core/TA.Prerender","ta/projects","ta/Browser","ta/util/ScreenSizeRecord","utils/BatchRequest"],["ta","ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"core-without-dust",files:{js3_secure:{ssl:{ta:{Core:{"TA.Record":1,"TA.Prerender":1}}}},"js-amd":{src:{amdloaders:1,utils:{BatchRequest:1,store:1}}},js3:{src:{ta:{projects:1,util:{ScreenSizeRecord:1,Error:1},Browser:1,Core:{"TA.Event":1,"TA.Load":1,"TA.LocalStorage":1,"TA.Store":1}}}}},_:{baseUrl:"/"}})};define("vanillajs",[],function(){return{}});define("amdloaders",["vanillajs"],function(){var j=[],u=[],v=[],l=[];var h=[];var d=null,B=null,E=null;var s={};var F={};var g={};var w={};var A=null;var r=false;var c=false;var i={};var q=function(G,H,I){if(!s[G]){s[G]=true;u.push(G)}h.push(function(J){if(!J&&H.parsed&&!H.parsed(G)){J=new Error("Dynamic load failed to define module '"+G+"'")}if(J&&I.error){I.error(J)}});D()};var p=function(G,H,I){if(!s[G]){s[G]=true;if(!F[G]&&!H.specified(G)){u.push(G)}}h.push(function(J){var K=H.specified(G);if(!J&&!F[G]&&!K){J=new Error("Dynamic load failed to define '"+G+"'")}if(J){if(I.error){I.error(J)}}else{if(K){H([G],I,I.error)}else{I(true)}}});D()};var a=function(G,H,I){j.push(G);h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var t=function(G,H,I){v.push(G);h.push(function(J){if(!J&&!H.specified("trhtml!"+G)){J=new Error("Dynamic load failed to define content '"+G+"'")}if(J){if(I.error){I.error(J)}}});D()};var n=function(G,H,I){if(!g[G]){g[G]=true;if(!w[G]){l.push(G)}}h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var n=function(G,H,I){if(!g[G]){g[G]=true;if(!w[G]){l.push(G)}}h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var D=function(){if(!A&&r&&!c&&(h.length||j.length||u.length||v.length||l.length)){A=setTimeout(z,0)}};var b=function(J,I){var G=J.getAttribute("data-rup");if(!G){return}var K;G=G.split(",");for(var H=0;H<G.length;H++){K=G[H].trim();if(K){I(K)}}};var x=i.getJSRollupsLoaded=function(){var I,H;var G=B;if(!G){G=[];H=document.getElementsByTagName("SCRIPT");if(H){for(I=0;I<H.length;I++){if(!H[I].hasAttribute("data-is-dust")){b(H[I],function(J){G.push(J);s[J]=true})}}}}return G};var m=i.getCSSRollupsLoaded=function(){var I,H;var G=d;if(!G){G=[];H=document.head&&document.head.getElementsByTagName("LINK");if(H){for(I=0;I<H.length;I++){b(H[I],function(J){G.push(J)})}}}return G};var e=i.getLoadedFilesParams=function(){return{haveJses:String(x()),haveCsses:String(m())}};var z=function(){A=null;if(!r||c){return}var L,J,G;var O=[],I=j,H=h,M=v,R=l;for(L=0;L<u.length;L++){G=u[L];if(G&&!F[G]&&!require.parsed(G)){O.push(G)}}h=[];j=[];u=[];v=[];l=[];if(!d){d=m()}if(!B){B=x()}if(!O.length&&!I.length&&!M.length&&!R.length){o(H);return}var K="haveJses="+encodeURIComponent(String(B))+"&haveCsses="+encodeURIComponent(String(d))+"&needJses="+encodeURIComponent(String(O))+"&needCsses="+encodeURIComponent(String(I))+"&needDusts="+encodeURIComponent(String(R));if(M.length>0){K+="&needContent="+encodeURIComponent(String(M))}if(window.pageServlet){K+="&metaReferer="+encodeURIComponent(window.pageServlet)}var U=null;try{U=new XMLHttpRequest()}catch(T){try{U=new ActiveXObject("MSXML2.XMLHTTP")}catch(S){try{U=new ActiveXObject("Microsoft.XMLHTTP")}catch(Q){throw new Error("Can't create XMLHttpRequest or similar")}}}var N=false;U.onreadystatechange=function(){if(!N&&U.readyState===4){N=true;if(U.status>=200&&U.status<=299){k(H,U.responseText)}else{o(H,new Error("XHR returned "+U.status))}}};U.open("POST","/DemandLoadAjax",true);try{U.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(P){}try{U.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(P){}try{U.setRequestHeader("Accept","text/html, */*")}catch(P){}c=true;U.send(K)};var o=function(H,G){c=false;D();if(!H.length){return}for(var I=0;I<H.length;++I){try{H[I](G)}catch(J){window.IS_DEBUG&&console.error&&console.error("Error in async callback: ",J)}}};var k=function(P,N){var M,O;var J=[];try{if(!(N&&N.substr)){throw new Error("no data returned from /DemandLoadAjax")}var G=document.createElement("DIV");G.innerHTML=N;var K=G.querySelectorAll("STYLE, LINK");var T=[];for(O=0;O<K.length;O++){T.push(K[O])}K=T;T=document.createDocumentFragment();for(O=0;O<K.length;O++){var I=K[O];b(I,function(U){d.push(U);define("trcss!"+U,[],C(H))});T.appendChild(I)}document.head.appendChild(T);K=G.getElementsByTagName("SCRIPT");var L=[];for(O=0;O<K.length;O++){var I=K[O];b(I,function(U){if(I.hasAttribute("data-is-dust")){w[U]=true}else{B.push(U);F[U]=true}});var S=document.createElement("script");S.setAttribute("type","text/javascript");S.setAttribute("data-rup",I.getAttribute("data-rup"));if(I.src){S.src=I.src;S.async=true;J.push(S)}else{if(I.text){S.text=I.text;document.head.appendChild(S);document.head.removeChild(S)}}}var H,Q;while((H=G.firstChild)){G.removeChild(H);if(H.nodeType===1){Q=H.getAttribute("data-content");if(Q){define("trhtml!"+Q,[],C(H))}}}}catch(R){M=R}if(J.length>0){y(J,P,M)}else{o(P,M)}};var C=function(G){return function(){return G}};var y=function(G,I,K){var J,H,M=0;var L=function(){if(--M===0){o(I,K)}};for(J=0;J<G.length;J++){H=G[J];if(H){H.onload=L;H.onerror=L;M+=1}}if(M<=0){o(I,K)}else{for(J=0;J<G.length;J++){H=G[J];if(H){document.head.appendChild(H)}}}};var f=function(){if(!r){r=true;if(!define.depLoader||define.depLoader.isDefault){define.depLoader=q}D()}};define("trjs",[],function(){return{load:p}});define("trcss",[],function(){return{load:a}});define("trhtml",[],function(){return{load:t}});define("trdust",[],function(){return{load:n}});if(document.addEventListener){document.addEventListener("DOMContentLoaded",f)}if(window.addEventListener){window.addEventListener("load",f)}else{if(window.attachEvent){window.attachEvent("onload",f)}}return i});if(typeof ta==="undefined"){var ta={}}var api=(function(){if(window.IS_DEBUG==null){window.IS_DEBUG=false}if(window.VERSION_MAP==null){window.VERSION_MAP={}}if(window.CDNHOST==null){window.CDNHOST=""}var a={overlays:{},maps:{},bmaps:{},common:{},phac:{},servlet:{},support:{},util:{},widgets:{},commerce:{},mobfull:{},photos:{},media:{},hac:{filters:{}},t4b:{},api:{maps:{}},p13n:{},registration:{},meta:{}};a.id=function(d){try{return document.id(d)}catch(f){if(a.util.error){a.util.error.record(f,"ta.id failed")}}};a.select=function(){var e=Array.from(arguments),f=e.length>1&&(("string"===typeof e[0])?e.pop():e.shift())||document,d=e.shift();return Slick.search(f,d,new Elements)};a.invoke=function(d,e){d.each(function(f){f[e]()})};a.selectInvoke=function(d,e){a.invoke($$(d),e)};a.css=function(e,d){return Asset.css(e,Object.merge({media:"screen, print"},d))};a.throttle=function(j,e,g,h){var f=(new Date()).getTime();var i;if(e in c){i=c[e];if(f-i.lastReset<i.minResolution){i.cb=j;return}}else{i=c[e]={start:f,minResolution:Math.max(Math.floor(g/10),50)}}i.cb=j;function d(){delete c[e];i.cb()}if(i.timeout){clearTimeout(i.timeout)}if(h&&(f-i.start>h)){d()}else{i.lastReset=f;i.timeout=setTimeout(d,g)}};var c={};var b=a;b.bind=function(d,e){return Function.prototype.bind.apply(d,Array.from(arguments).slice(1))};b.extend=function(){var n,f,d,e,k,l,j=arguments[0]||{},h=1,g=arguments.length,m=false;if(typeof j==="boolean"){m=j;j=arguments[h]||{};h++}if(typeof j!=="object"&&!isFunction(j)){j={}}for(;h<g;h++){if((n=arguments[h])!=null){for(f in n){d=j[f];e=n[f];if(j===e){continue}if(m&&e&&(isPlainObject(e)||(k=isArray(e)))){if(k){k=false;l=d&&isArray(d)?d:[]}else{l=d&&isPlainObject(d)?d:{}}j[f]=extend(m,l,e)}else{if(e!==undefined){j[f]=e}}}}}return j};b.addEvent=function(d,f,e){return d&&$(d).addEvent(f,e)};b.addEvents=function(e,d){return e&&$(e).addEvents(d)};b.fireEvent=function(e,f,d){return e&&$(e).fireEvent(f,d)};b.removeEvent=function(d,f,e){return d&&$(d).removeEvent(f,e)};b.removeEvents=function(e,d){return e&&$(e).removeEvents(d)};b.legacyFireEvent=b.fireEvent;b.legacyAddEvent=b.addEvent;b.createElement=function(d,e){return new Element(d,e)};b.getSize=function(d){return d&&$(d).getSize()};b.getPosition=function(d,e){return d&&$(d).getPosition(e)};b.getCoords=function(d){return d&&$(d).getCoordinates()};b.addClass=function(d,e){return d&&$(d).addClass(e)};b.removeClass=function(d,e){return d&&$(d).removeClass(e)};b.toggleClass=function(d,e,f){return d&&$(d).toggleClass(e,f)};b.hasClass=function(d,e){return d&&$(d).hasClass(e)};b.find=function(d,e){return $(e||document).getElement(d)};b.findAll=b.select;b.adopt=function(d){return Element.prototype.adopt.apply($(d),Array.prototype.slice.call(arguments,1))};b.parent=function(e,d){return e&&$(e).getParent(d)};b.getOffsetParent=function(d){return d&&$(d).getOffsetParent()};b.getOffsets=function(d){return d&&$(d).getOffsets()};b.setStyle=function(d,f,e){return d&&$(d).setStyle(f,e)};b.bindAll=function(d){if(arguments.length>1){Array.from(arguments).slice(1).each(function(e){d[e]=b.bind(d[e],d)})}else{Object.each(d,function(f,e){d[e]=b.bind(f,d)})}return d};b.checkBrowser=function(){return Array.from(arguments).some(function(d){return !!Browser[d]})};b.isNode=function(d){return(typeof Node==="object"?d instanceof Node:d&&typeof d==="object"&&typeof d.nodeType==="number"&&typeof d.nodeName==="string")};b.isElement=function(d){return(typeof HTMLElement==="object"?d instanceof HTMLElement:d&&typeof d==="object"&&d.nodeType===1&&typeof d.nodeName==="string")};b.inDocument=function(d){return !!d.parentNode&&d.parentNode.nodeType!==11};b.removePropertyEvent=function(f,h,g){if(h.substr(0,2)!=="on"){h="on"+h}f=$(f);var l="ta.call(",k=f.getProperty(h),d=k&&k.indexOf(g),j=k&&k.indexOf(")",d),i;if(!k||d<0){return}if(k.charAt(j+1)==";"){j++}if(k.charAt(d+g.length)=="("){i=k.slice(0,d)+k.slice(j+1)}else{if(d>=l.length+1&&k.substr(d-l.length-1,l.length)==l){d-=l.length+1;i=k.slice(0,d)+k.slice(j+1)}}f.setProperty(h,i&&i.trim())};b.containsEvent=function(e,h){if(!h){return false}var d=h.pageX,g=h.pageY;var f=b.getCoords(e);if("fixed"==(b.getOffsetParent(e)||e).style.position||typeof d==="undefined"||typeof g==="undefined"){d=h.clientX;g=h.clientY}return(g>=f.top&&g<=f.bottom&&d>=f.left&&d<=f.right)};b.containsElement=function(d,e){if(!d||!e){return false}while(e!=null){if(e===d){return true}e=e.parentElement}return false};b.elementOrParentMatches=function(d,e){if(!d||!e){return false}while(d!=null){if(e(d)){return true}d=d.parentElement}return false};b.createNamespace=function(d){var e=d.split(".");return e.reduce(function(g,f){return g[f]||(g[f]={})},window)};b.mixin=function(d){Array.prototype.slice.call(arguments,1).forEach(function(e){for(var f in e){this[f]=e[f]}},d);return d};b.merge=function(g){var f=Array.prototype.slice.call(arguments,1);for(var e=0,d=f.length;e<d;e++){for(var h in f[e]){if(f[e].hasOwnProperty(h)){g[h]=f[e][h]}}}return g};b.isArray=function(d){return Object.prototype.toString.call(d)==="[object Array]"};b.forceReflow=function(d){d&&d.offsetWidth};b.scrollTop=function(){var d=window.pageYOffset!==undefined,e=((document.compatMode||"")==="CSS1Compat");return d?window.pageYOffset:e?document.documentElement.scrollTop:document.body.scrollTop};b.scrollLeft=function(){var d=window.pageXOffset!==undefined,e=((document.compatMode||"")==="CSS1Compat");return d?window.pageXOffset:e?document.documentElement.scrollLeft:document.body.scrollLeft};b.stopEvent=function(d){if(d){if(d.stopPropagation){d.stopPropagation()}else{d.cancelBubble=true}if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}}return false};if(window.define){define("ta",[],function(){return a})}return b})();api.merge(ta,api);var ifdefNN=function(a){return typeof(a)!=="undefined"&&a!==null};define("ns-exporter",["vanillajs"],function(b){function a(d){if(!d){if(require.defined("ta/util/Error")){require("ta/util/Error").record(null,"Using ns-exporter:exportTo without a namespace")}return null}if(typeof d=="string"){var c=window;if(!c.ta){ta={}}d.split(".").forEach(function(e){if(!c[e]){c[e]={}}c=c[e]});d=c}return d}return{exportTo:function(e,d){d=a(d);if(!d){return false}for(var c in e){if(e.hasOwnProperty(c)){d[c]=e[c]}}return true},createNs:function(d,c,e){c=a(c);if(!c){return false}c[e]=d}}});define("ta/util/Object",["vanillajs","ns-exporter"],function(b,c){var a={};a.typeOf=function(d){return Object.prototype.toString.call(d).match(/(\w+)\]$/)[1].toLowerCase()};a.merge=function(j){for(var e=1;e<arguments.length;e++){var g=arguments[e];if(!g){continue}j||(j=(a.typeOf(g)==="array")?[]:{});for(var d in g){var h=g[d];if(g.hasOwnProperty(d)&&a.typeOf(h)!=="undefined"){var f=a.typeOf(h);if(f==="string"||f==="number"||f==="boolean"||f==="function"||h===null){j[d]=h;continue}j[d]=a.merge(j[d],h)}}}return j};c.exportTo(a,"ta.util");return a});define("ta/Core/TA.Store",["vanillajs","ns-exporter","ta/util/Object"],function(c,e,a){var d={};var b={};b.store=function(f,g){d[f]=g;return g};b.retrieve=function(f){return d[f]};b.has=function(f){return typeof(d[f])!="undefined"};b.retrieveOrStore=function(f,g){var h=d[f];if(typeof(h)=="undefined"){d[f]=g;h=g}return h};b.remove=function(f){var g=d[f];delete d[f];return g};b.keep=function(h,i){var f=b.retrieve(h),g;if(f){g=f instanceof Array?f:[f]}else{g=[]}if(i instanceof Array){i.forEach(function(j){if(!g.contains(j)){g.push(j)}})}else{g.push(i)}b.store(h,g)};b.merge=function(f,g){b.store(f,a.merge(b.retrieve(f)||{},g))};b.asInt=function(g,f){var h=parseInt(b.retrieve(g));return isNaN(h)?(f||0):h};b.asFloat=function(h,g){var i=parseFloat(b.retrieve(h));return isNaN(i)?(g||0):i};b.executeCallbacks=function(g){if(b.has(g)){var h=b.retrieve(g);if(!h instanceof Array){return}for(var f=0;f<h.length;f++){h[f]()}}};e.exportTo(b,"ta");return b});define("utils/store",["vanillajs","ta/Core/TA.Store"],function(a,b){return{add:b.store,get:b.retrieve,has:b.has,getOrAdd:b.retrieveOrStore,remove:b.remove}});define("utils/resourceLoader",["vanillajs"],function(c){var d={};var a={};function e(){var i,k,f;this.load=function(q,m,r){if(typeof m==="function"){r=m;m={}}i=0;k=b(q||null);r=r||function(){};m=m||{};f=m.serial;if(k.length==0){setTimeout(r,1)}else{if(f){var p=k.slice();var o;var n=function(s){o=o&&s;if(p.length==0){r&&r(o)}else{l(n,m.forceType,p.shift())}};n()}else{k.forEach(l.bind(null,r,m.forceType))}}};function g(){try{if(navigator.userAgent.match(/ Safari[/]/)&&!navigator.userAgent.match(/ Chrom/)&&navigator.userAgent.match(/ Version\/5\./)){return false}var n=navigator.userAgent.match(/\ AppleWebKit\/(\d+)\.(\d+)/);if(n){n.shift();var m=parseInt(n[0]),o=parseInt(n[1]);if(m<535||(m==535&&o<23)){return false}}return"onload" in document.createElement("link")}catch(p){return false}}function j(m,o,n){i++;(i==k.length||f)&&o(n);if(n){if(require.defined("ta/util/Error")){require("ta/util/Error").record(new Error(m),"utils/resourceLoader: failed to load file ["+m+"]")}}else{d[m]=1}}function h(m){if(m.match(/\.css$/)){return"css"}else{if(m.match(/\.js$/)){return"js"}}return""}function l(t,r,o){var q=r||h(o);if(q){var s,p,m;if(q=="css"){s=document.createElement("link");s.rel="stylesheet";s.type="text/css";m="href";p=g()}else{if(q=="js"){s=document.createElement("script");s.type="text/javascript";m="src";p="onload" in s}}if(p){s.onload=j.bind(null,o,t,false);if("onerror" in s){s.onerror=function(){if(a[o]){j(o,t,true)}else{a[o]=true;l(t,r,o)}}}}else{j(o,t,false)}s[m]=o;var n=document.getElementsByTagName("head")[0];n.appendChild(s)}else{if(require.defined("ta/util/Error")){require("ta/util/Error").record(new Error(o),"utils/resourceLoader: unknown file type for ["+o+"]")}j(o,t,true)}}}function b(h){var g=[];var f=function(i){if(i&&!(i in d)){if(i&&i.splice){i.forEach(f)}else{g.push(i)}}};f(h);return g}return{Loader:e,load:function(g,f,h){if(typeof f==="function"){h=f;f={}}(new e()).load(g,f,h)},loaded:function(f){return b(f).length==0}}});define("ta/Core/TA.Load",["vanillajs","ns-exporter","ta/Core/TA.Store","utils/resourceLoader"],function(c,d,f,b){var a={};a.load=function(i,n,m){var l=false;var j=e(i);if(j){l=VERSION_MAP[j]}var h=function(){var o=f.remove(g);o&&o.forEach(function(p){if(p){p()}})};if(l){var g=j+"_callback";if(f.has(g)){var k=f.retrieve(g);k.push(n);f.store(g,k)}else{f.store(g,[function(){delete VERSION_MAP[j];if(n){n()}}]);if(typeof l==="object"){b.load(l,{serial:true,forceType:"js"},h)}else{b.load(l,{forceType:"js"},h)}}}else{if(m&&b.loaded(l)){h();n&&n()}}return l};a.loadInOrder=function(g,h){b.load(g,{serial:true},h)};function e(k){if(typeof k!="string"||!VERSION_MAP){return}var i=false;if(VERSION_MAP[k]){i=k}else{if(VERSION_MAP[k+".js"]){i=k+".js"}else{var g=k.split(".");var h=0;while(g&&g.length>1&&h<10){g=g.slice(0,-1);var j=g.join("-")+".js";if(j&&VERSION_MAP[j]){i=j;break}h++}}}return i}d.exportTo(a,ta);return a});define("lib/jquery-amd",[],function(){return window.Zepto||ta.jquery||window.jQuery});define("utils/browserutils",["vanillajs"],function(e){var d={},b=window.navigator?window.navigator.userAgent.toLowerCase():"",a=window.navigator?window.navigator.platform.toLowerCase():"",c=b.match(/(opera|ie|firefox|chrome|trident|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],f=c[1]=="ie"&&document.documentMode;if(c[1]==="trident"){c[1]="ie";c[2]=parseInt(c[2],10)+4}d.name=(c[1]=="version")?c[3]:c[1];d.version=f||parseFloat((c[1]=="opera"&&c[4])?c[4]:c[2]);d.Platform={name:b.match(/ip(?:ad|od|hone)/)?"ios":(b.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]};d[d.name]=true;d[d.name+parseInt(d.version,10)]=true;d.Platform[d.Platform.name]=true;return d});define("utils/throttle",["vanillajs"],function(){return function(d,a){var c=Date.now(),b;return function e(){if(b){clearTimeout(b);b=0}if(Date.now()-c<a){b=setTimeout(d.apply.bind(d,this,arguments),a);return}var f=d.apply(this,arguments);c=Date.now();return f}}});define("utils/stopevent",["vanillajs"],function(){return function(a){if(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}return false}});define("utils/form-to-json",["vanillajs"],function(){function a(b,d,c){if(b in c){if(!Array.isArray(c[b])){c[b]=[c[b]]}c[b].push(d)}else{c[b]=d}}return function(d){var h={};var l={file:1,reset:1};var c={DATALIST:1,OUTPUT:1};var g={checkbox:1,radio:1};for(var j=0;j<d.elements.length;j++){var f=d.elements[j];var b=f.name;if(b){var n=f.nodeName,m=f.type;if(n==="SELECT"){for(var e=0;e<f.options.length;e++){var k=f.options[e];if(k.selected){a(b,k.value,h)}}}else{if(n==="INPUT"){if(m in g){if(f.checked){a(b,f.value,h)}}else{if(!(m in l)){a(b,f.value,h)}}}else{if(!(n in c)){a(b,f.value,h)}}}}}return h}});define("api-mod",["lib/jquery-amd","utils/browserutils","utils/throttle","utils/stopevent","utils/form-to-json"],function($,browser,throttle,stopEvent,formToJson){var exports={};exports.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=null;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split(".");var n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null};exports.bind=function(fn,obj){return Function.prototype.bind.apply(fn,Array.prototype.slice.call(arguments,1))};exports.bindAll=function(obj,_funcs_){if(arguments.length>1){Array.prototype.slice.call(arguments,1).forEach(function(name){obj[name]=this.bind(obj[name],obj)},this)}else{for(var name in obj){if(obj.hasOwnProperty(name)){obj[name]=this.bind(obj[name],obj)}}}return obj};exports.inDocument=function(elmt){elmt=exports.find(elmt);return !!elmt.parentNode&&elmt.parentNode.nodeType!==11};exports.addEvent=function(elmt,type,fn){$(elmt).on(type,fn)};exports.fireEvent=function(elmt,type,args){$(elmt).trigger(type,args)};exports.removeEvent=function(elmt,type,fn){$(elmt).off(type,fn)};exports.removePropertyEvent=function(elmt,type,fn){if(type.substr(0,2)!=="on"){type="on"+type}var property=elmt.getAttribute(type);if(!property){return}var newVal;var escFn=fn.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");newVal=property.replace(new RegExp(escFn+"\\s*\\([^)]*\\);?|(ta\\.call|requireCallLast|requireCallIfReady)\\s*\\(\\s*['\"]\\s*"+escFn+"[^)]*\\);?"),"");elmt[type]=newVal.trim()};exports.store=function(elmt,key,value){$(elmt).data(key,value)};exports.retrieve=function(elmt,key){return $(elmt).data(key)};exports.getSize=function(elmt){elmt=exports.find(elmt);if(!elmt){return null}if(/^(?:body|html)$/i.test(elmt.tagName)||elmt===window||elmt===document){var win=(!document.compatMode||document.compatMode==="CSS1Compat")?document.body.parentNode:document.body;return{x:win.clientWidth,y:win.clientHeight}}return{x:elmt.offsetWidth,y:elmt.offsetHeight}};exports.getPosition=function(elmt,relativeTo){relativeTo=$(relativeTo);elmt=$(elmt);if(relativeTo.length){var refOff=relativeTo.offset();var eltOff=elmt.offset();return{left:eltOff.left-refOff.left,top:eltOff.top-refOff.top}}else{return elmt.offset()}};exports.getCoords=function(elmt){elmt=exports.find(elmt);if(!elmt){return null}var size=this.getSize(elmt);var position=this.getPosition(elmt);return{top:position.top,left:position.left,bottom:position.top+size.y,right:position.left+size.x,height:size.y,width:size.x}};exports.getOffsetParent=function(elmt){return $(elmt).offsetParent().get(0)};exports.getParent=function(elmt,className){elmt=exports.find(elmt);if(!elmt){return null}if(className){for(;elmt&&elmt.tagName!="html";elmt=elmt.parentNode){if(exports.hasClass(elmt,className)){return elmt}}return null}else{return elmt.parentNode}};exports.elementOrParentMatches=function(elmt,matcher){if(matcher){for(;elmt;elmt=elmt.parentElement){if(matcher(elmt)){return true}}}return false};exports.containsElement=function(parentElement,childElement){parentElement=exports.find(parentElement);childElement=exports.find(childElement);if(!parentElement||!childElement){return false}while(childElement!=null){if(childElement===parentElement){return true}childElement=childElement.parentElement}return false};exports.checkBrowser=function(_args_){var args=Array.prototype.slice.call(arguments);return args.some(function(b){return !!browser[b]})};exports.containsEvent=function(elmt,evnt){elmt=exports.find(elmt);if(!evnt||!elmt){return false}var x=evnt.pageX,y=evnt.pageY;var s=this.getCoords(elmt);if("fixed"===$(this.getOffsetParent(elmt)||elmt).css("position")||typeof x==="undefined"||typeof y==="undefined"){x=evnt.clientX;y=evnt.clientY}return(y>=s.top&&y<=s.bottom&&x>=s.left&&x<=s.right)};exports.select=function(arg1,arg2){var args=Array.prototype.slice.call(arguments);var context=args.length>1&&(("string"===typeof args[0])?args.pop():args.shift())||document;var selector=args.shift();try{return $(selector,context).get()}catch(e){return[]}};exports.addClass=function(elmt,className){$(elmt).addClass(className)};exports.removeClass=function(elmt,className){$(elmt).removeClass(className)};exports.toggleClass=function(elmt,className,state){$(elmt).toggleClass(className,state)};exports.hasClass=function(elmt,className){return elmt&&$(elmt).hasClass(className)};exports.destroy=function(elmt){$(elmt).remove().get()};exports.find=function(selector,elmt){try{return $(selector,elmt||document)[0]}catch(e){}};exports.scrollTop=function(){var supportPageOffset=window.pageYOffset!==undefined;var isCSS1Compat=((document.compatMode||"")==="CSS1Compat");return supportPageOffset?window.pageYOffset:isCSS1Compat?document.documentElement.scrollTop:document.body.scrollTop};exports.scrollLeft=function(){var supportPageOffset=window.pageXOffset!==undefined;var isCSS1Compat=((document.compatMode||"")==="CSS1Compat");return supportPageOffset?window.pageXOffset:isCSS1Compat?document.documentElement.scrollLeft:document.body.scrollLeft};exports.createElement=function(tag,attributes){var el=document.createElement(tag);attributes&&$(el).attr(attributes);return el};exports.isElement=function(obj){if(typeof HTMLElement==="object"){return obj instanceof HTMLElement}return obj&&typeof obj==="object"&&obj.nodeType===1&&typeof obj.nodeName==="string"};exports.isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};exports.adopt=function(parentElt,_children_){$(parentElt).append(Array.prototype.slice.call(arguments,1))};exports.setStyle=function(elmt,property,value){$(elmt).css(property,value)};exports.stopEvent=stopEvent;exports.mixin=function(target,_mixins_){Array.prototype.slice.call(arguments,1).forEach(function(mixin){for(var prop in mixin){target[prop]=mixin[prop]}},target);return target};exports.merge=function(target,_mixins_){var fromList=Array.prototype.slice.call(arguments,1);for(var i=0,len=fromList.length;i<len;i++){for(var prop in fromList[i]){if(fromList[i].hasOwnProperty(prop)){target[prop]=fromList[i][prop]}}}return target};exports.getFormData=function(form){return formToJson($(form).get(0))};exports.toFormQueryString=function(obj){var qslist=[];if(obj&&obj.nodeName==="FORM"){obj=exports.getFormData(obj)}for(var key in obj){if(obj.hasOwnProperty(key)){var val=obj[key];if(val&&typeof(val)==="object"){for(var i=0;val.length&&i<val.length;++i){var subval=val[i];subval=typeof(subval)==="object"?"":String(subval);qslist.push(encodeURIComponent(key)+"="+encodeURIComponent(subval))}}else{qslist.push(encodeURIComponent(key)+"="+encodeURIComponent(String(val)))}}}return qslist.join("&")};exports.toArray=function(thing){if(typeof thing.length!=="number"){return[thing]}return Array.prototype.slice.call(thing)};exports.throttled=throttle;exports.forceReflow=function(elmt){$(elmt).each(function(idx,elt){elt.offsetWidth})};exports.stripTags=function(str,tag,contents){tag=tag||"";var regstr=contents?"<"+tag+"(?!\\w)[^>]*>([\\s\\S]*?)</"+tag+"(?!\\w)>":"</?"+tag+"([^>]+)?>";return str.replace(new RegExp(regstr,"gi"),"")};return exports});define("purify",["vanillajs"],function(c){function b(e,d){if(!e){return e}if(a(e)){if(window.IS_DEBUG){console.error("You're using a jQuery object where you shouldn't. Check the stack trace and fix it!")}return d&&e.length>1?e.get():e.get(0)}return e.forEach&&(e.length<=1||!d)?e[0]:e}function a(d){return !!(d.animate&&d.get&&d.eq&&d.each)}return b});define("ta/Core/TA.Record",["vanillajs","ns-exporter","ta/Core/TA.Store","purify"],function(v,g,d,R){var F={};var H={};var L=[];var Q=8;var b="impressionTrackingTree";var f=0,h=1,p=2;var j=[];var G=60;var K=function(aa){return typeof aa==="function"};var B=function(){var ab=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],ad;if(window.XMLHttpRequest){ad=new XMLHttpRequest()}else{for(var aa=0;aa<ab.length;aa++){try{ad=new ActiveXObject(ab[aa]);break}catch(ac){}}}return ad};var n=function(aa,ab){try{if(!aa||typeof ab!=="object"){return}if(window.JSON&&JSON.stringify){var ac=JSON.stringify(ab);if(ac&&ac.length<100000){j.push([aa,ac]);if(j.length>G){j.shift()}}}}catch(ad){}};var u=function(af,ab,ag){if(!af||typeof ab!=="object"){E(new Error("postUrl/dataObj is null/empty/undefined"),"TA.Record _simpleAjaxPost",null,arguments);if(ag){ag()}return}var ac;if(typeof Request!=="undefined"&&window.MooTools){ac={url:af,method:"post",data:ab};if(ag){ac.onComplete=ag;ac.timeout=3000}var ad=new Request(ac).send();n(af,ab);return ad}else{if(typeof Zepto!=="undefined"&&Zepto&&K(Zepto.ajax)){ac={type:"POST",url:af,data:ab,error:function(aj,ah){var ai=/InvalidTrackingTreeException/;if(window.IS_DEBUG&&new RegExp(ai).exec(aj.response)){var ak=/Caused by:\s(.*)\n/;alert("TRACKING ERROR DETECTED\n"+new RegExp(ak).exec(aj.response)[1])}E(new Error("XHR error, errorType = "+ah),"TA.Record _simpleAjaxPost",null,arguments)}};if(ag){ac.complete=ag;ac.timeout=3000}Zepto.ajax(ac)}else{if(typeof jQuery=="function"){ac={url:af,type:"POST",data:ab};if(ag){ac.complete=ag;ac.timeout=3000}jQuery.ajax(ac)}else{var aa=B(),ae=i(ab);aa.open("POST",af,false);aa.setRequestHeader("Content-type","application/x-www-form-urlencoded");aa.send(ae)}}}n(af,ab)};var E=function(){if(require.defined("ta/util/Error")){require("ta/util/Error").record.apply(this,arguments)}else{if(ta&&ta.m&&K(ta.m.recordJSError)){ta.m.recordJSError(arguments)}}};var C=function(aa){if(typeof aa=="undefined"||aa==null){return""}if(typeof aa!=="string"){aa=aa.toString()}return aa.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*")};var Z=function(ad){var aa=[];for(var ab in ad){var ac=ad[ab];aa.push(C(ab)+"."+C(ac))}return aa.join("*")};var z=function(aa){if(typeof aa=="undefined"||aa===null){return""}if(typeof aa!=="string"){aa=aa.toString()}return aa.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*").replace(/\~/g,"!~")};var t=function(ad){var aa=[];for(var ab in ad){var ac=ad[ab];aa.push(z(ab)+"."+z(ac))}return aa.join("*")};var r=function(aa){var ab=/(https?:\/\/[^\/]+)?\/([^#.?-]*)/;var ac=ab.exec(aa);if(ac){if(typeof ac[2]!="undefined"){return(ac[2])?ac[2]:"Home"}}return null};var V=function(){var aa=F.getPageData();if(aa&&aa.url){return aa.url.substring(1)}else{var ab=/\/([^-]*)/.exec(window.location.pathname);return ab?ab[1]:null}};var W=function(ac,aa,ad){var ab=new RegExp("(-"+aa+"([0-9]+))|([?&]"+ad+"=([0-9]+))");var ae=ab.exec(ac);if(ae){if(typeof ae[2]!="undefined"){return ae[2]}if(typeof ae[4]!="undefined"){return ae[4]}}return null};var M=function(aa){return W(aa,"d","detail")||W(aa,"g","geo")};var O=function(aa){var ab=document.cookie.match("(?:^|;)\\s*"+aa+"=([^;]*)");if(ab){ab=ab[1];if(ab.indexOf("%1%")===0){ab=ab.substring(3)}return decodeURIComponent(ab)}return false};var s=function(ad,ae,ab){try{var aa;if(ab.encode){ae=encodeURIComponent(ae)}if(ab.domain){ae+="; domain="+ab.domain}if(ab.path){ae+="; path="+ab.path}if(ab.duration){aa=new Date();aa.setTime(aa.getTime()+ab.duration*1000);ae+="; expires="+aa.toGMTString()}if(ab.secure){ae+="; secure"}document.cookie=ad+"="+ae}catch(ac){E(ac,"_setCookieInSeconds",null,arguments)}};var Y=function(){if(ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")){return ta.m.store.get("bookingSessionId")}return null};var D=function(){var aa=false;if(typeof ta.userLoggedIn==="boolean"){if(typeof ta.userSecurelyLoggedIn==="boolean"){aa=ta.userLoggedIn?(ta.userSecurelyLoggedIn?p:h):f}else{aa=ta.userLoggedIn}}return aa};var T=function(ad,ab){var aa={gac:ad[1],gaa:ad[2],gal:ad[3],gav:ad[4],gani:ad[5],gass:V(),gasl:M(document.location.href),gads:r(ab),gadl:M(ab),gapu:ta.uid,gams:D()},ac=Y();if(!aa.gass){throw new Error("Src servlet undefined, gac:"+aa.gac+", gaa:"+aa.gaa+", gal:"+aa.gal)}if(!aa.gads){throw new Error("Dst servlet undefined. gac:"+aa.gac+", gaa:"+aa.gaa+", gal:"+aa.gal)}if(d.has("gatt")){aa.gatt=d.retrieve("gatt")}if(ac){aa.bsid=ac}s("EVT",Z(aa),{domain:cookieDomain,duration:5,encode:true,path:"/"})};var U=function(ad){if(!ad||!ad.className||!ad.firstChild){return false}var ac=new RegExp("\\b"+b+"\\b"),aa=ad.firstChild.nodeType,ab=ad.firstChild.nodeValue;return ac.test(ad.className)&&aa===Q&&ab!==""};var k=function(){};if(require.defined("page-model")){require(["page-model"],function(aa){var ac=aa.session;var ab=ac.analyticsInfo;if(ab){d.keep("partials.pageProperties",ab.pagePropertyStringForCurrentPageview);d.store("gaMemberState",ab.memberState);if(ac.analyticsInfo&&require.defined("ta/Core/TA.Prerender")){require("ta/Core/TA.Prerender")._init(true)}}k=function(){if(ab){L.push(JSON.parse(ab.jsonForCurrentPageview))}k=function(){}}})}F.getPageData=function(){k();return L[L.length-1]};F.pushPageData=function(aa){k();if(aa){L.push(aa)}};F.popPageData=function(){k();return L.pop()};F._GARecordRequest=function(af,ad){var ab={gac:af[1],gaa:af[2],gal:af[3],gav:af[4],gani:af[5],gass:V(),gasl:M(document.location.href),gapu:ta.uid,gams:D()},ae=Y(),aa;if(ad){ab.gacl=ad}if(d.has("gatt")){ab.gatt=d.retrieve("gatt")}if(ae){ab.bsid=ae}var ac;try{if(d.retrieve("batch_garecord")){ac=require("utils/BatchRequest")}else{if(ta.m&&ta.m.batch_garecord_mobile){ac=require("mobile/lite/batch-request")}}}catch(ag){}if(ac){aa={get:function(){ac.queue("/GARecord",ab)}}}else{aa={get:function(){setTimeout(function(){var ah=new XMLHttpRequest();ah.open("GET","/GARecord?"+i(ab),true);ah.send(null)},1)}}}n("/GARecord",ab);return aa};var i=function(ab){var ac=[];for(var aa in ab){ac.push(encodeURIComponent(aa)+"="+encodeURIComponent(ab[aa]))}return ac.join("&")};H.urlArgLookup=function(ad,aa){var ac=new RegExp("[\\?&]"+ad+"=(\\w+)");var ab=ac.exec(aa);if(ab&&typeof ab[1]!="undefined"){return ab[1]}return null};F._validatedTrackEventArray=function(ac,ae,aa,ad,ab){if(ac&&typeof ac!="string"){ac=ac.toString()}if(ae&&typeof ae!="string"){ae=ae.toString()}if(aa&&typeof aa!="string"){aa=aa.toString()}if(!ad){ad=0}else{if(typeof ad!="number"){ad=parseFloat(ad);if(isNaN(ad)){ad=0}}}if(typeof ab!="boolean"){ab=(ab===true)}return["_trackEvent",ac,ae,aa,ad,ab]};F._toEvtParams=function(ac){try{var aa={gac:ac.module,gaa:ac.action,gal:ac.context,gav:ac.value,gani:ac.noninteraction};aa.gass=V();aa.gasl=M(document.location.href);aa.gapu=ta.uid;aa.gams=D();return aa}catch(ab){E(ab,"analytics._toEvtParams",null,ac)}};F._trackEventAfterAjax=function(ab){try{H.trackDMPBehavior(ab.module,ab.action,ab.context,ab.value,ab.noninteraction)}catch(aa){E(aa,"analytics._trackEventAfterAjax",null,ab)}};H.getEventPathOptions=function(af,ac,ab){try{var ae=w(ab,af);if(!ae){E(null,"ta.getEventPathOptions - invalid element",null,arguments);return}var aa=J(ae);if(ac){aa.noninteraction=ac}return aa}catch(ad){E(ad,"ta.getEventPathOptions",null,arguments)}};F._trackEventPathAfterAjax=function(aa){try{H.trackEventOnPage(aa.category,aa.action,aa.label,aa.value,aa.noninteraction)}catch(ab){E(ab,"analytics._trackEventPathAfterAjax",null,arguments)}};H.trackPhysicalCommerce=function(ac,ab,af,aa){try{var ad=F._validatedTrackEventArray(ac,"Commerce-Physical",ab,af,false);F._GARecordRequest(ad,aa).get()}catch(ae){E(ae,"ta.trackPhysicalCommerce",null,arguments)}};H.trackAttemptedCommerce=function(ab,aa,ad){try{H.trackDMPBehavior(ab,aa,ad,null,null)}catch(ac){E(ac,"ta.trackAttemptedCommerce",null,arguments)}};H.trackPhysicalAndAttemptedCommerce=function(ac,ab,ad,ae,aa){H.trackPhysicalCommerce(ac,ab,ae,aa);H.trackAttemptedCommerce(ac,ab,ad,ae)};H.trackImpressionEventOnPage=function(ab,ad,aa,ac){ab=ab||"";ad=ad||"";aa=aa||"";ac=ac||0;H.trackEventOnPage(ab,ad,aa,ac,true)};H.trackEventOnPage=function(ab,af,aa,ae,ad){try{var ac=F._validatedTrackEventArray(ab,af,aa,ae,ad);F._GARecordRequest(ac).get();H.trackDMPBehavior(ab,af,aa,ae,ad)}catch(ag){E(ag,"ta.trackEventOnPage",null,arguments)}};H.trackCommerceClickForInsight=function(af){if(!d.retrieve("insight_profile_commerce_clicks_from_data_attributes.enabled")){return}try{var ai,ab,ag,aa,ad,aj,ac,ae;ai=af.getAttribute("data-offerauthor");ab=af.getAttribute("data-locationId");ag=af.getAttribute("data-pernight");ad=ta.meta.link.getUrlFromClickElem(af);aj=ta.popups.PopUtil.extractSlotFromCommerceUrl(ad);aa=M(document.location.href);ac={};ac.providerName=""+ai;ac.clickLocId=""+ab;ac.price=""+ag;ac.slot=""+aj;ac.pageLocId=""+aa;ae=JSON.stringify(ac);H.trackEventOnPage("InsightEvent","InsightCommerceClick",ae)}catch(ah){E(ah,"ta.trackCommerceClickForInsight",null,arguments)}};H.trackEventOnPageOnce=function(ae,ag,ac,ad){var aa="eventsAlreadyTracked",af;if(ifdefNN(ta)&&ifdefNN(ta.m)&&ifdefNN(ta.m.store)){af=ta.m.store.get(aa)}else{af=d.retrieve(aa)}if(!af){af={};if(ifdefNN(ta)&&ifdefNN(ta.m)&&ifdefNN(ta.m.store)){ta.m.store.add(aa,af)}else{d.store(aa,af)}}var ab=ae+"|"+ag+"|"+ac;if(!af[ab]){H.trackEventOnPage(ae,ag,ac,0,ad);af[ab]=true}};H.trackDMPBehavior=function(ab,ae,aa,ad,ac){try{if(ta.common&&ta.common.dmp&&ta.common.dmp.isEnabled()){ta.common.dmp.sendGABehavior(ab,ae,aa,ad,ac)}}catch(af){E(af,"Error adding and sending GARecord behavior to DMP")}};H.setEvtCookie=function(ac,af,ab,ae,aa){try{var ad=F._validatedTrackEventArray(ac,af,ab,ae,false);T(ad,aa);if(ta.common&&ta.common.dmp&&ta.common.dmp.isEnabled()){ta.common.dmp.sendEventBehavior(ac,af,ab,ae,S())}}catch(ag){E(ag,"ta.setEvtCookie",null,arguments)}};var x=function(ac){var ab;try{ab=O("MEVT")||"";if(ab.length>0){ab+="~"}ab+=t(ac);if(ab.length>1024){throw"MEVT Cookie is full"}s("MEVT",ab,{domain:cookieDomain,duration:5,encode:true})}catch(aa){E(aa,"_appendMevtCookie",null,arguments);return false}return true};var m="trk";var a=m.length;var P="etk";var q=/^([A-Z]{1,2}:)?[A-Za-z_0-9\-\.]+$/;var S=function(){var aa=(typeof event!="undefined")?event:window.event;if(aa){return aa.target||aa.srcElement}return document.activeElement};F.getCommentTrackingPath=function(aa,ab){return w(aa,ab)};var w=function(ag,ai){ag=R(ag);if(!ag){ag=S();if(!ag){E(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments);return null}}if(ag.nodeType!=1){return null}var al=[];if(ai&&typeof ai=="string"&&ai!==""){if(q.test(ai)){if(ai.substring(0,2)=="P:"){al.push(ai.substring(2));return al}else{al.push(ai)}}}if(typeof ag.previousSibling==="undefined"){E(null,"_getCommentTrackingPath - browser does not support previousSibling",null,arguments);return al}LOOP_PARENT_NODES:for(var ad=ag;ad!=document.body;ad=ad.parentNode){if(ad==null){E(null,"_getCommentTrackingPath - LOOP_PARENT_NODES got unexpected null node",null,arguments);break}var aj=0;for(var aa=ad.previousSibling;aa!=null;aa=aa.previousSibling){if(aa.nodeType==Q){var ac=aa.nodeValue;if(ac==P){aj++;continue}if(ac.substring(0,a)!=m){continue}if(aj>0){aj--;continue}var af=ac.substring(a).split("/");if(!af){E(null,'ta._getCommentTrackingPath - cannot split context class: "'+ac+'"',null,arguments)}for(var ak=af.length-1;ak>=0;ak--){var ab=af[ak];var ah=q.exec(ab);if(!ah){E(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+af[ak]+'"',null,arguments);continue}if(ah[1]=="P:"){var ae=ah[0].substring(2);al.push(ae);break LOOP_PARENT_NODES}else{al.push(ah[0])}}}}}return al};var J=function(ac){if(ac.length===0){return null}var aa={action:ac[0],label:"",value:"1",category:ac[ac.length-1]};ac.shift();for(var ab=ac.length-2;ab>=0;ab--){aa.label+=ac[ab];if(ab>0){aa.label+="/"}if(ac[ab].substring(0,2)=="N:"){aa.value=ac[ab].substring(2)}}if(aa.label===""){aa.label="Unknown"}return aa};H.trk=function(ae,ag,ad,ab){ad=R(ad);try{var ai=ad?ad.getAttribute("data-trk-path"):null;if(ai){ai=ai.replace("P:","");ai=ai.split("/");ai.reverse()}else{ai=w(ad,ae);if(!ai||!ai.length){var ac="";if(ad){if(ad.outerHTML){var ah=document.createTextNode(ad.outerHTML);var aa=document.createElement("div");aa.appendChild(ah);ac=aa.innerHTML.substring(0,100)}else{if(ad.nodeName){ac=ad.nodeName}else{ac+=ad}}}else{if(ad===undefined){ac="undefined"}else{if(ad===null){ac="null"}}}if(!ae){if(ai===null){ae="null path"}else{if(ai===undefined){ae="undefined path"}else{if(ai.hasOwnProperty("length")){if(ai.length===0){ae="empty path"}else{ae=ai.join(",")}}else{ae="path: "+ai}}}}E(null,"ta.trk - invalid element for "+ae+" from "+ac,null,arguments);return}}H.trkWithPath(ai,ag,ab)}catch(af){E(af,"ta.trk",null,arguments)}};H.trkWithPath=function(af,ad,ae){try{if(!af||!af.length){E(null,"ta.trkWithPath - no path in arguments",null,arguments);return}if(ae&&ae.length>0&&af.length&&af.splice){for(var ab=ae.length-1;ab>=0;ab--){if(typeof(ae[ab])==="string"){af.splice(1,0,ae[ab])}}}var aa=J(af);H.trackEventOnPage(aa.category,aa.action,aa.label,aa.value,ad)}catch(ac){E(ac,"ta.trkWithPath - "+ac,null,arguments)}};H.trkImpTree=function(ab,ad){try{if(!U(ab)){E(null,"ta.trkImpTree called with invalid trackTreeElem!",null,arguments);if(ad){ad()}return}var aa=ab.firstChild.nodeValue;o(aa,ad)}catch(ac){E(ac,"ta.trkImpTree",null,arguments);if(ad){ad()}}};H.recordImpression=function(aa,ac){if(!aa){if(ac){ac()}return}try{o(I(aa),ac)}catch(ab){E(ab,"ta.recordImpression",null,arguments);if(ac){ac()}}};var A="<!--";var y="-->";var I=function(aa){var ab=aa.indexOf(A),ac=0,ad=aa.indexOf(y);if(ab!==-1){ac=ab+A.length}if(ad===-1){ad=aa.length}return aa.substring(ac,ad)};F.stripCommentsFromTree=I;var l="\\";var c="/";F.appendAscendTokens=function(ab){var ad=0,ac=0,aa=0;for(ad=0;ad<ab.length;ad++){if(ab[ad]===c){aa++}else{if(ab[ad]===l){ac=ad+1;while(ac<ab.length&&ab[ac]===l){aa--;ad=ac;ac++}}}}if(aa>0){for(ad=0;ad<aa;ad++){ab+=l}}return ab};var o=function(aa,ac){var ab={tTreeStr:aa&&aa.trim(),tTreeUid:ta.uid&&ta.uid.trim(),tTreeLastReferrer:window.location.href,tTreeIsMemberSignedIn:D()};if(ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")){ab.bsid=ta.m.store.get("bookingSessionId")}if(!ab.tTreeStr){E(new Error("tTreeStr is null/undefined/empty."),"ta._sendTreeImpression",null)}else{if(!ab.tTreeUid){E(new Error("tTreeUid is null/undefined/empty."),"ta._sendTreeImpression",null)}}u("/ImpressionRecord",ab,ac)};H.setEvtCookieAndPath=function(af,aa,ac){try{if(!ac){ac=S()}var ae=w(ac,af);if(!ae){E(null,"ta.setEvtCookieAndPath - invalid element for "+af,null,arguments);return}var ab=J(ae);if(!aa){while(ac.nodeName!="A"){if(ac==document.body){break}ac=ac.parentNode}aa=ac.href;if(!aa){E(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments);return}}H.setEvtCookie(ab.category,ab.action,ab.label,ab.value,aa)}catch(ad){E(ad,"ta.setEvtCookieAndPath",null,arguments)}};H.recordPageview=function(ab,ae){if(!ab){return}var aa=r(ab),ad="/PageviewRecord",ac=ae?ae:{};if(aa){ac.servletName=aa;u(ad,ac)}};H.recordTabView=function(af,ab,ae){if(!af||!ab){return}var aa=af+"-"+ab,ad="/PageviewRecord",ac=ae?ae:{};if(aa){ac.servletName=aa;u(ad,ac)}};H.resetPageDataUrl=function(){var aa=F.getPageData();if(aa){aa.url=""}};H.trackEngagementClick=function(aa,ab){if(!aa||!ab){E(new Error("object/selectionFunction is null/undefined"),"ta.trackEngagementClick",null,arguments);return}if(!K(ab)){E(new Error("passed variable selectionFunction is not a function"),"ta.trackEngagementClick",null,ab);return}ab(aa)};H.placementNodeSelectorTracker=function(ag){if(!ag||!ag.element||!ag.type){E(new Error("object/element/type is null/undefined"),"ta.placementNodeSelectorTracker",null,ag);return}var al=ag.element;var af=ag.type;var ah;var ac;var ao;var an;var ab;var ak;var ad=F.getCommentTrackingPath(al);af=af+"_Click";if(!ad){E(new Error("trackTreePath is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);return}if(ad.length<1){E(new Error("trackTreePath is missing information"),"ta.placementNodeSelectorTracker",null,arguments);return}ah=ad[ad.length-1];if(!ah){E(new Error("placement is null/undefined"),"ta.placementNodeSelectorTracker",null,ad);return}for(ak=ad.length-1;ak>=0;ak--){ab=ad[ak];if(!ab){continue}if(ab.indexOf("N:")===0){ac=ab;break}}if(ah==="HH_MainList"||ah==="Maps_MetaBlock"){ac="N:1"}else{if(!ac){E(new Error("positionNode is null/undefined"),"ta.placementNodeSelectorTracker",null,ad);return}}ao=ac.split(":");if(ao&&ao.length===2){an=ao[1]}else{E(new Error("positionSplit appears to be incorrect"),"ta.placementNodeSelectorTracker",null,arguments);return}if(!an){E(new Error("position is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);return}var aj=parseInt(an,10);if(isNaN(aj)){E(new Error("position is not a number"),"ta.placementNodeSelectorTracker",null,an);return}var aq=X(ah);if(aq===-1){return}an=aj+aq;ah=e(ah);if(ah==="hotels_slot_x"){var ap=document.getElementById("slotXListingWrap");if(ap){var aa=ap.getAttribute("data-prodAttr");var am=parseInt(ap.getAttribute("data-prodId"),10);H.trackEventOnPage(ah,af,aa,am+1)}return}var ae;var ai=document.querySelectorAll(".ui_tab_bar .ui_tab.selected");if(ai.length===1){ai=ai[0];ae=ai.getAttribute("data-currentSort")}H.trackEventOnPage(ah,af,ae,an)};var e=function(aa){if(!aa){return aa}if(V()!=="Hotels"){return"Clicks_"+aa}var ab;if(aa==="Hotels_MainList"||aa==="Hotels_MainList_Sponsored"){ab="Clicks_"+aa}else{if(aa==="hotels_list_short_cells2"){ab="Clicks_Hotels_MainList"}else{if(aa==="sponsored_coupon_listing"){ab="Clicks_Hotels_MainList_Sponsored"}else{if(aa==="DesktopSlotX"||aa==="MobileSlotX"||aa==="Hotels_SlotX_Sponsored"){return"hotels_slot_x"}}}}if(document.getElementById("sponsoredCouponListingWrap")&&ab==="Clicks_Hotels_MainList"){ab+="_Sponsored"}ab+=(ta.widgets.calendar.getCheckRatesData())?"_PostDates":"_PreDates";return ab};var X=function(ad){if(!ad){E(new Error("placement is null/undefined"),"ta._shiftOrdinalsWithSponsoredPlacement",null,ad);return -1}if(V()!=="Hotels"){return 0}var ab=0;var af=d.retrieve("hac.offset");if(af&&af>0){ab=af}if(!document.getElementById("sponsoredCouponListingWrap")){return ab}var ac=document.querySelector("#HAC_RESULTS .pageNumbers .current");var aa;if(ac){var ae=ac.getAttribute("data-page-number");aa=parseInt(ae,10);if(isNaN(aa)||!aa){E(new Error("pageNumber is not a number"),"ta._shiftOrdinalsWithSponsoredPlacement",null,ae);return -1}}if(ad==="hotels_list_short_cells2"||ad==="Hotels_MainList"){ab+=aa;return ab}if(af&&af>0&&(ad==="sponsored_coupon_listing"||ad==="Hotels_MainList_Sponsored")){ab+=(aa-1)}return ab};H.getRecentTARecords=function(){return j};H.addTypeAheadMevt=function(aa){aa.t="ta";return x(aa)};H.addGARecordMevt=function(ad,ae,ac,ai,ab){try{var aa=F._validatedTrackEventArray(ad,ae,ac,ai,false),ah={t:"ga",gac:aa[1],gaa:aa[2],gal:aa[3],gav:aa[4],gani:aa[5],gass:V(),gasl:M(document.location.href),gads:r(ab),gadl:M(ab),gapu:ta.uid,gams:D()},af=Y();if(!ah.gass){throw new Error("Src servlet undefined, gac:"+ah.gac+", gaa:"+ah.gaa+", gal:"+ah.gal)}if(!ah.gads){throw new Error("Dst servlet undefined. gac:"+ah.gac+", gaa:"+ah.gaa+", gal:"+ah.gal)}if(d.has("gatt")){ah.gatt=d.retrieve("gatt")}if(af){ah.bsid=af}x(ah);if(ta.common&&ta.common.dmp&&ta.common.dmp.isEnabled()){ta.common.dmp.sendEventBehavior(ad,ae,ac,ai,S())}}catch(ag){E(ag,"ta.addGARecordMevt",null,arguments)}};g.createNs(F,"ta","analytics");g.exportTo(H,"ta");var N={};g.exportTo(F,N);g.exportTo(H,N);return N});define("utils/ajax",["lib/jquery-amd","ta/Core/TA.Record","api-mod"],function($,taRecord,api){return function(url,options){if(!url.substr){options=url}var newOpts=$.extend({},options,{dataFilter:function(data,type){if(type=="json"){data=data.replace(/^\s*while\s*\([^)]*\);?/,"")}options&&options.dataFilter&&options.dataFilter.call(this,data,type);return data}});newOpts.xhrFields=newOpts.xhrFields||{};newOpts.xhrFields.withCredentials=true;if(api.isElement(newOpts.data)){newOpts.data=api.getFormData(newOpts.data)}var trackEvent=newOpts.trackEvent;if(trackEvent){$.extend(newOpts,taRecord._toEvtParams(trackEvent));newOpts.complete=function(){taRecord._trackEventAfterAjax(trackEvent);options&&options.complete&&options.complete.apply(this,arguments)}}if(newOpts.evalScripts){newOpts.success=function(data,status,xhr){if(data&&data.substr){var dom,scripts;if($.parseHTML){dom=$($.parseHTML(data,document,true));scripts=dom.filter("script").add(dom.find("script"))}else{dom=$("<div>"+data+"</div>");scripts=dom.find("script")}scripts.each(function(idx,script){if(script.innerHTML){if(window.execScript){window.execScript(script.innerHTML)}else{if(window.eval){window.eval(script.innerHTML)}else{var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.text=script.innerHTML;document.head.appendChild(scriptObj);document.head.removeChild(scriptObj)}}}})}options&&options.success&&options.success.apply(this,arguments)}}return url.substr?$.ajax(url,newOpts):$.ajax(newOpts)}});define("mixins/Events",["vanillajs"],function(b){var a=function(){this.events={};Array.prototype.slice.call(arguments).forEach(function(c){this.events[c]=[]},this)};a.create=(function(){function c(d){return a.apply(this,d)}c.prototype=a.prototype;return function(){return new c(arguments)}}());a.extend=function(d,e){var c=Object.create(a.prototype);c.delegate=d;a.apply(c,e);return c};a.prototype.on=a.prototype.addListener=function(d,c){if(this.events[d]!==undefined){this.events[d].push(c)}else{if(this.delegate){this.delegate.on(d,c)}else{this.events[d]=[c]}}return this};a.prototype.off=a.prototype.removeListener=function(e,d){if(this.events[e]!==undefined){if(d){var c=this.events[e].indexOf(d);if(c>=0){this.events[e].splice(c,1)}}else{this.events[e].length=0}}else{if(this.delegate){this.delegate.removeListener(e,d)}}return this};a.prototype.removeAllListeners=function(d){if(d&&this.events[d]!==undefined){this.events[d].length=0}else{if(!d){for(var c in this.events){if(this.events.hasOwnProperty(c)){this.events[c].length=0}}if(this.delegate&&this.delegate.removeAllListeners){this.delegate.removeAllListeners()}}else{if(this.delegate&&this.delegate.removeAllListeners){this.delegate.removeAllListeners(d)}}}};a.prototype.hasListeners=function(c){if(c){if(this.events.hasOwnProperty(c)){return this.events[c].length>0}if(this.delegate&&this.delegate.hasListeners){return this.delegate.hasListeners(c)}}return false};a.prototype.emit=function(e,d){if(this.events[e]){var c=Array.prototype.slice.call(arguments,1);this.events[e].slice(0).forEach(function(g){if(g){try{g.apply(this,c)}catch(i){if(typeof i==="string"){i=new Error(i)}var h="Error in event handler for "+e;if(require.defined("ta/util/Error")){require("ta/util/Error").record(i,h)}else{var f=require.defined("ta")&&require("ta");if(f&&f.log&&f.log.error){f.log.error(i,h)}else{if(f&&f.m&&f.m.recordJSError){f.m.recordJSError([i,h])}else{if(typeof console!="undefined"){(console.error||console.log)(h,i)}}}}}}},this)}else{if(this.delegate&&this.delegate.emit){this.delegate.emit.apply(delegate,arguments)}}return this};return a});define("ta/util/Error",["vanillajs","api-mod","utils/ajax","ns-exporter","mixins/Events"],function(g,e,m,n,p){var c={};var d=new p("error","beforeSend");var f=3000;var l="unset";var j=false;var a=0;c.record=function(J,s,C,D,y){var E=require("ta/util/Cookie");if(!J){J=new Error("Stub error to build stack.")}if(j||a>9){return}a++;j=true;var A=false;try{A=document.body.className.match(/\bjs_logging\b/)}catch(M){}if(!A){j=false;return}if(IS_DEBUG&&console.error){console.error("JS_ERROR_RECORD: "+s,J)}var P=true;if(D&&D.hasOwnProperty("error_script")&&!o(D.error_script)&&!q(D.error_script)){P=false}var x={};var O=false;try{if(C||window.event){O=(C||event).target;x.eTarg=this.getSelectorString(O)}}catch(B){}if(typeof(debugCacheKey)!="undefined"){x.key=debugCacheKey}var r=window.pageServlet;if(!r){r="unknown"}x.servlet=r;if(!y||typeof y!="string"){y="ERROR"}if(!P){y="WARN";x.warnReason="externalError"}else{if(!IS_DEBUG&&a>1){y="WARN";x.warnReason="notFirstJSError"}}var R={extraInfoError:"Problem storing extra info"};var w={};try{var v="";var u="";if(O){if(typeof O.id!=="function"){v=O.id}u=O.className}var K="";if(typeof serverPool!="undefined"&&serverPool){K=serverPool}var G="";if(window.MooTools){G+="MooTools "}if(require.defined("lib/jquery-amd")){G+="jQuery "}w={TARGET_ID:v,TARGET_CLASS:u,PAGE_UID:ta.uid,INTERNAL_JS:h(),CLIENT_POOL:K,COOKIES_ENABLED:E.canSet(),JS_LIBS:G};if(!P){w.INTERNAL_ERROR="false"}if(a>1){w.PRIOR_JS_PAGE_ERRORS=a-1}}catch(L){D=R}x.xInfo=i(w,D);try{x.eUrl=window.location.href}catch(B){}var z="No Error";try{if(J){if(Object.prototype.toString.call(J)===Object.prototype.toString.call(new Error)){z=J.name+"-"+J.message}else{if(typeof J==="object"){z="non-Error object "+Object.prototype.toString.call(J)+" passed, sample properties - ";var Q=0;for(var t in J){if(J.hasOwnProperty(t)){z+=t.substring(0,30)+": "+(J[t]&&J[t].toString?J[t].toString().substring(0,20):J[t])+", ";if(++Q>4){break}}}}else{z="non-Object error passed: "+(""+J).substring(0,30)}}z=z.replace(/[\r\n]/g,"")}}catch(B){}x.eMsg=z;var I="";try{I=k(s).substring(0,150);x.eBlk=I}catch(B){}try{if(I.indexOf("window.onerror")!=0){var N=b(J);if(N){x.eStak=N}}}catch(B){}try{d.emit("beforeSend",x)}catch(B){}x.eLogLevel=y;try{m({url:"/JSErrorRecord",data:x,method:"POST"})}catch(M){x={eBlk:"JSErrorRecord Error",servlet:r,eLogLevel:"ERROR",eMsg:"no error retrieved"};m({url:"/JSErrorRecord",data:x})}j=false;if(window.IS_DEBUG){(window.ERRORS||(window.ERRORS=[])).push(x);if(J&&y==="ERROR"&&false){throw J}}d.emit("error",z,s,y);if(l=="unset"){l=E.readRaw("JS_ERROR_HANDLING")}if(l){if(l.match(/alert/)){var F="";for(var H in x){if(x.hasOwnProperty(H)){F=F+H+": "+x[H]+"\n"}}window.alert(F)}if(l.match(/console/)){if(window.console){console.error(x)}}}};c.ajaxFailure=function(t,s,r){c.record(null,t,null,e.merge({status:s.status},r))};c.on=d.on.bind(d);c.off=d.off.bind(d);function i(z,r){var w="_extraInfoError_:Problem storing extra info.";var y={};var A="";try{if(Array.isArray(r)||(Object.prototype.toString.call(r)==="[object Arguments]")){var t={};for(var v=0;v<r.length;v++){var s=r[v];var x=typeof s;if(x==="string"||x==="number"||x==="boolean"){t[v]=s}else{t[v]=x}}r=t}e.merge(y,z,r)}catch(u){y=z}try{A=JSON.stringify(y);if(A){if(A.length>f){A=A.substring(0,f)}return A.replace(/[\r\n]/g,"")}}catch(u){}return w}function k(r){if(typeof r!="undefined"&&r!==null){return r.toString().replace(/[\r\n]/g,"")}return"null or undefined"}function b(x){var y="";if(x&&x.stack&&x.stack.substr){var z=x.stack.split("\n");z=z.map(function(D){var C=D.lastIndexOf("/");if(C>0){D=D.substr(C+1)}return D});return z.join()}try{if(arguments&&arguments.callee){var A=[];var s=arguments.callee.caller;s=s.caller;var v=0;while(s&&v++<20){var t=s.toString();if(t.match(/onErrorFunc/)){s=s.caller;continue}var r=t.length;var u=r>100?100:r;var B=t.substring(0,u);B=B.replace(/(\n|\r|\'|\")/g,"");B+="::";A.push(B);s=s.caller}return A.join(" ")}}catch(w){y="-arguments.callee issue"}return"none"+y}function h(){var r="";[].forEach.call(document.getElementsByTagName("script"),function(u){var t=u.src;if(o(t)){var s=r==""?"":", ";t=t.substring(t.indexOf("/js")+1);r=r+s+t}});if(r.length>f){r=r.substring(0,f)}return r}function o(r){if(!r||!r.indexOf){return false}var s=window.CDNHOST||"";if(window.IS_DEBUG&&s==""){return r.match(/(js3\/|js\/)/)!=null}else{return r.indexOf(s)==0}}function q(s){if(!s||!s.indexOf){return false}var r="noPage";try{r=window.location.href}catch(t){}return s===r}n.createNs(c,"ta.util","error");return c});define("ta/Core/TA.Event",["vanillajs","ta/util/Error","ta/Core/TA.Load","ns-exporter","ta/Core/TA.Store"],function(vanilla,taError,taLoad,nsExporter,taStore){var exports={};var _eventListeners={};exports.call=function(funcName,evnt,elmt){if(evnt==null){if(IS_DEBUG){alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);")}return false}if(funcName==null){if(IS_DEBUG){alert("ta.call of undefined function")}return false}var func=funcName;if(typeof(funcName)==="function"){funcName="<func>"}else{if(!/^ta\.[\w\d\.]+$/.test(funcName)){if(IS_DEBUG){alert("Invalid function name. Must be of the form: ta.namespace.Class.function")}return false}}var e=evnt||window.event;["stopPropagation","preventDefault"].forEach(function(name){if(!e[name]){e[name]=function(){}}});if(!e.stop){e.stop=function(){e.preventDefault();e.stopPropagation()}}if(!elmt){elmt=e.target||e.srcElement}if(!elmt){taError.record(null,"ta.call re-wrap fail (non-DOM element) - "+funcName,evnt,{elmtArg:taError.describe({none:"none"}),funcName:funcName})}var argSet=arguments;var args=Array.prototype.slice.call(argSet,3);args.splice(0,0,e,elmt);try{args.unshift({callback:_ta_call_defer,evt:e});args.unshift(func);return exports.run.apply(null,args)}catch(_ex){taError.record(_ex,"ta.call - "+funcName,evnt)}return false};var _ta_call_defer=function(func,options){if(options){delete (options.evt)}exports.run.apply(null,arguments)};exports.run=function(func,options){var argSet=arguments,args=Array.prototype.slice.call(argSet,2);try{var fn=exports.fn(func);if(typeof fn=="function"){var retVal=fn.apply(window,Array.prototype.slice.call(args));if(options&&options.onComplete){var completeFun=exports.fn(options.onComplete);if(completeFun){completeFun(retVal)}}return retVal}else{if(options&&options.evt){if(options.evt.stopPropagation){options.evt.stopPropagation()}else{options.evt.cancelBubble=true}if(options.evt.preventDefault){options.evt.preventDefault()}else{options.evt.returnValue=false}}}var callback=options&&options.callback;taLoad.load(func,(callback||exports.run).pass(arguments))}catch(_ex){taError.record(_ex,"ta.run - "+func)}return false};exports.on=function(name,f){var v=_eventListeners[name];if(!v){v=_eventListeners[name]=[]}v.push(f)};exports.fireEvent=function(name,_varargs_){var args=Array.prototype.slice.call(arguments),listeners=_eventListeners[name];args.shift();if(listeners){listeners.slice(0).forEach(function(callback){try{callback.apply(null,args)}catch(e){}})}};exports.off=function(name,f){if(f){var v=_eventListeners[name],index;if(v instanceof Array){index=v.indexOf(f);if(index>=0){v.splice(index,1)}}}else{delete _eventListeners[name]}};function QueueTimer(evtName,after){var m_timer=0;var m_totalTime=0;var m_data=[];var m_start=0;var m_done=false;this.start=function(){m_timer&&clearTimeout(m_timer);m_start=Date.now()};this.end=function(name){var now=Date.now();var duration=now-m_start;m_totalTime+=duration;var out=""+duration+"ms ["+(name||"")+"]";var outEvt=evtName+(after?"-after":"");if(m_done){console.error("Straggler for "+outEvt+": "+out)}else{m_data.push(out);m_timer=setTimeout(function(){console.error("Timing for "+outEvt+": "+m_totalTime+"ms\n"+m_data.sort(function(a,b){return parseInt(a)-parseInt(b)}).join("\n"));m_done=true},2000)}}}var OneTimeFunctionQueue=function(evtName,after,runNow){var _queue=[];var _runNow=!!runNow;var _timing;var _execFn=function(fn,name){_timing&&_timing.start();try{fn()}catch(_ex){try{taError.record(_ex,"OneTimeFunctionQueue "+evtName+(after?"-after":"")+(name?"-"+name:""))}catch(ignore){}}_timing&&_timing.end(name)};var _runQueuedFunctions=function(){_queue.sort(function(a,b){return(a.priority-b.priority)||(a.subpriority-b.subpriority)});if(after){var delay=1;_queue.forEach(function(item){setTimeout(_execFn.bind(null,item.func,item.name),delay++)})}else{_queue.forEach(function(item){_execFn(item.func,item.name)})}_queue=[]};if(evtName!=null){function onListener(){_runNow=true;_runQueuedFunctions()}if(window.addEventListener){window.addEventListener(evtName,onListener,false)}else{if(window.attachEvent){if(evtName=="DOMContentLoaded"){window.attachEvent("onload",onListener)}else{if(evtName=="load"){window.attachEvent("on"+evtName,function(){setTimeout(onListener,1)})}else{window.attachEvent("on"+evtName,onListener)}}}}}this.addToQueue=function(fn,priority,name){if(!fn){taError.record(null,"addToQueue for "+evtName+" queue - no function");return}if(typeof priority==="string"){name=priority;priority=false}if(_runNow){_execFn(fn,name)}else{priority=priority||(100+_queue.length);_queue.push({func:fn,priority:priority,name:name,subpriority:_queue.length})}};this.executeQueue=function(){_runQueuedFunctions()}};var loaded=typeof document!=="undefined"?document.readyState==="complete":false;var ready=(typeof document!=="undefined"?document.readyState==="interactive":false)||loaded;var _readyQ=new OneTimeFunctionQueue("DOMContentLoaded",false,ready);var _loadQ=new OneTimeFunctionQueue("load",false,loaded);var _afterLoadQ=new OneTimeFunctionQueue("load",true);if(!ready){_loadQ.addToQueue(function(){_readyQ.executeQueue()},-999999999,"checkReadyQueue")}_loadQ.addToQueue(function(){_afterLoadQ.executeQueue()},999999999,"afterLoadQueue");exports.queueForReady=function(fn,priority,name){_readyQ.addToQueue(fn,priority,name)};exports.queueForLoad=function(fn,priority,name){_loadQ.addToQueue(fn,priority,name)};exports.queueForAfterLoad=function(fn,name){_afterLoadQ.addToQueue(fn,0,name)};exports.hasEventListener=function(name){return !!(_eventListeners[name])};exports.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=false;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null};exports.fireClick=function(node){if(document.createEvent){var evt=document.createEvent("MouseEvents");evt.initEvent("click",true,false);node.dispatchEvent(evt)}else{if(document.createEventObject){node.fireEvent("onclick")}else{if(typeof node.onclick==="function"){node.onclick()}}}};nsExporter.exportTo(exports,ta);return exports});window.ta||(window.ta={});define("ta/util/RecordInterruption",["vanillajs","ta/Core/TA.Record","ta/util/Error"],function(e,a,c){var d="interruption_record";var g=["popup","popunder","gate","other"];var f=function(i,h){c.record(h,i,null,null)};var b=function(j){for(var h=0;h<g.length;h++){if(j===g[h]){return true}}return false};return{record:function(i,h){try{if(!b(i)){f("ta/util/RecordInterruption: Invalid type")}else{if(!h){f("ta/util/RecordInterruption: Name cannot be null or blank")}else{a.trackEventOnPage(d,i,h.replace(",",""),0,true)}}}catch(j){f("ta/util/RecordInterruption: exception tracking event",j)}}}});define("ta/Core/TA.LocalStorage",["vanillajs","ta/util/Error","ns-exporter"],function(q,g,w){var x=false,i="taLsTest",h="1",n="TALocalStorageCurrentSessionId",k=false,l="session-",j=false,A=[];var r=function(){return !!(k||j)};var s=function(e){if(!r()){g.record(null,"Accessing localStorage session cookie before session logic intialized: "+e);return false}return true};var m=function(e){return b(e,"value")};var t=function(e){return b(e,"now")};var b=function(E,G){if(!G){return null}try{var F=JSON.parse(x.getItem(E)||"0"),I;if(!F){return null}if(F.ttl&&F.ttl+F.now<new Date().getTime()){x.removeItem(E);return null}if(!F.hasOwnProperty(G)){return null}x.setItem("512",F[G]);I=x.getItem("512");x.removeItem("512");return I}catch(H){}return null};var y=function(E){try{var F=JSON.parse(x.getItem(E)||"0"),H;if(!F){return null}if(F.ttl&&F.ttl+F.now<new Date().getTime()){x.removeItem(E);return null}return F.value}catch(G){}return null};var D=function(E){try{x.removeItem(E)}catch(F){}};var C=function(E){try{var G=x.getItem(E);if(G!==null&&G!==undefined){return true}}catch(F){}return false};var a=function(F,G,E){try{x.setItem(F,JSON.stringify({ttl:E||0,now:new Date().getTime(),value:G}))}catch(H){}};var o=function(E){j=true;if(!E){g.record(null,"Attempting to initialize localStorage with invalid sesion key: "+E);return false}if(!v()){return false}k=m(n);if(!k||k!=E){k=E;a(n,k);var e=m("latestPageServlet");if(e){a("sessionEntryServlet",e)}d();if(C(n)&&require.defined("ta/Core/TA.Store")){require("ta/Core/TA.Store").store("isFirstSessionPageView",true)}}};var d=function(){try{var G=l+k;var E=new RegExp("^"+l);if(x.length){for(var F=0;F<x.length;F++){var I=x.key(F);try{if(E.test(I)&&I!=G){D(I)}}catch(H){}}}}catch(J){}};var v=function(){try{if(x&&x.setItem){x.setItem(i,h);var F=x.getItem(i)!=h;x.removeItem(i);if(F){x=false}return !!x}}catch(E){}return false};var f=function(E){try{x.setItem("session-"+k,JSON.stringify(E))}catch(F){}};var p=function(){try{var E=x.getItem("session-"+k);if(E){return JSON.parse(E)}}catch(F){}return{}};var c=function(e){A.push(e)};var B={enabled:v(),get:m,getObject:y,set:a,remove:D,has:C,getTimeStamp:t,updateSessionId:o,onSessionStorageChange:c,canUseSession:r,getSessionKey:function(E){if(!s(E)){return null}var e=p();if(e){return e[E]}return null},setSessionKey:function(E,F){if(!s(E)){return}var e=p();if(!e){e={}}e[E]=F;f(e)},removeSessionKey:function(E){if(!s(E)){return}var e=p();if(!e){return}delete e[E];f(e)},hasSessionKey:function(E){if(!s(E)){return false}var e=p();if(e){var F=e[E];if(F!==null&&F!==undefined){return true}}return false},setStorage:function(e){x=e;B.enabled=v()}};if(typeof window!=="undefined"){var z=false;try{z=window.localStorage}catch(u){}B.setStorage(z);(function(){function e(G){G=G||window.event;if(k&&(!G.key||G.key==="session-"+k)){for(var F=0,E=A.length;F<E;F++){A[F](G)}}}if(window.addEventListener){window.addEventListener("storage",e,false)}else{if(window.attachEvent){window.attachEvent("onstorage",e)}}})()}w.createNs(B,"ta","localStorage");return B});define("ta/Core/TA.Prerender",["vanillajs","api-mod","ta/Core/TA.Record","ta/util/Error"],function(c,b,f,a,e){var i={states:{PREFETCH_SENT:"prefetchSent",CLEAR:"clear"}};var g=function(m,o,k,n,l){if(a._validatedTrackEventArray&&a._GARecordRequest){var j=a._validatedTrackEventArray(m,o,k,n,l);a._GARecordRequest(j).get();return true}return false};var h=function(){if("visibilityState" in document){i._visibilityState="visibilityState";i._visibilitystatechanged="visibilitychange";return}var k=["webkit","moz","ms","o"];for(var j=0;j<k.length;j++){if((k[j]+"VisibilityState") in document){i._visibilityState=k[j]+"VisibilityState";i._visibilitystatechanged=k[j]+"visibilitychange"}}};var d=function(){try{if(i._state===i.states.PREFETCH_SENT&&document[i._visibilityState]!=="prerender"){g("Prerender","shown","",0,true);i._state=i.states.CLEAR}}catch(j){e.record(j)}};i._init=function(j){try{i._enabled=j;i._state=i.states.CLEAR;h();if(!i.isSupported()||!i.isEnabled()){return}if(document[i._visibilityState]==="prerender"){if(g("Prerender","prefetch","",0,true)){i._state=i.states.PREFETCH_SENT;document.addEventListener(i._visibilitystatechanged,d,false)}}}catch(k){e.record(k)}};i.isEnabled=function(){return i._enabled};i.isSupported=function(){return i._visibilityState!==undefined};return i});define("ta/projects",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(c,f,g){function b(i,h){return !!(i&&h&&!!i.className.match(new RegExp("\\b"+h+"\\b")))}var e={vals:{},set:function(h,i){e.vals[h]=i},setIfClass:function(j,i,h){if(typeof i=="string"){i=document.getElementById(i)}e.vals[j]=b(i,h)},get:function(h){return e.vals[h]},has:function(h){return h in e.vals}};function d(j,i,h){if(!e.has(j)){e.setIfClass(j,i,h)}return e.get(j)}var a={};a.isHotelsRedesign2011=function(){var h="isHotelsRedesign2011";if(!e.has(h)){if(window.pageServlet=="LastMinute"){e.set(h,true)}else{e.setIfClass(h,"HAC_SMRY","hotels_re_2011")}}return e.get(h)};a.isSmartDealsFilters=function(){return d("smartDealsFilters","DEALS","sdfilters")};a.isAttractionsRedesign2012=function(){return d("isAttractionsRedesign2012","ATTRACTIONS_2012","gridA")};a.isMetaHomepageIntegration2013=function(){return d("isMetaHomepageIntegration2013","PPT","ppt_container")};a.isMetaHotels2013=function(){return d("isMetaHotels2013","PAGE","meta_hotels")};a.isMetaHotelsRequest=function(){return g.has("isMetaHotelsRequest")};a.isHacMap=function(){return g.has("hac.maps.isHacMap")};a.isHRTabs2014=function(){return g.has("hr_tabs_2014")};a.isTabletAlbumViewer=function(){return g.retrieve("tabletAlbumPhotoLightbox.enabled")};a.isTabletRotationCTATest=function(){return g.retrieve("tabletRotationCTATest.enabled")};a.isAirport=function(){return window.pageServlet=="Airport"};f.exportTo(a,"ta");return a});define("ta/Browser",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(d,e,g){var b={};var c;var a=function(){return navigator.userAgent.indexOf("MSIE 10.0")>=0};var f=b.isIE11orHigher=function(){return g.retrieve("ta.isIE11orHigher")};b.isIE9orHigher=function(){return navigator.appVersion.indexOf("MSIE 9")>=0||a()||f()};b.isIE10Metro=function(){return a()&&b.isIEMetro()};b.isIEMetro=function(){var m=g.retrieve("metaCheckRatesDebugFeatureEnabled"),i=null,j=f(),k=j?127:0,h=(window.innerWidth==screen.width&&((screen.height-window.innerHeight)===k));if(m){return true}try{i=!!new ActiveXObject("htmlfile")}catch(l){i=false}return !i&&h&&(j||a())};b.isIE=function(){return navigator.userAgent.indexOf("MSIE")>=0};b.isChrome=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)};b.getFlashVersion=function(){if(typeof(c)!=="number"){var h;try{h=navigator.plugins["Shockwave Flash"].description}catch(k){try{h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(j){}}var i=(h||"0 r0").match(/\d+/g);c=Number(i[0]||"0."+i[1])||0}return c};e.exportTo(b,"ta.browser");return b});define("ta/util/ScreenSizeRecord",["vanillajs","ta/Core/TA.LocalStorage","ta/Core/TA.Record","ta/Core/TA.Event"],function(e,a,c,f){var d="screenSizeRecord";var i="pixelRatioRecord";function g(){var n=document.documentElement,l=document.body,m=window.innerWidth||n.clientWidth||l.clientWidth,k=window.innerHeight||n.clientHeight||l.clientHeight,p=screen.width,o=screen.height;return"s"+p+"x"+o+"b"+m+"x"+k}function j(m){var k=g(),l=a.getSessionKey(d);if(k!==l){a.setSessionKey(d,k);c.trackEventOnPage("screenSizeRecord",m,k)}}function b(){if(!ta.retrieve("pixelRatioRecord")){return}var k=a.getSessionKey(i);if(k){return}if(window.devicePixelRatio>1){c.trackEventOnPage("pixelRatioRecord","load","retina",window.devicePixelRatio,true)}a.setSessionKey(i,true)}function h(){if(!ta.retrieve("screenSizeRecord")||!a.enabled){return}j("load");b();var l;function k(){if(l){clearTimeout(l)}l=setTimeout(function(){j("resize")},250)}if(window.addEventListener){window.addEventListener("resize",k,false)}else{if(window.attachEvent){window.attachEvent("onresize",k)}}}f.queueForLoad(h,"ScreenSizeRecord.onLoad")});define("ta/util/Cookie",["vanillajs","ta/util/Error","ns-exporter","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Event"],function(e,b,i,h,c,f){var j=0;var a=5000;var d={cookiePIDName:"NPID",ONE_DAY:86400000,ONE_HOUR:3600000,setPIDCookie:function(k){try{d.write(d.cookiePIDName,k,a,"/",window.cookieDomain)}catch(l){var m=window.cookieDomain||"";b.record(l,"set pid cookie",null,{pid:k,cookieDomain:m})}},removePIDCookie:function(){try{d.write(d.cookiePIDName,"",j,"/",window.cookieDomain)}catch(k){}},openWindowWithPID:function(l,k){if(k){d.setPIDCookie(k)}window.open(l,"_blank");d.removePIDCookie()},setAjaxAction:function(m,k){if(m[0]!="/"){m="/"+m}m="target:"+m;try{var o=Array.prototype.splice.call(arguments).join("|");d.write("ajaxAction",o,null,"/",window.cookieDomain)}catch(l){var n=window.cookieDomain||"";b.record(l,"set pid cookie",null,{pid:pid,cookieDomain:n})}},setPIDNoA:function(k){pid=k.className.match(/pid(\d+)/);if(pid){d.setPIDCookie(pid[1])}},canSet:function(){document.cookie="SessionTest=true";if(document.cookie.match("(^|;)\\s*SessionTest=true\\s*(;|$)")){document.cookie="SessionTest=; expires=Thu, 01 Jan 1970 00:00:01 GMT";return true}return false},readRaw:function(k){k=k.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1");var l=document.cookie.match(new RegExp("(?:^|;)\\s*"+k+"=([^;]*)"));return l?l[1]:false},remove:function(l,m,k){d.write(l,"",new Date(1000),m,k)},write:function(m,n,l,o,k){if(typeof l=="number"){l=new Date(Date.now()+l)}document.cookie=m+"="+n+(l?"; expires="+l.toUTCString():"")+(o?"; path="+o:"")+(k?"; domain="+k:"")},setOneTimeCookieOnFQDN:function(k,l){d.write(k,l,5000);return true}};f.queueForLoad(function g(){if(!window.taSecureToken){return}try{var o=d.readRaw("roybatty");if(!window.taEarlyRoyBattyStatus){if(!o){d.write("roybatty",taSecureToken+",1",null,"/",cookieDomain);var m=require.defined("ta/Browser")?require("ta/Browser"):null;if(m&&m.isIEMetro&&m.isIEMetro()){h("/CookiePingback?metroBrowser=true")}else{h("/CookiePingback")}}else{var l=o.split(",");if(l&&l.length==2){var k=parseInt(l[1],10);d.write("roybatty",taSecureToken+","+k,null,"/",cookieDomain)}else{if(l&&l.length==1){d.write("roybatty",taSecureToken)}else{b.record(null,"royBatty -- Bad value in cookie: "+o)}}}}c.store("roybatty.checked",true)}catch(n){b.record(n,"javascript exection bot detection error")}},"RoyBatty");i.exportTo({setPID:d.setPIDCookie},window);i.createNs(d,"ta.util","cookie");return d});define("popunder/utils",["vanillajs","ta/util/Object"],function(f,b){function c(){return{height:window.outerHeight||document.documentElement.clientHeight,width:window.outerWidth||document.documentElement.clientWidth,left:window.screenLeft||window.screenX||0,top:window.screenTop||window.screenY||0}}function d(){var g=(ta.page&&ta.page.hasDates&&ta.page.hasDates("STAYDATES"))||(ta.widgets&&ta.widgets.calendar&&ta.widgets.calendar.hasPageDates());if(ta.ab&&ta.ab.roomlist&&ta.ab.roomlist.getData){var h=ta.ab.roomlist.getData();if(h&&h.summary){g=!!(h.summary.checkin&&h.summary.checkOut)}}return g}function a(){var g=window.modelGeoId;var i=window.modelLocId;if(ta.ab&&ta.ab.roomlist&&ta.ab.roomlist.getData){var h=ta.ab.roomlist.getData();if(h&&h.summary){g=h.summary.geoId;i=h.summary.locationId}}return{geoId:g,locId:i}}function e(h){var g=Array.prototype.slice.call(arguments,1);return h?b.merge.apply(null,g):g[0]}return{getWindowInfo:c,isDated:d,getLocationModel:a,mergeIfTrue:e}});define("mixins/mixin",["vanillajs"],function(a){return function(e){var c=Array.prototype.slice.call(arguments,1),b,f;for(var d in c){if(!c.hasOwnProperty(d)){continue}b=c[d];for(f in b){e[f]=b[f]}}return e}});define("popunder/context/base-context",["mixins/mixin","mixins/Events","popunder/utils","vanillajs"],function(b,a,e,d){var c=function(f){return b(this,new a("activate"),f)};c.prototype={init:function(){},isActive:function(){return true},generateUrl:function(){return"/PricefinderPopunder?content=PCB"},generateModel:function(){return{hasDates:e.isDated()}},servletName:"PricefinderPopunder?PCB"};return c});define("popunder/context/default",["popunder/context/base-context","vanillajs"],function(b,a){return new b({isActive:function(){return ta&&ta.localStorage&&ta.localStorage.enabled},generateUrl:function(c){return"/CpmForward"},servletName:"CpmForward"})});define("popunder/context/attraction-review",["popunder/context/base-context","popunder/utils","vanillajs"],function(c,b,a){return new c({isActive:function(){return window.pageServlet==="Attraction_Review"},generateUrl:function(d){return"/SmartDeals-g"+d.geoId+"-d"+d.locId},generateModel:function(){return b.mergeIfTrue(this.isActive(),c.prototype.generateModel(),b.getLocationModel())},servletName:"HotelsNearSD"})});define("popunder/context/geo-hotels",["popunder/context/base-context","popunder/utils","vanillajs"],function(c,b,a){return new c({isActive:function(){return window.pageServlet==="Hotels"},generateUrl:function(d){return"/SmartDeals-g"+d.geoId},generateModel:function(){return b.mergeIfTrue(this.isActive(),c.prototype.generateModel(),b.getLocationModel())},servletName:"SmartDeals"})});define("popunder/context/hotel-detail",["popunder/context/base-context","popunder/utils","vanillajs"],function(c,b,a){return new c({isActive:function(){return window.pageServlet==="Hotel_Review"},generateUrl:function(d){return"/Hotel_Review-s1-g"+d.geoId+"-d"+d.locId},generateModel:function(){return b.mergeIfTrue(this.isActive(),c.prototype.generateModel(),b.getLocationModel())},servletName:"HotelHighlight"})});define("popunder/context/ib-abandoner-survey",["ta","popunder/context/base-context","popunder/utils","vanillajs"],function(a,e,d,c){var b=false;return new e({init:function(){var f=this;if(window.pageServlet==="HotelBookingRoomSelectionHtml"){a.addEvent(window,"beforeunload",function(){b=true;f.emit("activate")})}},isActive:function(){return b},generateModel:function(){return d.mergeIfTrue(this.isActive(),e.prototype.generateModel(),d.getLocationModel())},generateUrl:function(f){return"/PricefinderPopunder?content=BOOKING_SURVEY"}})});define("popunder/context/flights",["ta","popunder/context/base-context","popunder/utils","vanillajs"],function(a,d,c,b){return new d({isActive:function(){return window.pageServlet==="CheapFlightsSearchResults"&&a.retrieve("flights.suppressExitUnit")!==true},generateModel:function(){return c.mergeIfTrue(this.isActive(),d.prototype.generateModel(),{customParams:a.retrieve("flights.exitUnitParams")})},generateUrl:function(e){return"/FlightsExitUnit?"+e.customParams},servletName:"FlightsExitUnit"})});define("popunder/context/smarter_travel",["popunder/context/base-context","popunder/utils","vanillajs"],function(c,b,a){return new c({isActive:function(){return(window.pageServlet==="Hotels"||window.pageServlet==="Hotel_Review")&&b.isDated()},generateModel:function(){return b.mergeIfTrue(this.isActive(),c.prototype.generateModel(),b.getLocationModel())},generateUrl:function(d){return"/PricefinderPopunder?content=SMARTER_TRAVEL&g="+d.geoId},servletName:"SmarterTravelLander"})});define("popunder/context/smartdeals",["popunder/context/base-context","popunder/utils","vanillajs"],function(c,b,a){return new c({isActive:function(){return window.pageServlet==="SmartDeals"},generateUrl:function(d){return"/Hotels-g"+d.geoId},generateModel:function(){return b.mergeIfTrue(this.isActive(),c.prototype.generateModel(),b.getLocationModel())},servletName:"Hotels"})});define("popunder/context/hotelhighlight",["popunder/context/base-context","popunder/utils","vanillajs"],function(c,b,a){return new c({isActive:function(){return window.pageServlet==="HotelHighlight"},generateUrl:function(d){return"/Hotels-g"+d.geoId},generateModel:function(){return b.mergeIfTrue(this.isActive(),c.prototype.generateModel(),b.getLocationModel())},servletName:"Hotels"})});define("popunder/context-store",["vanillajs","popunder/context/base-context","popunder/context/default","popunder/context/attraction-review","popunder/context/geo-hotels","popunder/context/hotel-detail","popunder/context/ib-abandoner-survey","popunder/context/flights","popunder/context/smarter_travel","popunder/context/smartdeals","popunder/context/hotelhighlight"],function(g,k,f,i,e,a,b,d,j,h,c){return{ATTRACTION_REVIEW:i,DEFAULT:f,FALLBACK:new k(),GEO_HOTELS:e,HOTEL_DETAIL:a,IB_ABANDONER_SURVEY:b,FLIGHTS:d,SMARTER_TRAVEL:j,SMART_DEALS:h,HOTEL_HIGHLIGHT:c}});define("popunder/context-manager",["vanillajs","ta/util/Object","ta/Core/TA.LocalStorage","popunder/context-store"],function(f,d,o,a){var b="pu_context";function c(s){var u=a[s],r=u.generateModel(),t=e();if(s===t.type){return d.merge({},t,r)}else{return d.merge({type:s},r)}}function e(){var r;if(o.enabled&&o.canUseSession()){r=o.getSessionKey(b);r=n(r)?r:null}return r||{type:"FALLBACK",geoId:null,locId:null}}function n(r){return !!(r&&a[r.type])}function k(r){if(o.enabled&&o.canUseSession()){o.setSessionKey(b,r)}}function j(s,r){k(d.merge(c(s),r))}function q(){var s=e(),r=a[s.type];return r.generateUrl(s)}function p(){var s=e(),r=a[s.type];return r.servletName}function m(){var r=e();return(a[r.trackingType]||a[r.type]).servletName}function i(){var r=e();return r.trackingType||r.type}function h(){return e().hasDates}function g(){return e().geoId}function l(){return e().type}return{updateType:j,getContextualUrl:q,getContextualServletName:p,getTrackingServletName:m,getTrackingType:i,isDated:h,getGeoId:g,getType:l}});require(["ta/rollupAmdShim"],function(a){a.install(["popunder/popunder-manager","popunder/chrome-new-window-strategy","popunder/chrome-two-click-new-window-strategy","popunder/console-strategy","popunder/ff-new-window-strategy","popunder/ie-new-window-strategy","popunder/safari-new-window-strategy","popunder/contextual-provider"],["ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"popunder",files:{"js-amd":{src:{popunder:{"ff-new-window-strategy":1,"chrome-new-window-strategy":1,"safari-new-window-strategy":1,"contextual-provider":1,"ie-new-window-strategy":1,"popunder-manager":1,"console-strategy":1,"chrome-two-click-new-window-strategy":1}}}},_:{baseUrl:"/"}})};define("popunder/popunder-manager",["vanillajs","api-mod","ta/Browser","utils/browserutils","ta/util/Cookie","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.Record","ta/util/Error"],function(p,m,f,a,k,i,u,s,h){var v=1000*60*60*24;var o,l,g=false;function t(y,w,x){o=y;l=w;if(!o||!l||window.name==="POPUNDER_CONTENT_FRAME"){return}!x&&b()}function r(x){if(f.isIE10Metro()){return"ie10metro"}if(!x.target){return false}if(window.noPopClass&&m.elementOrParentMatches(x.target,function(y){return m.hasClass(y,window.noPopClass)})){return"no_cpu_class"}var w=x.target.onclick;if(w&&w.toString&&w.toString().match(/window\.open/g)){return"onclick_script"}if(m.elementOrParentMatches(x.target,function(y){return y.target&&y.tagName==="A"})){return"has_target"}return false}function d(x,y){var w,z;if(x==="unload"&&a.chrome){return"Chrome_unload"}if(g&&x==="unload"&&!window.isTakeOver){return"paused"}if(!k.canSet()){return"failed_cookie_check"}w=k.readRaw("CommercePopunder");if(w&&(w!=="SuppressUnload"||x!=="click")){return"already_popped"}if(window.location.protocol==="http:"&&u.has("httpsDestination")){return"http_to_https"}if(x==="click"){z=r(y);if(z){return z}}if(typeof blockPU!=="undefined"&&blockPU){return"block_pu"}return false}function e(w){w=w||window.event;if(!g&&w.target&&m.elementOrParentMatches(w.target,function(x){return x.tagName==="A"})){g=true;setTimeout(c,1000)}}function c(){g=false}function b(){m.addEvent(document,"click",e);m.addEvent(document,"click",j.bind(null,"click"));m.addEvent(window,"beforeunload",j.bind(null,"unload"))}function n(x){var w=new Date(new Date().getTime()+v);k.write("CommercePopunder",x,w)}function j(x,z){var D,B,w;if(!o){return}w=l.getContentInfo();if(!w){return}D=d(x,z);if(D){return}var A=k.readRaw(k.cookiePIDName);if(u.has("suppress_pop_under_tracking")){s.trackEventOnPage("Pop_Under",u.has("suppress_pop_under")?"Would_Have_Been_Triggered":"Triggered",l.getTrackingServletName())}if(u.has("suppress_pop_under")){if(u.has("suppress_pop_under_tracking")){n("SuppressAll*"+new Date().getTime())}if(A){k.setPIDCookie(A)}return}try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(y){h.record(y,"commercePopunder - localStorage after before pop",null,{},"WARN")}B={name:"CommercePopunder",url:w.url,width:w.size.width,height:w.size.height,event:z};i.fireEvent("onPopunderBlur");try{localStorage.setItem("CommercePopunder.fallbackRelativeUrl","/PricefinderPopunder?content=PCB")}catch(C){}if(o.spawn(B)){q(w.url);n("SuppressAll*"+new Date().getTime())}else{h.record(null,"commercePopunder - past rules, no pop",null,{},"WARN");if(x==="unload"){n("SuppressUnload")}}if(A){k.setPIDCookie(A)}}function q(C){try{if(!C){return}var y="CommerceEnhancedPopunder";if(C.match(/AlsoViewedLB/)){y="AlsoViewedLB"}else{var w=C.match(/RuleBasedPopunder\?Rule=\d+/);if(w){var z=w[0].match(/\d+/);y="RuleBasedPopunder_"+z[0]}}var x="OpenWindow";var B=u.retrieve("checkrates.HWtracking");if(B){x="OpenWindow_"+B;u.remove("checkrates.HWtracking")}s.trackEventOnPage("CommercePopunder",x,y,"popunder",true)}catch(A){h.record(A,"CommercePopunder - trackPopunder")}}return{init:t}});define("popunder/chrome-new-window-strategy",["vanillajs","popunder/utils"],function(vanilla,Utils){var PDF_BASE64_DATA="data:application/pdf;base64, JVBERi0xLjMKJf////8KMSAwIG9iago8PCAvQ3JlYXRvciAoUHJhd24pCi9Qcm9kdWNlciAoUHJhd24pCj4+CmVuZG9iagoyIDAgb2JqCjw8IC9UeXBlIC9QYWdlcwovQ291bnQgMQovS2lkcyBbNSAwIFJdCj4+CmVuZG9iagozIDAgb2JqCjw8IC9UeXBlIC9DYXRhbG9nCi9QYWdlcyAyIDAgUgovTmFtZXMgNyAwIFIKPj4KZW5kb2JqCjQgMCBvYmoKPDwgL0xlbmd0aCA3Ngo+PgpzdHJlYW0KL0RldmljZVJHQiBjcwowLjAwMCAwLjAwMCAwLjAwMCBzY24KL0RldmljZVJHQiBDUwowLjAwMCAwLjAwMCAwLjAwMCBTQ04KcQpRCgplbmRzdHJlYW0KZW5kb2JqCjUgMCBvYmoKPDwgL1R5cGUgL1BhZ2UKL1BhcmVudCAyIDAgUgovTWVkaWFCb3ggWzAgMCA2MTIuMCA3OTIuMF0KL0NvbnRlbnRzIDQgMCBSCi9SZXNvdXJjZXMgPDwgL1Byb2NTZXQgWy9QREYgL1RleHQgL0ltYWdlQiAvSW1hZ2VDIC9JbWFnZUldCj4+Cj4+CmVuZG9iago2IDAgb2JqCjw8IC9TIC9KYXZhU2NyaXB0Ci9KUyA8ZmVmZjAwNjEwMDcwMDA3MDAwMmUwMDYxMDA2YzAwNjUwMDcyMDA3NDAwMjgwMDI3MDA0ZjAwNmUwMDY1MDAyMDAwNmQwMDZmMDA2ZDAwNjUwMDZlMDA3NDAwMjAwMDcwMDA2YzAwNjUwMDYxMDA3MzAwNjUwMDJlMDAyZTAwMmUwMDI3MDAyOT4KPj4KZW5kb2JqCjcgMCBvYmoKPDwgL1R5cGUgL05hbWVzCi9KYXZhU2NyaXB0IDggMCBSCj4+CmVuZG9iago4IDAgb2JqCjw8IC9OYW1lcyBbKHh5enp5KSA2IDAgUl0KPj4KZW5kb2JqCnhyZWYKMCA5CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNSAwMDAwMCBuIAowMDAwMDAwMDcxIDAwMDAwIG4gCjAwMDAwMDAxMjggMDAwMDAgbiAKMDAwMDAwMDE5MCAwMDAwMCBuIAowMDAwMDAwMzE2IDAwMDAwIG4gCjAwMDAwMDA0NzAgMDAwMDAgbiAKMDAwMDAwMDY0OSAwMDAwMCBuIAowMDAwMDAwNzAxIDAwMDAwIG4gCnRyYWlsZXIKPDwgL1NpemUgOQovUm9vdCAzIDAgUgovSW5mbyAxIDAgUgo+PgpzdGFydHhyZWYKNzQ1CiUlRU9GCg";var chromeHoldingWindowInit=function(){var intervalId=null,isPopunderHandlers=[],stnData={height:null,left:null,top:null,url:null,width:null},windowOpeningDone=false,addPopunderHandler=function addPopunderHandler(handler){isPopunderHandlers.push(handler)},setStnData=function setStnData(data){if(!data){return}["left","top","height","width","url"].forEach(function(key){stnData[key]=data[key]||stnData[key]||null})},wrapupStn=function wrapupStn(closeWhenInvalid){if(!stnData.url||!isPopunder()){if(closeWhenInvalid){window.close()}return}window.clearInterval(intervalId);window.moveTo(stnData.left,stnData.top);window.resizeTo(stnData.width,stnData.height);window.location.href=stnData.url},blurHandler=function blurHandler(event){window.removeEventListener("blur",blurHandler);isPopunderHandlers.push=function(handler){handler()};isPopunderHandlers.forEach(isPopunderHandlers.push)},focusHandler=function focusHandler(event){window.removeEventListener("focus",focusHandler);windowOpeningDone=true;window.addEventListener("blur",blurHandler);_startStateChecking()},isPopunder=function isPopunder(){return windowOpeningDone&&!window.document.hasFocus()&&(window.opener&&window.opener.document.hasFocus()||window.openerCopy&&window.openerCopy.document.hasFocus())},_startStateChecking=function startStateChecking(){_startStateChecking=function startStateChecking(){};intervalId=window.setInterval(function(){if(!isPopunder()){return}wrapupStn()},100)};window.resizeTo(0,navigator.userAgent.indexOf("Macintosh")!==-1?0:1);window.moveTo(9999,9999);window.addEventListener("focus",focusHandler);window.setTimeout(function(){_startStateChecking()},10000);window.setTimeout(function(){window.wrapupStn(true)},60000);window.addPopunderHandler=addPopunderHandler;window.setStnData=setStnData;window.wrapupStn=wrapupStn},chromeHoldingWindowInitTechnique="<script>("+chromeHoldingWindowInit.toString()+")()<\/script>";function executeTechnique(name,url,windowLeft,windowTop,windowHeight,windowWidth){var popupWindow=window.open("about:blank",name,"scrollbars=yes,resizeable=yes,height=1,width=1,top=9999,left=9999"),popupDoc,clearPdfAlert=function(){window.clearTimeout(timeoutId);iframe.src="about:blank";window.document.body.removeChild(iframe)},iframe,timeoutId;if(!popupWindow){return null}popupDoc=popupWindow.document.open();popupDoc.write(chromeHoldingWindowInitTechnique);popupDoc.close();popupWindow.setStnData({url:url,left:windowLeft,top:windowTop,height:windowHeight,width:windowWidth});_updateHolder(popupWindow);iframe=_injectPdf();popupWindow.addPopunderHandler(function(){clearPdfAlert();popupWindow.wrapupStn()});timeoutId=window.setTimeout(clearPdfAlert,2000);return popupWindow}function _updateHolder(popupWindow){eval(function(p,a,c,k,e,d){e=function(c){return c};if(!"".replace(/^/,String)){while(c--){d[c]=k[c]||c}k=[function(e){return d[e]}];e=function(){return"\\w+"};c=1}while(c--){if(k[c]){p=p.replace(new RegExp("\\b"+e(c)+"\\b","g"),k[c])}}return p}("0.2=0.1;0.1=3;",4,4,"popupWindow|opener|openerCopy|null".split("|"),0,{}))}function _injectPdf(){var iframeDoc=void 0,pdfContainer=void 0,iframe=void 0,pdfData=void 0;iframe=window.document.createElement("iframe");iframe.style.display="none";window.document.body.appendChild(iframe);iframeDoc=iframe.contentDocument;pdfContainer=iframeDoc.createElement("div");iframeDoc.body.appendChild(pdfContainer);pdfData=PDF_BASE64_DATA+Math.floor(900*Math.random())+100;pdfContainer.innerHTML='<object data="'+pdfData+'"></object>';return iframe}function _spawn(options){var popunder,wInfo=Utils.getWindowInfo();try{popunder=executeTechnique(options.name,options.url,wInfo.left+(wInfo.width-options.width)/2,wInfo.top+(wInfo.height-options.height)/2,options.height,options.width)}catch(e){popunder=null}return popunder}return{spawn:_spawn}});define("popunder/chrome-two-click-new-window-strategy",["vanillajs","popunder/utils"],function(d,f){var b=function(){var q=null,g=[],j={height:null,left:null,top:null,url:null,width:null},h=false,l=function l(s){g.push(s)},r=function r(s){if(!s){return}["left","top","height","width","url"].forEach(function(t){j[t]=s[t]||j[t]||null})},k=function k(s){if(!j.url||!p()){if(s){window.close()}return}window.clearInterval(q);window.moveTo(j.left,j.top);window.resizeTo(j.width,j.height);window.location.href=j.url},m=function m(s){window.removeEventListener("blur",m);g.push=function(t){t()};g.forEach(g.push)},n=function n(s){window.removeEventListener("focus",n);h=true;window.addEventListener("blur",m);o()},p=function p(){return h&&!window.document.hasFocus()&&window.opener.document.hasFocus()},o=function i(){o=function s(){};q=window.setInterval(function(){if(!p()){return}k()},100)};window.resizeTo(0,navigator.userAgent.indexOf("Macintosh")!==-1?0:1);window.moveTo(9999,9999);window.addEventListener("focus",n);window.setTimeout(function(){o()},10000);window.setTimeout(function(){window.wrapupStn(true)},60000);window.addPopunderHandler=l;window.setStnData=r;window.wrapupStn=k},c="<script>("+b.toString()+")()<\/script>";function e(h,g,l,m,n,k){var j=window.open("about:blank",h,"scrollbars=yes,resizeable=yes,height=1,width=1,top=9999,left=9999"),i;if(!j||!j.document){return null}i=j.document.open();i.write(c);i.close();if(!j.setStnData||!j.addPopunderHandler||!j.wrapupStn){j.close();return null}j.setStnData({url:g,left:l,top:m,height:n,width:k});j.addPopunderHandler(function(){j.wrapupStn()});return j}function a(h){var g,i=f.getWindowInfo();try{g=e(h.name,h.url,i.left+(i.width-h.width)/2,i.top+(i.height-h.height)/2,h.height,h.width)}catch(j){g=null}return g}return{spawn:a}});define("popunder/console-strategy",["vanillajs"],function(a){return{spawn:function(b){console.log("Spawning popunder with options: ",b);return true}}});define("popunder/ff-new-window-strategy",["vanillajs","popunder/utils"],function(a,b){return{spawn:function(d){var c,e=b.getWindowInfo(),f=function(){c.blur();window.focus();try{c.moveTo(e.left+(e.width-d.width)/2,e.top+(e.height-d.height)/2);c.resizeTo(d.width,d.height)}catch(h){}};window.open("javascript:window.blur();","_self","");c=window.open(d.url,d.name,"toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=1,height=1,left="+(e.left+e.width)+",top="+(e.top+e.height));if(!c){return false}var g=new Promise(function(i,h){window.onfocus=function(){i(window.document.hasFocus())};setTimeout(f,100)});g.then(function(h){if(!h){c.onload=f()}window.onfocus=""});return c}}});define("popunder/ie-new-window-strategy",["vanillajs","popunder/utils"],function(a,b){return{spawn:function(d){var c,e=b.getWindowInfo();c=window.open(d.url,d.name,"toolbar=1,location=1,directories=1,status=1,menubar=0,resizable=1,copyhistory=1,scrollbars=1,width=1,height=1,left="+(e.left+e.width)+",top="+(e.top+e.height));if(!c){return false}c.blur();window.focus();window.document.focus();if(window.event&&window.event.srcElement){window.event.srcElement.focus()}c.moveTo(e.left+(e.width-d.width)/2,e.top+(e.height-d.height)/2);c.resizeTo(d.width,d.height);return c}}});define("popunder/safari-new-window-strategy",["vanillajs","popunder/utils"],function(a,b){return{spawn:function(e){var c,f=b.getWindowInfo(),d=window.name;document.domain=window.location.hostname;c=window.open(e.url,e.name,"toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=1,height=1,left="+(f.left+f.width)+",top="+(f.top+f.height));if(!c){return false}c.blur();window.focus();if(!d){d=window.location.host.replace(/[-.]/g,"");window.name=d}window.open("",d);window.focus();c.moveTo(f.left+(f.width-e.width)/2,f.top+(f.height-e.height)/2);c.resizeTo(e.width,e.height);return c}}});define("popunder/contextual-provider",["vanillajs","ta","ta/Core/TA.Event","popunder/context-manager","popunder/context-store","popunder/utils"],function(d,h,j,a,b,o){var l={};var f=false;function e(r){var s=l[r];return s?s.priority:undefined}function m(r){var s=l[r];return s?s.behaviour:undefined}function c(s){var r;for(r in l){if(!l.hasOwnProperty(r)){continue}s(r)}}function n(s){var r=null;c(function(t){var v=b[t],u=e(t),x=m(t),w=e(r);if(v.isActive()&&(x==="INCLUDE"||(s&&x==="TRACK"))&&(w===undefined||u>=w)){r=t}});return r||"DEFAULT"}function g(u){var x=a.getType(),t=a.getTrackingType(),y=n(),v=n(true),s=e(x),r=e(y);u=u||{};u.trackingType=(e(v)>=e(t))?v:t;var w=(!x||s===undefined||r>s)?y:x;a.updateType(w,u)}function i(){var r=f?((screen&&screen.height*0.9)||796):696;var t=668;var s=o.getWindowInfo().height;r=Math.max(r,t);if(s>t){r=Math.min(r,s)}return{size:{width:1040,height:r},url:"/PriceFinderPopunder"}}function p(){return a.getTrackingServletName()}function k(){c(function(r){b[r].on("activate",g).init()})}function q(s,r){l=s;f=r;k();g();if(h.page&&h.page.usingUnifiedDates){h.page.on("dateSelected",function(u,t){if(t==="STAYDATES"){setTimeout(g,5000)}})}else{j.on("newInlinePageDates",function(){setTimeout(g,5000)});j.on("onHACUpdateComplete",function(){setTimeout(g,5000)})}}return{init:q,getContentInfo:i,getTrackingServletName:p}});define("utils/BatchRequest",["utils/ajax","ta","api-mod","vanillajs"],function(i,c,e,f){var h=1000;var g=10*1000;var a={};function d(k,j){a[k]=a[k]||[];a[k].push(j);c.throttle(b,"batched-request",h,g)}function b(){for(var j in a){if(!a.hasOwnProperty(j)){continue}i({type:"post",url:j,data:{batched:true,data:a[j]}})}a={}}e.addEvent(window,"onpagehide" in window?"pagehide":"unload",b);return{queue:d}});require(["ta/rollupAmdShim"],function(a){a.install([],[])});define("ta/util/Deferred",["vanillajs","ns-exporter"],function(e,j){var k=["success","failure","always","progress"];var b={resolved:["success","always"],rejected:["failure","always"]};var g=function(){};function l(i){g.prototype[i]=function(n,m){return a(this,i,m?n.bind(m):n)}}for(var c=0;c<k.length;c++){l(k[c])}g.prototype.then=function(m,n){var i=this.success(m);return n?i.failure(n):i};var h=function(o){var i="pending";var n=new g();n.queue=[];n.args=null;n.aplus=(typeof o==="boolean")&&o;n.status=function(){return i};var m={notify:function(){if(d(i)){throw new Error("Promise has already been fulfilled.")}var q=Array.prototype.slice.call(arguments);var s,r,p;for(r=0,p=n.queue.length;r<p;r++){s=n.queue[r];if(s.hook==="progress"){s.callback.apply(null,q)}}return n},resolve:function(){if(d(i)){throw new Error("Promise has already been fulfilled.")}i="resolved";n.args=Array.prototype.slice.call(arguments);return f(n)},reject:function(){if(d(i)){throw new Error("Promise has already been fulfilled.")}i="rejected";n.args=Array.prototype.slice.call(arguments);return f(n)},isFulfilled:function(){return d(i)},promise:function(){return n}};return m};var d=function(i){return i==="resolved"||i==="rejected"};var a=function(m,i,n){if(m.fwd){return a(m.fwd,i,n)}m.queue.push({hook:i,callback:n});return f(m)};var f=function(n){if(n.fwd){return f(n.fwd)}var m,i;while(d(n.status())&&(m=n.queue.shift())){if(~b[n.status()].indexOf(m.hook)){i=m.callback.apply(null,n.args);if(i instanceof g){i.queue=i.queue.concat(n.queue.splice(0));n=n.fwd=i}else{if(i&&n.aplus){n.args=[i]}}}}return n};j.createNs(h,"ta.util","Deferred");return h});/* Dust - Asynchronous Templating - v2.3.5
* http://linkedin.github.io/dustjs/
* Copyright (c) 2014 Aleksander Williams; Released under the MIT License */
(function(root){var dust={},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",loggingLevels=[DEBUG,INFO,WARN,ERROR,NONE],EMPTY_FUNC=function(){},logger={},originalLog,loggerContext;dust.debugLevel=NONE;dust.silenceErrors=false;if(root&&root.console&&root.console.log){loggerContext=root.console;originalLog=root.console.log}logger.log=loggerContext?function(){if(typeof originalLog==="function"){logger.log=function(){originalLog.apply(loggerContext,arguments)}}else{logger.log=function(){var message=Array.prototype.slice.apply(arguments).join(" ");originalLog(message)}}logger.log.apply(this,arguments)}:function(){};dust.log=function(message,type){type=type||INFO;if(dust.debugLevel!==NONE&&dust.indexInArray(loggingLevels,type)>=dust.indexInArray(loggingLevels,dust.debugLevel)){if(!dust.logQueue){dust.logQueue=[]}dust.logQueue.push({message:message,type:type});logger.log("[DUST "+type+"]: "+message)}if(!dust.silenceErrors&&type===ERROR){if(typeof message==="string"){throw new Error(message)}else{throw message}}};dust.onError=function(error,chunk){logger.log("[!!!DEPRECATION WARNING!!!]: dust.onError will no longer return a chunk object.");dust.log(error.message||error,ERROR);if(!dust.silenceErrors){throw error}else{return chunk}};dust.helpers={};dust.cache={};dust.register=function(name,tmpl){if(!name){return}dust.cache[name]=tmpl};dust.render=function(name,context,callback){var chunk=new Stub(callback).head;try{dust.load(name,chunk,Context.wrap(context,name)).end()}catch(err){dust.log(err,ERROR)}};dust.stream=function(name,context){var stream=new Stream();dust.nextTick(function(){try{dust.load(name,stream.head,Context.wrap(context,name)).end()}catch(err){dust.log(err,ERROR)}});return stream};dust.renderSource=function(source,context,callback){return dust.compileFn(source)(context,callback)};dust.compileFn=function(source,name){name=name||null;var tmpl=dust.loadSource(dust.compile(source,name));return function(context,callback){var master=callback?new Stub(callback):new Stream();dust.nextTick(function(){if(typeof tmpl==="function"){tmpl(master.head,Context.wrap(context,name)).end()}else{dust.log(new Error("Template ["+name+"] cannot be resolved to a Dust function"),ERROR)}});return master}};dust.load=function(name,chunk,context){var tmpl=dust.cache[name];if(tmpl){return tmpl(chunk,context)}else{if(dust.onLoad){return chunk.map(function(chunk){dust.onLoad(name,function(err,src){if(err){return chunk.setError(err)}if(!dust.cache[name]){dust.loadSource(dust.compile(src,name))}dust.cache[name](chunk,context).end()})})}return chunk.setError(new Error("Template Not Found: "+name))}};dust.loadSource=function(source,path){return eval(source)};if(Array.isArray){dust.isArray=Array.isArray}else{dust.isArray=function(arr){return Object.prototype.toString.call(arr)==="[object Array]"}}dust.indexInArray=function(arr,item,fromIndex){fromIndex=+fromIndex||0;if(Array.prototype.indexOf){return arr.indexOf(item,fromIndex)}else{if(arr===undefined||arr===null){throw new TypeError('cannot call method "indexOf" of null')}var length=arr.length;if(Math.abs(fromIndex)===Infinity){fromIndex=0}if(fromIndex<0){fromIndex+=length;if(fromIndex<0){fromIndex=0}}for(;fromIndex<length;fromIndex++){if(arr[fromIndex]===item){return fromIndex}}return -1}};dust.nextTick=(function(){return function(callback){setTimeout(callback,0)}})();dust.isEmpty=function(value){if(dust.isArray(value)&&!value.length){return true}if(value===0){return false}return(!value)};dust.filter=function(string,auto,filters){if(filters){for(var i=0,len=filters.length;i<len;i++){var name=filters[i];if(name==="s"){auto=null}else{if(typeof dust.filters[name]==="function"){string=dust.filters[name](string)}else{dust.log("Invalid filter ["+name+"]",WARN)}}}}if(auto){string=dust.filters[auto](string)}return string};dust.filters={h:function(value){return dust.escapeHtml(value)},j:function(value){return dust.escapeJs(value)},u:encodeURI,uc:encodeURIComponent,js:function(value){if(!JSON){dust.log("JSON is undefined.  JSON stringify has not been used on ["+value+"]",WARN);return value}else{return JSON.stringify(value)}},jp:function(value){if(!JSON){dust.log("JSON is undefined.  JSON parse has not been used on ["+value+"]",WARN);return value}else{return JSON.parse(value)}}};function Context(stack,global,blocks,templateName){this.stack=stack;this.global=global;this.blocks=blocks;this.templateName=templateName}dust.makeBase=function(global){return new Context(new Stack(),global)};Context.wrap=function(context,name){if(context instanceof Context){return context}return new Context(new Stack(context),{},null,name)};Context.prototype.get=function(path,cur){if(typeof path==="string"){if(path[0]==="."){cur=true;path=path.substr(1)}path=path.split(".")}return this._get(cur,path)};Context.prototype._get=function(cur,down){var ctx=this.stack,i=1,value,first,len,ctxThis;first=down[0];len=down.length;if(cur&&len===0){ctxThis=ctx;ctx=ctx.head}else{if(!cur){while(ctx){if(ctx.isObject){ctxThis=ctx.head;value=ctx.head[first];if(value!==undefined){break}}ctx=ctx.tail}if(value!==undefined){ctx=value}else{ctx=this.global?this.global[first]:undefined}}else{if(ctx){if(ctx.head){ctx=ctx.head[first]}else{ctx=undefined}}}while(ctx&&i<len){ctxThis=ctx;ctx=ctx[down[i]];i++}}if(typeof ctx==="function"){var fn=function(){try{return ctx.apply(ctxThis,arguments)}catch(err){return dust.log(err,ERROR)}};fn.isFunction=true;return fn}else{if(ctx===undefined){dust.log("Cannot find the value for reference [{"+down.join(".")+"}] in template ["+this.getTemplateName()+"]")}return ctx}};Context.prototype.getPath=function(cur,down){return this._get(cur,down)};Context.prototype.push=function(head,idx,len){return new Context(new Stack(head,this.stack,idx,len),this.global,this.blocks,this.getTemplateName())};Context.prototype.rebase=function(head){return new Context(new Stack(head),this.global,this.blocks,this.getTemplateName())};Context.prototype.current=function(){return this.stack.head};Context.prototype.getBlock=function(key,chk,ctx){if(typeof key==="function"){var tempChk=new Chunk();key=key(tempChk,this).data.join("")}var blocks=this.blocks;if(!blocks){dust.log("No blocks for context[{"+key+"}] in template ["+this.getTemplateName()+"]",DEBUG);return}var len=blocks.length,fn;while(len--){fn=blocks[len][key];if(fn){return fn}}};Context.prototype.shiftBlocks=function(locals){var blocks=this.blocks,newBlocks;if(locals){if(!blocks){newBlocks=[locals]}else{newBlocks=blocks.concat([locals])}return new Context(this.stack,this.global,newBlocks,this.getTemplateName())}return this};Context.prototype.getTemplateName=function(){return this.templateName};function Stack(head,tail,idx,len){this.tail=tail;this.isObject=head&&typeof head==="object";this.head=head;this.index=idx;this.of=len}function Stub(callback){this.head=new Chunk(this);this.callback=callback;this.out=""}Stub.prototype.flush=function(){var chunk=this.head;while(chunk){if(chunk.flushable){this.out+=chunk.data.join("")}else{if(chunk.error){this.callback(chunk.error);dust.log("Chunk error ["+chunk.error+"] thrown. Ceasing to render this template.",WARN);this.flush=EMPTY_FUNC;return}else{return}}chunk=chunk.next;this.head=chunk}this.callback(null,this.out)};function Stream(){this.head=new Chunk(this)}Stream.prototype.flush=function(){var chunk=this.head;while(chunk){if(chunk.flushable){this.emit("data",chunk.data.join(""))}else{if(chunk.error){this.emit("error",chunk.error);dust.log("Chunk error ["+chunk.error+"] thrown. Ceasing to render this template.",WARN);this.flush=EMPTY_FUNC;return}else{return}}chunk=chunk.next;this.head=chunk}this.emit("end")};Stream.prototype.emit=function(type,data){if(!this.events){dust.log("No events to emit",INFO);return false}var handler=this.events[type];if(!handler){dust.log("Event type ["+type+"] does not exist",WARN);return false}if(typeof handler==="function"){handler(data)}else{if(dust.isArray(handler)){var listeners=handler.slice(0);for(var i=0,l=listeners.length;i<l;i++){listeners[i](data)}}else{dust.log("Event Handler ["+handler+"] is not of a type that is handled by emit",WARN)}}};Stream.prototype.on=function(type,callback){if(!this.events){this.events={}}if(!this.events[type]){dust.log("Event type ["+type+"] does not exist. Using just the specified callback.",WARN);if(callback){this.events[type]=callback}else{dust.log("Callback for type ["+type+"] does not exist. Listener not registered.",WARN)}}else{if(typeof this.events[type]==="function"){this.events[type]=[this.events[type],callback]}else{this.events[type].push(callback)}}return this};Stream.prototype.pipe=function(stream){this.on("data",function(data){try{stream.write(data,"utf8")}catch(err){dust.log(err,ERROR)}}).on("end",function(){try{return stream.end()}catch(err){dust.log(err,ERROR)}}).on("error",function(err){stream.error(err)});return this};function Chunk(root,next,taps){this.root=root;this.next=next;this.data=[];this.flushable=false;this.taps=taps}Chunk.prototype.write=function(data){var taps=this.taps;if(taps){data=taps.go(data)}this.data.push(data);return this};Chunk.prototype.end=function(data){if(data){this.write(data)}this.flushable=true;this.root.flush();return this};Chunk.prototype.map=function(callback){var cursor=new Chunk(this.root,this.next,this.taps),branch=new Chunk(this.root,cursor,this.taps);this.next=branch;this.flushable=true;callback(branch);return cursor};Chunk.prototype.tap=function(tap){var taps=this.taps;if(taps){this.taps=taps.push(tap)}else{this.taps=new Tap(tap)}return this};Chunk.prototype.untap=function(){this.taps=this.taps.tail;return this};Chunk.prototype.render=function(body,context){return body(this,context)};Chunk.prototype.reference=function(elem,context,auto,filters){if(typeof elem==="function"){elem.isFunction=true;elem=elem.apply(context.current(),[this,context,null,{auto:auto,filters:filters}]);if(elem instanceof Chunk){return elem}}if(!dust.isEmpty(elem)){return this.write(dust.filter(elem,auto,filters))}else{return this}};Chunk.prototype.section=function(elem,context,bodies,params){if(typeof elem==="function"){elem=elem.apply(context.current(),[this,context,bodies,params]);if(elem instanceof Chunk){return elem}}var body=bodies.block,skip=bodies["else"];if(params){context=context.push(params)}if(dust.isArray(elem)){if(body){var len=elem.length,chunk=this;if(len>0){if(context.stack.head){context.stack.head["$len"]=len}for(var i=0;i<len;i++){if(context.stack.head){context.stack.head["$idx"]=i}chunk=body(chunk,context.push(elem[i],i,len))}if(context.stack.head){context.stack.head["$idx"]=undefined;context.stack.head["$len"]=undefined}return chunk}else{if(skip){return skip(this,context)}}}}else{if(elem===true){if(body){return body(this,context)}}else{if(elem||elem===0){if(body){return body(this,context.push(elem))}}else{if(skip){return skip(this,context)}}}}dust.log("Not rendering section (#) block in template ["+context.getTemplateName()+"], because above key was not found",DEBUG);return this};Chunk.prototype.exists=function(elem,context,bodies){var body=bodies.block,skip=bodies["else"];if(!dust.isEmpty(elem)){if(body){return body(this,context)}}else{if(skip){return skip(this,context)}}dust.log("Not rendering exists (?) block in template ["+context.getTemplateName()+"], because above key was not found",DEBUG);return this};Chunk.prototype.notexists=function(elem,context,bodies){var body=bodies.block,skip=bodies["else"];if(dust.isEmpty(elem)){if(body){return body(this,context)}}else{if(skip){return skip(this,context)}}dust.log("Not rendering not exists (^) block check in template ["+context.getTemplateName()+"], because above key was found",DEBUG);return this};Chunk.prototype.block=function(elem,context,bodies){var body=bodies.block;if(elem){body=elem}if(body){return body(this,context)}return this};Chunk.prototype.partial=function(elem,context,params){var partialContext;partialContext=dust.makeBase(context.global);partialContext.blocks=context.blocks;if(context.stack&&context.stack.tail){partialContext.stack=context.stack.tail}if(params){partialContext=partialContext.push(params)}if(typeof elem==="string"){partialContext.templateName=elem}partialContext=partialContext.push(context.stack.head);var partialChunk;if(typeof elem==="function"){partialChunk=this.capture(elem,partialContext,function(name,chunk){partialContext.templateName=partialContext.templateName||name;dust.load(name,chunk,partialContext).end()})}else{partialChunk=dust.load(elem,this,partialContext)}return partialChunk};Chunk.prototype.helper=function(name,context,bodies,params){var chunk=this;try{if(dust.helpers[name]){return dust.helpers[name](chunk,context,bodies,params)}else{dust.log("Invalid helper ["+name+"]",WARN);return chunk}}catch(err){dust.log(err,ERROR);return chunk}};Chunk.prototype.capture=function(body,context,callback){return this.map(function(chunk){var stub=new Stub(function(err,out){if(err){chunk.setError(err)}else{callback(out,chunk)}});body(stub.head,context).end()})};Chunk.prototype.setError=function(err){this.error=err;this.root.flush();return this};function Tap(head,tail){this.head=head;this.tail=tail}Tap.prototype.push=function(tap){return new Tap(tap,this)};Tap.prototype.go=function(value){var tap=this;while(tap){value=tap.head(value);tap=tap.tail}return value};var HCHARS=new RegExp(/[&<>\"\']/),AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(s){if(typeof s==="string"){if(!HCHARS.test(s)){return s}return s.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;")}return s};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;dust.escapeJs=function(s){if(typeof s==="string"){return s.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t")}return s};if(typeof exports==="object"){module.exports=dust}else{root.dust=dust}if(typeof window!=="undefined"&&window.define){define("dust",[],function(){return dust})}})((function(){return this})());/* dustjs-helpers - v1.2.0
* https://github.com/linkedin/dustjs-helpers
* Copyright (c) 2014 Aleksander Williams; Released under the MIT License */
(function(a){if(typeof window!=="undefined"&&window.define){define("dust-helpers",["dust"],a)}else{a(dust)}})(function(dust){var _console=(typeof console!=="undefined")&&(typeof IS_DEBUG!=="undefined")&&IS_DEBUG?console:{log:function(){}};function isSelect(context){var value=context.current();return typeof value==="object"&&value.isSelect===true}function jsonFilter(key,value){if(typeof value==="function"){return value.toString().replace(/(^\s+|\s+$)/mg,"").replace(/\n/mg,"").replace(/,\s*/mg,", ").replace(/\)\{/mg,") {")}return value}function filter(chunk,context,bodies,params,filterOp){params=params||{};var body=bodies.block,actualKey,expectedValue,filterOpType=params.filterOpType||"";if(typeof params.key!=="undefined"){actualKey=dust.helpers.tap(params.key,chunk,context)}else{if(isSelect(context)){actualKey=context.current().selectKey;if(context.current().isResolved){filterOp=function(){return false}}}else{_console.log("No key specified for filter in:"+filterOpType+" helper ");return chunk}}expectedValue=dust.helpers.tap(params.value,chunk,context);if(filterOp(coerce(expectedValue,params.type,context),coerce(actualKey,params.type,context))){if(isSelect(context)){context.current().isResolved=true}if(body){return chunk.render(body,context)}else{_console.log("Missing body block in the "+filterOpType+" helper ");return chunk}}else{if(bodies["else"]){return chunk.render(bodies["else"],context)}}return chunk}function coerce(value,type,context){if(value){switch(type||typeof(value)){case"number":return +value;case"string":return String(value);case"boolean":value=(value==="false"?false:value);return Boolean(value);case"date":return new Date(value);case"context":return context.get(value)}}return value}var helpers={tap:function(input,chunk,context){if(typeof input!=="function"){return input}var dustBodyOutput="",returnValue;returnValue=chunk.tap(function(data){dustBodyOutput+=data;return""}).render(input,context);chunk.untap();if(returnValue.constructor!==chunk.constructor){return returnValue}else{if(dustBodyOutput===""){return false}else{return dustBodyOutput}}},sep:function(chunk,context,bodies){var body=bodies.block;if(context.stack.index===context.stack.of-1){return chunk}if(body){return bodies.block(chunk,context)}else{return chunk}},idx:function(chunk,context,bodies){var body=bodies.block;if(body){return bodies.block(chunk,context.push(context.stack.index))}else{return chunk}},contextDump:function(chunk,context,bodies,params){var p=params||{},to=p.to||"output",key=p.key||"current",dump;to=dust.helpers.tap(to,chunk,context);key=dust.helpers.tap(key,chunk,context);if(key==="full"){dump=JSON.stringify(context.stack,jsonFilter,2)}else{dump=JSON.stringify(context.stack.head,jsonFilter,2)}if(to==="console"){_console.log(dump);return chunk}else{return chunk.write(dump)}},"if":function(chunk,context,bodies,params){var body=bodies.block,skip=bodies["else"];if(params&&params.cond){var cond=params.cond;cond=dust.helpers.tap(cond,chunk,context);if(eval(cond)){if(body){return chunk.render(bodies.block,context)}else{_console.log("Missing body block in the if helper!");return chunk}}if(skip){return chunk.render(bodies["else"],context)}}else{_console.log("No condition given in the if helper!")}return chunk},math:function(chunk,context,bodies,params){if(params&&typeof params.key!=="undefined"&&params.method){var key=params.key,method=params.method,operand=params.operand,round=params.round,mathOut=null,operError=function(){_console.log("operand is required for this math method");return null};key=dust.helpers.tap(key,chunk,context);operand=dust.helpers.tap(operand,chunk,context);switch(method){case"mod":if(operand===0||operand===-0){_console.log("operand for divide operation is 0/-0: expect Nan!")}mathOut=parseFloat(key)%parseFloat(operand);break;case"add":mathOut=parseFloat(key)+parseFloat(operand);break;case"subtract":mathOut=parseFloat(key)-parseFloat(operand);break;case"multiply":mathOut=parseFloat(key)*parseFloat(operand);break;case"divide":if(operand===0||operand===-0){_console.log("operand for divide operation is 0/-0: expect Nan/Infinity!")}mathOut=parseFloat(key)/parseFloat(operand);break;case"ceil":mathOut=Math.ceil(parseFloat(key));break;case"floor":mathOut=Math.floor(parseFloat(key));break;case"round":mathOut=Math.round(parseFloat(key));break;case"abs":mathOut=Math.abs(parseFloat(key));break;default:_console.log("method passed is not supported")}if(mathOut!==null){if(round){mathOut=Math.round(mathOut)}if(bodies&&bodies.block){return chunk.render(bodies.block,context.push({isSelect:true,isResolved:false,selectKey:mathOut}))}else{return chunk.write(mathOut)}}else{return chunk}}else{_console.log("Key is a required parameter for math helper along with method/operand!")}return chunk},select:function(chunk,context,bodies,params){var body=bodies.block;if(params&&typeof params.key!=="undefined"){var key=dust.helpers.tap(params.key,chunk,context);if(body){return chunk.render(bodies.block,context.push({isSelect:true,isResolved:false,selectKey:key}))}else{_console.log("Missing body block in the select helper ");return chunk}}else{_console.log("No key given in the select helper!")}return chunk},eq:function(chunk,context,bodies,params){if(params){params.filterOpType="eq"}return filter(chunk,context,bodies,params,function(expected,actual){return actual===expected})},ne:function(chunk,context,bodies,params){if(params){params.filterOpType="ne";return filter(chunk,context,bodies,params,function(expected,actual){return actual!==expected})}return chunk},lt:function(chunk,context,bodies,params){if(params){params.filterOpType="lt";return filter(chunk,context,bodies,params,function(expected,actual){return actual<expected})}},lte:function(chunk,context,bodies,params){if(params){params.filterOpType="lte";return filter(chunk,context,bodies,params,function(expected,actual){return actual<=expected})}return chunk},gt:function(chunk,context,bodies,params){if(params){params.filterOpType="gt";return filter(chunk,context,bodies,params,function(expected,actual){return actual>expected})}return chunk},gte:function(chunk,context,bodies,params){if(params){params.filterOpType="gte";return filter(chunk,context,bodies,params,function(expected,actual){return actual>=expected})}return chunk},"default":function(chunk,context,bodies,params){if(params){params.filterOpType="default"}return filter(chunk,context,bodies,params,function(expected,actual){return true})},size:function(chunk,context,bodies,params){var key,value=0,nr,k;params=params||{};key=params.key;if(!key||key===true){value=0}else{if(dust.isArray(key)){value=key.length}else{if(!isNaN(parseFloat(key))&&isFinite(key)){value=key}else{if(typeof key==="object"){nr=0;for(k in key){if(Object.hasOwnProperty.call(key,k)){nr++}}value=nr}else{value=(key+"").length}}}}return chunk.write(value)},dchoice:function(chunk,context,bodies,params){var choiceVar,value,cMod10,cMod100,locale=context.global.LOCALE;params=params||{};if(isNaN(parseInt(params.key),10)){_console.log("Choice variable not a number.");return chunk.write("")}choiceVar=Math.abs(params.key);cMod10=choiceVar%10;cMod100=choiceVar%100;if(locale==="ru"){if(cMod100!==11&&cMod10===1){value=params.arg0}else{if(cMod10>=2&&cMod10<=4&&(cMod100<=10||cMod100>=20)){value=params.arg1}else{value=params.arg2}}}else{if(locale==="cs"||locale==="sk"){if(choiceVar===1){value=params.arg0}else{if(choiceVar>=2&&choiceVar<=4){value=params.arg1}else{value=params.arg2}}}else{if(locale==="sr"||locale==="uk"){if(choiceVar>=11&&choiceVar<=14){value=params.arg2}else{if(cMod10===1){value=params.arg0}else{if(cMod10>=2&&cMod10<=4){value=params.arg1}else{value=params.arg2}}}}else{_console.log("Invalid dchoice locale: "+locale+". This should have been caught earlier.");value=""}}}return chunk.write(value)},dchoice2:function(chunk,context,bodies,params){var choiceVar,value;params=params||{};if(isNaN(parseInt(params.key),10)){_console.log("Choice variable not a number.");return chunk.write("")}choiceVar=Math.abs(params.key);if(choiceVar%100!==11&&(choiceVar%100)%10===1){value=params.arg0}else{value=params.arg1}return chunk.write(value)}};dust.helpers=helpers});(function(a){if(typeof window!=="undefined"&&window.define){define("dust-ta-helper",["dust","dust-helpers"],a)}else{a(dust)}})(function(g,n){var o=/^ *(\w+) +in +([$_a-zA-Z][.$_\w]*)/;var b=/^\//;var d=/^[a-zA-Z:]*\/\//;var m=/ctx\.(?:get\("(.*?)"\)|getPath\(false,\["(.*?)"\]\)),ctx,"h"(?:,\["(.*?)"\])?/;var e=/","/g;var k=/^\s|\s(?=\s|$)/g;var h=g.helpers["if"].bind(g.helpers);var r=g.helpers.eq.bind(g.helpers);var f=g.helpers.select.bind(g.helpers);var l=g.helpers.math.bind(g.helpers);var s=g.helpers.tap.bind(g.helpers);var p={pagination:["url"]};function q(u){return u===~~u}function i(v){if(typeof v!="function"){return v}v=v.toString();var u="";var x=/(?:reference\((.*?)\)|write\("(.*?)"\))[.;]/g;var w;var y;while(!!(w=x.exec(v))){if(w[1]){y=w[1].match(m);if(y){if(y[1]){u+=" {"+y[1]}else{if(y[2]){u+=" {"+y[2].replace(e,".")}}if(y[3]){u+="|"+y[3].replace(e,"|")}u+="} "}}else{if(w[2]){u+=w[2]}}}return u.replace(k,"")}function a(w,u){var v=u.split(".");while(w&&v.length>0){w=w[v.shift()]}return w}function t(v,u){if(v){if(!b.test(v)){v="/"+v}if(!v.match(d)){v=u.global.CDN_HOST+v}}return v}function j(v){var w=ta.retrieve&&ta.retrieve("BOOKING_FEATURES"),u=w&&(w.indexOf(v.trim().toUpperCase())>=0);if(!u){u=!!(ta.has&&ta.has("feature."+v))||!!(ta.retrieve&&ta.retrieve(v+".feature"))||!!(ta.m&&ta.m.feature&&ta.m.feature.enabled(v))}return u}if(typeof console=="undefined"){console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}}g.helpers["if"]=function(v,w,u,y){try{return h(v,w,u,y)}catch(x){console.error("Error in @if statement: "+x.name+": "+x.message+".",'Condition "'+i(y.cond)+'"','evaluated to "'+s(y.cond,v,w)+'".');return v}};g.helpers.select=function(v,x,u,y){var w=s(y.key,v,x);if(w==0){if(w==="0"){y.key=0}}else{if(w==+w){y.key=+w}}return f(v,x,u,y)};g.helpers.math=function(v,w,u,y){var x=w.current();if(y.inherit){y[y.inherit]=typeof x.selectKey!=="undefined"?x.selectKey:x._dustFilterOptions.selectKey}return l(v,w,u,y)};g.helpers.eq=function(v,x,u,z){var w=s(z.key,v,x);var y=s(z.value,v,x);if(w==+w){z.key=+w}if(y==+y){z.value=+y}return r(v,x,u,z)};g.helpers.contains=function(v,w,u,y){if(!(y.collection&&y.collection.indexOf)){console.error("@contains helper requires a valid 'collection' parameter");return v}var x=s(y.value,v,w);if(typeof x=="undefined"){console.error("@contains requires a 'value' parameter");return v}if(~y.collection.indexOf(x)){return u.block(v,w)}return u["else"]?u["else"](v,w):v};g.helpers.range=function(D,v,u,y){var x=+s(y.begin,D,v);if(!q(x)){x=0}var z=+s(y.end,D,v);if(!q(z)){console.error("@range requires an integral 'end' parameter")}var w=+s(y.step,D,v);if(!q(w)){w=(z-x)/Math.abs(z-x)}var A=w>0;try{for(var B=x;A?B<z:B>z;B=B+w){v.stack.head.$val=B;D=u.block(D,v)}}catch(C){console.error("Error in @range block",C.message)}delete v.stack.head.$val;return D};g.helpers.truncate=function(v,w,u,A){var z=g.escapeHtml(s(A.value,v,w))||"";var x=s(A.length,v,w)||100;var y=z.length<=x?z:(z.slice(0,x-3).replace(/(?:\s*\&\S*|\s+)$/,"")+"...");return v.write(y)};g.helpers.localizeInt=function(v,x,u,B){var z=s(B.val,v,x)||0;var y=z.toString().split("");if(y.length>3){y.reverse();if(x.global.LOCALE=="en_IN"){z="";var A=",";for(var w=0;w<y.length;w++){z=y[w]+z;if(w<y.length-1){if(w>=3&&((w-3)%2==1)){z=A+z}else{if(w<3&&w%3==2){z=A+z}}}}}else{z="";var A=",";if(x.global.LOCALE=="de"||x.global.LOCALE=="it"||x.global.LOCALE=="nl"||x.global.LOCALE=="br"||x.global.LOCALE=="es"||x.global.LOCALE=="es_AR"||x.global.LOCALE=="es_CL"||x.global.LOCALE=="es_CO"||x.global.LOCALE=="es_VE"||x.global.LOCALE=="fr_BE"||x.global.LOCALE=="pt_BR"||x.global.LOCALE=="nl_BE"||x.global.LOCALE=="tr"||x.global.LOCALE=="da"||x.global.LOCALE=="el"||x.global.LOCALE=="id"||x.global.LOCALE=="vi"||x.global.LOCALE=="sr"){A="."}else{if(x.global.LOCALE=="fr"||x.global.LOCALE=="pl"||x.global.LOCALE=="en_ZA"||x.global.LOCALE=="de_AT"||x.global.LOCALE=="fr_CA"||x.global.LOCALE=="fr_CH"||x.global.LOCALE=="pt_PT"||x.global.LOCALE=="no"||x.global.LOCALE=="nb"||x.global.LOCALE=="ru"||x.global.LOCALE=="hu"||x.global.LOCALE=="sk"||x.global.LOCALE=="uk"||x.global.LOCALE=="cs"||x.global.LOCALE=="fi"||x.global.LOCALE=="in"){A=" "}else{if(x.global.LOCALE=="it_CH"||x.global.LOCALE=="de_CH"){A="'"}}}for(var w=0;w<y.length;w++){z=y[w]+z;if(w%3==2&&w<y.length-1){z=A+z}}}}return v.write(z)};g.helpers.quotes=function(y,z,w,A){A=A||{};var x=s(A.italics,y,z)||"";var u=z.global.IS_RTL?"&#x201d;":"&#x201c;";var v=z.global.IS_RTL?"&#x201c;":"&#x201d;";if(x=="true"){u="<i>"+u+"</i>";v="<i>"+v+"</i>"}y.write(u);y=w.block(y,z);return y.write(v)};g.helpers.fbPic=function(v,x,u,y){var z=s(y.id,v,x);var w=s(y.size,v,x);v.write("<img ");if(z){v.write('src="//graph.facebook.com/'+z+"/picture?type=square");if(w){v.write("&width="+w+"&height="+w)}v.write('" ')}v=u.block(v,x);return v.write("/>")};g.helpers.img=function(v,w,u,y){var x=t(s(y.src,v,w),w);v.write("<img ");if(x){v.write('src="'+x+'" ')}if(u.block){v=u.block(v,w)}return v.write("/>")};g.helpers.maybeLazyImg=g.helpers.img;g.helpers.imgUrl=function(v,w,u,y){var x=t(s(y.src,v,w),w);if(x){v.write(x)}if(u.block){v=u.block(v,w)}return v};g.helpers.fittedImg=function(F,z,w,C){var v=s(C.src,F,z);var B=s(C.height,F,z);var y=s(C.width,F,z);var x=v.url;var E=v.height;var D=v.width;var u="";var G="";var A;if(D==0||E==0){u='style= "width:'+y+"px; height: "+B+'px;" '}else{if(B/E<y/D){A=y/D;E=Math.floor(E*A);D=y;G=Math.floor((E-B)/2)*-1;u='style= "width:'+D+"px; height: "+E+"px; margin-top: "+G+'px;" '}else{A=B/E;D=Math.floor(D*A);E=B;G=Math.floor((D-y)/2)*-1;u='style= "width: '+D+"px; height: "+E+"px; margin-left: "+G+'px; "'}}F.write('<div style="height:'+B+"px; width:"+y+'px; overflow: hidden;" >');if(x){F.write('<img src="'+x+'" '+u+"/>")}F=w.block(F,z);return F.write("</div>")};g.helpers.lazyimg=function(w,x,v,z){var u=s(z["class"],w,x);var y=s(z.src,w,x);w.write('<img class="lazy '+(u?u:"")+'" ');if(y){if(typeof window=="undefined"){w.write('data-src="'+y+'" ')}else{w.write('src="'+y+'" ')}}w=v.block(w,x);return w.write("/>")};g.helpers.avatarWithFBOverlay=function(x,y,v,z){var w=s(z.avatar,x,y);var A=s(z.id,x,y);var u=s(z["class"],x,y);x.write('<div class="avatar-with-overlay '+u+'" ');if(w){x.write('style="background-image: url('+w+')">')}else{x.write('style="background-image: url(//graph.facebook.com/'+A+'/picture?type=square)">')}x.write('<img src="'+y.global.CDN_HOST+'/img2/social/social_on_mobile/fb_icon_20x20.png" ');x.write('class="overlay" />');return x.write("</div>")};g.helpers.avatar=function(x,y,v,z){var w=s(z.avatar,x,y);var A=s(z.id,x,y);var u=s(z["class"],x,y);x.write('<div class="avatar '+u+'" ');if(w){x.write('style="background-image: url('+w+')">')}else{x.write('style="background-image: url(//graph.facebook.com/'+A+'/picture?type=square)">')}return x.write("</div>")};g.helpers.pos=function(w,x,u,y){var v=y&&y.start!=null?y.start:1;if(x.stack){x.stack.head.$pos=x.stack.index+v}if(u&&u.block){w=u.block(w,x)}return w};g.helpers.bubbleRating=function(x,y,w,A){var z=g.helpers.tap(A.value,x,y);var B=g.helpers.tap(A.ratingType,x,y)||"ss";var u=z?(z.toString().length==1?z.toString()+"0":z*10):null;var v=g.helpers.tap(A["class"],x,y);z=+z;x.write('<div class="rate rate_'+B+" "+B+u+" "+(v?v:"")+'">');x.write("<img ");x.write('src="'+y.global.CDN_HOST+'/img2/sprites/ratings-v6.png" ');x.write('class="sprite-ratings" property="v:rating" alt="');x.write(z+' of 5 stars" content="'+z+'" />');return x.write("</div>")};g.helpers.bubbleRatingSvg=function(v,w,u,z){var y=g.helpers.tap(z.value,v,w);var A=+g.helpers.tap(z.multiplier,v,w)||20;var x=y*A;x=x<0?0:x>100?100:x;v.write('<div class="svgico bubblesempty">');v.write('<div class="bubbles" style="width:'+x+'%;"><div class="svgico bubblesfull"></div></div>');return v.write("</div>")};g.helpers.bubbleNum=function(v,w,u,y){var x=s(y.value,v,w);x=Math.round(Number(x)*2)*5;x=Math.min(x,50);x=Math.max(x,0);x=String(100+x).substr(1);return v.write(x)};g.helpers.removeNonDigits=function(v,w,u,y){var x=s(y.value,v,w);return v.write(x.replace(/[^0-9]/g,""))};g.helpers.digitize=function(A,v,u,x){var C=+s(x.value,A,v);var z=+s(x.padding,A,v);var w=q(C)?C.toString().split(""):[];if(!q(z)){z=0}var B=z-w.length;if(B>0){while(B--){w.unshift("0")}}for(var y=0;y<w.length;y++){A=u.block(A,g.makeBase({digit:w[y]}))}return A};g.helpers.oxEach=function(A,u,z,H){if(u.stack.tail&&!(u.stack.head&&u.stack.head.__ox__)){console.error("Cannot call @oxEach within a section block");return A}var K=s(H.context,A,u);var y=K.match(o);var F=y[1];var C=y[2].split(".");var B=u.get(C[0]);var E;for(E=1;B&&E<C.length;E++){B=B[C[E]]}if(!B){return A}var L=s(H.name,A,u)||("each"+F.charAt(0).toUpperCase()+F.slice(1));var x="begin" in H||"end" in H;var I=+s(H.begin,A,u);if(!q(I)||I<0){I=0}var v=+s(H.end);v=isNaN(v)?null:v;if(v!=null&&(!q(v)||v<I)){console.error("Invalid @oxEach end index in collection"+C);v=null}var w=B.__offset__||0;A.write('<!-- @oxEach name="'+L+'" context="'+K+'"');if(x){A.write(' begin="'+I+'"');if(v!=null){A.write(' end="'+v+'"')}}A.write(" -->\n");I=I-w;if(v!=null){v=Math.min(v-w,B.length)}else{v=B.length}for(E=I;E<v;E++){var G=B[E];if(!G){console.error("@oxEach requires non-null items in collection "+C);break}var J={};for(var D in u.stack.head){J[D]=u.stack.head[D]}J[F]=G;J.$idx=E+w;J.$idx1=J.$idx+1;J.__ox__=true;J=u.rebase(J);A=z.block(A,J)}A.write("<!-- /oxEach -->\n");return A};g.helpers.oxContains=function(v,x,u,A){if(!(A.collection&&A.collection.indexOf)){console.error("@oxContains helper requires a valid 'collection' parameter");return v}var w=s(A.key,v,x);if(typeof w=="undefined"){console.error("@oxContains requires a 'key' parameter");return v}var z=s(A.value,v,x);if(typeof z=="undefined"){console.error("@oxContains requires a 'value' parameter");return v}var y=function(B){return B!=null&&a(B,w)==z};if(A.collection.filter(y).length>0){return u.block(v,x)}return u["else"]?u["else"](v,x):v};g.helpers.ifChanged=function(w,y,v,A){var z=A.collection;if(!(z&&z.indexOf)){console.error("@ifChanged helper requires a valid 'collection' parameter");return w}var x=s(A.key,w,y);if(typeof x=="undefined"){console.error("@ifChanged requires a valid 'key' parameter");return w}var u=+s(A.idx,w,y);if(!q(u)){console.error("@ifChanged requires a valid 'idx' parameter");return w}if(u<1||a(z[u],x)!=a(z[u-1],x)){return v.block(w,y)}return v["else"]?v["else"](w,y):w};g.helpers.oxSection=function(z,v,u,x){var w=s(x.namespace,z,v);var y=s(x.nsid,z,v);var C=s(x.tag,z,v)||"div";if(typeof w==="undefined"){console.error("@oxSection requires a valid 'namespace' parameter");return z}z.write("<"+C+' data-ox-section-name="'+w+'"');if(typeof y!=="undefined"){z.write(' data-ox-section-id="'+y+'"')}for(var B in x){if(B==="namespace"||B==="nsid"||B==="tag"){continue}var A=s(x[B],z,v);if(typeof B==="undefined"||typeof A==="undefined"){console.error("@oxSection key or value is undefined: "+B);continue}z.write(" "+B+'="'+A+'"')}z.write(" />\n");z=u.block(z,v);z.write("</"+C+">\n");return z};g.helpers.substr=function(D,E,u,y){var C=g.escapeHtml(g.helpers.tap(y.str,D,E))||"",v=g.helpers.tap(y.begin,D,E)||0,z=g.helpers.tap(y.end,D,E)||C.length,A=g.helpers.tap(y.len,D,E)||C.length,w=g.helpers.tap(y.underflow,D,E)||"",x=g.helpers.tap(y.overflow,D,E)||"";var B=(v==0?"":w)+(A<z-v?C.substr(v,A)+x:C.slice(v,z));return D.write(B)};g.helpers.replaceContent=function(w,u,v,A){var y=g.helpers.tap(A.key,w,u);var z=g.helpers.tap(v.block,w,u);var x=g.helpers.tap(v["with"],w,u);if(y){z=str.replace(new RegExp(escapeRegExp(y),"g"),z)}return w.write(z)};g.helpers.increment=function(v,x,u,z){var y=+s(z.base,v,x);var w=+s(z.addon,v,x);if(!q(y)){y=0}if(!q(w)){w=0}x.stack.head.$increment_val=y+w;v=u.block(v,x);delete x.stack.head.$increment_val;return v};g.helpers.pagination=function(K,w,u,A){var C=+s(A.offset,K,w);var B=+s(A.limit,K,w);var J=+s(A.total,K,w);var E=+s(A.pageNumbers,K,w)||2;var F=1+(J<=0?0:Math.floor(C/B));var H=u.url||A.url;var z=Math.ceil(J/B);var D;if(!q(C)||!q(B)||!q(J)){return K}var x=[];var I=[];var v=function(M){var N="";if(H){var L=w.rebase({pageNumber:M,offset:(M-1)*B});N=s(H,K,L)}return{pageNumber:M,offset:(M-1)*B,url:N}};var G=function(L){x.push(v(L));I.push(L)};if(z<=(E*2)+3){for(D=1;D*B<J+B;D+=1){G(D)}}else{if(F<=Math.max(E*2,3)){for(D=1;D<(E*2)+3;D++){G(D)}}else{if(z-F<=(E*2)-1){for(D=z-(E*2)+1;D<=z;D++){G(D)}}else{for(D=F-E;D<=F+E;D++){G(D)}}}}var y={previousPage:F>1?v(F-1):null,nextPage:F<z?v(F+1):null,firstPage:C<=0?null:v(1),lastPage:C+B>=J?null:v(Math.ceil(J/B)),containsFirstPage:I.indexOf(1)>=0,containsLastPage:I.indexOf(Math.ceil(J/B))>=0,currentPageNumber:F,pages:x};y=w.rebase(y);K=u.block(K,y);return K};g.helpers.feature=function(y,z,v,A){var x=s(A.name,y,z),w=A.hasOwnProperty("enabled")?s(A.enabled,y,z):true;if((typeof x=="undefined")||!x||!x.trim()){console.error("@feature requires a 'name' parameter");return y}x=x.trim();if(w){w=w.toString().trim()!=="false"}var u=j(x);if(u===w){return v.block(y,z)}return v["else"]?v["else"](y,z):y};g.helpers.localizeShowKeyOnHover=function(w,y,u,z){var v=j("DUST_LOCALIZE_SHOW_KEY_ON_HOVER");if(v){var x=s(z.key,w,y);w.write('<span class="ta-localized" title="');if(x){w.write(x)}w.write('">')}if(u.block){w=u.block(w,y)}if(v){w.write("</span>")}return w};var c=function(u){return function(v){return v.write(u)}};g.helpers.styleguide=function(C,x,v,z){var D={};var B=s(z.component||v.component,C,x);var w=p[B]||[];var u={};for(var y in z){D[y]=w.indexOf(y)>=0?z[y]:s(z[y],C,x);u[y]=c(D[y])}for(var A in v){D[A]=w.indexOf(A)>=0?v[A]:s(v[A],C,x);u[A]=c(D[A])}x=x.shiftBlocks(u).push(D);return C.partial(x.global.LOCALE+"styleguide_"+B,x,D)}});(function(a){if(typeof exports!=="undefined"){a(module.exports=require("dustjs-linkedin"))}else{if(typeof window!=="undefined"&&window.define){define("dust-iterate-helper",["dust"],a)}else{a(dust)}}})(function(a){a.helpers.iterate=function(o,d,b,f){var m=b.block,h,l,j,e,g,c;f=f||{};function n(k,i){if(k<i){return 1}else{if(k>i){return -1}}return 0}function p(i,k){return m(o,d.push({$key:i,$value:k,$type:typeof k}))}if(f.key){g=a.helpers.tap(f.key,o,d);if(m){if(!!f.sort){h=a.helpers.tap(f.sort,o,d);l=[];for(e in g){if(g.hasOwnProperty(e)){l.push(e)}}c=d.global[h];if(!c&&h==="desc"){c=n}if(c){l.sort(c)}else{l.sort()}for(j=0;j<l.length;j++){o=p(l[j],g[l[j]])}}else{for(e in g){if(g.hasOwnProperty(e)){o=p(e,g[e])}}}}else{_console.log("Missing body block in the iter helper.")}}else{_console.log("Missing parameter 'key' in the iter helper.")}return o}});(function(a){if(typeof window!=="undefined"&&window.define){define("dust-tracking-helper",["dust","dust-helpers"],a)}else{a(dust)}})(function(h,p){p=p||h.helpers;var s=h.helpers.tap.bind(h.helpers),r="__ttParentContext",u="dustTree",g="\\",n="/",a=/^([A-Z]{1,2}:)?[\\$-.\a-zA-Z_0-9|]+$/,l=/\\+$/,c=function(v){return v.global.__treeString},e=function(v){return v.global.__incrementingCounters},t=function(w,v,x){if(!w.global.__incrementingCounters){w.global.__incrementingCounters={}}w.global.__incrementingCounters[v]=x},k=function(w){var v=w.global.__treeString;w.global.__treeString=null;w.global.__incrementingCounters={};return v},j=function(w){var v=c(w),x=w.global[r];if(v!=null){return}v=w.global.__treeString=[];w.global.__incrementingCounters={};if((typeof x==="string"||x instanceof String)&&x.length>0){if(x[x.length-1]===g){v.push(x.substring(0,x.length-1));v.push(g)}else{v.push(x)}}},m=function(w,x,v){if(v&&v.block){w=v.block(w,x)}return w},q=function(w,v,x){if(v&&v.block&&w){w.write(x)}},f=function(z,x,y,w){var v=c(y),A=v.length;if(A===0||v[A-1]===g){v.push(z)}else{v.push(n);v.push(z)}q(x,w,"<!--trk"+z+"-->")},b=function(w,x,v){c(x).push(g);q(w,v,"<!--etk-->")},o=function(z,w,x,v){var y=d(z);j(x);if(y){f(z,w,x,v)}w=m(w,x,v);if(y){b(w,x,v)}return w},i=function(w){var v=c(w);return v?v.join(""):""},d=function(v){return(typeof v==="string"||v instanceof String)&&a.test(v)};h.helpers.track=function(w,x,v,A){try{var B=s(A&&A.noTrack,w,x);if(B){w=m(w,x,v);return w}var z=s(A&&A.name,w,x);return o(z,w,x,v)}catch(y){console.error(y)}};h.helpers.trackTree=function(x,z,w,C){var B,y=s(C&&C.name,x,z),v=k(z),A=u;j(z);x=m(x,z,w);B=i(z);if(x&&x.write){if(y){A=A+" "+y}x.write("<div class='"+A+"' data-tree='"+B+"'></div>")}z.global.__treeString=v;return x};h.helpers.trackWithIncrementingValue=function(D,w,v,x){var C,B,z=s(x&&x.name,D,w),y=x.hasOwnProperty("offset")&&x.offset?s(x.offset,D,w):1,A=window.ta&&ta.retrieve&&ta.store?ta.retrieve("dust.continue_inc_track"):null;if(z&&z.indexOf(":")<0){C=e(w);if(!C){if(w&&w.global&&w.global.DEBUG){console.warn("trackWithIncrementingValue outside of a @trackTree context.")}}if(!C||!C[z]){if(A&&A[z]){B=A[z]+1}else{B=y}}else{B=C[z]+1}t(w,z,B);z=z+":"+B;if(A){ta.store("dust.continue_inc_track",C)}}return o(z,D,w,v)};h.tracking={TREE_CLASS:u,setParentTree:function(w,v){if(v&&v.global){v.global[r]=w}},cleanTree:function(v){return v?v.replace(l,""):v}}});require(["ta/rollupAmdShim"],function(a){a.install(["ta/Core/TA.Dust"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-dust",files:{js3:{src:{ta:{Core:{"TA.Dust":1}}}}},_:{baseUrl:"/"}})};define("ta/Core/TA.Dust",["vanillajs","ns-exporter","ta/util/Error","ta/util/Deferred","ta/Core/TA.Store"],function(d,g,a,e,b){var c={};var f=null;var h=function(){if(f!=null){return f}try{f=JSON.parse(b.retrieve("DUST_GLOBAL"));return f}catch(j){}if(typeof window!=="undefined"&&window.DUST_GLOBAL){return window.DUST_GLOBAL}if(require.defined("page-model")){return require("page-model").DUST_GLOBAL}return{}};c.render=function(l,n,j,p){var m=h(),o=typeof j=="string"?document.querySelector(j):j,k=dust.makeBase(m).rebase(n);if(!o||!l||!m.LOCALE||!dust){return false}dust.render(i(l),k,function(r,q){if(q){o.innerHTML=q}else{if(r){a.record(r,"Error rendering dust template "+l)}}if(p){p(n)}});return true};c.renderToString=function(l,n){var m=h(),j=dust.makeBase(m).rebase(n),k=e(true);if(!l||!m.LOCALE||!dust){k.reject("Missing dependencies");return k.promise()}dust.render(i(l),j,function(p,o){if(o){k.resolve(o)}else{if(p){a.record(p,"Error rendering dust template "+l);k.reject(p)}}});return k.promise()};var i=function(j){var k=j.replace(/\//g,"_").replace(".dust",""),l=h().LOCALE;return l+k};g.exportTo(c,"ta.dust");return c});require(["ta/rollupAmdShim"],function(a){a.install(["ta/util/Cookie","ta/util/ASDF","ta/util/Doer","ta/util/Pending","ta/util/Load","ta/util/Date","ta/util/Currency","ta/util/Toggle","ta/util/URL","ta/util/I18N","ta/util/Element","ta/util/Link","ta/util/ajaxFormPopup","ta/util/LocalStorage","ta/util/SessionStorage","ta/util/Deferred","ta/util/Decoder","ta/util/Replace","ta/util/ajax","ta/util/cdn","ta/common/Search","ta/common/Flyout","ta/servlet/Reviews","ta/servlet/Popup","ta/servlet/ShowSpecialOfferStub","utils/cookieutils","utils/ceUtils","ta/util/ActionRecord","ta/util/Partials","ta/support/Facebook","lib/LazyLoad","lib/TypeAhead","ta/backbone/ModuleLoader","tamgfooter/tamgFooter","ta/maps/opener"],["ta","ta","ta","ta","ta","ta","ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-core-lite",files:{js3_secure:{ssl:{ta:{util:{LocalStorage:1,Deferred:1}}}},"js-amd":{src:{utils:{ceUtils:1,cookieutils:1}}},js3:{lib:{LazyLoad:1,TypeAhead:1},src:{tamgfooter:{tamgFooter:1},ta:{common:{Flyout:1,Search:1},maps:{opener:1},util:{Cookie:1,Replace:1,Load:1,Partials:1,ActionRecord:1,Element:1,ASDF:1,ajaxFormPopup:1,Decoder:1,cdn:1,ajax:1,Date:1,URL:1,Currency:1,Toggle:1,Doer:1,SessionStorage:1,Link:1,Pending:1,I18N:1},servlet:{Reviews:1,Popup:1,ShowSpecialOfferStub:1},backbone:{ModuleLoader:1},support:{Facebook:1}}}}},_:{baseUrl:"/"}})};define("utils/asdf-encoder",["ns-exporter","vanillajs"],function(b){var a={};a.getOffset=function(d){if(d>=97&&d<=122){return d-61}if(d>=65&&d<=90){return d-55}if(d>=48&&d<=71){return d-48}return -1};a.asdf=function(f){var j={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],q:[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],x:[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],z:[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]};var e="";for(var d=0;d<f.length;d++){var k=f.charAt(d);var g=k;if(j[k]&&d+1<f.length){d++;g+=f.charAt(d)}else{k=""}var h=getOffset(f.charCodeAt(d));if(h<0||typeof j[k][h]=="String"){e+=g}else{e+=j[k][h]}}return e};b.exportTo(a,window);return a});define("ta/util/ASDF",["vanillajs","utils/asdf-encoder","ta/util/Cookie","ns-exporter"],function(d,b,c,e){var a={asdf:function(g,f){if(f){c.setPIDCookie(f)}window.location=b.asdf(g)},asdfPopup:function(g,f){if(f){c.setPIDCookie(f)}ta.servlet.Popup.open(b.asdf(g))},asdfPopupTerms:function(f){ta.servlet.Popup.open(b.asdf(f),"terms",300,300,30,25)},asdfDcd:function(f){return b.asdf(f)}};e.exportTo(a,"ta.util.ASDF");return a});define("ta/util/Doer",["vanillajs"],function(b){var a={doit:function(g,f){var e="/"+g;var d=0;for(var c in f){if(d===0){e+="?"}else{e+="&"}e+=c+"="+f[c];d++}return e},aimdoit:function(k,e,c,l){var d=ta.util.Doer.doit(k,e);ta.stopEvent(c);var j=475;var f=390;var i=210;var g=5;if(l){j=980;f=800;i=240}else{if(screen.width>=1024&&screen.height>=768&&e&&(e.area.indexOf("Text")!=-1||e.area.indexOf("Thumbnail")!=-1)){j=900;f=768;i=240}else{if(screen.width>1024){j=800;f=600;i=240}else{if(screen.width>800){j=620;f=500;i=240}}}}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(d,null,j,f,i,g,false,true));if(ta.retrieve("isDaoDao")){if(ta.retrieve("checkrates.check_more_re")){dd.commerce.checkrates.checkMorePopupAIM(c,e)}}},tadoless:function(j,e,h,l,d){var c="/"+j;for(var k in e){c+="-"+k+e[k]}var g=h.length;for(var f=0;f<g;f++){c+="-"+h[f]}if(!d){c+=".html"}if(l.length>0){c+=l}return c}};return a});define("ta/util/Pending",["vanillajs","ns-exporter","ta/Core/TA.Store","ta/Core/TA.Load"],function(vanilla,nsExporter,taStore,taLoad){var exports={};var _callbacks={};exports.waitForMore=function(id,fn,limit,args,bind){if(taStore.has("pending."+id)){exports.cancel(id)}taStore.store("pending."+id,{timer:fn.delay(limit,bind,args),fn:fn,t:"m",n:limit})};exports.waitForFn=function(id,fn){try{var tmp=eval(fn),data;if(tmp){if(typeOf(tmp)==="function"){if(id in _callbacks){_callbacks[id]()}else{if(taStore.has("pending."+id)){data=taStore.retrieve("pending."+id);if(data.evnt){tmp.attempt([data.evnt,data.elmt])}else{tmp.attempt()}}else{tmp.attempt()}}}else{if(IS_DEBUG){alert("fn is not a function: "+typeOf(tmp))}}}else{exports.waitForFnAgain(id,fn)}}catch(e){exports.waitForFnAgain(id,fn)}};exports.WAIT_DELAY=100;exports.WAIT_TIMEOUT=50;exports.waitForFnAgain=function(id,fn){var data=taStore.has("pending."+id)?taStore.retrieve("pending."+id):{t:"f",fn:fn,count:1};if(data.count<exports.WAIT_TIMEOUT){data.count++;data.timer=exports.waitForFn.invokeLater(exports.WAIT_DELAY,null,[id,fn]);taStore.store("pending."+id,data)}else{if(IS_DEBUG&&!taStore.has("pending.ignore."+id)){alert("timed out ("+(exports.WAIT_TIMEOUT*exports.WAIT_DELAY)+"ms) waiting for function: "+fn)}}};exports.waitForFile=function(id,file,fn){if(taLoad.load(file)){exports.waitForFn(id,fn)}};exports.waitForHandler=function(id,fn,evnt,elmt){taStore.store("pending."+id,{count:0,t:"f",fn:fn,evnt:evnt,elmt:elmt});exports.waitForFn(id,fn)};exports.cancel=function(id){var p=taStore.remove("pending."+id);if(p&&p.timer){clearTimeout(p.timer)}};exports.lock=function(id,fn,timer,fail){if(taStore.has("pending."+id)){return[fail,false].pick()}taStore.store("pending."+id,true);if(timer){exports.unlock.delay(timer,null,id)}return fn()};exports.unlock=function(id){var o=taStore.remove("pending."+id);if(o&&typeof o==="object"){o.count--;if(o.count===0){o.fn()}else{taStore.store("pending."+id,o)}}};exports.multilock=function(id,fn,count){taStore.store("pending."+id,{count:count,fn:fn})};exports.multilockUpdate=function(id,delta){var key="pending."+id,lock=taStore.retrieve(key);if(lock){lock.count+=delta}};exports.wait=function(id,fn,delay,bind,args){taStore.store("pending."+id,{timer:fn.delay(delay,bind,args)})};exports.waitForElement=function(id,elmtId,callback){if(taStore.has("pending."+id)){return}var elmt=document.getElementById(elmtId);if(elmt){exports.cancel("pending."+id);callback(elmt)}else{taStore.store("pending."+id,{timer:exports.waitForElement.delay(2,null,[id,elmtId,callback])})}};exports.waitFor=function(check,fn,delay){if(check()){return fn()}setTimeout(function(){exports.waitFor(check,fn,delay)},delay);return false};exports.waitWithPing=function(truth,callback,pingCb,pingDuration){function waiter(failureCount,interval,pingDuration){var t=truth();if(t){callback(t)}else{if(pingCb&&failureCount>0&&failureCount%Math.ceil(pingDuration*1000/interval)==0){pingCb(failureCount*interval/1000)}setTimeout(function(){waiter(failureCount+1,interval,pingDuration)},interval)}}waiter(0,100,pingDuration||3)};exports.waitForSelector=function(selector,callback,pingCb,pingDuration){exports.waitWithPing(function(){return document.querySelector(selector)},callback,pingCb,pingDuration)};nsExporter.exportTo(exports,"ta.util.pending");return exports});define("utils/tempFunction",["vanillajs"],function(){var a=0;var c="__utils_tempFunction";var b={create:function(e,f){var d=c+a++;window[d]=f?e:function(){e();b.destroy(d)};return d},destroy:function(d){if(d in window&&d.indexOf(c)==0){delete window[d]}}};return b});define("ta/util/Load",["vanillajs","ns-exporter","ta/util/Error","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.Load","utils/resourceLoader","utils/tempFunction"],function(i,m,b,j,e,f,n,k){var g={};var d=false;var a=false;var h=[];var l;g.maps=function(o){if(d){o&&o()}else{if(a){h.push(o)}else{a=true;return ta.maps.load.library(function(){d=true;a=false;o&&o();h.each(function(p){p&&p()})})}}};g.mapsLazy=function(o){return j.run("ta.maps.load.library",{},o)};function c(r,q,s){var p=e.remove("infobox_js");if(p){var o=function(){g.maps(function(){n.load([p,r],q)})};if(!f.load(s,o)){b.record(null,"Rollup file was not found: ",s)}}else{b.record(null,"'infobox_js' path was not specified for this page")}}g.loadMapV2Lite=function(o,p){c(p,o,"ta-mapsv2-lite")};g.loadMapV2=function(o,p){c(p,o,"ta-mapsv2")};g.GoogleLoader=function(p){if(l=="loaded"){return p()}else{if(l=="loading"){return g.GoogleLoader.delay(500,this,p)}else{l="loading";var o=k.create(function(){l="loaded";p&&p();k.destroy(o)});n.load("//www.google.com/jsapi?callback="+o,{forceType:"js"})}}};g.LocalSearch=function(o){g.GoogleLoader(function(){google.load("search","1",{callback:function(){}})})};m.exportTo(g,"ta.util.load");return g});define("ta/util/Date",["vanillajs","ns-exporter"],function(b,c){var a={};a.MS_IN_DAY=1000*60*60*24;a.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];a.HOUR_CONST=12;a.THAI_BUDDHIST_YEAR_OFFSET=543;a.MAX_STAY_DURATION_DAYS=30;a.MAX_VR_DURATION_DAYS=183;a.MAX_DAYS_BEFORE_RETURN_FLIGHT=330;a.inDateSet=function(f,e){if((f==null)||(e==null)){return false}var h=e.length;for(var g=0;g<h;g++){var j=e[g];if(j.length){var k=j[0].getTime();var d=j[1].getTime();if((k<=f.getTime())&&(d>=f.getTime())){return true}}else{if(f.getTime()==j.getTime()){return true}}}return false};a.rangesIntersect=function(d,e){return Math.max(d[0].getTime(),e[0].getTime())<=Math.min(d[1].getTime(),e[1].getTime())};a.getDaysInRange=function(e,d){return Math.round((d.getTime()-e.getTime())/a.MS_IN_DAY)+1};a.getLastDayOfMonth=function(d){var e=new Date();if(d){e=new Date(d.getTime())}e=new Date(a.normalize(e));e.setDate(1);e.setMonth(e.getMonth()+1);e.setDate(0);return e.getDate()};a.getDaysApart=function(f,e){var d=24*60*60*1000;if(f&&e){return Math.round(Math.abs((f.getTime()-e.getTime())/(d)))}return 0};a.inSameMonth=function(e,d){return(e!=null)&&(d!=null)&&(e.getMonth()==d.getMonth())&&(e.getYear()==d.getYear())};a.normalize=function(d){return d.setHours(a.HOUR_CONST,0,0,0)};a.create=function(g,e,f){return new Date(g,e,f,a.HOUR_CONST)};c.exportTo(a,"ta.util.date");return a});define("ta/util/Currency",["vanillajs","ta/util/Cookie","ta/Core/TA.Record","ns-exporter"],function(c,b,e,d){var a={};a.formatCurrency=function(i,f,m,g){var l=f?f:"USD";var h=window.currencySymbol[l];var k=i;if(!g){k=a.formatThousands(Math.round(i))}var j=h[0];if(m&&a.addSpace(j)){if(!h[1]){return j+" "+k}else{return k+" "+j}}if(!h[1]){return j+k}else{return k+j}};a.formatCurrencyRange=function(l,g,f,k){var j=f?f:"USD";var h=window.currencySymbol[j];var i=h[0];if(k&&a.addSpace(i)){l=a.formatThousands(Math.round(l));g=a.formatThousands(Math.round(g));return a.formatCurrency(l+" - "+g,f,true,true)}else{l=a.formatCurrency(l,f);g=a.formatCurrency(g,f);return l+" - "+g}};a.addSpace=function(f){return/^[a-zA-Z]+$/i.test(f)};a.formatThousands=function(g){if(typeof groupingSize=="undefined"||typeof groupingSeparator=="undefined"||groupingSize<1){return g}var f="";var j=""+g;for(var h=1;h<=j.length;h++){f=j.charAt(j.length-h)+f;if(h%groupingSize==0&&h<j.length){f=groupingSeparator+f}}return f};a.setCurrencyAndReload=function(f,g){var h="SetCurrency";b.write(h,f,15000);g=g?g+"|":"";e.trackEventOnPage("CurrencyPicker","Select",g+f);location.reload(true)};d.exportTo(a,"ta.util.currency");return a});define("ta/util/Toggle",["api-mod","vanillajs","ns-exporter"],function(b,c,e){var a={};a.siblings=function(h,g){b.stopEvent(h);var f=b.hasClass(g,"closed");b.toggleClass(g,"closed sprite-arrow_toggle_blu_lft");Array.prototype.slice.call(g.parentNode.childNodes).forEach(function(i){if(i!=g&&i.nodeType==1&&!b.hasClass(i,"ignore_toggle")){i.style.display=f?"block":"none"}})};a.parentClass=function(h,f){b.stopEvent(h);var g=b.getParent(f,"toggle");g&&b.toggleClass(g,"off")};a.toggleTarget=function(h,f,g){b.stopEvent(h);b.toggleClass(f,"closed");b.toggleClass(f,"open");g.style.display=b.hasClass(f,"closed")?"none":"block"};a.toggleLI=function(k,j,f){var g=0;for(var h=k.nextSibling;h&&h.id!=j.id;h=h.nextSibling){if(h.nodeType==1){h.style.display=f?"block":"none"}if(++g>1000){break}}k.style.display=f?"none":"block";j.style.display=f?"block":"none"};a.splitHotel=function(){var j=b.find("#HOTEL_DESCRIPTION .descriptive_text");var h="textContent" in j?"textContent":"innerText";var i=j[h];var g=1000;if(i&&i.length>g){var f=i.substring(0,g);var k=i.substring(g,i.length);b.select("#HOTEL_DESCRIPTION .descriptive_text").forEach(function(l){l[h]=f});b.select("#HOTEL_DESCRIPTION .description_ellipsis, #HOTEL_DESCRIPTION .more_description").forEach(function(l){l.style.display="inline"});b.select("#HOTEL_DESCRIPTION .descriptive_text_last").forEach(function(l){l[h]=k})}};a.expandHotel=function(j,g){var f=b.find(".descriptive_text_last",g.parentNode);var i=b.find(".less_description",g.parentNode);if(i){i.style.display="inline"}if(f){f.style.display="inline";var h=d(f);h&&(h.style.display="none")}g.style.display="none"};a.truncateHotel=function(j,g){var i=b.find(".more_description",g.parentNode);var f=b.find(".descriptive_text_last",g.parentNode);if(i){i.style.display="inline"}if(f){f.style.display="none";var h=d(f);h&&(h.style.display="inline")}g.hide()};function d(f){for(var g=f.previousSibling;g;g=g.previousSibling){if(g.nodeType==1){return g}}}e.exportTo(a,"ta.util.Toggle");return a});define("ta/util/URL",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Store"],function(c,b,d,e){var a={parse:function(k){if(/^(\w+):(.*)/.test(k)){k=RegExp.$2;switch(RegExp.$1){case"DOM":var h=b.find(k);k=(h&&h.href)?h.href:"#";break;case"GMapsLC":if(k.length==0){break}var g=k.split(",");var i={from:pageServlet,Action:g.shift()};g.forEach(function(l){if(/^g(\d+)$/.test(l)){i.g=RegExp.$1}else{if("ext"==l){i.ext="y"}else{if(/^(.*)=(.*)$/.test(l)){i[RegExp.$1]=RegExp.$2}else{i[l]=""}}}});k="/GMapsLocationController?"+b.toFormQueryString(i);break;case"ABS":var f=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(k.charAt(0)!="/"){k="/"+k}k=window.location.protocol+"//"+window.location.hostname+f+k;break;case"ABSPAGE":var f=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(k.charAt(0)!="/"){k="/"+k}k=window.location.protocol+"//"+window.location.hostname+f+k;if(k.indexOf(".html")==-1){k+=".html"}break;case"REL":var j=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"));if(/\/$/.test(window.location.pathname)){j=window.location.pathname}var f=window.location.port=="80"?"":(":"+window.location.port);if(k.charAt(0)!="/"){k="/"+k}k=window.location.protocol+"//"+window.location.hostname+f+j+k;break;default:k=RegExp.$1+":"+k;break}}return k},getParameter:function(h,f){var g=new RegExp("[?&]"+f+"=([^&]+)");if(g.test(h)){return RegExp.$1}return false},getAbsoluteUrl:function(f){return location.protocol+"//"+location.hostname+f},https:function(f){f=f||"";if(f.indexOf("http")===-1){f=a.getAbsoluteUrl(f)}if(f.indexOf("https://")===0){return f}if(e.retrieve("access_control_headers")){return f.replace("http://","https://")}return f},getServletNameFromUrl:function(f){return/^(?:\w+:\/\/.*)?\/([^-?]*).*/.exec(f)&&RegExp.$1}};d.exportTo(a,"ta.util.URL");return a});define("ta/util/I18N",["vanillajs","ns-exporter"],function(b,c){var a={};a.isRtl=function(){return !!document.body.className.match(/\brtl\b/)};c.exportTo(a,"ta.util.i18n");return a});/*
 * hoverIntent v1.8.1 // 2014.08.11 // jQuery v1.9.1+
 * http://briancherne.github.io/jquery-hoverIntent/
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
define("lib/jquery/jquery.hoverIntent",["lib/jquery-amd"],function(d){var h={interval:100,sensitivity:6,timeout:0};var i=0;var g,f;var b=function(j){g=j.pageX;f=j.pageY};var a=function(m,k,l,j){if(Math.sqrt((l.pX-g)*(l.pX-g)+(l.pY-f)*(l.pY-f))<j.sensitivity){k.off(l.event,b);delete l.timeoutId;l.isActive=true;m.pageX=g;m.pageY=f;delete l.pX;delete l.pY;return j.over.apply(k[0],[m])}else{l.pX=g;l.pY=f;l.timeoutId=setTimeout(function(){a(m,k,l,j)},j.interval)}};var e=function(m,k,l,j){delete k.data("hoverIntent")[l.id];return j.apply(k[0],[m])};return function c(n,o,j){var m=i++;var l=d.extend({},h);if(d.isPlainObject(n)){l=d.extend(l,n);if(!d.isFunction(l.out)){l.out=l.over}}else{if(d.isFunction(o)){l=d.extend(l,{over:n,out:o,selector:j})}else{l=d.extend(l,{over:n,out:n,selector:o})}}var k=function(u){var s=d.extend({},u);var q=d(this);var p=q.data("hoverIntent");if(!p){q.data("hoverIntent",(p={}))}var t=p[m];if(!t){p[m]=t={id:m}}if(t.timeoutId){t.timeoutId=clearTimeout(t.timeoutId)}var r=t.event="mousemove.hoverIntent.hoverIntent"+m;if(u.type==="mouseenter"){if(t.isActive){return}t.pX=s.pageX;t.pY=s.pageY;q.off(r,b).on(r,b);t.timeoutId=setTimeout(function(){a(s,q,t,l)},l.interval)}else{if(!t.isActive){return}q.off(r,b);t.timeoutId=setTimeout(function(){e(s,q,t,l.out)},l.timeout)}};return this.on({"mouseenter.hoverIntent":k,"mouseleave.hoverIntent":k},l.selector)}});define("ta/util/Element",["lib/jquery-amd","utils/ajax","ta/Core/TA.Record","ns-exporter","ta/Core/TA.Event","lib/jquery/jquery.hoverIntent","utils/throttle"],function(d,h,f,i,g,a,l){var c={};c.replaceContent=function(m,p,o){p=d(p);if(!p.find(".progresstab")){var n=o+(o.indexOf("?")==-1?"?":"&")+"xhr=true";p.append('<div class="progresstab"></div>');h({url:n,success:function(q){p.html(q);if(window.behavior){window.behavior.apply(p)}ta.legacyFireEvent(p,"onContentReplaced",[m,p.get(0)])},evalScripts:true}).get()}};c.spinner=function(n,m){d(m).parents(".spinnerReplaceable").children().each(function(o,p){p.toggle(p.hasClass("spinner"))})};c.limitLength=function(n,m,o){if(m.value.length>=o){m.value=m.value.substr(0,o);return false}return true};c.updateValue=function(m,n){m=d(m);if(m.val()!=n){m.val(n).trigger("change",m)}};c.keepInWindow=function(p,o){if(!p){return}p=d(p);if(!o){o={top:true,right:true,bottom:true,left:true}}function u(w,x){var y=parseInt(w.get(0).style[x]);return y||y===0}var v=2;var t=p.offset();t.right=t.left+p.width();t.bottom=t.top+p.height();var r=d(window);var s=r.width(),q=r.height();var m=r.scrollTop(),n=r.scrollLeft();if(o.right&&u(p,"right")){if(t.left<n+v){p.css("right",s+n-p.width()-v)}else{if(t.right>s-n-v){p.css("right",v)}}}else{if(o.left&&u(p,"left")){if(t.left<n+v){p.css("left",v)}else{if(t.right>s-n-v){p.setStyle("left",s+n-t.width-v)}}}}if(o.bottom&&u(p,"bottom")){if(t.top<m+v){p.setStyle("bottom",q+m-t.height-v)}else{if(t.bottom>q-m-v){p.setStyle("bottom",v)}}}else{if(o.top&&u(p,"top")){if(t.top<m+v){p.setStyle("top",v)}else{if(t.bottom>q-m-v){p.setStyle("top",q+m-t.height-v)}}}}};var e=function(o,n){var m=n;if(o=="px"){m=8}else{if(o=="em"){m=0.5}else{if(o=="pt"){m=6}else{if(o=="%"){m=50}}}}return Math.max(n,m)};function k(n,q){var p=n.style.fontSize||d(n).css("font-size");var o=p.replace(/[\d\.]/g,"");var m=e(o,parseFloat(p)*q);n.style.fontSize=m+o}c.makeTextFit=function(n,p,o,s,r){r=r||1;s=s||8;var q=false;d(n).each(function(z,u){u=d(u);var A=u.find(p);if(!A){return}var t;if(typeof o=="number"){t=o}else{t=u.find(o).outerHeight();if(t===undefined){return}}var v=A.height();if(t<v){var B=A.css("font-size");if(B){var w=function(D,C){return(C=="px"&&D>=s)||(C=="em"&&D>=0.5)||(C=="pt"&&D>6)||(C=="%"&&D>=50)};var y=B.replace(/[\d\.]/g,"");var x=parseFloat(B)*Math.sqrt(t/v);if(y=="px"){x=Math.max(parseInt(x),s)}if(w(x,y)){A.css("font-size",x+y);q=true}}}});if(q>0&&r<4){g.fireEvent("makeTextFitResizedText");var m=this;setTimeout(function(){m.makeTextFit(n,p,o,s,r+1)},1)}};(function(){var n=4;var q=0.9;c.makeTextFitOneLine=function(v,s){var t=d(v);t.each(function(w,x){r(x)});if(s){var u;t.each(function(w,y){var x=d(y).css("font-size");if(!u||parseFloat(x)<parseFloat(u)){u=x}});if(u){t.css("font-size",u)}}};c.autoResizeTextInNode=function(t){t=d(t);var v=d(".autoResize",t);var u={};var s={width:{},text:{}};v.filter(":visible").removeClass("autoResize").each(function(w,y){var A=y.getAttribute("data-resizeWidthGroup");var x=y.getAttribute("data-resizeTextGroup");var z,B;if(A){z=s.width;B=A}else{if(x){z=s.text;B=x}}if(z){if(!z[B]){z[B]=[]}z[B].push(y)}else{r(y);o(y,u)}});p(s.width);m(s.text);v.each(function(w,x){var y=x.getAttribute("data-sizegroup");if(y){x.style.fontSize=u[y]+"px"}})};function r(u){var w=false;var v=u.clientWidth;var s=(parseFloat(u.style.paddingLeft)||0)+(parseFloat(u.style.paddingRight)||0);for(var t=0;t<n&&u.scrollWidth>v;t++){var x=(v-s)/(u.scrollWidth-s);k(u,x);w=true}if(u.scrollWidth>v){k(u,q);w=true}return w}function o(t,u){var v=t.getAttribute("data-sizegroup"),s=parseFloat(t.style.fontSize);if(v){u[v]=Math.min(u[v]||Number.MAX_VALUE,s)}}function p(t){for(var v in t){if(t.hasOwnProperty(v)){var w=t[v];var u=[];w.forEach(function(x){u.push([x.scrollWidth,x])});u.sort(function(y,x){return x[0]-y[0]});for(var s=0;s<u.length;s++){if(!r(u[s][1])){break}}}}}function m(s){var u;for(var t in s){if(s.hasOwnProperty(t)){u={};s[t].forEach(function(v){var x=v.innerHTML;var w=u[x];if(w!==undefined){if(w!=0){v.style.fontSize=w}}else{if(r(v)){u[x]=v.style.fontSize||0}else{u[x]=0}}})}}}g.on("refreshedDOMContent",function(s){c.autoResizeTextInNode(s)});g.queueForLoad(function(){if(document.body){c.autoResizeTextInNode(document.body)}},"autoResize all targets on load")})();c.makeSameWidth=function(m){var n=0;d(m).each(function(o,q){var p=Math.round(parseFloat(q.style.width));if(p&&p>n){n=p}}).css("width",n)};c.fitToContentsHorizontally=function(n,o,p,m){m=m||1;if(m<=0||o>p){return}var q=function(r){return r.scrollWidth>r.clientWidth||r.scrollHeight>r.clientHeight};d(n).each(function(r,s){s.style.width=o;for(var t=o;t<p&&q(s);t+=m){s.style.width=t}if(q(s)){s.style.width=p}})};c.scrollIntoView=function(o,q,m,s){if(!o){return}o=d(o);var r=o.offset().top+(q||0);if(m){var n=d("html, body");var p=o.parent();while(p.length&&!p.is(n)&&p.css("overflow")!="auto"){p=p.parent()}if(!p.length||p.is(n)||p.css("overflow")!="auto"){p=n}else{r=p.offset().top+p.scrollTop()+(q||0)}p.animate({scrollTop:r},{duration:300,complete:function(){s&&s()}})}else{window.scrollTo(0,r);s&&s()}};function j(){var q=[];var n=this;this.add=function(r){q.push(r);m(q.length-1);if(q.length>0){d(window).on("resize scroll",o)}};this.inViewport=function(t,s,u,v){t=d(t);if(!t.is(":visible")){return false}v=d.extend({top:0,left:0,right:0,bottom:0},v);if(u){var r=u.offsetHeight;if(r){if(u.offsetTop==0){v.bottom-=r}else{v.top+=r}}}var w=t.offset();if(!s){s=p()}return s.bottom>=Math.max(w.top+v.top,0)&&s.right>=Math.max(w.left+v.left,0)&&s.top<=Math.max(w.top+t.height()+v.bottom,0)&&s.left<=Math.max(w.left+t.width()+v.right,0)};var o=l(function(){if(q.length){var s=p();for(var r=q.length-1;r>=0;r--){m(r,s)}if(q.length==0){d(window).off("resize scroll",o)}}},300);function m(s,r){var v=q[s];var w=d(v.e);if(w.length>0){var u=v.inView;v.inView=false;w.each(function(){if(v.inView){return false}v.inView=n.inViewport(this,r,v.persistentElmt,v.offset)});if(!u&&v.inView){v.cb&&v.cb();if(!v.multiple){q.splice(s,1)}}}}function p(){var s=d(window);var r={};r.top=s.scrollTop();r.left=s.scrollLeft();r.bottom=r.top+s.height();r.right=r.left+s.width();return r}d(window).on("load",o)}var b=c.scrollTrackers=new j();c.isScrolledIntoView=function(m,n,o){return b.inViewport(m,null,n,o)};c.doIfElementIsVisible=function(n,o,m,p){if(n){b.add({e:n,cb:function(){o.apply(null,m);return true},offset:p})}};c.trackWhenScrolledIntoView=function(o,p,n){if(o&&p){var m=function(){f.trackEventOnPage.apply(f,p)};b.add({e:o,cb:m,multiple:n})}};c.getTotalWidth=function(m){return d(m).outerWidth(true)||0};c.getTotalHeight=function(m){return d(m).outerHeight(true)||0};c.hoverIntent=function(n,m){a.bind(d(n),m)()};i.exportTo(c,"ta.util.element");return c});define("ta/util/Link",["vanillajs","api-mod","ta/util/Error","utils/ajax","ta/util/ASDF","ta/Browser","ta/Core/TA.Record","ns-exporter","ta/Core/TA.Store"],function(h,g,a,i,e,f,d,j,b){var c={popResWidth:function(l,o,n){try{var k=475,p=390,r=210;if(screen.width>1024){k=800;p=600;r=240}else{if(screen.width>800){k=620;p=500;r=240}}var q=g.merge({width:k,height:p,xOffset:r,yOffset:5},n);c.popup(l,o,q)}catch(m){a.record(m,"ta.util.link - popCustom",l,q)}},popup:function(v,k,s){try{var p=g.merge({name:false,width:950,height:610,xOffset:false,yOffset:false,noScroll:0,aHref:false,fullOptions:true,ensureReferrer:false,isAsdf:false},s);if(v){g.stopEvent(v)}var o=false,l="";var m=b.retrieve("ta.popups.popupIndex");if(typeof m=="undefined"){m=1}if(!p.aHref){p.aHref=k.href}p.aHref=p.aHref.replace("%7Cnavarea%7C",ta.meta.link.getPhotoNavArea(k));if(p.isAsdf&&p.aHref){p.aHref=e.asdfDcd(p.aHref).replace(/&amp;/g,"&")}if(p.aHref&&p.aHref.indexOf("p=HotelsCom")>-1){p.width=Math.max(p.width,960);try{p.height=Math.max(p.height,window.getHeight(),600)}catch(q){p.height=Math.max(p.height,600)}}if(p.width){l+=",width="+p.width}if(p.height){l+=",height="+p.height}if(p.xOffset){l+=",screenX="+p.xOffset+",left="+p.xOffset}if(p.yOffset){l+=",screenY="+p.yOffset+",top="+p.yOffset}if(!f.isChrome){p.noScroll=1}if(p.fullOptions){var r=1;if(f.isIE9orHigher()){r=0}l="toolbar=1,resizable=1,menubar="+r+",location=1,status=1,scrollbars="+p.noScroll+l}else{l="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+p.noScroll+l}if(!p.name){p.name="p"+(m++)}b.store("ta.popups.popupIndex",m);if(p.ensureReferrer&&f.isIE()){try{var u=document.createElement("a");u.target=p.name;u.href=p.aHref;document.body.appendChild(u);o=window.open("",p.name,l);g.fireEvent(u,"click");document.body.removeChild(u)}catch(n){a.record(n,"ta.util.link - pop ensure referrer",v,p)}}else{try{o=window.open(p.aHref,p.name,l)}catch(q){a.record(q,"ta.util.link - popping window",v,{href:p.aHref,name:p.name,args:l})}}if(typeof o!="undefined"&&o!==null){try{o.opener=self;o.focus()}catch(n){}}}catch(t){a.record(t,"ta.util.link - popup",v,p)}},directionsPop:function(k,m,l,n){if(n){i("/ActionRecord?action="+n)}d.trackEventOnPage("map_pin_overlay","directions_click");c.popup(k,m,l)},directionsPopInfoCard:function(k,m,l,n){if(n){i("/ActionRecord?action="+n)}d.trackEventOnPage("dynamic_large_map","map_info_window","directions_cta");c.popup(k,m,l)},targetBlank:function(k,n,m){try{var o=g.merge({aHref:false,isAsdf:false},m);if(o.isAsdf&&o.aHref){o.aHref=e.asdfDcd(o.aHref).replace(/&amp;/g,"&")}if(o.newTab||navigator.appVersion.indexOf("MSIE 7.")!=-1){window.open(o.aHref,"_blank")}else{if(b.retrieve("ta.bl_calendar_lb")){ta.servlet.Popup.openExternalWithDefaultOptions(o.aHref)}else{window.open(o.aHref,"_blank")}}}catch(l){a.record(l,"ta.util.link - targetBlank",k,o)}}};j.exportTo(c,"ta.util.link");return c});define("overlays/loading-spinner",["vanillajs"],function(){var a=null;return function(){if(!a){a='<div style="padding:36px; min-width: 100px; min-height: 100px">';if(window.AnimationEvent){a+='<div class="cssLoadingSpinner" style="display:block">'}var c=window.CDNHOST||(require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("CDNHOST"));a+='<div class="spinnerImage" style="position: absolute; top: 50%; left: 50%; width: 32px; height: 32px; margin-top: -16px; margin-left: -16px; background:url('+c+'/img2/generic/site/ajax-loader.gif)"></div>';if(window.AnimationEvent){for(var b=1;b<=8;b++){a+='<div class="cssLoadingSpinner_step'+b+'"></div>'}a+="</div>"}a+="</div>"}return a}});define("overlays/utils",["vanillajs","overlays/loading-spinner","api-mod"],function(c,d,b){var a={};a.arrowDir={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"right",rightEvenInRtl:"left",bottomRight:"top",bottomLeft:"top"};a.arrowDirRtl={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"left",rightEvenInRtl:"right",bottomRight:"top",bottomLeft:"top"};a.getArrowDir=function(k,i,e){var h=(b.hasClass(document.body,"rtl")?a.arrowDirRtl:a.arrowDir);if(k==="wideside"&&i&&e){var g=b.getSize(i);var f=b.getPosition(i);var j=b.getSize(e);return f.left>(j.x-f.left-g.x)?h.left:h.right}return h[k]};a.injectContent=function(f,g,i,e,h){if(b.isElement(i)){b.adopt(f,i)}else{if(e){i=b.find(e,g);b.removeClass(i,"hidden");b.adopt(f,i)}else{if(h){i=b.find(h);i&&(f.innerHTML+=i.innerHTML)}else{f.innerHTML+=i}}}};a.injectContentWithDataAttrs=function(f,g,i,e,h){i=i||(g&&g.getAttribute("data-content"))||"";e=e||(g&&g.getAttribute("data-element"))||"";h=h||(g&&g.getAttribute("data-element-copy"))||"";a.injectContent(f,g,i,e,h)};a.parseOffsets=function(e){if(!e||!e.length){return{x:0,y:0}}return{x:e[0]&&parseInt(e[0],10)||0,y:e[1]&&parseInt(e[1],10)||0}};a.loadingSpinnerHtml=d;return a});define("overlays/Overlay",["vanillajs","api-mod","mixins/Events","overlays/utils"],function(e,d,c,b){var a=function(h,f){this.sourceElement=h;this.domParent=document.body;this.container=null;this.contentElement=null;d.mixin(this,new c("show","hide","destroy","positionDirty","hover"));d.bindAll(this,"show","hide","destroy");var f=(f&&Object.prototype.toString.call(f)==="[object Array]"?f:Array.prototype.slice.call(arguments,1));for(var g=0;g<f.length;g++){f[g]&&f[g].call(this)}};a.prototype.isOpen=function(){return d.inDocument(this.container)};a.prototype.show=function(){if(d.inDocument(this.container)){return this}this.domParent.appendChild(this.container);this.container.overlay=this;this.emit("append");this.emit("show");return this};a.prototype.hide=function(f){if(!d.inDocument(this.container)){return this}delete this.container.overlay;this.domParent.removeChild(this.container);this.emit("hide",{trigger:f});return this};a.prototype.destroy=function(f){this.hide(f);this.emit("destroy",{trigger:f});this.sourceElement=null;this.contentElement=null;return this};a.prototype.reposition=function(){this.emit("positionDirty");return this};a.prototype.updateContent=function(f){this.contentElement.innerHTML="";b.injectContentWithDataAttrs(this.contentElement,this.sourceElement,f);return this.reposition()};return a});define("overlays/styles/modal",["vanillajs","api-mod"],function(d,b){function c(f,h,i,e,g){this.container=b.createElement(g||"span",{"class":"ui_overlay ui_modal "+h});if(i){this.header=b.createElement("div",{"class":"header_text"});this.header.innerHTML=i;this.container.appendChild(this.header)}if(e){this.subheader=b.createElement("div",{"class":"subheader_text"});this.subheader.innerHTML=e;this.container.appendChild(this.subheader)}this.inner=b.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner;this.close=b.createElement("div",{"class":"ui_close_x"});this.container.appendChild(this.close)}var a=function(i,g,f,k,e,j,h){f=f||(i&&i.getAttribute("data-modal"))||"";k=k||(i&&i.getAttribute("data-header"))||"";e=e||(i&&i.getAttribute("data-subheader"))||"";return function(){c.call(this,g,f,k,e,h);this.updateContent(j);b.addEvent(this.close,"click",b.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return a});define("overlays/position",["vanillajs","api-mod","overlays/utils"],function(i,h,f){function d(o,n,m,l){return function(p,r,q){return function(){function s(){var y=h.getSize(this.arrow)||{x:0,y:0},z=a(p,this.sourceElement),u=(z?h.getSize(z):{x:0,y:0}),w=(z?h.getPosition(z):{left:0,top:0}),B=h.getSize(this.domParent),v=f.parseOffsets(k(p)),x=!z||r||g(this.sourceElement);this.container.style.position=x&&!q?"fixed":"absolute";var t=h.getSize(this.container);if(z&&z.getAttribute("data-anchorWidth")){if(h.hasClass(document.body,"rtl")){w.left+=u.x;u.x=Number(z.getAttribute("data-anchorWidth"));w.left-=u.x}else{u.x=Number(z.getAttribute("data-anchorWidth"))}}var A=(function(C,E,D,F){if(typeof C==="function"){var G=Math.floor(C(t,y,u,w,B,x))+E;if(this.domParent===document.body){G=Math.max(G,D);G=Math.min(G,F)}return G+"px"}else{return"auto"}}).bind(this);if(o&&n&&m&&l){this.container.style.position="fixed"}this.container.style.left=A(o,v.x,0,Math.max(B.x-t.x,0));this.container.style.right=A(m,v.x,0,Math.max(B.x-t.x,0));this.container.style.top=A(n,v.y,-Number.MAX_VALUE,Number.MAX_VALUE);this.container.style.bottom=A(l,v.y,-Number.MAX_VALUE,Number.MAX_VALUE)}this.on("show",s);this.on("positionDirty",s);this.reposition=s.bind(this)}}}function b(l,m){return function(){return function(){function n(){var o=h.getSize(this.container);this.container.style.position="fixed";if(l){if(h.hasClass(document.body,"rtl")){this.container.style.right="50%";this.container.style.marginRight=-o.x/2+"px"}else{this.container.style.left="50%";this.container.style.marginLeft=-o.x/2+"px"}}if(m){this.container.style.top="50%";this.container.style.marginTop=-o.y/2+"px"}}this.on("show",n);this.on("positionDirty",n)}}}function j(){return function(){return function(){function l(){h.addClass(this.container,"cssCentered")}this.on("show",l);this.on("positionDirty",l)}}}function a(m,l){if(!m||!m.length||!isNaN(m[0])){return l}return l&&h.find(m[0],l)}function k(l){if(!l||!l.length||!isNaN(l[0])){return l}return l.slice(1)}function g(l){while(l){if(l==document.body){return false}if(l.style.position){return l.style.position=="fixed"}if(l.currentStyle&&l.currentStyle.position==="fixed"){return true}if(window.getComputedStyle&&getComputedStyle(l).getPropertyValue("position")==="fixed"){return true}l=l.parentNode}return false}var e={};e.above=d(function(q,n,l,m,p,o){return m.left+(l.x/2)-(q.x/2)-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top-q.y-n.y-(o?h.scrollTop():0)});e.below=d(function(q,n,l,m,p,o){return m.left+(l.x/2)-(q.x/2)-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)});e.bottomRight=d(function(q,n,l,m,p,o){return m.left-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)});e.bottomLeft=d(null,function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)},function(q,n,l,m,p,o){return p.x-(m.left+l.x)+(o?h.scrollLeft():0)});e.left=d(function(q,n,l,m,p,o){return m.left-q.x-n.x-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?h.scrollTop():0)});e.right=d(function(q,n,l,m,p,o){return m.left+l.x+n.x-(o?h.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?h.scrollTop():0)});e.wideside=d(function(q,n,l,m,p,o){if(m.left>(p.x-m.left-l.x)){return m.left-q.x-n.x-(o?h.scrollLeft():0)}else{return m.left+l.x+n.x-(o?h.scrollLeft():0)}},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?h.scrollTop():0)});e.center=d(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return(p.y/2)-(q.y/2)+(o?0:h.scrollTop())});e.centerBelow=d(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?h.scrollTop():0)});e.topCenter=d(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return 0});e.topLeft=d(null,function(q,n,l,m,p,o){return m.top-q.y-n.y-(o?h.scrollTop():0)},function(q,n,l,m,p,o){return p.x-(m.left+l.x)+(o?h.scrollLeft():0)});e.movingCenter=b(true,true);e.movingCenterX=b(true,false);e.movingCenterY=b(false,true);e.cssCentered=j();e.absolute=d(function(){return 0},function(){return 0});e.framed=d(function(){return 0},function(){return 0},function(){return 0},function(){return 0});e.offScreen=d(function(){return -10000},function(){return -10000});e.noop=function(){return function(){}};e.rightEvenInRtl=e.right;e.leftEvenInRtl=e.left;if(typeof(document)!="undefined"&&h.hasClass(document.body,"rtl")){e.left=e.rightEvenInRtl;e.right=e.leftEvenInRtl;var c=e.bottomRight;e.bottomRight=e.bottomLeft;e.bottomLeft=c}return e});define("overlays/options/closeOnEscape",["vanillajs","api-mod"],function(d,b){function c(e){if(e.keyCode===27){e.preventDefault();this.hide("escape")}}var a=function(){var e=b.bind(c,this);this.on("show",function(){b.addEvent(document,"keydown",e)}).on("hide",function(){b.removeEvent(document,"keydown",e)})};return a});define("overlays/options/repositionOnEvent",["vanillajs","api-mod"],function(a,b){function c(){this.emit("positionDirty")}return function(e,d){return function(){var g=d.splice?d:[d];var f=b.bind(c,this);this.on("show",function(){g.forEach(function(h){b.addEvent(e,h,f)})}).on("hide",function(){g.forEach(function(h){b.removeEvent(e,h,f)})})}}});define("overlays/options/autoReposition",["vanillajs","overlays/options/repositionOnEvent"],function(a,b){return b(window,["resize","scroll"])});define("overlays/styles/windowshade",["vanillajs","api-mod"],function(c,b){var a=function(d){return function(){this.shade=b.createElement("div",{"class":"ui_backdrop "+(d||"dark")});this.on("show",function(){this.domParent.appendChild(this.shade)});var e=this.hide;this.hide=function(){if(b.inDocument(this.shade)){this.domParent.removeChild(this.shade)}e.apply(this,arguments)}}};return a});define("utils/object/set-props",["vanillajs"],function(){return function a(c,d){for(var b in d){if(d.hasOwnProperty(b)){c[b]=d[b]}}return c}});define("utils/object/shallow-copy",["utils/object/set-props","vanillajs"],function(b){return function a(e){var c;if(typeof(e)!=="object"||e===null){return e}if(e.constructor===Array){c=[];for(var d=0;d<e.length;++d){c.push(e[d])}}else{c=b({},e)}return c}});define("utils/AjaxData",["ta","mixins/Events","lib/jquery-amd"],function(c,b,e){function d(){}function a(u){u=u||{};var r=new b("update");var j=null;var h=null;var s=null;var g=null;var q=this;var m=0;var t=u.ajaxFunc||e.ajax;var f=u.transformer||d;var l=u.dataType||"html";var p=!!u.holdData;var i=void (0);this.dataVersion=0;function n(){return(s!==null||g!==null)}function k(){var v=n();var y=j;var w=g;j=null;s=null;g=null;if(w!==null){try{w.abort()}catch(x){}}if(y!==null){clearTimeout(y)}return v}function o(){var v=s;s=null;if(!v){return}var w;v.success=function(x){if(g==w){g=null;if(p){i=x}q.data=x;q.error=void (0);q.dataVersion=++m;f(q,w,v.data);r.emit("update")}};v.error=function(z,y,x){if(g==w){g=null;q.data=i;q.dataVersion=++m;q.error={type:y,error:x,status:z.status,responseText:z.responseText};f(q,w,v.data);r.emit("update")}};w=t(v);g=w;r.emit("update")}this.on=r.on.bind(r);this.off=r.off.bind(r);this.removeListener=r.removeListener.bind(r);this.isDone=function(){return !n()};this.isBusy=function(){return n()};this.clear=function(){var v=n()||typeof(this.data)!=="undefined"||typeof(this.error)!=="undefined";k();i=void (0);q.data=void (0);q.error=void (0);q.dataVersion=0;f(q);if(v){r.emit("update")}};this.refresh=function(z,v,y,w,x){k();if(!w||w<0){w=0}s={type:z,url:v,data:y,dataType:l,xhrFields:{withCredentials:true}};if(typeof x!=="undefined"){s.timeout=x}j=setTimeout(o,w);q.error=void (0);if(!p){q.data=void (0);f(q)}r.emit("update")};this.postJson=function(v,y,w,x){k();w=w||0;if(w<0){w=0}s={beforeSend:function(z){z.setRequestHeader("Content-Type","application/json")},type:"POST",url:v,contentType:"application/json",data:JSON.stringify(y),dataType:l,xhrFields:{withCredentials:true}};if(typeof x!=="undefined"){s.timeout=x}j=setTimeout(o,w);q.error=void (0);if(!p){q.data=void (0);f(q)}r.emit("update")}}return a});define("overlays/ajaxUtil",["vanillajs","ta","utils/object/shallow-copy","utils/AjaxData","mixins/Events","overlays/loading-spinner","utils/resourceLoader"],function(o,h,m,d,j,b,n){var c={};var q=10;var e=[];var k={};var g=q;var a=false;var s;var r=b();function i(y,u){var t=[];var x;for(x in u){t.push(x)}t.sort();var v=y;var z=v.indexOf("?")>=0?"&":"?";for(var w=0;w<t.length;++w){x=t[w];v+=z+encodeURIComponent(x)+"="+encodeURIComponent(String(u[x]));z="&"}return v}function p(){var t=0;var u={};var x=[];for(var w=e.length-1;w>=0;--w){var v=e[w];var y=k[v];if(y&&!u[v]){if(y.hasClients()||(++t<=q)){u[v]=y;x.push(v)}}}x.reverse();k=u;e=x;g=e.length+q;return e}function l(H,B){var J=this;var u=new d({dataType:"html",ajaxFunc:B.ajaxFunc});var C=new j("update","data-targetEvent");var t=B.loadingContent||r;var D=false;var L=!!B.sendTravelInfo;var A=void (0);var v=t;var G=u.dataVersion;var x=[];var K=0;var y;var E;function F(){var O=h.page.datesToQueryString("STAYDATES");if(O&&s!==O){s=O;p();for(var M=e.length-1;M>=0;--M){var N=k[e[M]];if(N.needsTravelInfo){N.invalidate()}}}}function I(S,O,Q,P,M,N){P=P&&h.page&&h.page.usingUnifiedDates;if(P){var R=h.page.datesToQueryString("STAYDATES");if(R){O+="&"+R}if(!a){a=true;s=R;h.page.on("dateSelected",F)}}if(M>1){if(M>20){return}O+="&reqNum="+M;if(!(N>=0)){N=2000}}else{N=0}if(!Q){S.refresh("GET",O,void (0),N)}else{S.refresh("POST",O,Q,N)}n.load(y,function(){E=true;w()})}function w(){if(u.isBusy()||!E){if(A){clearTimeout(A)}A=void (0);return}if(!u.data){if(u.dataVersion!==0){if(!J.error||J.error!==u.error){J.error=u.error||"no content";A=A||setTimeout(z,0)}}else{if(G!==0){v=t;G=u.dataVersion;x=[];if(C.hasListeners("update")){A=A||setTimeout(z,0)}}}return}if(G===u.dataVersion){return}try{var P=document.createElement("div");P.innerHTML=u.data;var N=D;var M=document.head||document.getElementsByTagName("head")[0];x=[];if(!B.noScript){Array.prototype.forEach.call(P.querySelectorAll("script"),function(Q){if(N){var R=document.createElement("script");R.setAttribute("type","text/javascript");if(Q.src){R.src=Q.src}if(Q.text){R.text=Q.text}R.setAttribute("data-rup",Q.getAttribute("data-rup"));M.appendChild(R);if(!Q.src){M.removeChild(R)}}Q.parentNode.removeChild(Q)})}Array.prototype.forEach.call(P.querySelectorAll("style"),function(Q){if(N){M.appendChild(Q)}else{Q.parentNode.removeChild(Q)}});Array.prototype.forEach.call(P.querySelectorAll("[data-targetEvent]"),function(Q){x.push(Q);Q.parentNode.removeChild(Q)});if(N){D=false;c[B.inlineResourceId]=true}v=P.innerHTML;G=u.dataVersion;u.data=void (0)}catch(O){J.error="invalid HTML"}A=A||setTimeout(z,0)}function z(){var M=!C.hasListeners("update");var R;A=void (0);J.data=v;J.dataVersion=G;C.emit("update");while((R=x.shift())){var Q=R.getAttribute("data-targetEvent");if(Q==="repoll-required"){if(M){x=[];J.data=v=t;J.dataVersion=G=0;return}if(!(++K>1)){K=2}var N=Number(R.getAttribute("data-delay"));I(u,H,B.reqParams,L,K,N)}else{if(Q==="offerClickTrackingTree"){try{var O=require("commerce/impression-tracker");if(O){O.onTrackingTreeElement(R)}}catch(P){}}else{C.emit("data-targetEvent",Q,R)}}}}this.error=void (0);this.loadingData=t;this.data=v;this.dataVersion=G;this.needsTravelInfo=L;this.on=C.on.bind(C);this.off=C.off.bind(C);this.removeListener=C.removeListener.bind(C);this.init=function(){u.on("update",w.bind(this))};this.isBusy=function(){return u.isBusy()||A};this.isDone=function(){return !u.isBusy()&&!A};this.invalidate=function(){u.clear();K=0;if(this.hasClients()){I(u,H,B.reqParams,L,0,0)}};this.hasClients=function(){return(C.hasListeners("update"))};this.load=function(){if(u.isBusy()){return}else{if(u.dataVersion!==0){setTimeout(function(){C.emit("update")},1);return}}var T=B.reqParams;var R=!B.isWidget||!B.inlineResourceId||!c[B.inlineResourceId];if(R){var Q=[];var S=[];var N=document.head||document.getElementsByTagName("head")[0];var P;var O=document.head.querySelectorAll('link[type="text/css"][rel=stylesheet][data-rup]');for(var M=0;M<O.length;M++){P=O[M].getAttribute("data-rup");if(P){Q.push(P)}}O=document.querySelectorAll("script[data-rup]");for(M=0;M<O.length;M++){P=O[M].getAttribute("data-rup");if(P){S.push(P)}}D=true;T=(T?m(T):{});T.haveJses=String(S);T.haveCsses=String(Q);if(B.isWidget){T.Action="install"}}y=B.resources;K=0;I(u,H,T,L,0,0)}}function f(v,u){var w=i(v,u.reqParams);if(w.length<128){v=w;u.reqParams=void (0)}var t=k[w];if(!t){t=new l(v,u);t.init();if(!u.noCache){k[w]=t}}if(!u.noCache){e.push(w);if(e.length>g){p()}}return t}return{loadData:function(u,t){!t&&(t={});var v=f(u,t);v.load();return v},loadOverlayWidget:function(w,u){var t="/OverlayWidgetAjax?Mode="+w;if(typeof(crPageServlet)==="string"){t+="&metaReferer="+encodeURIComponent(crPageServlet)}u=(u?m(u):{});u.inlineResourceId=w;u.isWidget=true;var v=f(t,u);v.load();return v},cleanCache:p}});define("overlays/options/ajax",["vanillajs","overlays/ajaxUtil"],function(d,b){function a(e){return e&&e.match(/^((https?:)?(\/\/)?([\da-z\.\-\u00a1-\uffff]+)\.([a-z\.\u00a1-\uffff]{2,6}))?(\/[\w]+)*(\?[\/\w\.+%=\-#&\/!\u00a1-\uffff]+)?$/)}function c(f,e){if(!e){e={}}function g(){if(this.sourceElement){f=f||this.sourceElement.getAttribute("data-url");if(e.noCache===undefined){e.noCache=this.sourceElement.getAttribute("data-ajaxNoCache")}if(!e.resources){e.resources=this.sourceElement.getAttribute("data-resources");if(e.resources){e.resources=e.resources.replace(/[\[\]]/g,"").split(/[ ,]+/)}}}if(!f){return}var j;var m=0;var l=(function(){if(j.dataVersion!==m){this.contentElement.innerHTML=j.data;m=j.dataVersion;if(require.defined("ta/prwidgets")){require("ta/prwidgets").initWidgets(this.contentElement)}}this.reposition();setTimeout(this.reposition.bind(this),1);this.emit("contentLoaded",j.error)}).bind(this);var k;var i=(function(){if(k==f){this.reposition();return}j&&j.invalidate();k=f;j=b.loadData(f,e);this.contentElement.innerHTML=j.data;this.reposition();m=j.dataVersion;if(require.defined("ta/prwidgets")){require("ta/prwidgets").initWidgets(this.contentElement)}j.on("update",l);j.on("data-targetEvent",h)}).bind(this);var h=this.emit.bind(this,"data-targetEvent");this.on("show",i);this.on("hide",function(){if(j){j.off("update",l);j.off("data-targetEvent",h);j=void (0)}});var n=this.updateContent;this.updateContent=function(o){if(!o){f="";o=this.sourceElement.getAttribute("data-url");return o?this.updateContent(o):n.apply(this,arguments)}if(!a(o)){f="";return n.apply(this,arguments)}f=o;if(this.isOpen()){i()}return this}}return g}return c});define("ta/util/ajaxFormPopup",["vanillajs","api-mod","ta/util/Cookie","ta/util/Error","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax"],function(i,h,c,e,b,j,d,k,a,f,l){var g;return{open:function(o,n){if(!n||!n.form||(n.validate&&!n.validate(n.form))){return}if(n.pid){c.setPIDCookie(n.pid)}var m=h.getFormData(n.form);if(n.method!="post"){o+=o.indexOf("?")>=0?"&":"?";o+=h.toFormQueryString(m);m=null}if(g){g.hide()}g=new b(null,[j(null,"center","small"),d.center([0,0]),k,a,f(),l(o,{noScript:!n.evalScripts,reqParams:m})]);g.on("contentLoaded",function(p){if(p){e.ajaxFailure("link - ajaxSubmit",p);g.hide()}else{n.callback&&n.callback()}}).on("hide",function(){g.destroy();g=null});g.show()}}});define("ta/util/SessionStorage",["vanillajs","ns-exporter"],function(b,c){var a={};a.canUseSessionStore=function(){try{if(window.sessionStorage){var f="taLsTest";sessionStorage.setItem(f,"1");var d=sessionStorage.getItem(f);return(d=="1")}}catch(g){return false}};c.exportTo(a,"ta.util.sessionStorage");return a});define("ta/util/LocalStorage",["vanillajs","ns-exporter","ta/Core/TA.LocalStorage","ta/util/SessionStorage"],function(d,e,b,c){var a={canUseLocalStore:function(){return b.enabled},canUseSessionStore:function(){return c.canUseSessionStore()}};e.exportTo(a,"ta.util.localstorage");return a});define("ta/util/Decoder",["vanillajs","ta/util/Error","ns-exporter"],function(c,a,d){var b={base64Decoder:function(i){i=i.replace(/\-/g,"+").replace(/\_/g,"/");if(i.length%4!==0){var j=4-i.length%4;for(var h=0;h<j;h++){i=i+"="}}var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="",r,p,n="",q,o,l,k="";for(var g=0;g<i.length;g+=4){q=f.indexOf(i.charAt(g));o=f.indexOf(i.charAt(g+1));l=f.indexOf(i.charAt(g+2));k=f.indexOf(i.charAt(g+3));if(q==-1||o==-1||l==-1&&k==-1){a.record(null,"Facebook signed request contains invalid base64 letter",null,{code:i});return}r=(q<<2)|(o>>4);p=((o&15)<<4)|(l>>2);n=((l&3)<<6)|k;e=e+String.fromCharCode(r);if(l!=64){e=e+String.fromCharCode(p)}if(k!=64){e=e+String.fromCharCode(n)}r=p=n="";q=o=l=k=""}return unescape(e)}};d.exportTo(b,"ta.util.decoder");return b});ta.util.files={reset:function(a){if(Browser.ie){a.clone(false,true).replaces(a)}else{a.value=""}},upload:function(c,e,g){function b(j,h){var k;try{k=document.createElement("<"+j+' name="'+h+'">')}catch(i){k=document.createElement(j);k.setAttribute("name",h)}return k}var f="upload_iframe_"+(Math.random()+"").split(".")[1];var d=b("iframe",f);d.setAttribute("id",f);d.setAttribute("src","about:blank");d.setAttribute("width","0");d.setAttribute("height","0");d.setAttribute("border","0");d.setAttribute("style","width:0; height:0; border:none; display:none; ");document.body.appendChild(d);c.target=f;function a(){ta.id(d).removeEvent("load",a);var h=d.contentWindow.document;g(h);setTimeout(function(){d.parentNode.removeChild(d)},250)}ta.id(d).addEvent("load",a);c.submit()}};define("ta/util/Replace",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(b,c,d){var a={img:function(g,f){try{g.src=d.retrieve(f).src}catch(h){}}};c.exportTo(a,"ta.util.replace");return a});define("ta/util/ajax",["vanillajs","ns-exporter","ta/Core/TA.Record","ta/util/Error","ta/util/Object","ta/util/Deferred"],function(d,g,h,a,b,c){var e=function(q){q||(q={});try{if(q.trackEvent){var i=h._toEvtParams(q.trackEvent);q.data=b.merge(q.data||{},i)}}catch(k){a.record(k,"ta.util.ajax.initialize.trackEvent")}var p=c(q.aplus);var o=function(r){};var n,j;var l=function(r){if(!r){return""}return r.replace(/^\s*while\(1\);\s*/,"")};var m={onComplete:typeof q.onComplete==="function"?q.onComplete:o,onSuccess:typeof q.onSuccess==="function"?q.onSuccess:o,onFailure:typeof q.onFailure==="function"?q.onFailure:o,onReadOnly:q.onReadOnly||o,onRedirect:q.onRedirect||o};q.onComplete=function(){var r;var v=n.getResponseHeader("content-type");var s=q&&q.useContentType;try{if(!s||(v.indexOf("application/json")>=0)){var u=l(n.responseText);r=JSON.decode?JSON.decode(u):JSON.parse(u)}}catch(t){}if(!r){r={text:n.responseText}}if(!r.code){r.code=n.status||0}r.contentType=v;try{if(q&&q.trackEvent){h._trackEventAfterAjax(this.options.trackEvent)}}catch(t){a.record(t,"ta.util.ajax.onComplete.trackEventAfterAjax")}if(r.code>=200&&r.code<300){r.status="ok";p.resolve(r)}else{if(r.code===301||r.code===302){r.status="redirect";p.reject(r)}else{r.status||(r.status="error");p.reject(r)}}};q.onCancel=function(){p.reject({code:0,status:"abort"})};q.onTimeout=function(){p.reject({code:0,status:"timeout"})};delete q.onLoadStart;delete q.onProgress;delete q.onException;delete q.onSuccess;delete q.onFailure;n=f(q);if(typeof q.onRequestCreated==="function"){q.onRequestCreated(n)}return p.promise().always(function(r){m.onComplete.call(n,r);if(r.status==="redirect"){m.onRedirect.call(n,r)}else{if(r.status==="readonly"){m.onReadOnly.call(n,r)}else{if(~["abort","timeout","error"].indexOf(r.status)){m.onFailure.call(n,r)}else{m.onSuccess.call(n,r)}}}})};function f(j){if(typeof MooTools!=="undefined"&&typeof Request!=="undefined"){return(new Request(j).send()).xhr}var n=new XMLHttpRequest();var p=n.abort.bind(n);var o=j.method?j.method.toUpperCase():"GET";var m=j.url||"/";var i=[];var l,k;if(j.withCredentials){n.withCredentials(true)}n.onreadystatechange=function(){if(this.readyState===4){clearTimeout(l);j.onComplete()}};n.abort=function(){p();j.onCancel()};if(j.timeout){l=setTimeout(function(){p();j.onTimeout()},j.timeout)}j.data||(j.data={});for(k in j.data){if(j.data.hasOwnProperty(k)&&j.data[k]!==null){i.push(k+"="+encodeURIComponent(j.data[k]))}}if(/GET/.test(o)){m+=(/\?/.test(m)?"&":"?")+i.join("&")}if(/POST/.test(o)){j.headers||(j.headers={});j.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8"}n.open(o,m);for(k in j.headers){n.setRequestHeader(k,j.headers[k])}j.onRequest&&j.onRequest.call(n);n.send(/POST/.test(o)?i.join("&"):null);return n}g.createNs(e,"ta.util","ajax");return e});define("ta/util/cdn",["vanillajs","ns-exporter"],function(b,c){var a={};a.imageServer=function(e){var d=(typeof(CDNHOST)==="string"&&CDNHOST)||(typeof(cdnhost)==="string"&&cdnhost);if(d&&e){if(!/^\//.test(e)){e="/"+e}e=d+e}return e};c.exportTo(a,"ta.util");return a});define("utils/objutils",["utils/object/set-props","utils/object/shallow-copy","vanillajs"],function(r,t){var l=function(y){return y};var k=function(y){return true};var b=function(y){return false};if(typeof(Object.freeze)==="function"){l=Object.freeze.bind(Object);b=Object.isFrozen.bind(Object);k=Object.isFrozen.bind(Object)}function w(){var G,z,x,y,D,E,C=arguments[0]||{},B=1,A=arguments.length,F=false;if(typeof C==="boolean"){F=C;C=arguments[B]||{};B++}if(typeof C!=="object"&&!a(C)){C={}}for(;B<A;B++){if((G=arguments[B])!=null){for(z in G){x=C[z];y=G[z];if(C===y){continue}if(F&&y&&(p(y)||(D=j(y)))){if(D){D=false;E=x&&j(x)?x:[]}else{E=x&&p(x)?x:{}}C[z]=w(F,E,y)}else{if(y!==undefined){C[z]=y}}}}}return C}function u(y){if(typeof(y)!=="object"||y===null||k(y)){return y}for(var x in y){if(y.hasOwnProperty(x)){y[x]=u(y[x])}}return l(y)}function s(y){if(typeof(y)!=="object"||y===null){return y}for(var x in y){if(y.hasOwnProperty(x)){var z=y[x];if(z===null){delete y[x]}else{s(z)}}}return y}function d(A){var y;if(typeof(A)!=="object"||A===null){return A}if(A.constructor===Array){y=[];for(var z=0;z<A.length;++z){y.push(d(A[z]))}}else{y={};for(var x in A){if(A.hasOwnProperty(x)){y[x]=d(A[x])}}}return l(y)}function f(A){var y;if(typeof(A)!=="object"||A===null){return A}if(A.constructor===Array){y=[];for(var z=0;z<A.length;++z){y.push(f(A[z]))}}else{y={};for(var x in A){if(A.hasOwnProperty(x)){y[x]=f(A[x])}}}return y}function n(A){var y;if(typeof(A)!=="object"||A===null){return A}y=A;if(A.constructor===Array){if(b(A)){y=[];y.length=A.length}for(var z=0;z<A.length;++z){y[z]=n(A[z])}}else{if(b(A)){y={}}for(var x in A){if(A.hasOwnProperty(x)){y[x]=n(A[x])}}}return y}function c(z,y){if(z!==y){if(z){if(!y||(z.length!==y.length)){return false}for(var x=0;x<z.length;x++){if(z[x]!==y[x]){return false}}}else{return !y}}return true}function h(A,z){if(A!==z){if(A){if(!z){return false}if(j(A)&&j(z)){return c(A,z)}var y=Object.keys(A);if(!c(y,Object.keys(z))){return false}for(var x=0;x<y.length;x++){if(A[y[x]]!==z[y[x]]){return false}}}else{return !z}}return true}function g(y,A){var x={};var z,B;for(z=0;z<y.length;++z){B=y[z];x[B[A]]=B}return x}function m(z,y){var x=z[y];if(!(x||z.propertyIsEnumerable(y))){throw"missing property: "+y}return x}function i(z,x){for(var y in z){if(z.hasOwnProperty(y)&&!x(z,z[y])){delete z[y]}}return z}function j(x){if(Array.isArray){return Array.isArray(x)}return Object.prototype.toString.call(x)==="[object Array]"}function v(A,y,z){var x;if(y){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(y,A,z)}x=y.length;z=z?z<0?Math.max(0,x+z):z:0;for(;z<x;z++){if(z in y&&y[z]===A){return z}}}return -1}function a(x){var y={};return x&&y.toString.call(x)==="[object Function]"}function p(z){var y,x;if(!z||Object.prototype.toString.call(z)!=="[object Object]"){return false}y=Object.getPrototypeOf(z);if(!y){return true}x=Object.hasOwnProperty.call(y,"constructor")&&y.constructor;return typeof x==="function"&&Object.toString.call(x)===Object.toString.call(Object)}function o(z){var y=[];for(var x in z){if(z.hasOwnProperty(x)){y.push(x)}}return y}function q(y,z){for(var x in y){if(y.hasOwnProperty(x)){if(z(y[x],x,y)){return y[x]}}}}function e(C,D,z){var y,A=0,B=C.length,x=B===undefined||a(C);if(z){if(x){for(y in C){if(D.apply(C[y],z)===false){break}}}else{for(;A<B;){if(D.apply(C[A++],z)===false){break}}}}else{if(x){for(y in C){if(D.call(C[y],y,C[y])===false){break}}}else{for(;A<B;){if(D.call(C[A],A,C[A++])===false){break}}}}return C}return{setProps:r,deepFreeze:u,deepFreezeCopy:d,unfreezeForDust:n,undefineNulls:s,shallowCopy:t,deepCopy:f,shallowEquals:h,index:g,need:m,filterProps:i,keys:o,isArray:j,inArray:v,isFunction:a,isPlainObject:p,each:e,extend:w,find:q}});define("ta/common/Repoll",["vanillajs","ta","utils/objutils","api-mod","ta/util/Error","utils/ajax","ta/Core/TA.Event"],function(f,c,b,e,a,h,d){var g=function(o){o=o||{};var H,i,J=1,B=0,t=null,p="POST",E=false,y={},m={},s=null,N=!!o.evaluateScripts,A=o.placement||"page";var w=function(P){if(P){return decodeURIComponent(P.replace(/\+/g," "))}else{return P}};var L=function(Q){var T,S;H=Q.split("#")[0];i=H.split("?")[0];y={};T=H.split("?")[1]||"";S=T.split("&");for(var R=0;R<S.length;R++){var P=S[R].split("=");if(P[0]){y[decodeURIComponent(P[0])]=w(P[1])}}};var M=function(P){x(!!P,[])};var k=function(P,Q){if(u(y,P)){x(true,Q)}};var l=function(P){if(u(y,P)){J=0}};var O=function(){return y};var I=function(P,Q){u(m,P||{});x(true,Q)};var u=function(T,S){if(!S){return false}var U=false,R=Object.keys(S||{});for(var Q=R.length-1;Q>=0;Q--){var P=R[Q];if(T[P]!==S[P]){U=true}T[P]=S[P]}return U};var z=function(){x(false)};var K=function(P){p=P};var n=function(){return !!(t||E)};var D=function(){return J};var F=function(P){N=P?true:false};var C=function(){return N};var x=function(P,S){var R;if(P&&!E){s={}}if(S&&s){if(typeof(S)==="string"){s[S]=true}else{b.each(S,function(U,T){s[T]=true})}}else{s=null}if(E){if(!P||J===0){return}}if(P){J=0}var Q=q();if(Q>=0){E=true;R=++B;window.setTimeout(function(){r(R)},Q)}else{d.fireEvent("hac-could-not-complete");G()}};var r=function(S){if(t||!E||S!==B){return}var P=++J;var Q=b.extend({},y,m);var R=null;Q.reqNum=P;if(s){R=[];b.each(s,function(U,T){if(T){R.push(U)}});Q.changeSet=R.toString()}E=false;t=h({method:p,url:i,data:e.toFormQueryString(Q),dataType:"html",cache:false,evalScripts:C(),success:j,error:G})};function v(R){if(!R){return}var P=R.querySelectorAll("[data-targetEvent]");if(!P){return}var T;try{T=Array.prototype.slice.call(P)}catch(S){T=[];for(var Q=0;Q<P.length;Q++){T.push(P[Q])}}T.forEach(function(U){var W=U.getAttribute("data-targetEvent");if(W){try{d.fireEvent(W,U)}catch(V){a.record(V,{errorMessage:"ERROR in handler for "+W})}}})}var j=function(Q){var R=document.createElement("div");R.innerHTML=Q;var P=E;t=null;m={};s=(s?{}:null);v(R);if(A==="page"){if(!R.querySelector('[data-targetEvent="'+A+'-repoll-not-done"]')){d.fireEvent(window,"MetaFetchComplete")}}t=null;if(P){r(++B)}};var G=function(){var P=E;t=null;if(P){r(++B)}else{d.fireEvent(A+"-repoll-failed")}};function q(){switch(J||0){case 0:return 10;case 1:case 2:case 3:case 4:return 1000;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2000;case 11:return 5000;case 12:return 9000;case 13:return 10000;case 14:return 11000;case 15:return 12000;default:return -1}}c.on(A+"-repoll-not-done",z);L(o.pageUrl||window.location.href);return{setMethod:K,setPageUrl:L,repoll:M,getAjaxParams:O,setAjaxParams:k,setAjaxParamsNoPoll:l,setOneTimeParams:I,setNotDone:z,isUpdatePending:n,getLastRequestNum:D,setScriptsEval:F,isScriptsEvalEnabled:C,fireTargetEvents:v}};return g});define("trcore",["vanillajs","ns-exporter","ta/util/Cookie"],function(b,d,a){var e={};function c(f,g){if(window.addEventListener){window.addEventListener(f,g)}else{if(window.attachEvent){window.attachEvent("on"+f,g)}}}e.registerOnLoad=function(g,f){if(require.defined("ta/Core/TA.Event")){require("ta/Core/TA.Event").queueForLoad(g,f)}else{c("load",g)}};e.registerOnUnload=function(f){c("unload",f)};e.getScrollOffset=function(){return[window.pageXOffset||document.documentElement.scrollLeft,window.pageYOffset||document.documentElement.scrollTop]};e.setOneTimeCookie=function(f,g){a.write(f,g,5000,null,cookieDomain);return true};e.setOneTimeCookieOnFQDN=function(f,g){a.write(f,g,5000);return true};d.exportTo(e,window||global);return e});define("ta/common/Search",["lib/jquery-amd","ta/Core/TA.Store","ta/common/Repoll","ta/util/Error","trcore","utils/ajax"],function(e,g,c,a,f,d){var b={ta_repoll:null,getRepoll:function(){if(!this.ta_repoll){this.ta_repoll=c()}return this.ta_repoll},langSelect:function(i,h){if(h.form.elements.q.value.length>0){h.form.submit()}},useCurrentLocation:function(h){e(".locNotFound.hidden").removeClass("hidden")},clearOnFocus:function(i,h){if(h.value==h.defaultValue){h.value="";e(h).removeClass("focusClear")}},defaultOnBlur:function(i,h){if(h.value==""){e(h).addClass("focusClear");h.value=h.defaultValue}},getFormFields:function(k){var l={};for(var h=0;h<k.elements.length;++h){var j=k.elements[h];if(j.name===""||j.nodeName!=="INPUT"||!j.value){continue}l[j.name]=j.value}return l},getUrlFromForm:function(j){if(!j){return""}var m=j.action;var h=b.getFormFields(j);var l=[];for(var i in h){l.push(encodeURIComponent(i)+"="+encodeURIComponent(h[i]))}return m+"?"+l.join("&")},validate:function(i,h){if(h.q.value.trim()==""||e(h.q).hasClass("focusClear")){return false}f.setOneTimeCookie("SRCHACT","NEW");return true},recordAndValidate:function(k,o,m,p,r){if(m||b.validate(k,o)){p=p||g.retrieve("ta_typeahead_widget");var s=function(){if(p&&p.options&&p.options.onSubmit){var u=b.getUrlFromForm(o);var t=k?k.type:"";p.options.onSubmit(p,u,r,t)}o.submit()};if(p&&p.options&&p.options.skipRecordAfterValidate){p.hide();s();return false}var n=p&&p.options?p.options.startTime:undefined;var q=p?p.lastSuccessfulQuery:undefined;var j=p&&p.options&&p.options.geoId;var i=p&&p.options?p.options.name:undefined;var h=p&&p.historyShown;e("#MASTAHEAD_TYPEAHEAD_START_TIME").val(n);e("#MASTAHEAD_TYPEAHEAD_UI_ORIGIN").val(i);if(p){p.hide()}var l=p&&p.options?p.options.searchSessionId:undefined;if(!l){l="no_search_session_id"}if(!r){d("/TypeAheadJson",{method:"GET",data:{action:"RECORD",eventType:"search_bttn",startTime:n,source:i,query:q,uiOrigin:i,global:(!j||pageServlet=="Search"),scope:(!j||pageServlet=="Search")?"G":j,hadHistory:h,searchSessionId:l},complete:s})}else{s()}}return false},selectLang:function(l,j){try{var p=e("#SEARCH_LANG_SELECT_POPUP");if(!p.hasClass("hidden")){var i=e("#SEARCH_LANG_SELECT_INPUT");var k=e("#SEARCH_LANG_SELECTED");if(i.length){var h=j.id.match(/lang_(.+)/);if(h){var o=h[1];i.val("all"==o?"":o)}if(k){if(h){e(".langSelectOption",p).removeClass("selected");e(j).addClass("selected")}}}p.addClass("hidden")}else{p.removeClass("hidden")}}catch(n){a.record(n,"select search lang")}},reviews:function(i,h){d("/ActionRecord?action=SearchReviews");return false},replaceOrAddParam:function(i,h){var l=h.split("=");var n=l[0];var m=l[1];var k=new RegExp("([\\?#&])("+n+"=\\w+)");var j=k.exec(i);if(j){return i.replace(k,"$1"+h)}else{return i+"&"+h}},extractParam:function(i,l,k){var j=new RegExp("[\\?#&]"+l+"=(\\w+)");var h=j.exec(i);if(h){return h[1]}return k||null},selectOption:function(i,k){var j=e(k);var n=j.closest("form");try{var s=function(u){var t=u.match(/([\d.]+)px/);if(t){return parseFloat(t)}return 0};var m=e(".SEARCH_SELECT_POPUP",n);var o=e(".SEARCH_SELECTED",n);if(!m.hasClass("hidden")){m.addClass("hidden");var l=e(".SEARCH_SELECT_INPUT",n);if(l){l.val(j.hasClass("lang_all")?1:2);o.html(j.html())}if(o.length){var p=b.width;var r=s(o.css("width"));var h=Math.max(p,r);o.css("width",h+"px")}}else{m.removeClass("hidden");if(o.length){b.width=s(o.css("width"))}}}catch(q){a.record(q,"select search lang")}},buildSearchHref:function(k,l,m,q){var h=window.location.hash;var m=m||0;if(k){h=b.replaceOrAddParam(h,"ssrc="+k)}if(q){h=b.replaceOrAddParam(h,"dist="+q)}h=b.replaceOrAddParam(h,"o="+m);window.location.hash=h;var p=g.retrieve("searchTrackingId");var n=g.retrieve("searchRefinementId");var o=g.retrieve("sessionId");var j=g.retrieve("searchSessionId");var i=window.location.href;i=i.replace(/#.*/,"");if(p){i=b.replaceOrAddParam(i,"sid="+p)}if(n){i=b.replaceOrAddParam(i,"rf="+n)}if(o){i=b.replaceOrAddParam(i,"sessionId="+o)}if(j){i=b.replaceOrAddParam(i,"searchSessionId="+j)}if(!k){k=b.extractParam(h,"ssrc","a")}i=b.replaceOrAddParam(i,"actionType=updatePage");i=b.replaceOrAddParam(i,"ssrc="+k);i=b.replaceOrAddParam(i,"dist="+q);i=b.replaceOrAddParam(i,"o="+m);i=b.replaceOrAddParam(i,"ajax=search");return i},loadSRPlacement:function(m){function h(){var u=0;var t=e(".pagination .currentPageNumber");var s=30;var n=t.attr("data-position");if(n){u=(n-1)*s}var r=e(".selected","#SEARCH_FILTERS_COLUMN");var q=r.length?r.prop("id"):"a";var p=b.buildSearchHref(q,"PG",u);var o=g.retrieve("resultCacheKey");if(o){p+="&resultCacheKey="+o}return p}if(!g.retrieve("commerce_on_srp")){return}if(!ta.widgets.calendar.hasPageDates()){return}var j=e(".result.LODGING").length>0;var l=e("#page-repoll-not-done").length==0;if(!m&&(!j||l)){return}var i=h();var k=this.getRepoll();k.setPageUrl(i);k.setNotDone()}};return b});define("overlays/styles/tooltip",["vanillajs","api-mod","overlays/utils"],function(e,c,a){function d(g,h,f){this.container=c.createElement(f||"span",{"class":"ui_overlay ui_tooltip arrow_"+a.getArrowDir(g,this.sourceElement,this.domParent)+" "+h});this.arrow=c.createElement("div",{"class":"arrow"});this.container.appendChild(this.arrow);this.inner=c.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner}var b=function(i,h,g,j,f){g=g||i.getAttribute("data-tooltip");return function(){d.call(this,h,g,f);this.updateContent(j)}};return b});define("overlays/options/closeOnDocClick",["vanillajs","api-mod"],function(e,d){function b(f){if(this.sourceElement&&d.containsElement(this.sourceElement,f.target)){return}if(d.containsElement(this.container,f.target)){return}if(f.target&&(f.target.tagName==="option"||d.hasClass(f.target,"ui_dropdown")||d.getParent(f.target,"ui_dropdown"))){return}if(d.checkBrowser("ie")&&f.target&&f.target.tagName=="select"&&d.containsEvent(f.target,f)&&d.select(this.container,"input").indexOf(f.target)){return}this.hide("doc-click")}function a(f){return function(){var g=d.bind(b,this);this.on("show",function(){setTimeout((function(){if(this.isOpen()){d.addEvent(document,"click",g);f&&d.addEvent(document,"touchstart",g)}}).bind(this),1)}).on("hide",function(){d.removeEvent(document,"click",g);f&&d.removeEvent(document,"touchstart",g)})}}var c=a(true);c.withoutTouchEvents=a(false);return c});define("booking/common/ChildAgesSerialization",[],function(){var a=",";var d=":";var e=new RegExp(a+"|"+d);function b(f){if(f==null||f.length===0){return[]}return f.split(e).map(function(g){return parseInt(g,10)}).filter(function(g){return !isNaN(g)})}function c(h,p){if(p==null||p.length===0){return""}var o=Math.floor(p.length/h);var l=p.length-(o*h);var n=[];var m=0;for(var j=0;j<h;++j){var g=0;if(j<l){g=o+1}else{g=o}if(g){var k=Math.min(m+g,p.length);var f=p.slice(m,k);m=k;n.push(f.join(a))}}return n.join(d)}return{deserialize:b,serialize:c}});define("ta/common/Flyout",["vanillajs","utils/ajax","ns-exporter","ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/styles/tooltip","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","booking/common/ChildAgesSerialization"],function(c,n,o,g,b,j,m,d,l,i,a,f,p,e){var k;var h={showRecentLocationSaveOverlay:function(){setPID(3832);var q=new b(null,[j(null,"center","RecentlyViewedOverlay",""),d.center([0,0]),l,i,a,f(),p("/RecentlyViewedAjax",{reqParams:{a:"save_overlay"}})]);q.on("show",function(){if(q.inner.innerHTML.match("emptyRecentlyViewed")){q.hide()}});q.show()},showEmailHotelOverlay:function(v,u,r,w){var s={detail:v,isOfferEmail:u,overrideOfferEmail:r,contactColumn:w};var q=ta.retrieve("guests.rooms.object");if(q){s.rooms=q.rooms;s.guests=q.guests+e.deserialize(q.child_rm_ages).length}var t=new b(null,[j(null,"center","",""),d.center([0,0]),l,i,a,f(),p("/EmailHotel",{resources:[window.g_emailHotelCSS,window.g_emailHotelJs],reqParams:s})]);var y=0;function x(){y++;if(y>=2){require("ta/t4b/Emailhotel").init(t)}}t.on("contentLoaded",x).on("show",x);t.show()},bestValue:function(s,r){s&&s.preventDefault();r.onmouseover=null;var q=new b(r,[m(r,"below","",""),d.below(),p("/vpages/bestValueFly.html?log=false")]);q.show();return false},amenities:function(u,s,q,t){if(u){u.preventDefault()}s.onclick=null;if(q&&q>0){setPID(q);n("/ActionRecord?excludeFromVS=false&action=HRAmenitiesFlyout")}var r="/LocationTab?tab=amenities&from="+location.pathname.replace(/^[/]|-.*$/g,"")+"&suppressLinks="+!!t;if(s.id.indexOf("amenity_")==0){r+="&d="+s.id.substring(8)}k=k||new b(s,[j(s,"center","small",""),d.center([0,0]),l,a,f(),p(r,{resources:[amenityOverlayCss]})]);k.show();return false}};o.exportTo(h,"ta.common.flyout");return h});ta.common.sendmessage={getMessageCode:function(){var e=new Date().getTime();var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ123456";var f=[];for(var a=0;a<32;a++){f[a]=((e&(1<<a))!=0)?1:0}var c=[[],[],[],[],[],[]];for(var a=0;a<30;a++){c[a%(c.length)].push(f[f.length-1-a])}var d="";for(var a=0;a<c.length;a++){d+=b.substr(parseInt(c[a].reverse().join(""),2),1)}return d},communityLightbox:function(e,d){if(!communityEnabled){window.callback_communityLightboxEnable=function(){communityEnabled=true;var g=ta.retrieve("overlays.sendmessage");if(g){g.hide()}ta.common.sendmessage.communityLightbox(e,d)};var a=new StringBuffer();a.append('<p id="inviteStatusField" style="display: none; color: red;"></p>');a.append("<p>"+JS_mem_travelnet_friends_disabledM2M+".</p>");a.append('<p><a href="javascript:void(0)" onclick="ta.common.sendmessage.enableCommunity(window[\'callback_communityLightboxEnable\'], true); return false;">'+JS_common_Clickhere+"</a> "+JS_mem_travelnet_friends_turnOn+".</p>");var f=ta.overlays.showInLightbox(a.toString(),{backdrop:ta.overlays.BACKDROP_NEVER,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});f.container.setStyle("z-index","9997");if($("vrWideOverview")&&ta.has("vrShowCaptcha")){f.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()})}ta.store("overlays.sendmessage",f);return}if(d){var b=function(g){var h=ta.overlays.showInLightbox(g,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});h.container.setStyle("z-index","9997");if($("vrWideOverview")&&ta.has("vrShowCaptcha")){h.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()})}ta.store("overlays.sendmessage",h);var i=window[d];if(i&&typeOf(i)=="function"){i()}}}else{var b=function(g){var h=ta.overlays.showInLightbox(g,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});h.container.setStyle("z-index","9998");if($("vrWideOverview")&&ta.has("vrShowCaptcha")){h.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()})}ta.store("overlays.sendmessage",h)}}var c={url:e,onSuccess:b,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:communityLightbox")};new Request(c).send()},enableCommunity:function(c,a){var b=c;if(!a){b=function(d){ta.common.sendmessage.enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:enableCommunity")}).send()},enableCommunityResponse:function(res,callback){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){document.getElementById("inviteStatusField").innerHTML=data.ERROR;document.getElementById("inviteStatusField").style.display="block"}}else{document.getElementById("inviteStatusField").innerHTML=JS_community_on;document.getElementById("inviteStatusField").style.display="block"}},submitSendMessage:function(h,b){h.stop();b.onclick=function(i){ta.stopEvent(i)};var a=b.className.match(/LSO_(\w+)/)[1];$("LsoId").value=footprintGetWithSet(a);$("screenWidth").value=screen.width;$("screenHeight").value=screen.height;if(!b.className.match(/\bform_(\w+)\b/)){return}var e=$(RegExp.$1);var d={url:b.href,data:e,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:submitSendMessage")};var g=window["callback_"+e.name];if(b.className.match(/method_(\w+)\b/)){d.method=RegExp["$1"]}if(b.className.match(/\btgt_(\w+)\b/)){d.update=RegExp["$1"]}else{d.onComplete=function(k,i){if(ta.retrieve("messaging.isiframe")&&ta.id("PAGE")){ta.id("PAGE").set("html",k);if(ta.id("SUCCESS")){window.top.location.href="/Messages?f=512&o=0&cnt=25&j=-3&oo=0&oj=-3"}}else{var j=ta.retrieve("overlays.sendmessage");if(j&&j.inner&&j.newOverlays){j.inner.innerHTML=k}else{var j=ta.overlays.showInLightbox(k,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});ta.store("overlays.sendmessage",j)}}if(g&&typeOf(g)=="function"){g()}}}var c=window["validate"+e.id];if(c&&typeOf(c)=="function"&&c.apply(e)==false){return}if(b.className.match(/\bevalScripts\b/)){d.evalScripts=true}var f=ta.retrieve("overlays.sendmessage");if(f&&f.options&&f.options.permanent){f.options.permanent=false}new Request(d).send()},cancel:function(a){if(a){return}var b=ta.retrieve("overlays.sendmessage");if(b){ta.remove("overlays.sendmessage")}if(ta.has("community.needsReload")){window.location.reload()}},closeSendMessage:function(c,a){if(c&&c.stop){c.stop()}if(a){a.onclick=null}var b=ta.retrieve("overlays.sendmessage");if(b){b.hide(c)}if($("vrWideOverview")&&ta.has("vrShowCaptcha")){ta.vr.showRecaptcha()}}};ta.servlet.Inspiration={sortPopularity:function(b,a){sort("popularity")},sortAlphabetical:function(b,a){sort("alphabetical")}};define("overlays/options/closeOnWindowshadeClick",["vanillajs","api-mod"],function(a,b){return function(){var c=this;b.addEvent(this.shade,"click",function(){c.hide("windowshade")})}});define("pages/inappropriate_vote_stub",["ta","ta/util/Element","ta/Core/TA.Store","vanillajs","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnWindowshadeClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax"],function(i,o,g,l,c,m,e,n,k,b,f,d){var h={};var j;h.open=function(s,q,p){p.elmt=p.elmt||q;p.direction=p.direction||"below";g.store("iapFlyoutOptions",p);var r={flow:"CORE_COMBINED",pid:39841,userRequestedForce:true,loggedInBypass:true,onSuccess:a.bind(null,p)};i.call("ta.registration.RegOverlay.show",{type:"dummy"},p.elmt,r)};function a(q){if(!o.isScrolledIntoView(q.elmt)){o.scrollIntoView(q.elmt)}var p="/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&step=START&voteContentType="+q.voteContentType;if(q.owner){p+="&action=explain&reason=21&reviewid="+q.reviewid+"&isGeo="+q.isGeo+"&locationid="+q.locationid}else{p+="&action=reportIAP&contentId="+q.contentId}if(j){j.updateContent(p);j.sourceElement=q.elmt;j.on("contentLoaded",function(){if(!q.owner){require("pages/inappropriate_vote").initUI()}});j.show()}else{j=new c(q.elmt,[m(q.elmt,q.direction,"iapFlyout"),e.cssCentered(),n,b,f("light"),k,d(p,{resources:[g_jsIapVote]})]);j.on("contentLoaded",function(){if(!q.owner){require("pages/inappropriate_vote").initUI()}});j.show();g.store("iapFlyout",j)}}return h});define("overlays/styles/popover",["api-mod","lib/jquery-amd","overlays/utils"],function(c,e,a){function d(f,g,h){this.container=c.createElement("span",{"class":"ui_overlay ui_popover arrow_"+a.getArrowDir(f,this.sourceElement,this.domParent)+" "+g,style:h});this.arrow=c.createElement("div",{"class":"arrow"});this.container.appendChild(this.arrow);this.header=c.createElement("div",{"class":"header_text"});this.container.appendChild(this.header);this.inner=c.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner;this.close=c.createElement("div",{"class":"ui_close_x"});this.container.appendChild(this.close)}var b=function(j,g,f,m,l){j=e(j);f=f||j.attr("data-popover")||"";m=m||j.attr("data-header")||"";l=l||j.attr("data-content")||"";var i=j.attr("data-style")||"";var k=j.attr("data-header-element");var h=j.attr("data-header-copy");return function(){d.call(this,g,f,i);this.updateContent(l);if(m){a.injectContent(this.header,j,m,k,h)}c.addEvent(this.close,"click",c.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return b});define("overlays/styles/dropdown",["vanillajs","api-mod"],function(d,b){function c(f,g,h,e){this.container=b.createElement(e||"span",{"class":"ui_overlay ui_dropdown "+g,style:h});this.contentElement=this.container}var a=function(i,h,g,k,f,e){g=g||i.getAttribute("data-dropdown")||"";var j=f||i.getAttribute("style")||"";return function(){c.call(this,h,g,j,e);this.updateContent(k)}};return a});define("overlays/options/pinnable",["vanillajs","api-mod","ta/Core/TA.Event"],function(c,b,a){return function(){var g=this;var d;this.pinned=false;function e(){if(g.pinned&&b.inDocument(g.container)&&!d){d=b.createElement("div",{"class":"ui_backdrop dark"});d.setAttribute("style","z-index:499");b.addEvent(d,"click",function(){g.hide()});g.domParent.appendChild(d)}}function f(){g.pinned=true;e()}this.pin=f;this.on("show",function(){e();a.on(g.sourceElement,"click",f)});this.on("hide",function(){if(d){g.domParent.removeChild(d);d=void (0);a.off(g.sourceElement,"click",f)}})}});define("overlays/widgetoverlays",["vanillajs","ta","api-mod","overlays/Overlay","overlays/styles/popover","overlays/styles/modal","overlays/styles/dropdown","overlays/styles/windowshade","overlays/position","overlays/options/ajax","overlays/options/pinnable","overlays/options/closeOnWindowshadeClick","overlays/options/repositionOnEvent"],function(p,h,n,g,t,b,a,v,f,r,m,o,e){function s(y,z){var x=y.prwidget_ovl||(y.prwidget_ovl={key:z});if(x.key!==z){if(x.showtimer){clearTimeout(x.showtimer);delete x.showtimer}if(x.overlay){x.overlay.destroy();delete x.overlay}x.key=z}return x}function k(){var z=this;var y=z.prwidget_ovl;if(!y){return}if(y.showtimer){clearTimeout(y.showtimer);delete y.showtimer}if(h.page&&h.page.usingUnifiedDates&&n.find(".ui_modal.date_picker_modal",document.body)){return}var x=y.overlay;if(x&&!x.pinned&&!x.prw_leaveTimer){x.prw_leaveTimer=setTimeout(function(){x.pinned||x.hide()},250)}}function w(){var x=this;if(x){x.prw_entered=true;if(x.prw_leaveTimer){clearTimeout(x.prw_leaveTimer);delete x.prw_leaveTimer}}}function i(){if(h.page&&h.page.usingUnifiedDates&&n.find(".ui_modal.date_picker_modal",document.body)){return}var x=this;if(x&&!x.pinned&&!x.prw_leaveTimer){x.prw_leaveTimer=setTimeout(function(){x.pinned||x.hide()},250)}}function d(z,A){var y=!z.pinned&&w.bind(z);var B=!z.pinned&&i.bind(z);var x=function(){y&&n.removeEvent(z.container,"mouseenter",y);B&&n.removeEvent(z.container,"mouseleave",B);z.off("hide",x);delete A.overlay};y&&n.addEvent(z.container,"mouseenter",y);B&&n.addEvent(z.container,"mouseleave",B);z.on("hide",x)}function j(z,y){var x=y.url||"/OverlayWidgetAjax?Mode="+encodeURIComponent(z);if(typeof(crPageServlet)==="string"){x+="&metaReferer="+encodeURIComponent(crPageServlet)}return x}function q(A,E,K,L,M){var y=s(A,K);if(y.showtimer){clearTimeout(y.showtimer);delete y.showtimer}if(y.overlay){return}var C=(M.position||"wideside").split(" ").filter(function(N){return !!N.length});var J=C.shift();if(J==="wideside"){try{var z=n.getPosition(A).x;var B=n.getSize(A).x;var G=n.getSize(document.body).x;J=(z>(G-z-B)?"leftEvenInRtl":"rightEvenInRtl")}catch(I){J="right"}}var D=M.classes|"";var x=j(K,M);M.reqParams=L;M.inlineResourceId=K;M.isWidget=true;var H=[t(A,J,D,""),r(x,M),f[J](C,false),m];if(M.mixins&&M.mixins.length>0){H.push.apply(H,M.mixins)}var F=new g(A,H);if(E==="click"){F.pin()}F.show();y.overlay=F;d(F,y)}function l(C,y,B){B=B||{};var D=(B.position||"center").trim().split(" ")[0];var A=j(C,B);B.reqParams=y;B.inlineResourceId=C;B.isWidget=true;var x=[b(null,null,B.classes),r(A,B),f[D](void (0),true),v(),o,e(window,"resize")];if(B.mixins&&B.mixins.length>0){x.push.apply(x,B.mixins)}var z=new g(null,x);z.show();return z}function u(D,A,C,x,y){D=D||window.event;A=A||D.currentTarget;var B=(D&&D.type)||"click";if(D){n.stopEvent(D)}var z=s(A,C);if(B==="click"){if(!z.overlay){q(A,B,C,x,y)}}else{if(z.overlay){if(z.overlay.prw_leaveTimer){clearTimeout(z.overlay.prw_leaveTimer);delete z.overlay.prw_leaveTimer}return false}if(z.showtimer){return false}if(!z.hasLeaveHandler){n.removeEvent(A,"mouseleave",k);n.addEvent(A,"mouseleave",k);z.hasLeaveHandler=true}z.showtimer=setTimeout(function(){q(A,B,C,x,y)},y.delay||300)}return false}function c(E,y,C,D,F){E=E||window.event;y=y||E.currentTarget;if(E){n.stopEvent(E)}F=F||{};var B=(F.position||"below").trim().split(" ")[0];var x=j(C,F);F.reqParams=D;F.inlineResourceId=C;F.isWidget=true;var A=[a(y,B,F.classes,null,F.containerStyles,F.elementType||"div"),r(x,F),f[B](void (0),true)];if(F.mixins&&F.mixins.length>0){A.push.apply(A,F.mixins)}var z=new g(y,A);z.show();return z}return{triggerFlyout:u,showLightbox:l,showDropdown:c}});define("members/sendMessageLightbox",["ta","overlays/widgetoverlays"],function(a,c){function b(k,e,f){a.stopEvent(k);if(!f){return false}var g=a.retrieve("overlays.sendmessage");if(g){if(typeof(g.hide)==="function"){g.hide()}a.store("overlays.sendmessage",null);g=null}var j=f+"&Mode=owa";var l=typeof(footprintGet)!="undefined"?footprintGet():null;if(l){j+="&LsoId="+l}if(!a.registration.isAuthorized("SEND_MESSAGE")){var h={flow:"CONTENT_SUBMISSION",pid:473,userRequestedForce:true,onSuccess:function(){b(null,e,f)}};a.call("ta.registration.RegOverlay.show",{type:"dummy"},e,h);return false}var i;if(!communityEnabled){window.callback_communityLightboxEnable=function(){window.callback_communityLightboxEnable=void (0);communityEnabled=true;i&&i.hide();b(k,e,f)};i=c.showLightbox("COMMUNITY_LIGHTBOX");return false}var d=c.showLightbox("SEND_MESSAGE_LIGHTBOX",{},{url:j});if(d){d.newOverlays=true;a.store("overlays.sendmessage",d)}}return{showSendMessage:b}});define("members/memberOverlay",["vanillajs","api-mod","overlays/widgetoverlays","ta/Core/TA.Record"],function(e,d,b,g){var c="members_memberOverlay_init";function a(k,m,v,o,r){if(!k||(k.type!=="click"&&k.type!=="mouseenter"&&k.type!=="mouseover")){return}if(k.type==="click"){d.stopEvent(k)}var u="";var h="";var s="";var t=false;var l=false;var p=v.split("-");for(var q=0;q<p.length;q++){var n=p[q];if(n.match(/\bUID_([0-9A-F]+)\b/)){u=RegExp.$1}else{if(n.match(/\bSRC_(\d+)\b/)){h=RegExp.$1}else{if(n.match(/\bCATID_(\d+)\b/)){s=RegExp.$1}else{if(n.match("FUS")){t=true}else{if(n.match("PATT")){l=true}}}}}}var w="";if(typeof(window.footprintGet)!="undefined"){w=window.footprintGet()}var j="/MemberOverlay?Mode=owa&uid="+u+"&c="+s+"&src="+h+"&fus="+t+"&partner="+l+"&LsoId="+w;b.triggerFlyout(k,m,"MEMBER_OVERLAY",{},{url:j,mixins:[function(){if(o&&r){g.trackEventOnPageOnce(o,"show_reviewer_info_window",r)}}]});return false}function f(j,h,k,i,l){if(h[c]){return false}h[c]=true;d.addEvent(h,"click",function(m){a(m||window.event,this,k,i,l)});d.addEvent(h,"mouseenter",function(m){a(m||window.event,this,k,i,l)});if(j){a(j,h,k,i,l)}return false}return{initMemberOverlay:f}});define("ta/util/ajaxPreserves",["lib/jquery-amd"],function(b){var a={};a.copy=function(g,f){if(!f||!g){return}var e=b(".ajax_preserve",f);if(e.length>0){var d={};var c=b(".ajax_preserve, .ajax_preserve_noreplace",g);c.each(function(h,j){var i=j.getAttribute("data-ajax-preserve");if(i){d[i]=j}});e.each(function(h,j){j=b(j);var i=d[j.attr("data-ajax-preserve")];if(i){j.replaceWith(i)}})}};a.replaceContent=function(d,c){a.copy(c,d);b(c).html("").append(b(d).children().detach())};a.setContentElement=function(e,c,d){a.copy(e,c);if(d){b(e).replaceWith(c)}else{b(e).html("").append(c)}};return a});define("lib/LazyLoad",["lib/jquery-amd","ta/util/Error","utils/throttle","ta/Core/TA.Store"],function(d,a,c,g){function f(m,t,w){var v=m.range===undefined?200:m.range;var k=m.mode=="horizontal"?"left":"top";var A=d(m.container||window);var z={height:A.height(),width:A.width()};var D=z[k=="top"?"height":"width"]+v;var j=r();var p=0;var o=t||[];var n=w||[];var x=[];var i;function s(){var G=document.body.scrollHeight;var F;n=n.filter(function(I){var H=d(I.id?"#"+I.id:I.selector).get(0);if(H){I.elt=H;I.onReady=function(){F=F||new e();this.elt.innerHTML=F.unobfuscate(this)||this.data};return u(!I.scroll,I)}return false});o=o.filter(function(I){var J=I.src||I.data;var H=d(I.id?"#"+I.id:I.selector);if(H.length&&J){I.src=J;I.priority=I.priority||1000;I.elt=H.get(0);I.onReady=function(){this.priority+=x.length/10000;x.push(this)};if(I.logerror){H.on("error",function(){a.record(new Error("lazy img did not load from "+I.src),null,null,null,"WARN")})}if(y(H)){return u(!I.scroll,I)}}return false});C();if(G!=document.body.scrollHeight){A.trigger("scroll")}A.on({scroll:B,resize:q})}function B(G,F){if(F=="force"){i=true}h()}var h=c(function(){j=r();if(i||j>p){E();p=j;if(!o.length){A.off({scroll:B,resize:q})}i=false}},500);function l(G){var F=G.elt.getBoundingClientRect();if(F.top==0){return false}return F[k]<D}var u=function(H,G){var F=H||l(G);if(F){G.onReady()}return !F};function E(){n=n.filter(u.bind(null,false));o=o.filter(u.bind(null,false));C()}function q(){var F={height:A.height(),width:A.width()};if(F.height!=z.height||F.width!=z.width){z=F;D=z[k=="top"?"height":"width"]+v;j=r();E()}}function r(){return k=="top"?A.scrollTop():A.scrollLeft()}function C(){x.sort(function(G,F){return G.priority-F.priority});x.forEach(function(G){var F=G.elt;if(F.tagName=="IMG"){F.src=G.src}else{F.style.backgroundImage="url('"+G.src+"')"}});x=[]}function y(G){if(!G.hasClass("hasImage2x")&&!G.hasClass("image2x")){return true}var F=window.devicePixelRatio&&window.devicePixelRatio>=1.5;var H=(!F&&G.hasClass("hasImage2x"))||(F&&G.hasClass("image2x"));G.toggleClass("hidden",!H);return H}s()}function e(){var i;function h(){if(i===undefined){i=null;var j;if(require.defined("page-model")){try{j=JSON.parse(require("page-model").session.lazyObf)}catch(k){}}else{j=g.retrieve("ta.commerce.obf")}if(j){try{i={given:j.given.split(""),replace:j.replace.split(""),token:j.token}}catch(k){a.record(k,"obfuscation object corrupted")}}}}this.unobfuscate=function(k){h();var n=i?k.data.indexOf(i.token):-1;if(i&&n==0){try{var l=k.data.substr(i.token.length).split("");for(var j=l.length;j--;){var m=l[j];n=i.replace.indexOf(m);if(n!=-1){l[j]=i.given[n]}}return l.join("")}catch(o){a.record(o,"lazy html",null,{id:k.id})}}return null}}function b(h){d(h).find(".onDemandImg").each(function(){var i=d(this);i.attr("src",i.attr("data-src"));i.removeClass("onDemandImg")})}return{init:function(i,h,j){return new f(i,h,j)},demandLoadImagesInNode:b}});define("ta/servlet/Reviews",["pages/inappropriate_vote_stub","members/sendMessageLightbox","members/memberOverlay","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","ta/util/ajaxPreserves","lib/LazyLoad","api-mod"],function(p,q,c,j,a,t,i,l,d,r,o,n,s,m){ta.keep("facebook.onAvail",function(){FB.Event.subscribe("edge.create",function(x,z){try{var A=false;if(z){A=ta.id(z)}var u="";var w=x||"";if(A){if(A.className){var v=false;if(v=A.className.match(/track_(\w+)/)){u=v[1]}if(A.hasClass("expanded")){u+="_expanded"}}}new Request({url:"/ActionRecordPlus?action=LIKE&from="+u+"&url="+w}).send()}catch(y){ta.util.error.record(y,"FB like review tracking error")}})});var k,b;ta.servlet.Reviews={expandCount:0,PAGING_HEIGHT:1000,expandReview:function(H,x,w){var u=0;if(ta.retrieve("expand_"+w)){return}ta.store("expand_"+w,true);u++;var v=ta.id(w);var G=new Event(H);try{u++;if(!v){ta.util.error.record(null,"expandReview - no container",G,{revId:w});return}var C,E,A=false;if(v.getElement){C=v.getElement(".dyn_full_review");E=v.getElement(".basic_review");A=v.getElement(".revBotContent")}if(!E||!E.hasClass){ta.util.error.record(null,"expandReview - no basic_rev",G,{revId:w});return}u++;var B=E.hasClass("first");if(A&&A.getElement){var z=A.getElement(".fb_like_button")}var D=E.getElement(".helpful");u++;if(C){C.setStyle("display","block");if(z){ta.servlet.Reviews.injectFBLikeIntoFull(z,C)}if(ta.servlet.Reviews.translationRatings.contains(expandedReviewId)){ta.servlet.Reviews.injectTranslationRating(E,C)}E.setStyle("display","none");ta.remove("expand_"+w)}else{u++;ta.servlet.Reviews.expandCount++;var F=E.getElement(".partnerRvw span.linkItem");u++;if(F){F.getElement("img.textArrow_more").setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(F)}u++;new Request({url:"/SingleUserReview-g"+modelGeoId+"-d"+modelLocId+"?review="+w+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount,onSuccess:function(L,M){try{var K=0;C=new Element("div");C.addClass("dyn_full_review");C.set("html",L);C.inject(E,"after");K++;var N=C.getElement(".collapse");if(N){N.addEvent("click",function(){ta.servlet.Reviews.collapseReview(v)})}K++;if(B){C.getElement(".basic_review").addClass("first")}K++;h(C);K++;if(typeof processLinks!=="undefined"){processLinks(C)}K++;ta.servlet.Reviews.fixMTHelpfulUrl(C,w);if(E){var Q=E.getElement("img.anim_loop");Q.dispose()}K++;if(F){var J=F.getElement("img.textArrow_more");if(typeof(J)!="undefined"&&J!=null){J.setStyle("display","inline")}}K++;var O=ta.retrieve("facebook.data.handlers.FRIEND_NAMES");var I=ta.retrieve("facebook.data.handlers.HIGHLIGHT_FRIENDS");if(O&&typeof(O)=="function"){O()}if(I&&typeof(O)=="function"){I({expanded:true})}if(z){ta.servlet.Reviews.injectFBLikeIntoFull(z,C)}if(D){helpfulVotingKey=D.id.match(/(helpful\w+)_\w+/);if(helpfulVotingKey){helpfulVotingKey=helpfulVotingKey[1];if(ta.retrieve(helpfulVotingKey)){var S=C.getElement(".helpful");if(S){S.innerHTML=D.innerHTML}}}}K++}catch(P){ta.util.error.record(P,"expandReview - post AJAX",null,{postProg:K})}if(E&&E.setStyle){E.setStyle("display","none")}if(A&&A.setStyle){A.setStyle("display","none")}ta.remove("expand_"+w);var R=ta.retrieve("ta.servlet.Reviews.callback");if(R!=null){R()}},evalScripts:true}).send()}}catch(y){ta.util.error.record(y,"expandReview",G,{revId:w,prog:u});ta.remove("expand_"+w)}},expandReviews:function(A,D,B,K,I){if(ta.retrieve("expand_"+B)){return}ta.trackEventOnPage("Reviews","expand_click");ta.store("expand_"+B,true);var F=ta.id(B);var H=new Event(A);try{if(!F){ta.util.error.record(null,"expandReviews - no container",H,{revId:B});return}var C,L,R=false;if(F.getElement){C=F.getElement(".dyn_full_review");L=F.getElement(".basic_review");R=F.getElement(".revBotContent")}if(!L||!L.hasClass){ta.util.error.record(null,"expandReviews - no basic_rev",H,{revId:B});return}if(C){ta.servlet.Reviews.showExpandedReview(B,true);ta.remove("expand_"+B)}else{ta.servlet.Reviews.expandCount++;var M=L.getElement(".partnerRvw span.moreLink");if(M){var w=M.getParent().getElement("img.textArrow_more");if(w){w.setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(M,"after")}}var Q=$$("#REVIEWS .reviewSelector");var u;for(var N=0;N<Q.length;N++){if(Q[N].id==B){u=Q.slice(N)}}var P=0;var E=[];if(u&&u.length>0){for(var N=0;N<u.length;N++){var J=u[N].id;if(J&&J.indexOf("review_")===0){var O=u[N].getElement(".dyn_full_review");if(!O){var z=u[N].getElement(".basic_review");if(z){E[E.length]=J.split("_")[1];if(z.getElement(".ownerFav")){P=E[E.length-1]}}else{ta.util.error.record(null,"expandReviews - basic_review content missing",null,{revId:J},"WARN")}}}}}if(E.length>0){var G=E[0];var v=0;if(K){v=K}var y=E.join(",");new Request({url:"/ExpandedUserReviews-g"+modelGeoId+"-d"+modelLocId+"?target="+G+"&context="+v+"&reviews="+y+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount+(P>0?"&favorite="+P:""),trackEvent:{module:"Reviews",action:"expand"},onSuccess:function(Z,V){try{var aa=[];var S=new Element("div");S.set("html",Z);var ah=S.getChildren();var Y=[];window.fireEvent("ReviewExpanded");for(var ag=0;ag<ah.length;ag++){var W=ah[ag];var ac=W.id.split("_")[2];var aj=ta.id("review_"+ac);if(aj&&aj.getElement){Y.push(aj.getProperty("id"));var af=aj.getElement(".basic_review");if(af){aa.push(ac);W.erase("id").addClass(af.className.replace("basic_review","dyn_full_review")).inject(af,"after").hide();var ak=W.getChildren()[0];if(ak){ak.removeClass("review")}var ab=W.getElement(".collapse");if(ab){ab.addEvent("click",ta.servlet.Reviews.getCollapseCallback(aj))}h(W);if(typeof processLinks!=="undefined"){processLinks(W)}if(ta.servlet.Reviews.translationRatings.contains(ac)){ta.servlet.Reviews.injectTranslationRating(af,W)}ta.servlet.Reviews.fixMTHelpfulUrl(W,"review_"+ac);if(ac===G){var T=af.getElement("img.anim_loop");if(T){T.dispose()}ta.servlet.Reviews.injectInlineBanner(aj);var ae=af.getElement(".partnerRvw span.moreLink");if(ae){var U=ae.getParent().getElement("img.textArrow_more");if(typeof(U)!="undefined"&&U!=null){U.setStyle("display","inline")}}}}}}var X=true;for(var ag=0;ag<aa.length;ag++){if(ag==1){X=false}var ad="review_"+aa[ag];ta.servlet.Reviews.showExpandedReview(ad,X)}if(window.lazyImgs!=null){s.init({},window.lazyImgs,window.lazyHtml)}}catch(al){ta.util.error.record(al,"expandReviews - post AJAX",null,{});var T=L.getElement("img.anim_loop");if(T){T.dispose()}var ae=L.getElement(".partnerRvw span.moreLink");if(ae){var U=ae.getParent().getElement("img.textArrow_more");if(typeof(U)!="undefined"&&U!=null){U.setStyle("display","inline")}}}if(Browser.ie&&Browser.version<8){var ai=function(){for(var am=0;am<Y.length;++am){var an=ta.id(Y[am]);if(an!==null){an.addClass("dummy")}}};setTimeout(ai,0)}ta.remove("expand_"+B)},onFailure:function(S,T){ta.util.error.record(null,"ExpandedUserReviews ajax call failed",null,{reviewIds:y},"WARN");var V=L.getElement("img.anim_loop");if(V){V.dispose()}var W=L.getElement(".partnerRvw span.moreLink");if(W){var U=W.getParent().getElement("img.textArrow_more");if(typeof(U)!="undefined"&&U!=null){U.setStyle("display","inline")}}},evalScripts:true}).send()}}}catch(x){ta.util.error.record(x,"expandReviews",H,{revId:B});ta.remove("expand_"+B)}},filterReviews:function(w,G){if(ta.page&&ta.page.applyReviewFiltersForm){return ta.page.applyReviewFiltersForm(w,G)}var x=arguments.callee;G=G||{};var C=ta.id("REVIEWS");var v=C.getElement(".loadingContainer");if(v){var z=C.getStyle("position");if(z!=="relative"&&z!=="absolute"&&z!=="fixed"){C.setStyle("position","relative")}var E=0;var y=G.whiteBoxTopElmt?ta.id(G.whiteBoxTopElmt):undefined;if(y){E=y.getPosition(C).y}v.setStyles({display:"block",top:E+"px",height:(C.getSize().y-E)+"px"});var B=v.getElement(".loadingBox");if(B){B.setStyle("top",G.loadingBoxTopElmt?(ta.id(G.loadingBoxTopElmt).getPosition(C).y-E)+"px":undefined)}}var u=location.pathname;var F=false;if(!G.ignoreOffset){if(window.pageServlet==="ShowUserReviews"){var D=window.onhashchange;window.onhashchange=undefined;location.hash="#or0";(function(){window.onhashchange=D}).delay(0)}else{u=location.pathname.replace(/-or\d+/,"");F=location.pathname!==u}}if(!history.replaceState&&F){w.submit()}else{if(x.request){x.request.cancel()}if(F){history.replaceState(history.state,document.title,u)}var A=G.scrollToElmt?ta.id(G.scrollToElmt):undefined;if(A){window.scrollTo(0,A.getPosition().y)}x.request=new Request({url:u,data:"mode=filterReviews&"+w.toQueryString(),evalScripts:true,onSuccess:function(K){var I=new Element("div",{html:K});var J=I.getChildren();if(J.length>0){J[0].getElements("[data-targetEvent]").each(function(L){ta.fireEvent(L.getAttribute("data-targetEvent"),L)});var H=C.getElement(":focus");n.copy(C,J[0]);J[0].replaces(C);if(H&&H.getParent(".ajax_preserve")){H.focus()}ta.prwidgets.initWidgets(J[0])}else{ta.util.error.record(e,"filterReviews got invalid response");v.setStyle("display","none")}},onFailure:function(){if(!G.reqNum){return x(w,Object.merge({reqNum:1},G))}ta.util.error.record(undefined,"filterReviews");v.setStyle("display","none")}}).send()}},injectInlineBanner:function(u){try{if(u){if(ta.has("ads.gptEnabled")){if(!ta.has("ads.inlineReviewAd.injected")){ta.store("ads.inlineReviewAd.injected",true);if(ta.has("ads.reviewLargeBanner")){ta.common.ads.queueForInjection(["gpt-ad-728x90-c"])}else{ta.common.ads.queueForInjection(["gpt-ad-468x60"])}}else{var v=u.getElement(".iab_inlineBanner");if(v){v.destroy()}}}else{injectAdsTargeted(u)}}else{throw new Error("Review parent element is null")}}catch(w){ta.util.error.record(w,"unable to inject inline banner on review expansion")}},refreshSidebarAds:function(){try{if(ta.has("ads.gptEnabled")){ta.common.ads.refreshSidebarAds()}else{ta.common.ads.refreshSideBarAdsWithRefreshOrdKey()}}catch(u){ta.util.error.record(u,"unable to refresh sidebar ads on review expansion")}},refreshGutterAd:function(u){try{ta.common.ads.refreshAjaxAds(u)}catch(v){ta.util.error.record(v,"unable to refresh gutter ad on More click")}},getCollapseCallback:function(u){return function(){ta.servlet.Reviews.collapseReview(u)}},showExpandedReview:function(u,v){try{if(typeof(u)==="undefined"){ta.util.error.record(null,"showExpandedReview - reviewId is undefined");return}var y=ta.id(u);if(y){var B,D,z=false;if(y.getElement){B=y.getElement(".dyn_full_review");D=y.getElement(".basic_review");z=y.getElement(".revBotContent")}else{ta.util.error.record(null,"showExpandedReview - recContainer missing getElement attribute",null,{revId:u});return}if(!D){ta.util.error.record(null,"showExpandedReview - basic_rev is null",null,{revId:u});return}if(!D.hasClass){ta.util.error.record(null,"showExpandedReview - basic_rev missing hasClass attribute",null,{revId:u});return}if(z&&z.getElement){var x=z.getElement(".fb_like_button")}var C=D.getElement(".helpful");if(!B){ta.util.error.record(null,"showExpandedReview - no full");return}if(C){var A=C.id.match(/(helpful\w+)_\w+/);if(A){A=A[1];if(ta.retrieve(A)){var E=B.getElement(".helpful");if(E){E.innerHTML=C.innerHTML}}}}if(x){ta.servlet.Reviews.injectFBLikeIntoFull(x,B)}B.show();D.hide()}else{ta.util.error.record(null,"showExpandedReview - revContainer is null",null,{revId:u});return}}catch(w){ta.util.error.record(w,"showExpandedReview")}},fixMTHelpfulUrl:function(w,u){var x=w.getElement("input[name=returnTo]");if(x){var v=document.location.href;if(v.indexOf("#")>=0){v=v.substring(0,v.indexOf("#"))}x.value=v+"#mtreview_"+u}},injectFBLikeIntoFull:function(w,u){try{if(w){var y=w.getFirst();if(y){y.addClass("expanded")}var v=u.getElement(".helpful");if(v){w.inject(v,"after")}}}catch(x){ta.util.error.record(x,"expandReview - like button")}},injectTranslationRating:function(w,v){if(w&&v){var u=w.getElement(".translation"),x=v.getElement(".translation");if(u&&x){x.set("html",u.get("html"))}}},translationRatings:[],collapseReview:function(u){try{u=ta.id(u);var y=u.getElement(".dyn_full_review");var w=u.getElement(".basic_review");var x=u.getElement(".revBotContent");var v=y.getElement(".fb_like_button");if(w&&w.setStyle){w.setStyle("display","block")}if(x&&x.setStyle){x.setStyle("display","block")}if(v){var B=v.getFirst();if(B){B.addClass("expanded")}if(x){v.inject(x,"inside")}}var A=u.id.replace("review_","");if(ta.servlet.Reviews.translationRatings.contains(A)){ta.servlet.Reviews.injectTranslationRating(y,w)}y.setStyle("display","none")}catch(z){ta.util.error.record(z,"collapseReview")}},findLink:function(v,u){if(/\bt(r[\d]+)\b/.test(u.className)){window.location=$(RegExp.$1).href}},mtSubmitOnClick:function(v,u){if(u.value==="true"){ta.util.cookie.setPIDCookie(25173)}else{if(u.value==="false"){ta.util.cookie.setPIDCookie(25172)}}u.form.submit()},openMTEdit:function(u,v,w){if(b){b.updateContent("/MachineTranslationEdit?r="+w)}else{b=new j(null,[a(null,"center","mtedit_overlay"),t.center([0,0]),d,i,l,r(),o("/MachineTranslationEdit?r="+w)]);ta.store("translationEditOverlay",b);b.on("contentLoaded",function(){try{var x=ta.id("mtedit_mt").getElements(".mtedit_text")[0];x.style.height=ta.id("mtedit_english").clientHeight+ta.id("mtedit_mt").offsetTop-x.offsetTop+"px"}catch(y){ta.util.error.record(y,"openMTEdit:onLoad")}})}b.show()},validateMTEdit:function(x,w){var v=ta.id("mtedit_mt");var u=v.getElements(".mtedit_orig_title")[0].value;var A=v.getElements(".mtedit_title")[0].value;var z=v.getElements(".mtedit_orig_text")[0].value;var y=v.getElements(".mtedit_text")[0].value;return A&&y&&(A!=u||y!=z)},enableMTEditSubmit:function(w,v){var u=ta.id("mtedit_submit");if(u.disabled&&ta.servlet.Reviews.validateMTEdit(w,v)){u.disabled=false}},submitMTEdit:function(z,x,u,y){var v=ta.id("mtedit_submit");v.disabled=true;ta.select(".mtedit_error").each(function(C){C.hide()});if(ta.servlet.Reviews.validateMTEdit(z,x)){var w=ta.id("mtedit_mt");var B=w.getElements(".mtedit_title")[0].value;var A=w.getElements(".mtedit_text")[0].value;new Request({url:"/MachineTranslationEditSubmit?r="+u,data:{title:B,body:A,token:y},onSuccess:function(){try{ta.id("mtedit").hide();ta.id("mtedit_received").show();b.reposition();var C=ta.id("mtForm"+u);C.getElement(".mtRateLabel").hide();C.getElement(".mtImproveButton").hide();C.getElement(".mtEditThanksLabel").show()}catch(D){ta.util.error.record(D,"submitMTEdit:onSuccess")}},onFailure:function(C){try{if(C.status>=400&&C.status<=499){ta.id("mtedit_404").show()}else{v.disabled=false;ta.id("mtedit_500").show()}}catch(D){ta.util.error.record(D,"submitMTEdit:onFailure")}}}).send()}else{ta.id("mtedit_nochange").show()}},rateMTReview:function(u,x){var w=ta.id(x.form);var B=w.getElement("input[name=translateRating]:checked");if(B){var y=B.value;var z=w.elements.userId.value;var v=w.elements.reviewId.value;ta.servlet.Reviews.translationRatings.push(v);var A=w.action+"?at=true&rateValue="+v+","+z+","+y;new Request({url:A}).send();var C=w.getElement(".thanks").innerHTML;w.getElement(".translationRatingForm").innerHTML=C}},rateMTReviewNew:function(u,x,v,y){var w=ta.id("mtForm"+v);if(w){var B=w.elements.userId;if(B){ta.servlet.Reviews.translationRatings.push(v);var C=w.action+"?at=true&rateValue="+v+","+B.value+","+y;new Request({url:C}).send();var z=document.getElement(".mtRatingOverlay");if(z){z.hide()}var A=w.getElement(".mtRatingButton");if(A){A.hide()}var D=w.getElement(".thanks");if(D){D.show()}}}},popSocialShare:function(v,u){if(v&&v.href){var w="toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=800,height=400,left=40,top=40,screenx=40,screeny=40";window.open(v.href,"SocialShare",w)}new Request({url:"/ActionRecord?action=shareOn"+u}).send();return false},resizeHelpfulVote:function(z){var v=document.querySelectorAll(z),A=document.querySelector(".helpful.redesigned"),y=document.querySelector(".isHelpful"),w=document.querySelector(".tooltips"),B=(ifdefNN(A)?A.parentNode.clientWidth:336)-20,x,C,u;if(ifdefNN(y)){B-=y.clientWidth}if(ifdefNN(w)){B-=w.clientWidth}for(x=0;x<v.length;x++){C=12;u=v[x];u.style.fontSize=C+"px";while(u.clientWidth>B&&C>8){u.style.fontSize=C+"px";C--}}},helpfulVoteHandlerOb:(function(){var u={};return function(x,w,y){if(u[w]){return}u[w]=true;new Event(x).preventDefault();var z=w.className.match(/\btgt_(\w+)\b/);if(!z){return}z=z[1];var v=z.match(/\d+/);if(ifdefNN(v)){v=v[0]}y=ta.util.ASDF.asdfDcd(y);new Request({url:y,onSuccess:function(A,C){var E=ta.id(z+"_expanded");var B=ta.id(z+"_collapsed");if(E){E.innerHTML=A}if(B){B.innerHTML=A;ta.store(z,true)}var D=ta.id("postVoteMessage_"+v);if(ifdefNN(D)){setTimeout(function(){D.addClass("seen")},500)}},onComplete:function(){delete u[w]}}).send()}})(),recordUnattached:function(v,u){new Request({url:"/ActionRecord?action=START_UNATTACHED_RVW_SEARCH"}).send();u.removePropertyEvent("keyup","ta.servlet.Reviews.recordUnattached")},changeSearchType:function(I,w){if(window.searchType){$$("span."+window.searchType.id).hide()}window.searchType=w;ta.select("span."+w.id).setStyle("display","inline");var z=w.getAttribute("data-type")||w.value;ta.find('input[name="type"]').value=z;var K=ta.id("query");var C=K.retrieve("typeahead");if(K&&C){var J=ta.servlet.Reviews.poiTypeIdMap[z];C.options.search=TypeAhead.utils.query(false,J,null,null,true,10);C.options.minChars=J=="al"?2:3;C.search()}var v=ta.find(".poiSearch");if(v){if(w.id=="type_rental"){ta.select(".poiSearchForm, #UR_SELECT, #SRCH_RSLT").hide();ta.select(".vrSearchForm").show();var E=ta.id("reviewGeo");if(E){E.focus();E.select()}}else{var G={type_hotel:"hotel",type_attraction:"attr",type_restaurant:"eat",type_airline:"al",type_location:"geo"};ta.store("tpAhdType",G[w.id]);ta.select(".vrSearchForm, #SRCH_RSLT_VR, #MAIN_COL, #POST_PHOTOS_FORM").hide();ta.select(".poiSearchForm, #UR_SELECT").show();if(K.value.length>0){searchByType()}K.focus();K.select();var H=ta.id("queryGeo");if(H){var A=H.retrieve("typeAhead");if(A){var x="GEO";if(w.id=="type_attraction"){x="ATTRGEO"}else{if(w.id=="type_restaurant"){x="RESTGEO"}}A.changeUrl("/TypeAheadJson?action="+x);A.query();A.updateChoices()}}}ta.select("#SRCH_RSLT, .tips").hide();ta.store("searchResultFlag",true)}else{var D="GEO";if(w.id!="type_rental"){switch(w.id){case"type_hotel":ta.store("tpAhdType","hotel");break;case"type_attraction":ta.store("tpAhdType","attr");D="ATTRGEO";break;case"type_restaurant":ta.store("tpAhdType","eat");D="RESTGEO";break;case"type_location":ta.store("tpAhdType","geo");break}if($("SRCH_BOX_VR")){$("SRCH_BOX_VR").hide()}if($("SRCH_RSLT_VR")){$("SRCH_RSLT_VR").hide()}if($("MAIN_COL")){$("MAIN_COL").hide()}if($("POST_PHOTOS_FORM")){$("POST_PHOTOS_FORM").hide()}$("SRCH_BOX").show();$("UR_SELECT").show();var u=ta.id("query");var y=u.retrieve("typeAhead");var F=ta.id("SEARCH_GEO");if(y){var B="/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true";if(ifdefNN(F)&&ifdefNN(F.value)){B+="&parentids="+F.value}y.changeUrl(B);if(ifdefNN(u.value)&&u.value.trim().length!==0){y.query();y.updateChoices()}}u.focus();u.select();var H=ta.id("queryGeo");if(H){var A=H.retrieve("typeAhead");if(A){A.changeUrl("/TypeAheadJson?action="+D);A.query();A.updateChoices()}}}else{$("SRCH_BOX_VR").show();$("SRCH_BOX").hide();$("UR_SELECT").hide();var E=$("reviewGeo");E.focus();E.select()}ta.store("searchResultFlag",true);ta.id("SRCH_RSLT").hide()}},unattachedSearchOnFocus:function(y,w,v){var x=ta.retrieve("tpAhdType");var u={xargs:"&types="+x};if(v){u.geo=v}ta.run("ta.widgets.typeahead.factory.global_mutable",{},y,w,"SINGLELOCTYPE","ta.widgets.typeahead.events.onSelectUnattached",u);w.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchOnFocus")},unattachedSearchGeoOnFocusAttach:function(x,u){var v=ta.retrieve("tpAhdType"),w=u.retrieve("typeAhead");ta.run("ta.widgets.typeahead.factory.global_mutable",{},x,u,"GEOGRAPHICONLY","ta.widgets.typeahead.events.onSelectGeoUnattached",{xargs:"&types="+v,minLength:1,noSearchPrompt:true});u.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchGeoOnFocus")},unattachedSearchGeoOnFocus:function(w,u){var v=ta.id("SEARCH_GEO");v.value=1;u.value=""},unattachedSearchGeoOnBlur:function(A,v){var z=ta.id("SEARCH_GEO"),w=ta.id("query"),x=v.retrieve("typeAhead"),u=w.retrieve("typeAhead");if(!x.selected){var y=x.choices.getFirst();if(v.value==""||!y||!y.responseObj||y.responseObj.notFound){z.value=1;v.value=""}else{z.value=y.responseObj.value;v.value=y.responseObj.name}u.changeUrl("/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true&parentids="+z.value)}},ratingFlyoutScroll:function(v){try{var w=v.getScroll().y,u=v.getScrollSize().y;if(v.retrieve("canFetchMore",true)&&w>u-ta.servlet.Reviews.PAGING_HEIGHT){v.store("canFetchMore",false);ta.servlet.Reviews.fetchRatingPage(v)}}catch(x){ta.util.error.record(x,"ratingFlyoutScroll")}},fetchRatingPage:function(v){var u=v.getElement(".ratingVal").innerHTML,w=v.getElement(".locId").innerHTML,y=v.getElement(".revId"),x=y.innerHTML;if(x!=0){new Request({url:"/RatingPagingAjax",data:{locId:w,ratingVal:u,revId:x},method:"get",onSuccess:function(z,A){y.destroy();v.innerHTML+=z;v.store("canFetchMore",true)}}).send()}},toggleOnRecentReview:function(B,z,u){if(!B||!z||!u){return}var y=ta.id(B.target||B.srcElement);var x=ta.id("RECENT_REVIEW_QUOTE_"+u);if(x&&y&&y.id==z.id){var A=x.getElement(".speechBubble");if(A){A.addClass("highlight")}var w=x.getElement(".recentReview_meta_content");if(w){w.addClass("highlight")}}if(!x||!x.hasClass("hidden")){return}var v=ta.id("RECENT_REVIEW_ATTRIBUTION_"+u);if(!v){return}ta.select("#HR_HACKATHON_CONTENT .recentReviewQuote").each(function(C){if(C.get("id")!="RECENT_REVIEW_QUOTE_"+u){if(!C.hasClass("hidden")){C.addClass("hidden")}}else{C.removeClass("hidden")}});ta.select("#HR_HACKATHON_CONTENT .recentReviewAttribution").each(function(C){if(C.get("id")!="RECENT_REVIEW_ATTRIBUTION_"+u){if(!C.hasClass("hidden")){C.addClass("hidden")}}else{C.removeClass("hidden")}})},toggleOffRecentReview:function(A,y,u){if(!A||!y||!u){return}var w=ta.id("RECENT_REVIEW_QUOTE_"+u);if(!w){return}var x=ta.id(A.target||A.srcElement);if(x&&x.id==y.id){var z=w.getElement(".speechBubble");if(z){z.removeClass("highlight")}var v=w.getElement(".recentReview_meta_content");if(v){v.removeClass("highlight")}}},onClickRecentReview:function(x,w,u){if(!x||!w||!u){return}var v=ta.id("RECENT_REVIEW_QUOTE_"+u);if(!v){return}var y=v.getElement(".quoteLnk");if(y){y.click()}},toggleReview:function(u,w,v,y){if(!u||!w||!v){return}var A=ta.id("review_"+v);var z=ta.id("UR"+v);var C;if(z){C=z}else{if(A){C=A}else{return}}var B=C.getElement(".col2of2");var x=C.getElement(".innerBubble");if(B&&x){if(y){B.addClass("highlight");x.addClass("highlight")}else{B.removeClass("highlight");x.removeClass("highlight")}}},scrollToReview:function(v,x,w){var C=document.getElements(".persistent_tabs_header");var y=0;if(C&&C.length!=0){y=C.getHeight()}var A=ta.id("review_"+w);if(A){window.scrollTo(0,A.getPosition().y-y)}else{var z=ta.retrieve("location.helpful_review_highlight.full."+w);if(z){var B=ta.select("#REVIEWS .reviewSelector");var u=Elements.from(z);B.some(function(D){if(!D.getParent("#FRIENDS_LOCATION_CONTENT_SUMMARY")){u.inject(D,"before");A=ta.id("review_"+w);window.scrollTo(0,A.getPosition().y-y);return true}return false})}}},poiTypeIdMap:{2:"hotel",7:"eat",5:"attr",15:"al"},selectPoiType:function(x,u){ta.select(".poiTypes li").removeClass("selected");u.addClass("selected");var v=u.id.replace("type_","");ta.ReviewTracking.trackEvent("TYPE",v);var w=ta.find(".unattachedTypeahead");w&&w.toggleClass("hidden",u.id=="type_rental");ta.servlet.Reviews.changeSearchType(x,u)},selectPoiIcon:function(x,u){ta.select(".poiTypes li").addClass("collapsed");u.removeClass("disabled");u.getSiblings().addClass("disabled");var v=u.id.replace("type_","");ta.ReviewTracking.trackEvent("TYPE",v);var w=ta.find(".unattachedTypeahead");w&&w.toggleClass("hidden",u.id=="type_rental");ta.servlet.Reviews.changeSearchType(x,u)},createUnattachedTypeahead:function(y,w){w.onfocus=null;var v=ta.find('input[name="type"]').value;var x=ta.servlet.Reviews.poiTypeIdMap[v];var z=TypeAhead.utils.query(false,x,null,null,true,10,null,null,null,null,["no_closed"]);var u={name:"UnattachedWarLander",minChars:x=="al"?2:3,maxResults:10,containerParent:ta.id("PAGE"),containerClass:"typeaheadResults",search:z,itemTemplate:TypeAhead.views.itemTemplate(),itemSelector:"li",width:348,positionRelative:false,selectInputText:false,selectOnBlur:false,assumeOnBlur:false,cacheResults:false,autopopulateHighlighted:false,forceProcessResults:true,shouldSubmit:function(){searchByType(w);A.hide();return false},onSelect:function(B){var C=ta.find('input[name="type"]').value;ta.trackEventOnPage("Unattached_search","action",ta.servlet.Reviews.poiTypeIdMap[C]);var D=ta.id("UR_SELECT");if(D&&B){D.appendChild(new Element("input",{type:"hidden",name:"detail",value:B.value}));D.submit()}},resolveSelection:function(B){return B.name},onShow:function(B){B.container.addClass("visible")},onHide:function(B){B.container.removeClass("visible")}};TypeAhead.views.configureTypeAheadForSegmentedResults(u);var A=new TypeAhead(w,u);w.store("typeahead",A)},initializeMap:function(w,A,x,v){var z=w;var y=A;function u(){var B=new ta.servlet.Reviews.Map();B.initialize(z,y,x,v);ta.store("reviews.map."+w,B)}if(document.readyState==="complete"){u()}else{google.maps.event.addDomListener(window,"load",u)}},addDraggableMarker:function(u){var v=ta.retrieve("reviews.map."+u);if(v){v.addMarker();v.userMarker.setDraggable(true)}},makeMarkerDraggable:function(u){var v=ta.retrieve("reviews.map."+u);if(v&&v.userMarker){v.userMarker.setDraggable(true)}},restoreDefaultMarker:function(u){var v=ta.retrieve("reviews.map."+u);if(v){v.resetMap();if(v.userMarker){v.userMarker.setDraggable(false)}if((ta.retrieve("reviews.pinRedist"))!="true"){v.userMarker.setVisible(false)}}},mapPinConfirmationOverlay:function(w,v){var u=ta.retrieve("map_pin_confirmation_overlay");if(!u){u=new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_NEVER,showArrow:true,arrowClass:"arrow arrowLeft",showCloseButton:true,style:"tooltip ttGreen small",mirrorIfRtl:true,offsetRight:3,offsetTop:77},v);ta.store("map_pin_confirmation_overlay",u)}u.show()},trackMapPinConfirmationEvent:function(u,w){var v=ta.retrieve("reviews.map."+u);if(v){ta.trackEventOnPage("WAR_Optional",v.trackingPrefix+w)}},pinVoteNo:function(w,v,u){ta.servlet.Reviews.trackMapPinConfirmationEvent(u,"no");ta.id("PIN_YES").removeClass("selected");ta.id("PIN_NOTSURE").removeClass("selected");ta.id("PIN_NO").addClass("selected");ta.id("pinVote").value="no";if((ta.retrieve("reviews.pinRedist"))=="true"){ta.servlet.Reviews.makeMarkerDraggable(u);ta.servlet.Reviews.mapPinConfirmationOverlay(w,ta.id("MAP_CONTAINER"))}else{ta.servlet.Reviews.restoreDefaultMarker(u)}},pinVoteNotSure:function(w,v,u){ta.servlet.Reviews.trackMapPinConfirmationEvent(u,"unsure");ta.id("PIN_YES").removeClass("selected");ta.id("PIN_NO").removeClass("selected");ta.id("PIN_NOTSURE").addClass("selected");ta.id("pinVote").value="unsure";ta.servlet.Reviews.restoreDefaultMarker(u)},pinVoteYes:function(w,v,u){ta.servlet.Reviews.trackMapPinConfirmationEvent(u,"yes");ta.id("PIN_NO").removeClass("selected");ta.id("PIN_NOTSURE").removeClass("selected");ta.id("PIN_YES").addClass("selected");ta.id("pinVote").value="yes";if((ta.retrieve("reviews.pinRedist"))!="true"){ta.servlet.Reviews.addDraggableMarker(u);ta.servlet.Reviews.makeMarkerDraggable(u);ta.servlet.Reviews.mapPinConfirmationOverlay(w,ta.id("MAP_CONTAINER"))}else{ta.servlet.Reviews.restoreDefaultMarker(u)}},showReviewOverlay:function(){ta.find("#TOP_REVIEW_OVERLAY_HEADING_TITLE").innerHTML=ta.find(".altHeadInline a").innerHTML;var v=ta.find("#OVERLAY_REVIEW");if(v){var u=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true,style:"reviewMsgOverlay"}).loadRemoteSuccess(v.innerHTML);ta.store("userreview.overlayReview",u);ta.trackEventOnPage("UserReviewSearch","overlay_open","")}},initUserReviewOnTopTracking:function(){var v=ta.find(".writeAnotherReviewCta");if(v==null){return}ta.util.element.doIfElementIsVisible(v,ta.trackEventOnPage,["User_review_top","inView"]);var w;var x=function(){w=y.delay(500,v)};var u=function(){clearTimeout(w)};var y=function(){ta.trackEventOnPage("User_review_top","Impression","");v.removeEvent("mouseenter",x);v.removeEvent("mouseleave",u)};v.addEvent("mouseenter",x);v.addEvent("mouseleave",u)},initOwnersFavoriteReviewTracking:function(u){var w=function(){new Request({url:"/BLImpRecord",trackEvent:{module:servletName,action:"FAVORITE_VIEW",context:modelLocId},data:{blImps:JSON.stringify([{locationId:modelLocId,servlet:servletName,tab:"Reviews",display:"FavoriteReview",details:"REVIEW",position:1}])}}).send()};var v=ta.id("review_"+u);if(v){ta.util.element.doIfElementIsVisible(v,w);ta.select(v,".helpful_text").addEvent("click",function(){ta.trackEventOnPage(servletName,"FAVORITE_HELPFUL",modelLocId)});ta.select(v,".reportTxt").addEvent("click",function(){ta.trackEventOnPage(servletName,"FAVORITE_REPORT",modelLocId)});ta.select(v,"#rn"+u).addEvent("click",function(){ta.setEvtCookie(servletName,"FAVORITE_REVIEW_TITLE",modelLocId,0,this.href)});ta.select(v,".moreLink").addEvent("click",function(){ta.trackEventOnPage(servletName,"FAVORITE_MORE",modelLocId)});ta.select(v,".ownerFavHeader").addEvent("mouseover",function(){ta.trackEventOnPage(servletName,"FAVORITE_TOOLTIP",modelLocId);ta.id(this).removeEvents("mouseover")})}},iapFlyout:function(w,v,u){p.open(w,v,{voteContentType:"USERREVIEW",contentId:u})},iapOwnerFlyout:function(w,v,u){u.owner=true;p.open(w,v,u)},showSendMessage:function(u,w,v){q.showSendMessage(u,w,v)},openTranslation:function(v,u){ta.util.cookie.setPIDCookie(16009);if(k){k.sourceElement=v;k.updateContent(u)}else{k=new j(v,[a(v,"center",""),t.center([0,0]),d,i,l,r(),o(u,{resources:[window.conceptCss]})]);ta.store("translationOverlay",k);k.container.style.maxWidth="90%";k.container.style.width="800px"}k.show()},showRoomTips:function(v){var u=new j(null,[a(null,"center","small no_padding"),t.center(),d,i,l,o("/AccommodationTips?d="+window.modelLocId+(v?"&filterLang="+v:""))]);u.on("contentLoaded",function(){if(ta.find("#emptyTips",u.contentElement)){setTimeout(u.hide.bind(u),1)}});u.show()}};ta.servlet.Reviews.Map=function g(){this.mapId=null;this.isInteractive=false;this.isZoomInitialized=false;this.googleMap=null;this.streetField=null;this.localStreetField=null;this.street1_local=null;this.street1=null;this.city=null;this.state=null;this.country=null;this.defaultLat=null;this.defaultLng=null;this.hasDefault=false;this.redistributable=false;this.userMarker=null;this.userMarkerMoved=false;this.userMarkerZoom=-1;this.resetPinButton=null;this.trackingPrefix=null;this.trackingInteractivePrefix=null;this.updateTimeout=null};ta.servlet.Reviews.Map.prototype.initialize=function(w,B,y,v){this.mapId=w;this.isInteractive=B;this.streetField=ta.id(y);this.localStreetField=ta.id(v);this.populateMapInfoFromServlet();ta.trackEventOnPage("WAR_Optional",this.trackingPrefix+"load");var u={center:this.hasDefault?{lat:this.defaultLat,lng:this.defaultLng}:{lat:13.081,lng:80.274},zoom:this.hasDefault?this.streetLevelZoom+1:2,streetViewControl:B,draggable:B,scrollwheel:B,disableDefaultUI:!B,disableDoubleClickZoom:!B};this.googleMap=new google.maps.Map(document.getElementById(w),u);var x,z;if(B){x=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pinSearchCustom.png");z=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pinSearchCustomOver.png")}else{x=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pin_v2_CurrentCenter.png");z=new google.maps.MarkerImage(CDNHOST+"/img2/maps/icons/pin_v2_CurrentCenterOver.png")}this.userMarker=new google.maps.Marker({visible:false,icon:x,zIndex:10,optimized:false,draggable:false,title:B?ta.retrieve("reviews.userMarkerTooltip"):""});this.userMarker.setMap(this.googleMap);this.userMarker.setVisible(this.redistributable);this.userMarker.setPosition(this.googleMap.getCenter());this.removeReportAnErrorButton(this.googleMap);if(B){this.addListeners(x,z);this.addMapControls()}this.clearMapWarnings();var A=this;google.maps.event.addListenerOnce(this.googleMap,"tilesloaded",function(){A.setupGeoCodes()})};ta.servlet.Reviews.Map.prototype.addListeners=function(v,u){Element.NativeEvents.input=2;var w=this.userMarker;var x=this;[this.streetField,this.localStreetField].forEach(function(A){if(A){var z="mapChangeEvent."+x.mapId+"."+A.id;var y=function(C){x.updateGeoCodes()};var B=ta.retrieve(z);["change","input"].forEach(function(C){A.removeEvent(C,B);A.addEvent(C,y)});ta.store(z,y)}});google.maps.event.addListener(w,"mouseover",function(){w.setIcon(u)});google.maps.event.addListener(w,"mouseout",function(){w.setIcon(v)});google.maps.event.addListener(this.googleMap,"bounds_changed",function(){if(x.isZoomInitialized){ta.trackEventOnPage("WAR_Optional",x.trackingPrefix+"map_zoom")}if(x.userMarker.getVisible()&&x.googleMap.getBounds().contains(x.userMarker.getPosition())){x.userMarkerZoom=Math.max(x.googleMap.getZoom(),x.userMarkerZoom)}x.validateMap()});google.maps.event.addListener(w,"dragend",function(){ta.trackEventOnPage("WAR_Optional",x.trackingInteractivePrefix+"pin_move");x.resetTimeout();x.userMarkerMoved=true;x.userMarkerZoom=x.googleMap.getZoom();x.validateMap();ta.id("newLat").value=w.getPosition().lat();ta.id("newLng").value=w.getPosition().lng()})};ta.servlet.Reviews.Map.prototype.removeReportAnErrorButton=function(x){var u={name:"Dummy Style"};var v=[{featureType:"road",elementType:"all",stylers:[{visibility:"on"}]}];var w=new google.maps.StyledMapType(v,u);x.mapTypes.set("Dummy Style",w);x.setMapTypeId("Dummy Style")};ta.servlet.Reviews.Map.prototype.populateMapInfoFromServlet=function(){this.streetLevelZoom=parseInt(ta.retrieve("reviews.street_level_zoom"))||15;this.redistributable=(ta.retrieve("reviews.pinRedist"))=="true";this.defaultLat=parseFloat(ta.retrieve("reviews.pinLat"));this.defaultLng=parseFloat(ta.retrieve("reviews.pinLng"));this.hasDefault=!!(this.defaultLat&&this.defaultLng);this.city=ta.retrieve("reviews.address_city");this.state=ta.retrieve("reviews.address_state");this.country=ta.retrieve("reviews.address_country");this.street1=ta.retrieve("reviews.address_street1");this.street1_local=ta.retrieve("reviews.address_street1_local");if(this.redistributable){this.trackingPrefix="map_confirm_";this.trackingInteractivePrefix="map_confirm_no_"}else{if(this.hasDefault){this.trackingPrefix="map_addpin_noregc_";this.trackingInteractivePrefix="map_addpin_noregc_yes_"}else{this.trackingPrefix="map_addpin_nogc_";this.trackingInteractivePrefix="map_addpin_nogc_yes_"}}};ta.servlet.Reviews.Map.prototype.handleNewGeoCodes=function(y,w){var z=null;var x=null;var v=false;if(w==google.maps.GeocoderStatus.OK){if(y&&y[0]&&y[0].geometry&&y[0].geometry.location){v=true;var u=y[0].geometry.location;this.googleMap.fitBounds(y[0].geometry.viewport);this.userMarker.setPosition(this.googleMap.getCenter());if(this.street1||this.street1_local){z=u.lat();x=u.lng();this.googleMap.setZoom(this.streetLevelZoom+1)}}}else{if(w==google.maps.GeocoderStatus.ZERO_RESULTS){v=true}}if(v){this.defaultLat=z;this.defaultLng=x;this.hasDefault=!!(z&&x);this.userMarker.setVisible(this.hasDefault);this.userMarkerMoved=false}this.validateMap()};ta.servlet.Reviews.Map.prototype.resetTimeout=function(){if(this.updateTimeout){clearTimeout(this.updateTimeout);this.updateTimeout=null}};ta.servlet.Reviews.Map.prototype.updateGeoCodes=function(v){if(this.updateTimeout){clearTimeout(this.updateTimeout)}var w=this;var u=function(){w.updateTimeout=null;w.street1=w.streetField?w.streetField.value:null;w.street1_local=w.localStreetField?w.localStreetField.value:null;var A=w.googleMap;var y=[];y.push(w.street1_local||w.street1);y.push(w.city);y.push(w.state);y.push(w.country);var x=y.join(", ");var z=new google.maps.Geocoder();z.geocode({address:x},function(C,B){w.handleNewGeoCodes(C,B)})};if(v){u()}else{this.updateTimeout=setTimeout(u,500)}};ta.servlet.Reviews.Map.prototype.setupGeoCodes=function(){if(this.hasDefault){this.userMarker.setPosition(new google.maps.LatLng(this.defaultLat,this.defaultLng));this.userMarker.setVisible(this.redistributable);this.googleMap.setCenter(this.userMarker.getPosition());this.googleMap.setZoom(this.streetLevelZoom+1);this.validateMap();this.isZoomInitialized=true}else{this.updateGeoCodes(true);var u=this;google.maps.event.addListenerOnce(this.googleMap,"tilesloaded",function(){u.isZoomInitialized=true})}};ta.servlet.Reviews.Map.prototype.resetMap=function(){this.resetTimeout();if(this.hasDefault){var u=new google.maps.LatLng(this.defaultLat,this.defaultLng);this.userMarker.setPosition(u);if(!this.googleMap.getBounds().contains(u)){this.googleMap.setCenter(u)}ta.id("newLat").value="";ta.id("newLng").value=""}else{this.userMarker.setVisible(false)}this.userMarkerMoved=false;this.validateMap()};ta.servlet.Reviews.Map.prototype.addMarker=function(){this.resetTimeout();this.userMarker.setPosition(this.googleMap.getCenter());this.userMarkerZoom=this.googleMap.getZoom();this.userMarker.setVisible(true);this.validateMap()};ta.servlet.Reviews.Map.prototype.addMapControls=function(){var y=this;var w=document.createElement("div");var v=ta.retrieve("reviews.resetPinText");var x=ta.retrieve("reviews.resetPinTooltip");var u=function(){return function(){ta.trackEventOnPage("WAR_Optional",y.trackingInteractivePrefix+"pin_reset");y.resetMap()}};y.resetPinButton=ta.servlet.Reviews.Map.prototype.createButton("resetPinButton",v,x,u());w.appendChild(y.resetPinButton);w.index=0;this.googleMap.controls[google.maps.ControlPosition.RIGHT_TOP].push(w)};ta.servlet.Reviews.Map.prototype.createButton=function(A,y,z,v){var u=document.createElement("div");u.id=A;u.className="mapButton";var x=document.createElement("div");x.className="mapButtonBorder";x.title=z;u.appendChild(x);var w=document.createElement("div");w.className="mapButtonText";w.innerHTML=y;x.appendChild(w);if(v!=null){google.maps.event.addDomListener(x,"click",v)}return u};ta.servlet.Reviews.Map.prototype.addMapWarning=function(w){var v=ta.id("warningMessages");var u=ta.id("warningMessageContainer");if(u){ta.id(u).show()}if(v){if(v.innerHTML.length>0){v.innerHTML+="<br />"}v.innerHTML+=w}};ta.servlet.Reviews.Map.prototype.clearMapWarnings=function(){var v=ta.id("warningMessages");var u=ta.id("warningMessageContainer");if(u){ta.id(u).hide()}if(v){v.innerHTML=""}};ta.servlet.Reviews.Map.prototype.validateMap=function(){if(!this.isInteractive){return}this.clearMapWarnings();if(!this.checkZoom()){this.addMapWarning(ta.retrieve("reviews.zoomInWarningMsg"))}if(!this.userMarkerMoved){ta.id(this.resetPinButton).hide()}else{ta.id(this.resetPinButton).show()}};ta.servlet.Reviews.Map.prototype.checkZoom=function(){return this.userMarkerZoom>this.streetLevelZoom||!this.userMarkerMoved};var f={};function h(u){var B=u.getElement(".usefulReviewContainer");var z=u.getElement(".usefulReviewSlider");var x=u.getElement(".userfulReviewSrc");var w=u.getElement(".userfulReviewUserId");var y=u.getElement(".usefulReviewThankYou");if(B&&z&&x&&w&&y){var A=x.innerHTML;var v=new Slider(B,z,{onChange:function(C){f[A]={userId:w.innerHTML,rating:C+1};y.style.display="block"},steps:4,offset:0});v.setDefault(2)}}window.addEvent("load",function(){setTimeout(function(){m.select("div.usefulReview").forEach(function(u){h(u)})},50)})});ta.servlet.Location={distanceUnitsCookieName:"TAdistanceCookie",showMi:function(){$$("#NEARBY .milesOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .distanceMiles").show();$$("#NEARBY .distanceKm").hide();Cookie.write(this.distanceUnitsCookieName,0)},showKm:function(){$$("#NEARBY .kmOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .distanceMiles").hide();$$("#NEARBY .distanceKm").show();Cookie.write(this.distanceUnitsCookieName,1)},reportClosedVote:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodeclosed&id="+c,onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})}}).send()}},reportGeoCode:function(d,c,e,b,a){if(e&&e>0){e=encodeURIComponent(e);new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodebad&id="+e,onSuccess:function(f){ta.overlays.showInLightbox(f,{style:"mg s4",delayedPosition:true})}}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,e)}},reportCorrectAddr:function(c,f,k,n,d,i,l,o){if(k&&k>0){k=encodeURIComponent(k);var h=document.getElementById("street").value;var j=document.getElementById("city").value;var b=document.getElementById("state").value;var e=document.getElementById("zip").value;var g=document.getElementById("country").value;var m=document.getElementById("phone").value;var a=document.getElementById("website").value;if(n==h&&d==j&&i==e&&l==m&&o==a){new Request({method:"post",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodecorrect&updated=false&id="+k,onSuccess:function(p){ta.overlays.showInLightbox(p,{style:"mg s4",delayedPosition:true})}}).send()}else{h=encodeURIComponent(h);j=encodeURIComponent(j);b=encodeURIComponent(b);e=encodeURIComponent(e);g=encodeURIComponent(g);m=encodeURIComponent(m);a=encodeURIComponent(a);new Request({method:"post",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&action=geocodecorrect&updated=true&id="+k+"&street="+h+"&city="+j+"&state="+b+"&zip="+e+"&country="+g+"&phoneNumber="+m+"&webSite="+a,onSuccess:function(p){ta.overlays.showInLightbox(p,{style:"mg s4",delayedPosition:true})}}).send()}}},reportGeoCodeDialog:function(d,c,e,b,a){if(typeof(incorrectLocation)!="undefined"&&!this.incorrectLocationLink){this.incorrectLocationLink=Asset.css(incorrectLocation)}if(e&&e>0){e=encodeURIComponent(e);new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&id="+e+"&action=geocodedialog",onSuccess:function(f){ta.overlays.showInLightbox(f,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,e)}},updateListingInformation:function(a,c,e,i,f,b,h,g){if(e&&e>0){if(g){window.location.href=g}else{var d={style:"glnew_lightbox",closeButtonClass:"innerClose",delayedPosition:true,attachCloseEvent:false,permanent:true,showCloseButton:true};new Request({url:"/GetListedUpdate"+b+"?id="+e,onSuccess:function(k){var j=ta.overlays.showInLightbox(k,Object.merge(d,{title:h}));j.closeBtn.addEvent("click",function(){ta.GetListedNew.closeOverlay()})},evalScripts:true}).send()}}if(ta.trackEventOnPage&&i&&f){ta.trackEventOnPage(i,f,e)}},reportClosedVoteNew:function(d,c,f,b,a,e){if(f&&f>0){new Request({method:"post",url:"/"+e+"?action=closedareyousure&id="+f,onSuccess:function(g){ta.overlays.showInLightbox(g,{style:"glnew_update_areyousure mg s4",delayedPosition:true,isChild:true,showCloseButton:false})},evalScripts:true}).send()}},recordOpenVote:function(d,c,f,b,a,e){if(f&&f>0){new Request({method:"post",url:"/"+e+"?action=voteopen&id="+f,onSuccess:function(g){ta.overlays.showInLightbox(g,{style:"mg s4",delayedPosition:true,showCloseButton:false})},evalScripts:true}).send()}},requestListingWithLightbox:function(b,c,a,h,k,e,l){l=l||{};var f={};var i=document.getElementById("query");if(i&&i.value){f.query=i.value}var d={style:"glnew_lightbox",closeButtonClass:"innerClose",delayedPosition:true,attachCloseEvent:false,permanent:true,showCloseButton:true};var j={showthanks:k,fromWARToDo:e,placetype:a,reviewID:l.reviewID};var g="/GetListedLightbox?"+Object.toQueryString(j);new Request({method:"post",url:g,data:f,onSuccess:function(n){var m=ta.overlays.showInLightbox(n,Object.merge(d,{title:h}));m.closeBtn.addEvent("click",function(){ta.GetListedNew.closeOverlay()});if(l.onHide){m.addEvent("hide",function(){l.onHide({display:"form"})})}m.container.store("onhide",l.onHide);ta.select(".overlayBG").setStyle("height",Math.max(window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight),document.body.scrollHeight))},evalScripts:true}).send()},showReportForm:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&id="+c+"&action=geocodeform",onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}},setTrackPID:function(c,b,a){if(a==10022){ta.util.cookie.setPIDCookie(17138)}else{if(a==10021){ta.util.cookie.setPIDCookie(17137)}}},closeLightbox:function(){var a=ta.retrieve("overlays.current");if(a){a.hide()}},activateReportButton:function(){var a=ta.id("REPORT_LOCATION").getElements(".button")[0];a.removeClass("inactive");a.removeProperty("disabled")}};define("ta/servlet/Popup",["ns-exporter","lib/jquery-amd","ta/Browser","ta/util/Error","ta/Core/TA.Record","ta/Core/TA.Store","ta/util/Cookie","api-mod"],function(k,f,i,b,g,d,a,h){var j=0;function c(l){if(l){if(l.preventDefault){l.preventDefault()}else{l.returnValue=false}}}var e={open:function(l,m,n,C,v,u,q,B){try{if(isNaN(parseInt(n))){n=600}else{n=parseInt(n)}if(isNaN(parseInt(C))){C=400}else{C=parseInt(C)}if(isNaN(parseInt(v))){v=0}else{v=parseInt(v)}if(isNaN(parseInt(u))){u=0}else{u=parseInt(u)}if(l.indexOf("p=HotelsCom")>-1){n=Math.max(n,960);C=Math.max(C,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,600)}if(i.isChrome()){q=true}var p=1;if(q){p=0}var t=1;if(i.isIE9orHigher()){var t=0}var s=false;if(m&&typeof m=="string"){s=m}if(!s){var D=j++;s="TripPop"+D}var o="";if(B){o="toolbar=1,resizable=1,location=1,status=1"}else{t=0;o="toolbar=0,resizable=1,location=0,status=0"}o+=",menubar="+t;o+=",scrollbars="+p;o+=",width="+n;o+=",height="+C;o+=",screenX="+v+",left="+v;o+=",screenY="+u+",top="+u;var z=window.open(l,s,o);if(z!=null){try{z.focus();z.opener=self}catch(A){}return z}}catch(r){b.record(r,"Popup.open",null,{name:m,width:n,height:C,x:v,y:u,noScroll:q,allOptions:B})}},openExternalWithDefaultOptions:function(l){try{var m=475;var A=390;var u=210;var t=5;if(screen.width>=1024&&screen.height>=768){m=900;A=768;u=240}else{if(screen.width>1024){m=800;A=600;u=240}else{if(screen.width>800){m=620;A=500;u=240}}}if(l.indexOf("p=HotelsCom")>-1){m=Math.max(m,960);A=Math.max(A,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,600)}var p=false;if(i.isChrome()){p=true}var o=1;if(p){o=0}var s=1;if(i.isIE9orHigher()){var s=0}var B=j++;var r="TripPop"+B;var n="toolbar=1,resizable=1,location=1,status=1";n+=",menubar="+s;n+=",scrollbars="+o;n+=",width="+m;n+=",height="+A;n+=",screenX="+u+",left="+u;n+=",screenY="+t+",top="+t;var v=window.open(l,r,n);if(v!=null){try{v.focus();v.opener=self}catch(z){}return v}}catch(q){b.record(q,"Popup.open - openExternalWithDefaultOptions",null,{name:name,width:m,height:A,x:u,y:t,noScroll:p})}},openSizedPopup:function(p,m,o){c(p);var n=600;var l=400;if(sz=m.className.match(/sz(\d+)x(\d+)/)){n=sz[1];l=sz[2]}e.open(m.href,"photoTPW",n,l,false,false,((typeof o!=="undefined")?o:true),true)},checkrates:function(m,l){c(m);l=f(l).closest("a")[0];e.open(l.href,"cr",245,610,5,5);g.trackEventOnPage("map_pin_overlay","check_rates_click")},sponsorCheckRates:function(o,m){c(o);m=f(m).closest("span")[0];var l=m.className.match(/id_(\d+)/)[1];var n="/HotelDateSearch?d="+l+"&fromPop=false&sponsid="+d.retrieve("sponsor.id")+"&area=QC_Button_Map&from=HACSearchButton&returnTo=__2F__GMapsLocationController&sponsdet=mapsHacBottom";e.open(n,"cr",245,610,5,5)},termsPopup:function(m,l){popup.apply(l,[m,"terms",300,300,30,25]);return false},openInParent:function(p,o,n){var l=false;if(window.top&&window.top.opener){l=window.top}else{if(window.opener){l=window}}if(!l){return true}var m="";if(o.nodeName==="FORM"){m=o.action+"?"+h.toFormQueryString(o)}else{o=f(o).closest("a")[0];if(o){m=o.href}}if(m!==""){c(p);l.opener.location=m;if(!(typeof n!=="undefined"&&n)){l.close()}else{window.blur()}}},openInParentOrSelf:function(o,n){var l=false;if(window.top&&window.top.opener){l=window.top}else{if(window.opener){l=window}}var m="";if(n.nodeName==="FORM"){m=n.action+"?"+h.toFormQueryString(n)}else{n=f(n).closest("a")[0];if(n){m=n.href}}if(m!==""){c(o);if(!l||(typeof l.opener=="undefined")||!l.opener||(typeof l.opener.closed==="undefined")||l.opener.closed){window.location=m}else{l.opener.location=m;l.close()}}},photoGallery:function(l,o){o=f(o).closest("a")[0];if(!o){b.record(r,"photoGallery - get anchor elmt");return false}var m="";var n="1";if(o.className){m=o.className.match(/u_([^ ]*)/)[1];n=o.className.match(/#([0-9]+)/)[1]}try{if(typeof cookieDomain=="undefined"){var q=window.location.hostname.split("."),p=0,t;while(q[p]&&q[p]!="tripadvisor"){p++}t=q.slice(p).join(".");if(t){cookieDomain="."+t}}a.write("PhotoPop",n,null,null,cookieDomain)}catch(r){b.record(r,"photoGallery - cookie set")}try{var s="";if(m){s=e.open(m,"media",780,800)}else{}try{if(s&&s.showImage){s.showImage(n)}}catch(r){}}catch(r){b.record(r,"photoGallery - pop window")}return false},openAIMLink:function(q,o){c(q);var n;var l=f(o).closest("span.fkASDF,div.fkASDF,a")[0];if(!l){return}else{if(l.nodeName==="A"){n=l.href}else{n=o.className.match(/u_([^ ]*)/)[1]}}var p="navarea";if(ta.meta&&ta.meta.link&&ta.meta.link.getPhotoNavArea){p=ta.meta.link.getPhotoNavArea(o)}n=n.replace("%7Cnavarea%7C",p);var m=o.className.match(/win(.+)/);if(m&&m.length>1){m=m[1]}else{m=null}d.store("commerce.AIMWindow",e.open(n,m,980,800,240,5,false,true))},openProviderWindow:function(m,l){c(m);e.open(l.href,"photoTPW",1260,922,false,false,true,true)}};k.exportTo(e,"ta.servlet.Popup");return e});(function(){ta.servlet.Hotel={detailsTabClicked:function(e,d){a(locationId,"tabDetails")},photosTabClicked:function(e,d){a(locationId,"tabPhotos")},mapTabClicked:function(e,d){a(locationId,"tabMap")},ratingsTabClicked:function(e,d){a(locationId,"tabRatings")},anchorAtHotelsSortingHeader:function(){var d=ta.id("hotels_list_sorting_header");if(d){new Fx.Scroll(document.body,{offset:{x:0,y:d.getPosition().y}}).toTop()}},setPid:function(d){ta.util.cookie.setPIDCookie(d)},setConceptCookie:function(){if(ta.has("topconcepts.lastconcept")){var d=ta.retrieve("topconcepts.lastconcept");Cookie.write("CONCEPT",d,{domain:cookieDomain,time:5})}return true},voteRecorded:false,recordVote:function(e,j,h,f,d){if(d.checked&&!ta.servlet.Hotel.voteRecorded){ta.servlet.Hotel.voteRecorded=true;new Request({url:"/ActionRecord-g"+e+"-d"+j+"?action=TopConceptsHelpful_"+h}).send();var g=$("preVote");var i=$("postVote");if(g&&i){g.style.display="none";i.style.display="inline"}else{ta.util.error.record(null,"recordVote - cannot find voting spans")}}return true},isHotelsServlet:function(d){if(ta.has("is_hotels_serv")){return ta.retrieve("is_hotels_serv")}var e=ta.id("PAGE");if(e&&typeof e!="undefined"){if(e.hasClass("hotels_like")){ta.store("is_hotels_serv",true);return true}else{if(e.hasClass("non_hotels_like")){ta.store("is_hotels_serv",false);return false}}}if(typeof d!="undefined"){return d}return false},selectLanguage:function(g,e,h){var f=ta.id("LANG_FORM");var d=ta.id("filterLang");if(f&&d){ta.setEvtCookie("Reviews_Controls","language_sort","",0,window.location.href);d.value=h;f.submit()}},selectSeason:function(d,i,l,e,g,h){var j=ta.find("#MONTH_FORM .seasonLabel");if(ta.util.localstorage&&ta.util.localstorage.canUseLocalStore()){var k=new Date();k.setHours(k.getHours()+12);if(g!=0){localStorage.setItem("season_memory_expiry_time",k);localStorage.setItem("season_memory_loc_id",l);localStorage.setItem("season_memory_geo_id",e)}else{localStorage.removeItem("season_memory_expiry_time");localStorage.removeItem("season_memory_popup_shown");localStorage.removeItem("season_memory_loc_id");localStorage.removeItem("season_memory_new_popup_shown");localStorage.removeItem("season_memory_geo_id")}}if(j&&h){j.set("text",h)}var f=ta.id("MONTH_FORM");var n=ta.id("filterSeasons");if(f&&n){n.value=g;ta.trackEventOnPage("Reviews_Controls","season","",g);function m(){var o=ta.select(".seasonList .spinner img");o.forEach(function(q){q.remove()});var p=ta.find(".spinner",i);if(p){new Asset.image(CDNHOST+"/img2/spinner.gif").inject(p)}}m();f.submit()}}};var c=null;var b=false;window.addEvent("load",function(){if(ta.id("CONTAINER01")){c={};b=$$("#TABS01 .current");if(b){b=b[0]}}});function a(j,m){function g(s,e){if(!s){return}if(s.removeClass){s.removeClass(e)}if(s.childNodes){var r=s.childNodes;for(var q=0;q<r.length;q++){g(r[q],e)}}}try{if(!c){return}if(!b){b=ta.id("tabRatings")}var o=document.getElementById("CONTAINER01");if(!o){ta.util.error.record(null,"hotel tab loading - no container")}if(b&&!c[b.id]){c[b.id]=o.innerHTML}g(b,"current");var f=ta.id(m);if(!f||!f.addClass){ta.util.error.record(null,"hotel tab loading - trouble wrapping elmt");return}b=f.addClass("current");if(c[m]){try{o.innerHTML=c[m];if(window.behavior){window.behavior.apply(ta.id(o))}}catch(l){ta.util.error.record(l,"showTab - existing")}return}var p=false;try{p=location.pathname;if(p&&typeof p=="string"&&p.length>0){if(p.charAt(0)=="/"){p=p.substring(1)}var n=p.indexOf("-");if(n>=0){p=p.substring(0,n)}}}catch(l){ta.util.error.record(l,"hotel tab loading - servlet access",null,{tabName:m})}o.innerHTML="";var i=new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{"class":"anim_loop"}).inject(o,"top");var k="http://"+document.domain;new Request({url:k+"/LocationTab",evalScripts:true,data:{d:j,tab:m.replace(/tab/,"").toLowerCase(),from:p},onSuccess:function d(q){try{var r=document.getElementById("CONTAINER01");r.innerHTML=q;if(window.behavior){window.behavior.apply(ta.id(r))}c[this.options.data.tab]=q}catch(s){ta.util.error.record(s,"hotel tab loading - content load")}},onFailure:function(e){ta.util.error.record(l,"hotel tab loading - no content",null,{status:e.status,tabName:m,detId:j,from:p})}}).send()}catch(h){ta.util.error.record(h,"hotel tab loading",null,{tabName:m})}}})();define("ta/servlet/ShowSpecialOfferStub",["vanillajs","ta/Core/TA.Event","ns-exporter"],function(c,b,d){var a={};a.open=function(){var f=[].slice.call(arguments);if(require.defined("ta/servlet/ShowSpecialOffer")){var e=require("ta/servlet/ShowSpecialOffer");e.openCoupon.apply(e,f)}else{b.run.apply(b,["ta.overlays.Factory.createCouponAnnouncementOverlay",null].concat(f))}};a.openOnOpen=function(){if(require.defined("ta/Core/TA.Store")){require("ta/Core/TA.Store").store("suppressMetaFocus",true)}a.open.apply(null,arguments)};d.exportTo(a,"ta.servlet.ShowSpecialOffer");return a});define("utils/cookieutils",["vanillajs","utils/ajax"],function(e,f){var a=function(g){return typeof(g)!=="undefined"&&g!==null},c=function(g){return g.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},b=function(){var g=window.location.host.match(/\.tripadvisor\..*/);if(g!=null){g=g[0];return g}else{return null}},d=function(i,j,h){if(!(a(h.doNotEscape)&&h.doNotEscape)){j=encodeURIComponent(j)}if(h.domain){j+="; domain="+h.domain}else{j+="; domain="+b()}if(h.path){j+="; path="+h.path}if(h.duration){var g=new Date();g.setTime(g.getTime()+h.duration*1000);j+="; expires="+g.toGMTString()}if(h.secure){j+="; secure"}var k="%1%";if(a(h.ignoreVersion)&&h.ignoreVersion){k=""}document.cookie=i+"="+k+j};return{addPidToCookie:function(g){if(a(g)&&0!==g.length){d("NPID",g,{path:"/",duration:(5),ignoreVersion:true})}},roybatty:function(){var g=b(),j=window.taSecureToken,k,l;if(window.taEarlyRoyBattyStatus){if(window.taEarlyRoyBattyStatus>1&&ta&&ta.trackEventOnPage){ta.trackEventOnPage("early_roy_batty","confirm","",0,true)}}else{l=this.getCookie("roybatty");if(!l){document.setCookie("roybatty",j+",1",{domain:g,ignoreVersion:true,path:"/"});f({type:"POST",url:"/CookiePingback"})}else{var i=l.split(",");if(i&&i.length==2){var h=parseInt(i[1],10);document.setCookie("roybatty",j+","+h,{domain:g,ignoreVersion:true,path:"/"})}}}},getCookie:function(g){var h=document.cookie.match("(?:^|;)\\s*"+c(g)+"=([^;]*)");if(h){h=h[1];if(h.indexOf("%1%")===0){h=h.substring(3)}return decodeURIComponent(h)}return null},setCookieInSeconds:d}});define("utils/ceUtils",["ta","vanillajs","api-mod","mixins/Events","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","utils/browserutils","overlays/widgetoverlays",],function(i,k,j,o,c,m,e,n,b,f,d,l,h){function g(){j.mixin(this,new o("showExplanatoryOverlay","hideExplanatoryOverlay","beginInstall","cancelInstall","test"));var p=this;this.detectExtension=function(s,r,t){var q=new Image();q.src="chrome-extension://"+s;q.onload=function(){r&&r()};q.onerror=function(){t&&t()}};this.showExplanatoryOverlay=function(r){var q=l.Platform.name.match(/(linux|mac|win)/);var s="win";if(q&&q.length>=1){s=q[0]}var t=h.showLightbox("CHROME_EXPLANATORY_OVERLAY",{version:r,classes:s},{classes:["chrome explanatory",s,r].join(" "),mixins:[e.topCenter([0,284])]});p.emit("showExplanatoryOverlay");p.on("hideExplanatoryOverlay",function(){t.hide()})};this.installClickHandler=function(q,u,r,s){if(window.event){window.event.preventDefault();window.event.stopPropagation()}try{chrome.webstore.install(g.WEBSTORE_URL,function(){i.trackEventOnPage(q,u,"installed",r,true);p.emit("hideExplanatoryOverlay")},function(w){i.trackEventOnPage(q,u+"_e",w,r,true);if(/Could not fetch data from the Chrome Web Store|Installs can only be initiated by one of the Chrome Web Store item's verified sites|Inline installs can not be initiated from fullscreen/i.test(w)){var v=g.prototype.WEBSTORE_URL+"?utm_source="+u+"&utm_medium=install_error";location.href=v}p.emit("hideExplanatoryOverlay")});p.showExplanatoryOverlay(s)}catch(t){}};this.lpdlInterstitial=function(s,v,t,w){var q="ce_promo_campaign";var u="interstitial";var r=new c(null,[m(null,"center","pcb chrome","","",null),e.center([0,0]),n,b,f(),d("/MetaPlacementAjax",{reqParams:s,resources:v})]);r.on("hide",t);r.on("contentLoaded",function(){w();var x=i.find(".chrome_dt .install_btn");x&&x.addEvent("click",function(){p.installClickHandler(q,u,x.dataset.version,"v-6310");i.trackEventOnPage(q,u,"click",x.dataset.version)});i.trackEventOnPage(q,u,"impression",x.dataset.version)});r.show();i.store("PCBInterstitialOpen",true);p.on("showExplanatoryOverlay",function(){r.hide()});p.on("hideExplanatoryOverlay",function(){r.show()});return r}}g.prototype.CHROME_EXT_ID="oiekdmlabennjdpgimlcpmphdjphlcha";g.prototype.CHROME_EXT_TAG=g.prototype.CHROME_EXT_ID+"/images/owl-48.png";g.prototype.WEBSTORE_URL="https://chrome.google.com/webstore/detail/"+g.prototype.CHROME_EXT_ID;g.prototype.PINTEREST_EXT_ID="";var a=function(r,q,p){if(chrome&&chrome.runtime&&chrome.runtime.sendMessage){chrome.runtime.sendMessage(r,{message:"installed"},function(s){if(s){q&&q()}else{p&&p()}})}else{p()}};return new g()});ta.widgets.calendar={multiDateFormatter:function(f,g,e,c,d){var b={cname:"",contents:f.getDate()};var a="";if(!e){a="invalid"}else{if(f.getTime()==this.today.getTime()){if(this.newInDate&&f.getTime()==this.newInDate.getTime()){a="today inDate"}else{if(!g){a="today disabled"}else{a="today"}}}else{if(this.newInDate&&f.getTime()==this.newInDate.getTime()){a=d.inDateClass}}}b.cname=a;return b},calendarSingleSelect:function(h,g,a,f,b){try{ta.id(b).getParent(".overlay").overlay.calendar.singleDaySelect(h,ta.util.date.create(g,a,f),b)}catch(c){ta.util.error.record(c,"calendarSingleSelect issue")}},calendarMCSelect:function(h,g,a,f,b){try{ta.id(b).getParent(".overlay").overlay.calendar.multiCitySelect(h,ta.util.date.create(g,a,f),b)}catch(c){ta.util.error.record(c,"calendarMCSelect issue")}},dateFromString:function(f,i){f=f.replace(/\n/g,"");var c=i?i:ta.widgets.calendar.getDatePickerFormat("classic");var h=c.replace(/\w/g,"")[0];c=c.replace(/ /g,"").split(h);var d=f.replace(/ /g,"").split(h);if(c.contains("MM")&&c.contains("dd")&&c.contains("yyyy")){var g=c.indexOf("MM"),a=c.indexOf("dd"),b=c.indexOf("yyyy");var e=new Date(d[b],d[g]-1,d[a]);if(ta.retrieve("thai_buddhist_era_year")){e.setFullYear(e.getFullYear()-ta.util.date.THAI_BUDDHIST_YEAR_OFFSET)}if(e!="Invalid Date"){return e}}return undefined},lastDateBefore:function(b,c){if(b.multiCityFlight&&c>1){var a;var d=c;while((!a||a.trim()==="")&&d>1){--d;a=ta.id("date_picker_in_"+d).innerHTML}if(a&&a.trim()!==""){return ta.widgets.calendar.dateFromString(a)}}return this.getPageInDate()},calendarMultiSelect:function(h,g,a,f,b){try{ta.id(b).getParent(".overlay").overlay.calendar.multiSelect(h,ta.util.date.create(g,a,f),b)}catch(c){ta.util.error.record(c,"calendarMultiSelect issue")}},calendarMouseOver:function(f,e,a,c,b){ta.id(b).getParent(".overlay").overlay.calendar.dayOver(f,ta.util.date.create(e,a,c),b)},calendarPrev:function(c,b){var a=ta.id(b);if(a&&a.hasClass("sprite-date_picker-btnLeftInactive")){return}if(ta.util.i18n.isRtl()&&a&&a.hasClass("sprite-date_picker-btnRightInactive")){return}a.getParent(".overlay").overlay.calendar.prev()},calendarNext:function(c,b){var a=ta.id(b);if(a&&a.hasClass("sprite-date_picker-btnRightInactive")){return}if(ta.util.i18n.isRtl()&&a&&a.hasClass("sprite-date_picker-btnLeftInactive")){return}a.getParent(".overlay").overlay.calendar.next()},adultsOver:function(c,b){var a=document.getElements(".date_picker_adults_option");if(a){Array.each(a,function(d){ta.id(d).removeClass("adults_selected")})}ta.id(b).addClass("adults_selected")},removeMetaCalendarFromSync:function(c){if(!ta.has("metaDatePickerEnabled")){return}var b="avail.data."+c+"._met";var a=ta.retrieve("avail.data.objects");if(a){a.erase(b)}ta.store("avail.data.objects",a);ta.remove(b)},getCalendarObjectKey:function(d,b,a){var c="avail.data";if(a){c=c+"."+a}c=c+"."+d;if(b){c=c+"."+b}return c},trackCalendarObject:function(d){var a=d.calendar?d.calendar.options.pickerOption:null;var b=ta.widgets.calendar.getCalendarObjectKey(d.locId,d.ext,a);ta.store(b,d);var c=ta.retrieve("avail.data.objects");if(!c){c=[]}c.include(b);ta.store("avail.data.objects",c)},trackCalendarFlyout:function(d,c,e){var f="date.picker.calendarflyout";var b=ta.retrieve(f);if(!b){b=[]}var a={};a.elmt=d;a.overlay=c;a.overlaySrc=e;b.push(a);ta.store(f,b);ta.remove("date.picker.calendarflyout.allCleared")},clearCalendarFlyouts:function(){var b="date.picker.calendarflyout";var a=ta.retrieve(b);if(a){a.each(function(c){var e=c.elmt;var d=c.overlay;var f=c.overlaySrc;if(e&&d&&f){e.removeEvent("mouseenter",d.showWithDelay);e.removeEvent("mouseleave",d.hideWithDelay);e.removeEvent("mouseenter",d.show);e.removeEvent("mouseleave",d.hide);e.removeEvent("click",d._pin);e.adopt(f)}});ta.store("date.picker.calendarflyout.allCleared",true)}},getDateBefore:function(b){var a=new Date(b.getTime());a.setDate(a.getDate()-1);return a},getDateAfter:function(b){var a=new Date(b.getTime());a.setDate(a.getDate()+1);return a},setPageInDate:function(b,a){if(b&&b.getDate){ta.store("date.picker.pageInDate",b)}if(ta.has("date.picker.pageOutDate")){ta.store("meta.page_dates",true)}if(!a&&ta.page&&ta.page.setDates){ta.page.setDates("CHECKIN",[b]);ta.page.emit("dateSelected",null,"CHECKIN",[b])}},setPageOutDate:function(b,a){if(b&&b.getDate){ta.store("date.picker.pageOutDate",b)}if(ta.has("date.picker.pageInDate")){ta.store("meta.page_dates",true)}ta.widgets.calendar.updateCalendarPropertiesOnDateSet();if(!a&&ta.page&&ta.page.setDates){ta.page.setDates("CHECKOUT",[b]);ta.page.emit("dateSelected",null,"CHECKOUT",[b])}},setTimeoutPageDates:function(){var b=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDateTimeout"));if(b){ta.widgets.calendar.setPageInDate(b)}var a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDateTimeout"));if(a){ta.widgets.calendar.setPageOutDate(a)}},clearPageDates:function(a){ta.store("data.picker.cachedDateCleared",true);ta.remove("date.picker.pageInDate");ta.remove("date.picker.pageOutDate");ta.remove("multiDP.inDate");ta.remove("multiDP.outDate");ta.remove("meta.page_dates");ta.remove("meta.session_dates");ta.remove("multiDP.priorDates");if(ta.isMetaHotelsRequest()||ta.has("meta.mini_meta_on_accommodations")){ta.store("dates.datesCleared",true)}if(!a&&ta.page&&ta.page.clearDates){ta.page.clearDates("STAYDATES");ta.page.emit("dateSelected",null,"STAYDATES",[null,null])}},clearPageInDate:function(a){ta.remove("date.picker.pageInDate");ta.remove("multiDP.inDate");ta.remove("meta.page_dates");if(!a&&ta.page&&ta.page.setDates){ta.page.setDates("CHECKIN",[null]);ta.page.emit("dateSelected",null,"CHECKIN",[null])}},clearPageOutDate:function(a){ta.remove("date.picker.pageOutDate");ta.remove("multiDP.outDate");ta.remove("meta.page_dates");if(!a&&ta.page&&ta.page.setDates){ta.page.setDates("CHECKOUT",[null]);ta.page.emit("dateSelected",null,"CHECKOUT",[null])}},updateCalendarPropertiesOnDateSet:function(){var a=ta.retrieve("avail.data.objects");if(a){Array.each(a,function(c){var b=ta.retrieve(c);if(b&&b.calendar){b.calendar.setPermanent(false)}})}},setPageAdultsCount:function(a){if(a){ta.store("date.picker.adultsCount",a)}},getPageInDate:function(){var a=false;if(ta.has("date.picker.pageInDate")){a=ta.retrieve("date.picker.pageInDate")}if(!a&&ta.has("multiDP.inDate")){a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDate"));if(a){ta.widgets.calendar.setPageInDate(a)}}if(a){return new Date(a.getTime())}return false},getPageOutDate:function(){var a=false;if(ta.has("date.picker.pageOutDate")){a=ta.retrieve("date.picker.pageOutDate");if(!ta.widgets.calendar.isValidStayLength(a)){ta.widgets.calendar.clearPageOutDate();return false}if(a){return new Date(a.getTime())}}if(!a&&ta.has("multiDP.outDate")){a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDate"));if(a){ta.widgets.calendar.setPageOutDate(a)}if(!ta.widgets.calendar.isValidStayLength(a)){ta.widgets.calendar.clearPageDates();return false}if(a){return new Date(a.getTime())}}return false},haveDatesChanged:function(){var a=ta.widgets.calendar.getPageInDate(),b=ta.widgets.calendar.getPageOutDate(),d=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDate")),c=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDate"));return(!d||a.getTime()!=d.getTime())||(!c||b.getTime()!=c.getTime())},isValidStayLength:function(b){var c=ta.widgets.calendar.getPageInDate();if(!c||!b){return true}var d=0,a=0;if(ta.retrieve("allowLongTrips")){d=b-new Date();a=ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT}else{d=b-c;if(ta.retrieve("isVacationRentals")){a=ta.util.date.MAX_VR_DURATION_DAYS}else{a=ta.util.date.MAX_STAY_DURATION_DAYS}}d=Math.round(d/1000/60/60/24);if(d>a){return false}return true},getPageAdultsCount:function(){if(ta.has("date.picker.adultsCount")){return ta.retrieve("date.picker.adultsCount")}if(ta.has("multiDP.adultsCount")){ta.store("date.picker.adultsCount",ta.retrieve("multiDP.adultsCount"));return ta.retrieve("multiDP.adultsCount")}return"2"},getGuestsRoomsPickerData:function(){var b=ta.retrieve("guests.rooms.object"),i,a,j;if(!b){try{var f=require("utils/cookieutils").getCookie("TATravelInfo");var h=ta.widgets.calendar.getGuestsRoomsValue(f,"A");if(h&&h!==""){i=parseInt(h,10)}var g=ta.widgets.calendar.getGuestsRoomsValue(f,"RS");if(g&&g!==""){a=parseInt(g,10)}var d=ta.widgets.calendar.getGuestsRoomsValue(f,"CA");if(d&&d!==""){j=d}if(i&&i>0&&a&&a>0){b={rooms:a,guests:i,child_rm_ages:j};ta.store("guests.rooms.object",b);ta.fireEvent("onLegacyGuestsChanged",b)}}catch(c){ta.util.error.record(c,"ta.widgets.calendar.getGuestsRoomsPickerData")}}if(!b){b={rooms:1,guests:2,child_rm_ages:""};ta.store("guests.rooms.object",b)}return b},getGuestsRoomsPickerDataForUnifiedDatesParam:function(){var a=ta.widgets.calendar.getGuestsRoomsPickerData();var b=[a.rooms,a.guests];if(a.child_rm_ages){b.push(a.child_rm_ages)}return{uguests:b.join("_")}},getCheckRatesData:(function(){function b(){var d=ta.widgets.calendar.getPageInDate(),c=ta.widgets.calendar.getPageOutDate();if(!d||!c||!d.getMonth||!c.getMonth){return false}return{inMonth:(d.getMonth()+1)+" "+d.getFullYear(),inDay:d.getDate(),outMonth:(c.getMonth()+1)+" "+c.getFullYear(),outDay:c.getDate()}}function a(c){c=c||"STAYDATES";return ta.page.datesToQueryJson(c)}return function(d){var c=(ta.page&&ta.page.datesToQueryJson)?a(d):b();c.adults=ta.widgets.calendar.getPageAdultsCount();if(ta.has("guests_rooms_picker.enabled")){var e=ta.widgets.calendar.getGuestsRoomsPickerData();c.adults=e.guests;c.rooms=e.rooms;c.child_rm_ages=e.child_rm_ages}return c}})(),_parseDatePickerDate:function(c){try{if(c&&c.split&&c.split(" ").length>1){var a=c.split(" ");var b=new Date();ta.util.date.normalize(b);b.setFullYear(a[0]);b.setDate(1);b.setMonth(parseInt(a[1],10)-1);b.setDate(a[2]);return b}}catch(d){return false}},hasPageDates:function(){if(!ta.has("metaDatePickerEnabled")){return false}if(ta.has("meta.page_dates")){return true}ta.widgets.calendar.getPageInDate();ta.widgets.calendar.getPageOutDate();return ta.has("meta.page_dates")},oneDayMill:(24*60*60*1000),updateDateWidgetDisplay:function(a){if(!a){return}ta.id(a).removeClass("date_picker_error");var c=ta.widgets.calendar.getPageInDate();var b=ta.widgets.calendar.getPageOutDate();ta.widgets.calendar.updateDateDisplay(a,c,b);var d=document.getElements(".adults");if(d){d.each(function(e){ta.widgets.calendar.updateAdultsDisplay(e)})}},getPageInCalendarField:function(b,a){return ta.id("date_picker_in_"+b+a)},getPageOutCalendarField:function(b,a){return ta.id("date_picker_out_"+b+a)},getErrorDates:function(){var c="no dates";try{var a=ta.widgets.calendar.getDatePickerFormat("classic");if(ta.widgets.calendar.hasPageDates()){c=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),a);c=c+" - "+ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),a)}}catch(b){}return c},updateDateDisplay:function(b,c,g){var d,a,f,i,e,h,j;if(c&&g&&c.getTime()>g.getTime()){d=c;c=g;g=d}a=ta.widgets.calendar.getDatePickerFormat("classic");if(ta.id(b).getParent(".dual_date")){b.innerHTML=c?ta.widgets.calendar.dateToString(c,a):ta.retrieve("multiDP.checkIn");f=b.id.replace("date_picker_in","date_picker_out");if(f&&ta.id(f)){ta.id(f).innerHTML=g?ta.widgets.calendar.dateToString(g,a):ta.retrieve("multiDP.checkOut")}}else{i=b.innerHTML=ta.retrieve("multiDP.enterDatesText");e=ta.widgets.calendar.getSingleDateFieldDatesText(c,g,a);if(e){i=e}b.innerHTML=i;h=ta.id(b).getParent();if(h){j=h.getElement(".date_picker_calendar_nights");ta.widgets.calendar.updateNightsDisplay(j,c,g)}}},getSingleDateFieldDatesText:function(d,b,a){var c="";var e=ta.retrieve("multiDP.dateSeparator")||" - ";if(d){c=ta.widgets.calendar.dateToString(d,a)+e;if(b){c=c+ta.widgets.calendar.dateToString(b,a)}}return c},updateNightsDisplay:function(d,c,a){if(!d){return}if(!a){d.innerHTML="";return}var b=ta.widgets.calendar.getNumberOfNightsFromDates(c,a);if(b==1){d.innerHTML=ta.retrieve("multiDP.singleNightText")}else{d.innerHTML=ta.retrieve("multiDP.multiNightsText").replace(/\d+/,b)}},getNumberOfNights:function(){var b=ta.widgets.calendar.getPageInDate(),a=ta.widgets.calendar.getPageOutDate();return ta.widgets.calendar.getNumberOfNightsFromDates(b,a)},getNumberOfNightsFromDates:function(b,a){if(b&&a){return Math.round(Math.abs((b.getTime()-a.getTime())/ta.widgets.calendar.oneDayMill))}else{return 0}},updateAdultsDisplay:function(b){if(!b){return}var a=ta.widgets.calendar.getPageAdultsCount();if(a=="1"){b.innerHTML=ta.retrieve("multiDP.singleAdultsText")}else{b.innerHTML=ta.retrieve("multiDP.multiAdultsText").replace(/\d+/,a)}},syncAllDatePickers:function(){var c=document.getElements(".date_picker.date");if(c){Array.each(c,function(g){if(g&&!ta.id(g).hasClass("out_date")&&!ta.id(g).hasClass("multiCity")&&!ta.id(g).hasClass("oneWay")){ta.widgets.calendar.updateDateWidgetDisplay(g)}})}var a=$$(".tablet_date_label");if(a&&ta.widgets.calendar.hasPageDates()){a.addClass("showLabels")}a=document.getElements(".dateLabel");if(a){var f=ta.widgets.calendar.getDatePickerFormat("short");var b=ta.widgets.calendar.getDatePickerFormat("classic");var e=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),b);if(ta.has("guests_rooms_picker_3.enabled")){e=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),f)}var d=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),b);Array.each(a,function(g){var h=ta.id(g);if(h){if(h.hasClass("inDate")){h.innerHTML=e?e:ta.retrieve("multiDP.checkIn")}else{if(h.hasClass("outDate")){h.innerHTML=d?d:ta.retrieve("multiDP.checkOut")}}}})}},getDatePickerFormat:function(a){if(a==="classic"&&typeof DATE_PICKER_CLASSIC_FORMAT!="undefined"){return DATE_PICKER_CLASSIC_FORMAT}else{if(a==="short"&&typeof DATE_PICKER_SHORT_FORMAT!="undefined"){return DATE_PICKER_SHORT_FORMAT}else{if(a==="days_and_slashes"&&typeof DATE_PICKER_DAY_AND_SLASHES_FORMAT!="undefined"){return DATE_PICKER_DAY_AND_SLASHES_FORMAT}else{if(typeof DATE_PICKER_META_FORMAT!="undefined"){return DATE_PICKER_META_FORMAT}}}}if(typeof a!="string"){a="not_a_string"}return""},dateToString:function(d,e){var b,j,a,h,c,k,i,f,g;if(!d.getDate||!e||typeof e!="string"){return""}if(ta.widgets.calendar.getDatePickerFormat("classic").indexOf(e)>-1){b=new Date(d);if(ta.retrieve("thai_buddhist_era_year")){b.setFullYear(b.getFullYear()+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET)}j="MM";a="yyyy";h="dd";f=b.getDate()+"";if(f&&f.length===1){f="0"+f}g=(b.getMonth()+1)+"";if(g&&g.length===1){g="0"+g}e=e.replace(j,g).replace(h,f).replace(a,b.getFullYear()).replace(/'/g,"");return e}else{if(ta.widgets.calendar.getDatePickerFormat("short").indexOf(e)>-1){b=new Date(d);j="MM";h="dd";f=b.getDate()+"";if(f&&f.length==1){f="0"+f}g=(b.getMonth()+1)+"";if(g&&g.length==1){g="0"+g}e=e.replace(j,g).replace(h,f).replace(/'/g,"");return e}else{if(ta.widgets.calendar.getDatePickerFormat("days_and_slashes").indexOf(e)>-1){b=new Date(d);i="EEE";j="MM";a="yyyy";h="dd";k=d.getDay();if(ta.retrieve("multiDP.isMondayFirstDayOfWeek")){k=k-1}if(k==-1){k=6}f=b.getDate()+"";if(f&&f.length===1){f="0"+f}g=(b.getMonth()+1)+"";if(g&&g.length===1){g="0"+g}if(e.indexOf(i)!=-1){e=e.replace(i,jsGlobalDaysAbbrev[k])}else{if(e.indexOf("EE")!=-1){e=e.replace("EE",jsGlobalDaysAbbrev[k])}else{e=e.replace("E",jsGlobalDaysAbbrev[k])}}e=e.replace(j,g).replace(h,f).replace(a,b.getFullYear()).replace(/'/g,"");return e}}}c=ta.retrieve("multiDP.abbrevMonthList");k=d.getDay();if(ta.retrieve("multiDP.isMondayFirstDayOfWeek")){k=k-1}if(k==-1){k=6}i="EEE";j="MMM";if(e.indexOf("EEEE d MMMM")>-1){i="EEEE";j="MMMM"}e=e.replace(i,jsGlobalDaysAbbrev[k]).replace(j,c[d.getMonth()]).replace(/\bd\b/,d.getDate()).replace(/'/g,"");return e},showCalendarByLocId:function(b,a){if(!/^\d+$/.test(b)){ta.util.error.record(null,"Cannot show calendar due to missing/invalid location ID: "+b);return}a=a||"";var c={id:"",className:"id_"+b+a,"data-date_suffix":a,toString:function(){return"[showCalendarSrc: "+b+a+"]"}};ta.widgets.calendar.setErrorStyling(c)},clickCalendarEvent:function(b){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("click",true,true);b.dispatchEvent(a)}else{b.click()}},setErrorStyling:function(d){var c=false,g=d["data-date_suffix"]||null;var b=d.id.match(/CHECK_RATE_([a-zA-Z]+)/);if(b&&b.length>1&&(b[1]=="mnf"||b[1]=="mnl"||b[1]=="photoviewer"||b[1]=="albumMeta")){g="_"+b[1]}try{c=d.className.match(/\bid_(\d+)/)[1]}catch(f){}if(c){var a=false;var h="date_picker_in_";if(!a&&g){a=ta.id(h+c+g)}if(!a){a=ta.id(h+c+"_met")}if(!a){a=ta.id(h+c+"_cro")}if(!a){a=ta.id(h+c+"_per")}if(!a){a=ta.id(h+c+"_pop")}if(!a){a=ta.id(h+c+"_mnl")}if(!a){a=ta.id(h+c+"_mnm")}if(!a){a=ta.id(h+c+"_smt")}if(!a){a=ta.id(h+c+"_pto")}if(!a){a=ta.id(h+c+"_pal")}if(!a){a=ta.id(h+c+"_amo")}if(!a&&d.id.slice(-4)=="_inm"){a=ta.id(h+c+"_inm")}if(!a){a=ta.id(h+c)}if(a){setTimeout(function(){ta.widgets.calendar.clickCalendarEvent(a)},100)}}},launchInlineMeta:function(a){ta.widgets.calendar._crBtnOnclick("#CHECK_RATE",a)},launchMetaLightboxUpdate:function(){},launchCRLBUpdate:function(){ta.commerce.meta.clearStoredMiniData();ta.overlays.Factory.updateMiniMetaPlacements()},_crBtnOnclick:function(b,c){ta.store("meta.calendarCR",true);var a=document.getElement(b);if(a){document.getElement(b).onclick(c)}ta.remove("meta.calendarCR")},onShowPricesClick:function(a,b){if(!ta.widgets.calendar.hasPageDates()){return}ta.trackEventOnPage("GuestRoomSelector","ShowPrices_Calendar_click");if(b==="Hotels"){ta.servlet.HACSearch.doMetaDateSearch();ta.commerce.meta.updateHeaderDates()}else{if(b==="HotelHighlight"){ta.widgets.calendar.onCalendarRangeSelect(a)}else{ta.fireEvent("newInlinePageDates",a)}}ta.widgets.calendar.closeCalendarWidgets();if(ta.has("guests_rooms_picker_3.enabled")){this.displayStayInfoPicker()}},displayStayInfoPicker:function(){$$(".stayInfoHeader").removeClass("hidden");$$(".changeStayInfoButton").removeClass("hidden");$$(".date_control_wrapper").addClass("hidden")},closeCalendarWidgets:function(){var b=document.getElements(".date_picker_calendar");if(b){Array.each(b,function(e){if(e&&e.overlay){var d=true;var c=e.overlay.source;if(c&&(c.hasClass("isPreDatesPermanent")||c.getParent(".isPreDatesPermanent"))){d=false}if(d){e.overlay.hide()}}})}var a=document.getElement(".dp.overlay");if(a&&a.overlay){a.overlay.hide()}},getInOutTrackingKey:function(b){var a="avail.data.dateClicked";if(b){return a+".in"}else{return a+".out"}},removeInOutCalendarSelected:function(a){ta.remove(ta.widgets.calendar.getInOutTrackingKey(a))},trackInOutCalendarSelected:function(a){ta.store(ta.widgets.calendar.getInOutTrackingKey(a),true)},inOutCalendarSelected:function(a){return ta.retrieve(ta.widgets.calendar.getInOutTrackingKey(a))},trackCalendarEvent:function(c,d,b,g){try{var a=ta.has("multiDP.priorDates")?ta.retrieve("multiDP.priorDates"):ta.widgets.calendar.hasPageDates();b+=a?"|CHANGE":"|PRE";ta.trackEventOnPage(c,d,b,g,true)}catch(f){}},cancelAllExistingHAC:function(){if(ta.hac.filters&&ta.hac.filters.removeProcessingForExistingHACQuery){ta.hac.filters.removeProcessingForExistingHACQuery()}if(ta.meta.update&&ta.meta.update.cancelAllMetaCurrentQuery){ta.meta.update.cancelAllMetaCurrentQuery()}if(ta.commerce.metajson&&ta.commerce.metajson.cancelCurrentBulkFetch){ta.commerce.metajson.cancelCurrentBulkFetch()}},submitHacSearch:function(d,c,f){if(typeof(f)=="undefined"){f=false}if(ta.has("useHotelsFilterState")){return ta.widgets.calendar.submitHotelsForm(d,c,f)}var b="";c=ta.id(c);if(c.get("tag")=="form"){var e=c.getElement("input[name=q]");if(e){e.name=""}b=c.action+"?"+c.toQueryString()}else{if(c.get("tag")=="a"){b=c.href}else{c=c.getParent("a");b=c.href}}if(b!==""){if(ta.widgets.calendar.hasPageDates()){if(!b.match(/\?/)){b=b+"?"}var a=ta.widgets.calendar.getCheckRatesData();if(a){b=b+"&"+Object.toQueryString(a)}}if(d){new Event(d).preventDefault()}if(f){window.open(b)}else{window.location=b}}},clearSessionDates:function(b,a){new Request({url:"/UpdateSessionDatesAjax?clear=true",onSuccess:function(){ta.widgets.calendar.clearDates();if(b){document.location.href="./"+b}if(a&&typeof a==="function"){a()}}}).send()},clearAllDatePickers:function(){var c=ta.retrieve("avail.data.objects");if(c){Array.each(c,function(d){var e=ta.retrieve(d);if(e){e.clear()}})}var b=document.getElements(".date_picker.date");if(b){Array.each(b,function(d){ta.widgets.calendar.updateDateWidgetDisplay(d);ta.widgets.calendar.showEnterDates(d)})}var a=$$(".tablet_date_label");if(a){a.removeClass("showLabels")}},showEnterDates:function(a){if(!a){return}if(ta.id(a).getParent(".dual_date")){if(ta.id(a).hasClass("out_date")){a.innerHTML=ta.retrieve("multiDP.checkOut")}else{a.innerHTML=ta.retrieve("multiDP.checkIn")}}else{a.innerHTML=ta.retrieve("multiDP.enterDatesText")}},clearDates:function(){ta.widgets.calendar.clearPageDates();ta.widgets.calendar.clearAllDatePickers();var a=document.getElement(".clear_dates_button")||document.getElement(".clearDates");var j=document.getElement(".clear_dates_wrapper")||document.getElement(".clearDatesWrapper");var c=document.getElement(".showPriceButton");var b=document.getElement(".change_dates_button");var h=document.getElement(".date_picker_post_dates");var e=document.getElement(".date_picker_pre_dates");var f=document.getElement(".show_prices_button");var i=ta.id("ANIMATED_DATE_CTA");var d=ta.id("BC_PHOTOS");var g=document.getElement("#BC_PHOTOS .photo_slideshow");var k=document.getElement("#BC_PHOTOS .ug_thumbs");if(ta.retrieve("animate_date_reformat")){i=ta.id("ANIMATED_DATE_CTA_REFORMAT")}if(e){e.show()}if(h){h.hide()}if(a){a.hide()}if(j){j.hide()}if(b){b.hide()}if(f){f.show()}if(i){ta.servlet.HACSearch.loadAnimatedDateCTA()}if(c){c.hide()}if(d){d.style.opacity=1}if(g){g.style.opacity=1}if(k){k.style.opacity=1}if(ta.servlet.HACSearch&&ta.has("hac_timezone_awareness")){ta.servlet.HACSearch.clearDateFieldHighlighting()}},clearDatesAndRedirect:function(){var a=window.location.hash;var b=false;var c=window.location.href.match(/geo=\d+/g);if(c&&c[0]){b=c[0]}if(!b){c=window.location.href.match(/-g\d+/g);if(c&&c[0]){b="geo="+c[0].substring(2)}}if(b){var d="HACSearch?"+b+a;ta.widgets.calendar.clearSessionDates(d)}},storePriorDates:function(){ta.store("multiDP.priorDates",ta.retrieve("multiDP.priorDates")||ta.widgets.calendar.hasPageDates())},datesExist:function(){var b=ta.widgets.calendar.getPageInDate();var a=ta.widgets.calendar.getPageOutDate();return b&&a},datesInRange:function(){var c=ta.widgets.calendar.getPageInDate();var a=ta.widgets.calendar.getPageOutDate();if(!ta.widgets.calendar.datesExist()){return false}var b=Math.round(Math.abs((c.getTime()-a.getTime())/ta.widgets.calendar.oneDayMill));return b>=1&&b<=ta.util.date.MAX_STAY_DURATION_DAYS},openFirstDatePicker:function(b){new Event(b).stopPropagation();var a=$$(".date_picker_calendar_wrap");if(a&&a.length>0){a[0].click()}ta.trackEventOnPage("price_filter_dates_link","click","")},justUpdateSessionDates:function(b,c,a){if((c&&!ta.widgets.calendar.haveDatesChanged())||(ta.util.date.getDaysApart(this.inDate,this.outDate)>ta.util.date.MAX_STAY_DURATION_DAYS)||(this.inDate&&this.outDate&&ta.util.date.normalize(this.inDate)==ta.util.date.normalize(this.outDate))){if(b&&typeof(b)=="function"){b()}return}new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",async:(a!==true),onSuccess:function(){if(b&&typeof(b)==="function"){b()}if(!ta.retrieve("dates.moniker.fired")){ta.store("dates.moniker.fired",true);ta.widgets.calendar.loadDateEnteredMonikers()}ta.fireEvent("hotels.sessionDatesUpdated")}}).send();return true},justUpdateSessionAdults:function(a){var b=ta.widgets.calendar.getPageAdultsCount();if(b<=0){return}new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString({adults:b,onlyAdults:true}),method:"post",onSuccess:function(){if(a&&typeof(a)==="function"){a()}}}).send()},getGuestsRoomsValue:function(d,c){if(!d){return}var a=d.split("*");for(var b=0;b<a.length;b++){var e=a[b].split(".");if(e.length!=2){continue}if(e[0]===c){return e[1]}}},updateGuestsRoomsPickerDataFromCookie:function(){var g=require("utils/cookieutils").getCookie("TATravelInfo"),h,b,e,c,a,f;a=ta.widgets.calendar.getGuestsRoomsValue(g,"A");if(a&&a!==""){e=parseInt(a,10)}f=ta.widgets.calendar.getGuestsRoomsValue(g,"RS");if(f&&f!==""){b=parseInt(f,10)}var d=ta.widgets.calendar.getGuestsRoomsValue(g,"CA");if(d&&d!==""){c=d}if(e>=1&&b>=1&&e.toFixed&&b.toFixed){h={rooms:b,guests:e,child_rm_ages:c};ta.store("guests.rooms.object",h);ta.fireEvent("onLegacyGuestsChanged",h)}},updateGuestsRoomsPickerUI:function(){var b=ta.widgets.calendar.getGuestsRoomsPickerData();var a=document.getElements(".grp-rooms-value");a.each(function(c){if(c){c.innerHTML=b.rooms}});a=document.getElements(".grp-guests-value");a.each(function(c){if(c){c.innerHTML=b.guests}})},updateGuestsRoomsButtonLabelsPluralization:function(b,c){var a=$$(b);a.each(function(d){if(c>1){d.addClass("multiple")}else{d.removeClass("multiple")}})},checkDatesMakeHacCallHR:function(a){if(ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.handleNewDates(a)}},checkDatesMakeHacCallHotels:function(a){if(ta.widgets.calendar.hasPageDates()){ta.servlet.HACSearch.doMetaDateSearch(a)}},updateSDCalendar:function(){new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",onSuccess:function(){var c,b,a=document.getElement("#STATIC_DATE_PICKER_BAR .filterControls");window.fireEvent("sd_hh_datesChanged");if(ta.id("SDDatesHeaderCenter")){c=ta.id("SDDatesHeaderCenter");c.addClass("hide")}if((ta.id("SD_DATEBAR_TOOLTIP"))){c=ta.id("SDDatePickerBarStaticButton");c.addClass("hide");b=ta.id("SDDatePickerBarStaticChangeDates");b.removeClass("hide")}if(a){if(ta.widgets.calendar.datesExist()){a.removeClass("noDatesSelected");a.addClass("datesSelected")}else{a.removeClass("datesSelected");a.addClass("noDatesSelected")}}if(!ta.retrieve("dates.moniker.fired")){ta.store("dates.moniker.fired",true);ta.widgets.calendar.loadDateEnteredMonikers()}}}).send()},updateHLCalendar:function(){new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",onSuccess:function(){var h,a,d;window.fireEvent("sd_hh_datesChanged");a=ta.id("BODYCON");if(a){h=a.getElement("#HLDatePickerBar .metaDatePicker.moreProminent");d=a.getElement("#STATIC_DATE_PICKER_BAR .filterControls");if(d){if(ta.widgets.calendar.datesExist()){d.removeClass("noDatesSelected");d.addClass("datesSelected")}else{d.removeClass("datesSelected");d.addClass("noDatesSelected")}}}if(h){var f=document.getElement(".overlayBG");var c=document.getElement(".rgba_flyout.gray.overlay.relative");var g=document.getElement(".baseHotelInfoLeft");var b=document.getElement(".baseHotelInfoRight");var e=document.getElement(".HLBaseDisclaimer");if(f){f.destroy()}if(c){c.destroy()}if(g&&b){b.inject(g,"before")}if(e&&e.hasClass("hide")){e.removeClass("hide")}}if(!ta.retrieve("dates.moniker.fired")){ta.store("dates.moniker.fired",true);ta.widgets.calendar.loadDateEnteredMonikers()}}}).send()},updateSessionDates:function(a,b){new Request({url:"/UpdateSessionDatesAjax",data:b,method:"post",onSuccess:function(){if(a){if(ta.retrieve("smartDealsSearchIframe")){window.open(a,"_blank")}else{window.location=a}}},onFailure:function(){if(a){if(ta.retrieve("smartDealsSearchIframe")){window.open(a,"_blank")}else{window.location=a}}}}).send()},redirectToHotelOverview:function(a){this._redirectToHotelOverview(a,function(b){window.location=b})},openTabToHotelOverview:function(a){this._redirectToHotelOverview(a,function(b){window.open(b)})},_redirectToHotelOverview:function(b,c){if(b){b=JSON.decode(b);var a=b.url;if(ta.retrieve("is_from_sdprospect")&&a.contains("Hotels")){a=a.replace("Hotels","SmartDeals")}c(a)}else{c("/Hotels")}},submitHotelsForm:function(e,b,d){b=ta.id(b);if(typeof(d)=="undefined"){d=false}var c=b.toQueryString();if(ta.widgets.calendar.hasPageDates()){var a=ta.widgets.calendar.getCheckRatesData();if(a){c=c+"&"+Object.toQueryString(a)}}new Request({url:"/FilterState",data:c,method:"post",onSuccess:function(f){d?ta.widgets.calendar.openTabToHotelOverview(f):ta.widgets.calendar.redirectToHotelOverview(f)},onFailure:function(){d?ta.widgets.calendar.openTabToHotelOverview(null):ta.widgets.calendar.redirectToHotelOverview(null)}}).send();if(e){new Event(e).preventDefault()}return false},getPlacement:function(h){if(!h||!h.id){return null}var e=/date_picker_[0-9]*_([a-z]*)/;var i=/date_picker_in_[0-9]*_([a-z]*)/;var g=/date_picker_out_[0-9]*_([a-z]*)/;var f=/date_picker_adults_[0-9]*_([a-z]*)/;var a=h.id;var d=e.exec(a);if(!d){d=i.exec(a)}if(!d){d=g.exec(a)}if(!d){d=f.exec(a)}if(d){d=d[1]}if(!d){var b=h.getParent(".HotelDateSearch");if(b&&b.id){var c=(b.id).split("_");if(c.length>1){d=c[(c.length-1)]}}}return d},handleNewDates:function(k,n){if(ta.retrieve("hotel_review_low_price_message")){var e=document.getElement("#PRICE_ALERT_RIBBON");if(e){e.hide();ta.fireEvent("priceAlertBannerHidden")}ta.remove("hidePriceAlertRibbon")}if(!ta.retrieve("dates.moniker.fired")){ta.store("dates.moniker.fired",true);ta.widgets.calendar.loadDateEnteredMonikers()}if(ta.retrieve("tablet_maps_v1")&&n){var b=n.getParent(".flexCard");if(b){b.addClass("withMeta")}}ta.store("meta.requestFromArea","");if(ta.retrieve("origHTMLForUserReviews")){var h=ta.id("noAvailRHS");if(h){h.innerHTML=ta.retrieve("origHTMLForUserReviews")}}var j=document.getElement(".seeMoreHotels");if(j){j.hide()}var d=ta.id("BC_PHOTOS");if(d){d.style.opacity=1}var g=document.getElement("#BC_PHOTOS .photo_slideshow");if(g){g.style.opacity=1}var m=document.getElement("#BC_PHOTOS .ug_thumbs");if(m){m.style.opacity=1}var c=ta.widgets.calendar.getPlacement(n);if(c=="geo"){ta.widgets.calendar.justUpdateSessionDates();return}if(ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")){if(pageServlet=="Hotel_Review"||pageServlet=="ShowUserReviews"||pageServlet=="LocationPhotoDirectLink"){ta.store("meta.isFromDatesChange",true)}}ta.store("hotels.datesChanged",true);if(ta.commerce.datepickerpersist){ta.commerce.datepickerpersist.update()}var f="property_"+k;var i=ta.id(f);var a=ta.retrieve("overlay.lastElmt.className");var l=(c=="pop")&&(pageServlet=="Hotels")&&i&&a&&a.match(/custom_area_QC_Hotels_Meta/);if(ta.meta&&ta.meta.update&&!l){if(pageServlet==="Hotels"){ta.servlet.HACSearch.displayPostDatesLinks()}ta.fireEvent("newInlinePageDates",k,c);return}else{if(!l&&ta.util&&ta.util.error){ta.util.error.record(null,"handleNewDates - no meta js");return}}ta.store("hotels.datesChanged",true);ta.servlet.HACSearch.displayPostDatesLinks();ta.store("meta.redirectingToHR",true);ta.remove("overlay.lastElmt.className");ta.widgets.calendar.justUpdateSessionDates(false,false,true);ta.hac.filters.updateResultsFromDateSearch();window.open(i.href);document.getElements(".overlay").each(function(o){if(o.overlay&&o.overlay.hide){o.overlay.hide()}})},trackCRButtonClick:function(a){var c=ta.widgets.calendar.getPageInDate();var b=ta.widgets.calendar.getPageOutDate();var d=[a];if(c){d.push("CHECKIN")}if(b){d.push("CHECKOUT")}ta.trackEventOnPage("CRBUTTON","CLICK",d.join("|"))},setupNewDatesEvent:function(){try{ta.on("newInlinePageDates",ta.widgets.calendar.inlineCalendarOnDateSelection)}catch(a){ta.util.error.record(a,"trouble building event - newInlinePageDates")}},inlineCalendarOnDateSelection:function(){ta.widgets.calendar.onCalendarChangeDates();var a=window.modelLocId;if(a){ta.widgets.calendar.onCalendarRangeSelect(a)}},onCalendarChangeDates:function(){ta.commerce.meta.tracking.resetAllTimingLocks();ta.commerce.meta.tracking.clearSuppressedAreas();ta.commerce.meta.polling.clearAllPollingInfo();if(ta.isHacMap()){ta.servlet.hotelsMap.map.cleanupOverlays()}},onCalendarRangeSelect:function(c,b){if(ta.commerce.metajson){ta.commerce.metajson.refetchAll()}if(typeof oxapp!="undefined"&&oxapp&&oxapp.context){var a=oxapp.context.has("TravelDates")&&oxapp.context.get("TravelDates");if(a){a.save()}}if(c&&!(ta.retrieve("tablet_maps_v1")&&ta.retrieve("maps_v2_open"))){ta.commerce.meta.loadMetaAF(c,"AV_ABOVE_FOLD_META",false)}ta.store("ta.calRangeSelectCtx",{locId:c,ext:b});ta.fireEvent("onCalendarRangeSelect");ta.store("ta.calRangeSelectCtx",null)},trackCalendarSelect:function(c){var i=document.getElement(".inline_calendar");if(i){i=i.getParent()}if(!i){return}var f=i.getElement(".meta_date_field.first .date_picker");if(c){f=i.getElement('.meta_date_field:not([class="first"]) .date_picker')}if(!f){return}var d=ta.id(f).get("id");d=d.substring(d.length-3,d.length);var b="START";var g="DATES";var a=ta.widgets.calendar.getPageInDate();var e=ta.widgets.calendar.getPageOutDate();if(d=="upt"){g="Interrupter"}if(c){b="SELECT";if(ta.retrieve("ta.calendar.isPriceOverlayCalendar")){g="PRICE_CALENDAR"}else{if(a&&e){var h=ta.util.date.getDaysInRange(a,e)-1;if(h>ta.util.date.MAX_STAY_DURATION_DAYS){g="DATES_OVER_30_DAYS"}}}}ta.widgets.calendar.trackCalendarEvent(ta.widgets.calendar.getTrackingString(),b,g)},setFirstDisplayMonth:function(c){var a=document.getElement(".month");if(!a){return false}var b=ta.widgets.calendar.getDateFromElem(a);if(!b){b=new Date(ta.util.date.normalize(new Date()))}if(c){b.setDate(1);b.setDate(32);b.setDate(1)}else{b.setDate(1);b.setDate(-1);b.setDate(1)}return b},updateCalendarMonths:function(a,g){try{if(!ta.has("ta.calendar.date.clickFunction")){ta.widgets.calendar.setClickMouseOverFunctions()}if(!a){return}a=ta.id(a);if(!g){if(ta.util.i18n.isRtl()&&!a.hasClass("sprite-date_picker-arrowButtonRight")){return}else{if(!ta.util.i18n.isRtl()&&!a.hasClass("sprite-date_picker-arrowButtonLeft")){return}}}else{if(ta.util.i18n.isRtl()&&!a.hasClass("sprite-date_picker-arrowButtonLeft")){return}else{if(!ta.util.i18n.isRtl()&&!a.hasClass("sprite-date_picker-arrowButtonRight")){return}}}var c=ta.widgets.calendar.setFirstDisplayMonth(g);var b=document.getElement(".inline_calendar");var d=b.getElements(".month");if(d){Array.each(d,function(e){e.dispose()})}var f=ta.widgets.calendar.createMonth(c);ta.widgets.calendar.injectMonth(f.elmt,b,true);ta.widgets.calendar.updatePrevNext(b,f)}catch(h){ta.util.error.record(h,"update calendar months")}},updatePrevNext:function(b,g){var c=g.date;var e=g.date;if(!ta.has("ta.calendar.firstDate")){ta.widgets.calendar.setFirstLastDates()}var i=ta.util.date.inSameMonth(c,ta.retrieve("ta.calendar.firstDate"));var a=ta.util.date.inSameMonth(e,ta.retrieve("ta.calendar.lastDate"));var f=ta.util.i18n.isRtl()?"sprite-date_picker-arrowButtonRight":"sprite-date_picker-arrowButtonLeft";var h=ta.util.i18n.isRtl()?"sprite-date_picker-arrowButtonLeft":"sprite-date_picker-arrowButtonRight";b.getElement(".prev").addClass(i?"":f).removeClass(i?f:"");b.getElement(".next").addClass(a?"":h).removeClass(a?h:"");var d=b.getElement(".prevText");if(d){if(i||!g.date){d.innerHTML=""}else{d.innerHTML=jsGlobalMonthsAbbrev[(g.date.getMonth()-1)%12]}}d=b.getElement(".nextText");if(d){if(a||!g.date){d.innerHTML=""}else{d.innerHTML=jsGlobalMonthsAbbrev[(g.date.getMonth()+1)%12]}}},dayClick:function(l,j,c,h,b){try{b=ta.id(b);if(!b||b.getParent(".disabled")){return}var k=ta.util.date.create(j,c,h);var a=ta.widgets.calendar.getPageOutDate();if(k){if(!ta.has("ta.first.date.selected")){if(a&&ta.widgets.calendar.isValidStayLength(a)){ta.widgets.calendar.clearPageDates()}ta.widgets.calendar.setPageInDate(k);ta.widgets.calendar.setFirstDateSelected(true);ta.widgets.calendar.trackCalendarSelect(false,b)}else{var i=ta.widgets.calendar.getPageInDate();if(!i){if(a&&ta.widgets.calendar.isValidStayLength(a)){ta.widgets.calendar.clearPageDates()}ta.widgets.calendar.setPageInDate(k);ta.widgets.calendar.setFirstDateSelected(true);return}else{if(i.getTime()==k.getTime()){return}else{if(i.getTime()>k.getTime()){ta.widgets.calendar.setPageInDate(k);ta.widgets.calendar.setPageOutDate(i)}else{ta.widgets.calendar.setPageOutDate(k)}}}ta.widgets.calendar.setFirstDateSelected(false);var f=1;if(typeof modelLocId!="undefined"){f=modelLocId}ta.widgets.calendar.handleNewDates(f);ta.widgets.calendar.showInlineCalendar(false);ta.widgets.calendar.trackCalendarSelect(true,b)}ta.widgets.calendar.updateSelectedDays(l,k,b);ta.widgets.calendar.syncAllDatePickers()}}catch(g){ta.util.error.record(g,"dayClick")}},setFirstDateSelected:function(a){if(a){ta.store("ta.first.date.selected",true);ta.widgets.calendar.addFirstDateFlag()}else{ta.remove("ta.first.date.selected");ta.widgets.calendar.removeFirstDateFlag();ta.widgets.calendar.removeHoverDateFlag()}ta.widgets.calendar.setMaxLengthOfStayStyling();ta.widgets.calendar.setInDateInputSelectState(a)},clearCalendarSelections:function(){ta.widgets.calendar.clearSelectedDays();ta.widgets.calendar.clearDates();ta.widgets.calendar.setFirstDateSelected(false)},addFirstDateFlag:function(){var a=ta.widgets.calendar.getPageInDate();var d=ta.widgets.calendar.getDayElemFromDate(a);var b=ta.retrieve("calendar.checkInText");if(b){var c=new ta.widgets.ArrowLabel(d,b);ta.store("ta.calendar.firstDateFlag",c)}},removeFirstDateFlag:function(){if(ta.has("ta.calendar.firstDateFlag")){var a=ta.retrieve("ta.calendar.firstDateFlag");if(a){a.remove();ta.remove("ta.calendar.firstDateFlag")}}},addHoverDateFlag:function(c,f,b){var a=ta.widgets.calendar.getPageInDate();if(a.getTime()==c.getTime()){ta.widgets.calendar.removeHoverDateFlag();return}if(ta.has("ta.calendar.hoverDateFlag")){var e=ta.retrieve("ta.calendar.hoverDateFlag");if(e){e.setParentElem(f);e.setText(b)}return}var d=new ta.widgets.ArrowLabel(f,b,{labelArrowBaseClass:"calendarDateStyling hoverDateStyling"});ta.store("ta.calendar.hoverDateFlag",d)},removeHoverDateFlag:function(){if(ta.has("ta.calendar.hoverDateFlag")){var a=ta.retrieve("ta.calendar.hoverDateFlag");if(a){a.remove();ta.remove("ta.calendar.hoverDateFlag")}}},addChooseDatesFlag:function(){if(!ta.has("ta.calendar.chooseDateFlag")){var a=ta.retrieve("calendar.enterDatesText");var b=document.getElement(".metaContentSection .largeOpenCalCRButton");var c=new ta.widgets.ArrowLabel(b,a,{labelArrowBaseClass:"calendarDateStyling enterDatesArrowElem",arrowSpriteClass:"sprite-date_picker-orangeArrowUp"});ta.store("ta.calendar.chooseDateFlag",c)}},removeChooseDatesFlag:function(){if(ta.has("ta.calendar.chooseDateFlag")){var a=ta.retrieve("ta.calendar.chooseDateFlag");if(a){a.remove();ta.remove("ta.calendar.chooseDateFlag")}}},onDateInputClick:function(a,b){var c=document.getElement(".inline_calendar");if(c&&c.hasClass("hidden")){ta.widgets.calendar.showInlineCalendar(true,!b.getParent(".meta_date_field.first"))}else{if(c&&ta.has("ta.first.date.selected")&&b&&b.getParent(".meta_date_field.first")){ta.widgets.calendar.clearCalendarSelections()}}},onDateInputOver:function(){if(!ta.widgets.calendar.hasPageDates()&&!ta.has("ta.first.date.selected")){ta.widgets.calendar.addChooseDatesFlag()}},onDateInputOut:function(){ta.widgets.calendar.removeChooseDatesFlag()},getDayElemFromDate:function(a){if(!a||!a.getTime){return false}return document.getElement(".date_"+a.getDate()+".month_"+a.getMonth()+".year_"+a.getFullYear())},getDateFromElem:function(c){var a,b=1,f=false,d=false,e;if(!c){return false}c=ta.id(c);a=c.className;if(!a){return false}e=a.match(/date_(\d+)/);if(e&&e[1]){b=e[1]}e=a.match(/month_(\d+)/);if(e&&e[1]){f=e[1]}e=a.match(/year_(\d+)/);if(e&&e[1]){d=e[1]}if(f===false||d===false){return false}return ta.util.date.create(d,f,b)},setMaxLengthOfStayStyling:function(){var e=ta.has("ta.first.date.selected");var f=document.getElements(".month td");if(e){var a=ta.widgets.calendar.getPageInDate();var c=ta.widgets.calendar.getPageInDate();c.setDate(c.getDate()+ta.util.date.MAX_STAY_DURATION_DAYS);if(f&&a){Array.each(f,function(h){var g=ta.widgets.calendar.getDateFromElem(h);if(g&&(g.getTime()<a.getTime()||c.getTime()<g.getTime())){h.addClass("disabled")}})}}else{if(f){var b=new Date(ta.util.date.normalize(new Date()));if(!ta.has("ta.calendar.lastDate")){ta.widgets.calendar.setFirstLastDates()}var d=ta.retrieve("ta.calendar.lastDate");Array.each(f,function(h){var g=ta.widgets.calendar.getDateFromElem(h);if(g&&(b.getTime()<=g.getTime()&&g.getTime()<=d.getTime())){h.removeClass("disabled")}})}}},setInDateInputSelectState:function(b,d){var c=document.getElements(".metaContentSection .date_picker_calendar_wrap");var a=ta.widgets.calendar.getSelArrowElem();if(c){Array.each(c,function(e){if(!d){if(e.getParent()&&e.getParent().hasClass("first")){if(b){e.removeClass("selectionStyle")}else{e.addClass("selectionStyle");e.getParent().adopt(a)}}else{if(b){e.addClass("selectionStyle");if(e.getParent()){e.getParent().adopt(a)}}else{e.removeClass("selectionStyle")}}}else{e.removeClass("selectionStyle");a.dispose()}})}},getSelArrowElem:function(){var a=document.getElement(".selectionUpArrow");if(!a){if(document.getElement(".inline_calendar")){a=new Element("div",{"class":"sprite-date_picker-pointer-orange-ac selectionUpArrow"})}else{a=new Element("div",{"class":"sprite-date_picker-pointer selectionUpArrow"})}}return a},showInlineCalendar:function(f,d){var h=document.getElement(".inline_calendar");if(h){if(f){var c=h.hasClass("hidden");h.removeClass("hidden");var b=document.getElement("#HR_HACKATHON_CONTENT .postShowMetaCR");if(b){b.dispose()}if(d){if(!ta.has("date.picker.pageInDate")){d=false}}ta.widgets.calendar.setFirstDateSelected(!!d);if(c){ta.widgets.calendar.trackCalendarEvent(ta.widgets.calendar.getTrackingString(),"OPEN","DATES")}}else{h.addClass("hidden");ta.widgets.calendar.setInDateInputSelectState(false,true);var g=document.getElement(".largeOpenCalCRButton");if(g){g.dispose()}var a=document.getElement(".open_calendar_legend");if(a){a.addClass("miniMetaHideHdr").removeClass("miniMetaShowHdr")}var e=document.getElement(".open_calendar_highlight_bg");if(e){e.removeClass("open_calendar_highlight_bg")}}}},dayOver:function(f,e,a,c,b){if(typeof(isIPad)!="undefined"&&isIPad){ta.widgets.calendar.dayClick(f,e,a,c,b);return}ta.widgets.calendar.updateSelectedDays(f,ta.util.date.create(e,a,c),b)},updateSelectedDays:function(p,l,m){var n,f="prevSel",j="start",b="end",h=false,e,k,c,o,g,a,i;if(!ta.has("ta.first.date.selected")){return}if(!m){ta.widgets.calendar.removeHoverDateFlag();return}m=ta.id(m).getParent();n=l;ta.widgets.calendar.clearSelectedDays();e=ta.widgets.calendar.getPageInDate();k=ta.widgets.calendar.getPageOutDate();h=false;c=false;if(e){h=document.getElement(".month_"+e.getMonth()+".date_"+e.getDate());c=e}else{if(k){h=document.getElement(".month_"+k.getMonth()+".date_"+k.getDate());c=k}}a=h;i=m;if(!a){a=document.getElement(".month td");if(a){a.addClass(f)}}else{a.addClass(j).addClass(f)}if(n.getTime()<c.getTime()){ta.widgets.calendar.removeHoverDateFlag();return}if(!i){i=document.getElement(".month_"+n.getMonth()+".date_"+ta.util.date.getLastDayOfMonth(n));i.addClass(f)}else{i.addClass(b)}ta.widgets.calendar.updateSelectedDaysHelper(a,i,true,f);if(m.hasClass("disabled")){ta.widgets.calendar.removeHoverDateFlag()}else{o=ta.retrieve("calendar.singleNightText");g=ta.util.date.getDaysInRange(c,n)-1;if(1<g){o=ta.retrieve("calendar.multiNightsText");o=o.replace(/\d+/,g)}ta.widgets.calendar.addHoverDateFlag(n,m,o)}},updateSelectedDaysHelper:function(e,j,g,h){if(!e||e==j){return}var f="nextSibling";var k="firstChild";if(!g){f="previousSibling";k="lastChild"}var d=false;if(ta.widgets.calendar.isValidDateElem(e.getNext())){d=e.getNext()}else{var a=ta.id(e.parentNode);if(a&&a.getNext()){d=a.getNext()[k]}else{if(a&&ta.id(a).getParent(".month")){var c=ta.id(a).getParent(".month");if(ta.util.i18n.isRtl()){f=(f=="previousSibling")?"nextSibling":"previousSibling"}var i=c.getNext();if(!i){return}var b=ta.id(i).getElements("td");if(!g){b.reverse()}b.some(function(l){if(ta.widgets.calendar.isValidDateElem(l)){d=l;return true}return false},this)}}}if(d){ta.id(d).addClass(h);ta.widgets.calendar.updateSelectedDaysHelper(d,j,g,h)}},isValidDateElem:function(b){if(!b||b.tagName!="TD"){return false}var a=b.className;if(a.match(/other/)||a.match(/disabled/)){return false}return true},clearSelectedDays:function(){var a=["prevSel","selected","start","end","inDate","inDate_DP7"];Array.each(a,function(c){var b=document.getElements(".inline_calendar .month td."+c);if(b){Array.each(b,function(d){d.removeClass(c)})}})},injectMonth:function(d,b,f){var c=b,a="top",e=b.getElement(".navCal");if(f&&e){c=e;a="after"}else{if(!f){a="bottom"}}d.inject(c,a);ta.widgets.calendar.setMaxLengthOfStayStyling();ta.widgets.calendar.removeFirstDateFlag();if(ta.has("ta.first.date.selected")){ta.widgets.calendar.addFirstDateFlag()}},setFirstLastDates:function(){var c=11;var b=new Date();b=new Date(ta.util.date.normalize(b));ta.store("ta.calendar.firstDate",b);var f=new Date(b.getTime());f.setDate(1);var a=f.getMonth();var e=a+c;f.setFullYear(f.getFullYear()+e/12);f.setMonth(e%12);f=new Date(ta.util.date.normalize(f));ta.store("ta.calendar.lastDate",f)},setClickMouseOverFunctions:function(){ta.store("ta.calendar.date.clickFunction","ta.widgets.calendar.dayClick");ta.store("ta.calendar.date.mouseOverFunction","ta.widgets.calendar.dayOver")},buildDayClass:function(a){var f="";var e=ta.widgets.calendar.getPageInDate();var c=ta.widgets.calendar.getPageOutDate();var b=new Date(ta.util.date.normalize(new Date()));if(!ta.has("ta.calendar.lastDate")){ta.widgets.calendar.setFirstLastDates()}var d=ta.retrieve("ta.calendar.lastDate");if(e&&e.getTime()==a.getTime()){f="inDate_DP7 start prevSel"}else{if(e&&c&&e.getTime()<a.getTime()&&c&&a.getTime()<c.getTime()){f="prevSel"}else{if(c&&c.getTime()==a.getTime()){f="inDate_DP7 end prevSel"}else{if(a.getTime()<b.getTime()||d.getTime()<a.getTime()){f="disabled"}}}}if(a.getTime()==b.getTime()){f="today "+f}return f},createMonth:function(l){var k={date:l},g,c="",o,m,b,p,a,e=-1,j,n,f,q,r,h;if(!ta.has("ta.calendar.firstDate")){ta.widgets.calendar.setFirstLastDates()}g=new Date(l.getTime());g.setDate(1);ta.util.date.normalize(g);o=l.getFullYear();m=l.getMonth();b;p=new Date(ta.util.date.normalize(new Date()));a=ta.retrieve("ta.calendar.lastDate");j=ta.widgets.calendar.getPageInDate();if(j&&g.getMonth()==j.getMonth()){e=j.getDate()}if(j){b=new Date(j.getTime());b.setDate(b.getDate()+ta.util.date.MAX_STAY_DURATION_DAYS+1)}n=o;if(ta.retrieve("thai_buddhist_era_year")){n=n+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET}c+='<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">';if(typeof DATE_FORMAT_MMM_YYYY!="undefined"){c+=DATE_FORMAT_MMM_YYYY.replace(/MMM/,jsGlobalMonths[m]).replace(/YYYY/,n)}c+="</th></tr><tr>";for(f=0;f<jsGlobalDaysShort.length;f++){c+="<th>";c+=jsGlobalDaysShort[f];c+="</th>"}c+="</tr></thead><tbody><tr>";q=new Date(g.getTime());q.setDate(1);r=1-q.getDay();q.setDate(r);for(f=1;f<=42;f++){if(q.getDay()===0){c+="</tr><tr>"}h=ta.widgets.calendar.buildDayClass(q)+" "+ta.widgets.calendar.buildCalendarFrameClass(f);c+='<td class="month_'+q.getMonth()+" date_"+q.getDate()+" year_"+q.getFullYear()+" "+h+'">';if(q.getTime()<p.getTime()||a.getTime()<q.getTime()){c+=q.getDate()}else{c+=ta.widgets.calendar.buildDayAnchorTag(q)}c+="</td>";q.setDate(q.getDate()+1)}c+="</tr></tbody></table>";k.elmt=new Element("div",{"class":"month month_"+k.date.getMonth()+" year_"+k.date.getFullYear()}).set("html",c);return k},buildCalendarFrameClass:function(b){var a="";if(b%7===1){a="leftCalFrame"}else{if(b%7===0){a="rightCalFrame"}}if(b<8){a=a+" topCalFrame"}else{if(35<b){a=a+" bottomCalFrame"}}return a},buildDayAnchorTag:function(a){var b="";if(ta.has("checkrates.add_holding_windows")){b+='<a href="javascript:void(0);" class="no_cpu" '}else{b+='<a href="javascript:void(0);"'}if(ta.has("ta.calendar.date.clickFunction")){b+=' onmouseover="';b+=ta.retrieve("ta.calendar.date.mouseOverFunction");b+="(event,";b+=a.getFullYear();b+=",";b+=a.getMonth();b+=",";b+=a.getDate();b+=',this);"'}if(ta.has("ta.calendar.date.clickFunction")){b+=' onclick="';b+=ta.retrieve("ta.calendar.date.clickFunction");b+="(event,";b+=a.getFullYear();b+=",";b+=a.getMonth();b+=",";b+=a.getDate();b+=',this)";'}b+=">";b+=a.getDate();b+="</a>";return b},addCustomDayStyleString:function(g,f,d,h,c){var i="";var a=ta.widgets.calendar.getPageInDate();var e=ta.widgets.calendar.getPageOutDate();var b="";if(a&&e){b=" inDate_DP7 prevSel";if(c.getTime()>a.getTime()&&c.getTime()<e.getTime()){i=i+" prevSel"}}if(a&&d.date.getMonth()==a.getMonth()&&h==a.getDate()){i=i+" start"+b}if(e&&d.date.getMonth()==e.getMonth()&&h==e.getDate()){i=i+" end"+b}return i},getDateArgsObject:function(){try{var b=ta.widgets.calendar.getPageInDate();var e=ta.widgets.calendar.getPageOutDate();var h=ta.widgets.calendar.getPageAdultsCount();if(!b||!e||!h){return null}var i=b.getDate();var k=b.getMonth()+1;var g=b.getFullYear();var c=e.getDate();var f=e.getMonth()+1;var a=e.getFullYear();var j={inDay:i,inMonth:k+" "+g,outDay:c,outMonth:f+" "+a,adults:h};return j}catch(d){ta.util.error.record(d,"Unable to create calendar date args object");return null}},loadDateEnteredMonikers:function(){ta.common.ads.loadMonikers.delay(2000)},getTrackingString:function(){return ta.retrieve("multiDP.trackString")||"DATEPICKER"},clickDatepickerThroughBackdrop:function(f,c,a){if(!f){return}f=new Event(f);var g=f.page.x;var d=f.page.y;var b=false;Array.from([c,a]).each(function(i){if(!b){var j=i.getPosition();var h=i.getSize();if(g>=j.x&&g<=(j.x+h.x)&&d>=j.y&&d<=(j.y+h.y)){b=true;var e=new MouseEvent("click",{view:window,bubbles:true,cancelable:true});i.dispatchEvent(e);f.stopPropagation()}}})},datesExplicitlySetByUser:function(){return ta.has("date.picker.pageInDate")&&ta.has("date.picker.pageOutDate")},updateAllGuestsRoomsButtons:function(){var a=ta.widgets.calendar.getGuestsRoomsPickerData();ta.select(".roomsButton .grp-rooms-value").each(function(b){b.set("html",a.rooms)});ta.select(".guestsButton .grp-guests-value").each(function(b){b.set("html",a.guests)});ta.widgets.calendar.syncAllDatePickers()}};ta.queueForReady(function(){if(require.defined("ta/util/Error")){require("ta/util/Error").on("beforeSend",function(a){a.eDates=ta.widgets.calendar.getErrorDates()})}});ta.widgets.ArrowLabel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{charWidth:7,sidePadding:0,labelArrowBaseClass:"calendarDateStyling",arrowElemClass:"defaultArrowElemStyling",textElemClass:"arrowTextElemStyling",arrowSpriteClass:"sprite-date_picker-grayDownArrow",arrowIconClass:"arrowIconStyling",arrowIconWidth:16},initialize:function(f,d,i){this.setOptions(i);if(!f||!d){return false}this.labelText=d;this.parentElem=f;var a=d.length+1;var h=(a*this.options.charWidth);var b=0;if(this.parentElem.getCoordinates&&this.parentElem.getCoordinates().width){b=this.parentElem.getCoordinates().width;if(b%2==1){b=b+1}}var c=0;if(h){if(h%2==1){h=h+1}c=(-1)*((h/2)-(b/2))}var g="left";if(ta.util.i18n.isRtl()){g="right"}this.inlineRelElem=new Element("div",{"class":this.options.labelArrowBaseClass+" inlineRelElemStyling"});this.arrowElem=new Element("div",{"class":this.options.arrowElemClass,styles:{width:h,padding:"0 "+this.options.sidePadding+"px"}});this.arrowElem.setStyle(g,c);this.arrowTextElem=new Element("div",{html:this.labelText,"class":this.options.textElemClass});this.arrowIconElem=new Element("div",{"class":this.options.arrowSpriteClass+" "+this.options.arrowIconClass});var e=0;if(this.options.arrowIconWidth){e=(-1)*((this.options.arrowIconWidth/2)-(b/2))}else{if(b){e=b/2}}this.arrowIconElem.setStyle(g,e);this.arrowTextElem.inject(this.arrowElem);this.arrowElem.inject(this.inlineRelElem);this.arrowIconElem.inject(this.inlineRelElem);this.inlineRelElem.inject(f)},setParentElem:function(a){if(a&&this.inlineRelElem){this.parentElem=a;this.parentElem.adopt(this.inlineRelElem)}},setText:function(a){this.labelText=a;this.arrowTextElem.innerHTML=this.labelText},remove:function(){if(this.inlineRelElem){this.inlineRelElem.destroy()}}});ta.widgets.Calendar=new Class({Binds:["addCustomDayStyleString","getCreatorElement"],Implements:[Options,Events],options:{selectedDate:null,firstDate:null,lastDate:null,dualCalendar:true,invalidDates:null,useLinks:true,dayNames:false,formatter:null,offsetOther:0,choiceLink:null,prevAction:null,nextAction:null,monthHeadingFormat:"",monthspan:11,indicateTurnoverDays:false,monthChangeDuration:500,postContent:null,prevStyle:false,nextStyle:false,showRange:false,isFirstCal:null,creatorElem:null,includeTodayInRange:false,holidaysOnCalendar:false,stableTableHeight:false,treatInvalidAsOutOfRange:false,useInoutMonth:true},initialize:function(b){this.setOptions(b);if(!this.options.firstDate){var c=ta.retrieve("calendar.serverTime");if(ta.has("hac_timezone_awareness")&&ta.has("ta.hac.locationTimezoneOffset")){var e=ta.retrieve("ta.hac.locationTimezoneOffset");var a=c?new Date(c):new Date();var d=a.getTime();d+=(a.getTimezoneOffset()*60000);var f=d+e;this.options.firstDate=new Date(f)}else{this.options.firstDate=c?new Date(c):new Date()}}if(!this.options.lastDate){this.setLastDate(this.options.monthspan)}this.today=new Date();this.selectedDate=this.options.selectedDate;if(b.oneWayFlight){this.options.choiceLink="ta.widgets.calendar.calendarSingleSelect"}if(b.multiCityFlight){this.options.choiceLink="ta.widgets.calendar.calendarMCSelect"}ta.util.date.normalize(this.today);if(this.options.firstDate){ta.util.date.normalize(this.options.firstDate)}if(this.options.lastDate){ta.util.date.normalize(this.options.lastDate)}if(this.selectedDate){ta.util.date.normalize(this.selectedDate)}this.container=new Element("div",{"class":"calendar"});this.addPrevNext();if(this.options.postContent){if(typeof(this.options.postContent)==="function"){this.options.postContent=this.options.postContent()}this.container.adopt(this.options.postContent)}if(this.options.wrapper){if(typeof(this.options.wrapper)==="function"){this.options.wrapper=this.options.wrapper()}this.options.wrapper.getElement(".wrapper_inner").adopt(this.container);this.container=this.options.wrapper}if(this.options.monthHeadingFormat==""&&DATE_FORMAT_MMM_YYYY){this.options.monthHeadingFormat=DATE_FORMAT_MMM_YYYY}},setLastDate:function(b){if(b==null||b<1){b=11}var e=new Date();e.setDate(1);var a=e.getMonth();var c=a+b;e.setFullYear(e.getFullYear()+c/12);e.setMonth(c%12);this.options.lastDate=e},getFirstDate:function(){return this.selectedDate||(this.theOtherCal&&this.theOtherCal.selectedDate)||this.today},update:function(){if(this.currentMonth){this.removeTable(null,this.currentMonth)}if(this.nextMonth){this.removeTable(null,this.nextMonth)}var c=this.getFirstDate();if(this.options.useInoutMonth){if(ta.widgets.calendar.getPageInDate()){c=new Date(ta.widgets.calendar.getPageInDate());if(ta.has("datepicker_autoadvance_fday")){c=ta.retrieve("datepicker_autoadvance_fday")}}if(ta.widgets.calendar.getPageOutDate()&&(!ta.widgets.calendar.getPageInDate()||(this.options.flights&&!this.isIn))){c=new Date(ta.widgets.calendar.getPageOutDate());c.setDate(0)}}if(this.options.firstDate&&c<this.options.firstDate){c=this.options.firstDate}if(this.options.dualCalendar){var f=new Date(c);f.setDate(ta.util.date.DAYS_IN_MONTH[f.getMonth()]);ta.util.date.normalize(f);if(f>=this.options.lastDate){c=new Date(c);if(c.getMonth()==0){c.setFullYear(c.getFullYear()-1,11,1)}else{c.setMonth(c.getMonth()-1,1)}}}this.currentMonth=this.createMonth(c);this.injectMonth(this.currentMonth.elmt,true);if(this.options.dualCalendar){var e=new Date(this.currentMonth.date);var a=e.getDate();var b=e.getMonth()+1;if(a>ta.util.date.DAYS_IN_MONTH[b]){a=ta.util.date.DAYS_IN_MONTH[b]}e.setMonth(b,a);this.nextMonth=this.createMonth(e);this.injectMonth(this.nextMonth.elmt,false)}this.updatePrevNext();return this},injectMonth:function(c,d){if(ta.util.i18n.isRtl()){d=!d}var b=this.container,a="top";if(!d&&ta.id(this.container).getElement(".wrapper_inner .calendar")){b=ta.id(this.container).getElement(".wrapper_inner .calendar")}if(d&&this.nav){b=this.nav;a="after"}else{if(!d){if(this.options.postContent){b=this.options.postContent;a="before"}else{a="bottom"}}}c.inject(b,a)},reposition:function(){this.currentMonth.elmt.setStyle("left","0px");if(this.options.dualCalendar){if(!ta.util.i18n.isRtl()){this.nextMonth.elmt.setStyle("left",this.currentMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}else{this.nextMonth.elmt.setStyle("left","0px");this.currentMonth.elmt.setStyle("left",this.nextMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}}return this},updatePrevNext:function(){var b=this.currentMonth.date;var a=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date;var e=ta.util.date.inSameMonth(b,this.options.firstDate);var d=ta.util.date.inSameMonth(a,this.options.lastDate);var c=function(k,j,h){if(!j||j.length==0){if(h==k.tagName){return k}}else{if(k.className&&(!h||h==k.tagName)){var l=-1;do{l=k.className.indexOf(j,l+1);if(l>=0&&(l==0||k.className.charCodeAt(l-1)==32)&&(l+j.length==k.className.length||k.className.charCodeAt(l+j.length)==32)){return k}}while(l>=0)}}for(var g=0;g<k.childNodes.length;g++){var f=c(k.childNodes[g],j,h);if(f){return f}}return null};c(this.container,"prev").style.display=(e?"none":"block");c(this.container,"next").style.display=(d?"none":"block")},createPagingElement:function(a,b,c){return'<span class="'+a+'"><a style="display: block;" onclick="'+b+'(event, this);">'+c+"</a></span>"},addPrevNext:function(){if(!(this.options.prevAction&&this.options.nextAction)){return}var a=[],b=this.nav=new Element("div",{"class":"navCal"}).inject(this.container);a.push(this.createPagingElement("prev"+(this.options.prevStyle?" "+this.options.prevStyle:""),this.options.prevAction,"Previous Month"));a.push(this.createPagingElement("next"+(this.options.nextStyle?" "+this.options.nextStyle:""),this.options.nextAction,"Next Month"));b.set("html",a.join(""))},getHolidays:function(f,c,d,b){var e;if(f){var a=c+"-"+(d+1)+"-"+b;e=f[a]}return e},createMonth:function(D){var F={date:D};var o=new Date(D);o.setDate(1);ta.util.date.normalize(o);var q=(o.getDay()-jsGlobalDayOffset+7)%7;var B=new Date(D);B.setDate(0);this.prevDayValid=(this.isInvalidDate(B)?0:1);if(B<this.options.firstDate||B>this.options.lastDate){this.prevDayValid=-1}var t=2;if(this.options.multiCityFlight&&this.crId>t){this.options.firstDate=ta.widgets.calendar.lastDateBefore(this.options,this.crId)}var c=[];var s=D.getFullYear();var v=D.getMonth();var h=new Date();var w;var C=ta.util.date.inSameMonth(h,D)?h.getDate():-1;var p=-1;if(this.selectedDate&&this.selectedDate.getMonth()==v&&this.selectedDate.getFullYear()==s){p=this.selectedDate.getDate()}var E;if(this.options.showRange&&this.theOtherCal&&this.theOtherCal.selectedDate){E=this.theOtherCal.selectedDate;ta.util.date.normalize(E)}if(this.options.singleSelect){if(this.options.pickerOption=="out"&&ta.widgets.calendar.getPageInDate()){if(!this.options.flights){w=new Date(ta.widgets.calendar.getPageInDate());w.setDate(w.getDate()+ta.util.date.MAX_STAY_DURATION_DAYS)}else{w=new Date();ta.util.date.normalize(w);w.setDate(w.getDate()+ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT)}}}var u=s;if(ta.retrieve("thai_buddhist_era_year")){u=u+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET}c.push('<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">');c.push(this.options.monthHeadingFormat.replace(/MMM/,jsGlobalMonths[v]).replace(/YYYY/,u));c.push("</th></tr><tr>");for(var z=0;z<jsGlobalDaysShort.length;z++){c.push("<th>");c.push(this.options.dayNames?jsGlobalDaysAbbrev[z]:jsGlobalDaysShort[z]);c.push("</th>")}c.push("</tr></thead><tbody><tr>");var g=0;for(var z=0;z<q;z++){c.push('<td class="other">&nbsp;</td>');g++}q--;var y=0;var b=ta.util.date.DAYS_IN_MONTH[F.date.getMonth()];if(F.date.getMonth()==1&&F.date.getYear()%4==0){b+=1}var k=b;while(y<b){q=(q+1)%7;y++;o.setDate(y);var A=y;var e=null;var r=this.getHolidays(this.options.holidaysOnCalendar,s,v,y);if(this.options.includeTodayInRange){var a=!(o<=this.options.firstDate||o>this.options.lastDate||(w&&o>w))}else{var a=!(o<this.options.firstDate||o>this.options.lastDate||(w&&o>w))}var x=!this.isInvalidDate(o);var n=this.options.choiceLink;var m=!((this.selectedDate&&this.selectedDate.getTime()<o.getTime())||(E&&E.getTime()<o.getTime()));if(this.options.formatter){this.options.selectedDay=p;this.options.otherDate=E;var f=this.options.formatter.call(this,o,a,x,q,this.options);e=f.cname;A=f.contents;n=f.link||n}else{if(!x){e="invalid"}else{if(y==C){if(y==p||(E&&o.getTime()===E.getTime())){e="today selected "+(m?"start":"end");m=!m;if(this.selectedDate&&E){e+=" rngDt"}}else{if(!a){e="today disabled"}else{e="today"}}}else{if(y==p||(E&&o.getTime()===E.getTime())){e="selected "+(m?"start":"end");m=!m;if(this.selectedDate&&E){e+=" rngDt"}}else{if(this.selectedDate&&E&&((this.selectedDate.getTime()<o.getTime()&&o.getTime()<E.getTime())||(this.selectedDate.getTime()>o.getTime()&&o.getTime()>E.getTime()))){e="rngDt"}}}}}if(this.options.indicateTurnoverDays){if(x){if(this.prevDayValid==0){if(e){e+=" depart"}else{e="depart"}}this.prevDayValid=1}else{if(this.prevDayValid==1){if(e){e+=" arrive"}else{e="arrive"}}this.prevDayValid=0}if(!a){this.prevDayValid=-1}}if(q==0){c.push("</tr><tr>")}if(!a||(this.options.treatInvalidAsOutOfRange&&!x)){c.push('<td class="');c.push(e||"disabled");c.push('">');if(r){c.push(r)}else{c.push(A||y)}c.push("</td>")}else{if(this.options.singleSelect){var j=this.date;if(j&&j.getDate()==y&&j.getMonth()==v){e=e+" selected"}}var l=this.addCustomDayStyleString(n,s,F,y,o,A);if(l){e+=l}if(e){c.push('<td class="');c.push(e);c.push('">')}else{c.push("<td>")}c.push(this.buildDayAnchorTag(n,s,v,y,A,o));c.push("</td>")}}while(++q<7){c.push("<td class='other'>&nbsp;</td>");g++}if(this.options.stableTableHeight){while((b+g)<42){c.push("</tr><tr>");var z=0;for(z=0;z<7;z++){c.push("<td class='other'>&nbsp;</td>");g++}}}c.push("</tr></tbody></table>");F.elmt=new Element("div",{"class":"month"}).set("html",c.join(""));return F},addCustomDayStyleString:function(d,b,f,a,e,c){},buildDayAnchorTag:function(f,c,e,b,d,g){var a=[];if(this.options.useLinks&&f){if(ta.has("checkrates.add_holding_windows")){a.push('<a href="javascript:void(0);" class="no_cpu" ondragstart="return false;" onclick="')}else{a.push('<a href="javascript:void(0);" ondragstart="return false;" onclick="')}a.push(f);a.push("(event,");a.push(c);a.push(",");a.push(e);a.push(",");a.push(b);a.push(',this)"');if(this.options.dayMouseOver){a.push(' onmouseover="');a.push(this.options.dayMouseOver);a.push("(event,");a.push(c);a.push(",");a.push(e);a.push(",");a.push(b);a.push(',this)"')}if(this.options.dayMouseOut){a.push(' onmouseout="');a.push(this.options.dayMouseOut);a.push("(event,");a.push('this)"')}a.push(">");a.push(d);a.push("</a>")}else{a.push(d)}return a.join("")},isInvalidDate:function(a){return ta.util.date.inDateSet(a,this.options.invalidDates)},isValid:function(){if(!this.selectedDate){return true}return this.selectedDate.getTime()>=this.options.firstDate.getTime()&&this.selectedDate.getTime()<=this.options.lastDate.getTime()},prev:function(){if(this.animating){return}var k=this.options.dualCalendar;this.animating=true;var h=new Date(this.currentMonth.date);var g=h.getMonth()-1;if(g<0){g=g+12;h.setFullYear(h.getFullYear()-1)}var i=h.getDate();if(i>ta.util.date.DAYS_IN_MONTH[g]){i=ta.util.date.DAYS_IN_MONTH[g]}h.setMonth(g,i);var j=this.currentMonth.elmt.getCoordinates().width;var f=j+(k?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(h);if(!ta.util.i18n.isRtl()){b.elmt.style.left="-"+j+"px"}else{b.elmt.style.left=f+"px"}this.injectMonth(b.elmt,true);var e=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[-j,0]},"1":{left:[0,j+this.options.offsetOther]}};if(k){a["2"]={left:[j+this.options.offsetOther,j*2+this.options.offsetOther]}}}else{a={"0":{left:[0,-j]},"1":{left:[j+this.options.offsetOther,0]}};if(k){a["2"]={left:[j*2+this.options.offsetOther,j+this.options.offsetOther]}}}var c=new Fx.Elements(e,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.nextMonth||this.currentMonth),duration:this.options.monthChangeDuration});if(k){this.nextMonth=this.currentMonth}this.currentMonth=b;this.updatePrevNext();c.start(a)},next:function(){if(this.animating){return}var k=this.options.dualCalendar;this.animating=true;var h=new Date(this.currentMonth.date);var g=h.getMonth()+(k?2:1);if(g>11){g=g-12;h.setFullYear(h.getFullYear()+1)}var i=h.getDate();if(i>ta.util.date.DAYS_IN_MONTH[g]){i=ta.util.date.DAYS_IN_MONTH[g]}h.setMonth(g,i);var j=this.currentMonth.elmt.getCoordinates().width;var f=j+(k?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(h);if(!ta.util.i18n.isRtl()){b.elmt.style.left=f+"px"}else{b.elmt.style.left="-"+j+"px"}this.injectMonth(b.elmt,false);var e=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[0,-j]},"1":{left:[j+this.options.offsetOther,0]}};if(k){a["2"]={left:[j*2+this.options.offsetOther,j+this.options.offsetOther]}}}else{a={"0":{left:[-j,0]},"1":{left:[0,j+this.options.offsetOther]}};if(k){a["2"]={left:[j+this.options.offsetOther,j*2+this.options.offsetOther]}}}var c=new Fx.Elements(e,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.currentMonth),duration:this.options.monthChangeDuration});if(k){this.currentMonth=this.nextMonth;this.nextMonth=b}else{this.currentMonth=b}this.updatePrevNext();c.start(a)},removeTable:function(b,a){a.elmt.dispose()},doneAnimating:function(b,a){this.removeTable(b,a);this.animating=false},select:function(a,b){this.selectedDate=b;this.fireEvent("onSelect",[this,a])},clear:function(a){this.selectedDate=null;this.fireEvent("onClear",[this,a])},nearbyMonth:function(b,a){var c=b+a;if(c>11){c-=12}else{if(c<0){c+=12}}return c},getCreatorElement:function(){return this.options.creatorElem}});(function(){ta.widgets.SingleDateCalendar=new Class({Extends:ta.widgets.Calendar,Implements:[Options,Events],Binds:["onOutDateCalShow","updateInputStyling","updateDualDateInputStyling","showCalendarOverlay","setPositionElement","hashHack","getCalendarTopOffset","getCalendarLeftOffset","callOnSelect","setPageDates","getPageInDate","getPageOutDate"],options:{singleSelect:true,pickerOption:"in",autoAdvance:true,dualCalendar:true,dayMouseOver:"ta.widgets.calendar.calendarMouseOver",choiceLink:"ta.widgets.calendar.calendarMultiSelect",prevAction:"ta.widgets.calendar.calendarPrev",nextAction:"ta.widgets.calendar.calendarNext",selectedHoverClass:"rngDt",previousSelectedClass:"prevSel",inDateClass:"inDate",outDateClass:"outDate",selectionStartClass:false,selectionEndClass:false,captureKeyEvents:true,autoShow:false,displayCalendarInOverlay:true,formatter:ta.widgets.calendar.multiDateFormatter,monthChangeDuration:150,submitOnEnter:true,useClassicSkin:false,classicStyling:false},inDate:false,newInDate:false,oldInDate:false,startRangeElem:false,outDate:false,oneSelected:false,monthOffset:0,initialize:function(f,m,o,t,u){this.isIn=u;this.parent(f,this.input);this.crId=m;this.setPositionElement();if(typeof o==="function"){this.onSelect=o.bind(this)}this.argArray=t;if(this.options.displayCalendarInOverlay){var d=this.onCalendarOverlayShow.bind(this);var a=this.onCalendarOverlayHide.bind(this);var k=this.onCalendarOverlayShow.bind(this);var h=this.positionElement.getParent(".overlay");if(h){this.parentOverlay=h.overlay}var y=ta.overlays.ACTIVATE_CLICK;var l=this.options.offsetLeft?this.options.offsetLeft:this.getCalendarLeftOffset();var s=this.options.offsetTop?this.options.offsetTop:this.getCalendarTopOffset();var w="date_picker_calendar";if(this.options.useClassicSkin){w="typeO"}if(this.options.classicStyling){w=w+" classicStyling"}if(this.options.oneWayStyling){w=w+" oneWayStyling"}if(!this.options.dualCalendar){w=w+" singleWidth"}if(!ta.widgets.calendar.hasPageDates()){w=w+" predates"}var q=ta.retrieve("tablet_calendar_update.enabled")?ta.overlays.BACKDROP_ALWAYS:ta.overlays.BACKDROP_NEVER;var c=ta.retrieve("tablet_calendar_update_v2.enabled")?0.01:0.6;var x=null;if(ta.retrieve("tablet_calendar_update_v2.enabled")){var e=ta.id("date_picker_in_"+this.crId+this.options.ext);var g=ta.id("date_picker_out_"+this.crId+this.options.ext);x=function(z){ta.widgets.calendar.clickDatepickerThroughBackdrop(z,e,g)}}var r=ta.overlays.RelativeOverlayBelow;var v={style:w,noPadding:true,autoShow:false,noCpu:true,backdrop:q,backdropOpacity:c,onBackdropClick:x,offsetLeft:l,offsetTop:s,activate:y,onShow:d,onHide:a,onFocus:k,zIndex:1001,showCloseButton:false,parentContainer:this.options.parentContainer,fontSize:this.options.fontSize};if(ta.has("hr_meta_focus_with_dates")||ta.has("sd_datepicker_focus")||ta.has("hotels_meta_focus")){v.zIndex=10001}if(f&&f.isGuestsRoomsCalendar){v.useTransparentOverlayPadding=true;v.transparentOverlayPaddingValue=80}if(ta.isTabletAlbumViewer()||ta.retrieve("tablet_maps_v1")){var j=document.getElement(".footerPocketWithInsert");if(j&&j.isVisible()){if(this.positionElement&&this.positionElement.getParent(".footerPocketWithInsert")){v.parentContainer=j}else{v.positionType="fixed"}var p=v.onShow;v.onShow=function(z){if(p){p(z)}window.addEvent("orientationchange",this.hide)};var n=v.onHide;v.onHide=function(z){if(n){n(z)}window.removeEvent("orientationchange",this.hide)}}}this.calendarOverlay=new r(v,this.positionElement);var b=ta.id(this.positionElement).getParent();if(b&&b.hasClass("date_picker_calendar_wrap")){b.onclick=function(){};ta.id(this.positionElement).removeEvents("click");ta.id(this.positionElement).getParent().addEvent("click",this.showCalendarOverlay.bind(this))}if(b&&!window.tabletOnFullSite){b.addEvent("focus",this.showCalendarOverlay.bind(this))}if(this.outDateField){ta.id(this.outDateField).getParent().onclick=function(){};ta.id(this.outDateField).getParent().addEvent("click",this.onOutDateCalShow.bind(this));if(!window.tabletOnFullSite){ta.id(this.outDateField).getParent().addEvent("focus",this.onOutDateCalShow.bind(this))}}this.calendarOverlay.inner.adopt(this.container);this.calendarOverlay.calendar=this;if(this.positionElement&&(this.positionElement.hasClass("isPreDatesPermanent")||this.positionElement.getParent(".isPreDatesPermanent"))){this.calendarOverlay.options.permanent=true;this.calendarOverlay.options.pinnable=ta.overlays.PINNABLE_ALWAYS}this.calendarOverlay.container.addEvent("click",function(z){if(z||window.event){z=new Event(z||window.event);z.stopPropagation()}});this.update();this.reposition()}var i=this.onDocumentClick.bind(this);document.addEvent("click",i)},addCustomDayStyleString:function(k,j,h,l,g,c){var m="";var b=this.getPageInDate();var i=this.getPageOutDate();var f="";if(b&&i){f=" prevSel inDate_DP7";if(g.getTime()>b.getTime()&&g.getTime()<i.getTime()){m=m+" prevSel"}}if(b&&h.date.getMonth()==b.getMonth()&&l==b.getDate()){m=m+" inDate start"+f}if(i&&h.date.getMonth()==i.getMonth()&&l==i.getDate()){m=m+" inDate end"+f}if(ta.retrieve("cal_xsell")&&(this.today.getMonth()==g.getMonth()||((this.today.getMonth()+1)%12)==g.getMonth())){var e=ta.util.date.getDaysInRange(this.today,g)-1;if(!this.isIn){e-=1}var a=ta.retrieve("cal_xsell");if(e>=0&&e<a.availability.length){var d=a.availability[e];if(!d){m+=" calXSellUnAvail"}}}return m},buildDayAnchorTag:function(g,d,f,b,e,h){var a=[];var c=this.getHolidays(this.options.holidaysOnCalendar,d,f,b);if(this.options.useLinks&&g){if(ta.has("checkrates.add_holding_windows")){a.push('<div href="javascript:void(0);" class="day no_cpu')}else{a.push('<div href="javascript:void(0);" class="day')}if(c){a.push(" hld")}a.push(" day_"+b);a.push('" onclick="');a.push(g);a.push("(event,");a.push(d);a.push(",");a.push(f);a.push(",");a.push(b);a.push(',this)"');if(window.FastClick){a.push(' ontouchend="');a.push(g);a.push("(event,");a.push(d);a.push(",");a.push(f);a.push(",");a.push(b);a.push(',this)"')}if(this.options.dayMouseOver){a.push(' onmouseover="');a.push(this.options.dayMouseOver);a.push("(event,");a.push(d);a.push(",");a.push(f);a.push(",");a.push(b);a.push(',this)"')}a.push(' value="');a.push(h.valueOf());a.push('"');a.push(">");if(c){a.push(c)}else{a.push(e)}a.push("</div>")}else{a.push(e)}return a.join("")},callOnSelect:function(){if(this.onSelect){this.fireEvent("onChangeDates");if(this.argArray&&this.argArray.length>0){this.onSelect.apply(this,this.argArray)}else{this.onSelect.call(this,this.crId,this.positionElement);if(ta.has("guests_rooms_picker_3.enabled")){ta.store("calendarClosedByDocClick",false)}}}},clear:function(b){this.date=null;ta.widgets.calendar.clearPageDates();if(this.positionElement&&!(this.positionElement.hasClass("tab0")&&this.positionElement.hasClass("header_tab"))){var a="";if(this.isIn){if(this.options.classicDateFormat&&typeof JS_DateFormat!="undefined"){a=JS_DateFormat}else{a=ta.retrieve("multiDP.checkIn")}}else{if(this.options.classicDateFormat&&typeof JS_DateFormat!="undefined"){a=JS_DateFormat}else{a=ta.retrieve("multiDP.checkOut")}}this.positionElement.innerHTML=a}this.fireEvent("onClear",[this,b]);if(this.calendarOverlay){this.calendarOverlay.hide()}},clearPrevSelectedDays:function(){if(!this.calendarTop){this.calendarTop=this.calendarOverlay.container.getElement(".calendar")}var a=this.calendarTop.getElements("td."+this.options.previousSelectedClass);a.removeClass(this.options.previousSelectedClass);this.options.selectionStartClass&&a.removeClass(this.options.selectionStartClass);this.options.selectionEndClass&&a.removeClass(this.options.selectionEndClass)},clearSelectedDays:function(){if(!this.calendarTop){this.calendarTop=this.calendarOverlay.container.getElement(".calendar")}var a=this.calendarTop.getElements("td."+this.options.selectedHoverClass);a.removeClass(this.options.selectedHoverClass);this.options.selectionStartClass&&a.removeClass(this.options.selectionStartClass);this.options.selectionEndClass&&a.removeClass(this.options.selectionEndClass)},createPagingElement:function(a,b,c){return'<span class="'+a+'" onclick="'+b+'(event, this);"></span>'},dayOver:function(b,c,a){ta.util.date.normalize(c);if(!this.oneSelected){this.updateHoverElem(a);return}this.hoverDay=c;this.updateSelectedDays(c,a)},ensureValidDates:function(){var c=this.getPageInDate();var b=this.getPageOutDate();if(this.options.firstDate&&c){if(c<this.options.firstDate){ta.util.date.normalize(this.options.firstDate);c=this.options.firstDate;ta.widgets.calendar.setPageInDate(c);this.bypassSecondCal=true;var a=ta.widgets.calendar.getDateAfter(c);if(b&&b<a){b=a;ta.widgets.calendar.setPageOutDate(b)}}}if(b&&!c){c=ta.widgets.calendar.getDateBefore(b)}if(c&&!b){b=ta.widgets.calendar.getDateAfter(c)}ta.widgets.calendar.setPageInDate(c);ta.widgets.calendar.setPageOutDate(b)},focusOtherCalendar:function(){var a;if(this.isIn){a=ta.widgets.calendar.getPageOutCalendarField(this.crId,this.options.ext)}else{a=ta.widgets.calendar.getPageInCalendarField(this.crId,this.options.ext)}var b=document.getElement("#PERSISTENT_DATE_PICKER:not(.hidden)")||document;if(a===null&&ta.has("guests_rooms_picker_3.enabled")){if(this.isIn){a=b.getElement(".stayInfoHeaderDateTrigger.outDateTrigger")}else{a=b.getElement(".stayInfoHeader.inDateTrigger")}}if(a){if(a.click){ta.store("overlay.dontCloseOnClick",true);a.click();ta.store("overlay.dontCloseOnClick",false)}else{if(document.createEvent&&a.dispatchEvent){var c=document.createEvent("MouseEvent");c.initEvent("click",true,true);a.dispatchEvent(c)}}}},getCalendarLeftOffset:function(){var a=1;if(ta.util.i18n.isRtl()){a=127}if(ta.isMetaHomepageIntegration2013()){a=2;if(ta.util.i18n.isRtl()){a=121}}if(ta.retrieve("ta.calendar.isOutDateTrigger")&&ta.retrieve("ta.calendar.isPriceOverlayCalendar")){a=138}if(ta.has("hotels_left_filters_redesign")){return 0}return a},getCalendarTopOffset:function(){if(ta.has("hotels_left_filters_redesign")){return -7}if(ta.isMetaHomepageIntegration2013()){return -1}return -4},getFirstDate:function(){var b=this.getPageInDate();var a=this.getPageOutDate();if(this.options.multiCityFlight&&this.crId>1){return ta.widgets.calendar.lastDateBefore(this.options,this.crId)}if(this.isSecondCalShown()){if(!this.isIn&&b){return b}else{if(this.isIn&&a){return a}}}else{if((this.isIn)&&b){return b}else{if(!this.isIn&&a){return a}}}return this.today},getPageInDate:function(){return ta.widgets.calendar.getPageInDate()},getPageOutDate:function(){return ta.widgets.calendar.getPageOutDate()},getState:function(){var c=this.inDate,b=this.outDate,a={};if(c instanceof Date){Object.append(a,{inMonth:(c.getMonth()+1)+" "+c.getFullYear(),inDay:c.getDate()})}if(b instanceof Date){Object.append(a,{outMonth:(b.getMonth()+1)+" "+b.getFullYear(),outDay:b.getDate()})}return a},hashHack:function(){var a=ta.id(this.positionElement).get("id");if(a){a=a.substring(a.length-3,a.length);if(a=="olb"||a=="bin"||a=="som"){window.location.hash=" ";window.location.hash="#MetaPricesTab"}}},includeElemInRange:function(b,a){b.className=b.className+" "+a},isSecondCalShown:function(){if(!this.options.autoAdvance){return true}var a=ta.widgets.calendar.inOutCalendarSelected(!this.isIn);return a},isValidDateElem:function(b){if(!b||b.tagName!="TD"){return false}var a=b.className;if(a.match(/other/)||a.match(/disabled/)){return false}return true},initTracking:function(){if(!ta.remove("meta.datepicker_tracked")){var c=ta.id(this.positionElement).get("id")||this.options.ext||"_owl";var d=c.indexOf("_persist")>0;c=c.substring(c.length-3,c.length);var b=this.isIn?"CheckIn|":"CheckOut|";if(d){b+="Persistent|"}if(ta.retrieve("cal_xsell")){b+="CalXSell|"}switch(c){case"pto":b+="PHOTOS_LIGHTBOX";break;case"amo":b+="AMENITIES_LIGHTBOX";break;case"pop":b+="DHTML_FLYOUT";break;case"cro":b+="CalendarLightbox";break;case"inm":b+="DATES_INLINE|Tabs";ta.store("isPricesTabDatePicker",true);break;case"bin":b+="DATES_INLINE_FLEXIBLE";break;case"met":b+="DATES_LIGHTBOX";break;case"olb":b+="DATES_LIGHTBOX_FLEXIBLE";break;case"som":b+="DATES_State-Optimized-Modal_FLEXIBLE";break;case"cmp":b+="footer";break;case"hpt":b+="HOMEPAGE_PYPT";break;case"thc":b+="HAC_TOURISM";break;case"gnv":b+="GLOBAL_NAV";break;case"ond":b+="RoomTab";break;default:b+="DATES"}var a=this.getTrackingPrefix()+ta.widgets.calendar.getTrackingString();ta.widgets.calendar.trackCalendarEvent(a,"OPEN",b);ta.store("multiDP.trackString",false)}},singleDaySelect:function(g,i,f){if(g){new Event(g).stop()}ta.util.date.normalize(i);if(!i||!i.getTime){return}this.date=i;var c=new Date(i);c.increment("week",1);if(this.options.flights){var h=(new Date()).increment("day",ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT);if(c>h){c=h}}this.setPageDates(i,c);this.closedByDocOrDateClick=true;this.bypassSecondCal=true;var a=ta.widgets.calendar.getDatePickerFormat("classic");i=ta.widgets.calendar.dateToString(i,a);var b=ta.id(f).getParent(".overlay");b.overlay.calendar.options.creatorElem.innerHTML=i;if(this.calendarOverlay){this.calendarOverlay.hide()}},multiCitySelect:function(l,m,f){if(l){new Event(l).stop()}ta.util.date.normalize(m);if(!m||!m.getTime){return}var b=ta.widgets.calendar.getDatePickerFormat("classic");var o=ta.id(f).getParent(".overlay");var c=2;if(o.overlay.calendar.crId===c){var n=undefined;if(typeof NE!=="undefined"){n=new Date(m);n.increment("week",1);if(this.options.flights){var j=(new Date()).increment("day",ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT);if(n>j){n=j}}}this.setPageDates(m,n);this.closedByDocOrDateClick=true;this.bypassSecondCal=true}if(typeof NE!=="undefined"){NE.checkMultiCityFields(o.overlay.calendar.crId,m)}else{var a=parseInt(o.overlay.calendar.crId);var g=4;for(var k=a;k<=g+1;k++){if(ta.id("date_picker_in_"+k)&&ta.id("date_picker_in_"+k).innerHTML.length>1){var h=ta.widgets.calendar.dateFromString(ta.id("date_picker_in_"+k).innerHTML);if(m>h){ta.id("date_picker_in_"+k).innerHTML=""}}}}m=ta.widgets.calendar.dateToString(m,b);o.overlay.calendar.options.creatorElem.innerHTML=m;if(this.calendarOverlay){this.calendarOverlay.hide()}},multiSelect:function(g,h,b){if(g){new Event(g).stop()}ta.util.date.normalize(h);if(!h||!h.getTime){return}this.date=h;var a=null;var i=null;a=this.getPageInDate();i=this.getPageOutDate();var f=!a&&!i;var l=true;this.closedByDocOrDateClick=true;var k=false;if((!ta.widgets.calendar.getPageInDate()&&!ta.widgets.calendar.getPageOutDate())||(ta.retrieve("enteredDatesInPreDates")&&!ta.widgets.calendar.hasPageDates())){ta.store("enteredDatesInPreDates",true)}else{ta.store("enteredDatesInPreDates",false)}var j=!ta.has("hotels_left_filters_redesign")&&ta.has("guests_rooms_picker_3.enabled")&&this.isIn;if(j&&!f){ta.widgets.calendar.cancelAllExistingHAC();this.bypassSecondCal=false;if(this.isIn){a=h;if(i&&h.getTime()>=i.getTime()){i=false;k=true;ta.widgets.calendar.clearPageOutDate(this.crId,this.options.ext);ta.widgets.calendar.removeInOutCalendarSelected(false)}if(!i){if(h.getDate()<=23){ta.store("datepicker_autoadvance_fday",this.currentMonth.date)}else{ta.remove("datepicker_autoadvance_fday")}}}else{i=h;if(a&&h.getTime()<(new Date()).getTime()){a=new Date();i=ta.widgets.calendar.getDateAfter(a)}else{if(a&&h.getTime()<=a.getTime()){a=false;k=true;ta.widgets.calendar.clearPageInDate(this.crId,this.options.ext);ta.widgets.calendar.removeInOutCalendarSelected(true)}else{if(a){ta.widgets.calendar.trackInOutCalendarSelected(true);this.bypassSecondCal=true}}}}}else{if(this.isIn){var c=i&&(h.getTime()==i.getTime()&&!this.options.flights);if(i&&(h.getTime()>i.getTime()||c)){a=this.date;i=false;k=true;ta.widgets.calendar.clearPageOutDate(this.crId,this.options.ext)}else{a=h;if(i){this.bypassSecondCal=true}}}else{var c=a&&(h.getTime()==a.getTime()&&!this.options.flights);if(a&&h.getTime()<(new Date()).getTime()){a=new Date();i=ta.widgets.calendar.getDateAfter(a)}else{if(a&&(h.getTime()<a.getTime()||c)){i=this.date;a=false;k=true;ta.widgets.calendar.clearPageInDate(this.crId,this.options.ext)}else{i=h;if(a){this.bypassSecondCal=true}}}}}this.inDate=a;this.outDate=i;if(ta.has("guests_rooms_picker_3.enabled")){this.setPredatesState()}this.setPageDates(a,i);if(ta.has("guests_rooms_picker_3.enabled")&&ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.syncAllDatePickers();ta.commerce.meta.updateHeaderDates()}this.hoverDay=false;if(!this.bypassSecondCal&&((!this.getPageOutDate()||!this.getPageInDate())&&!k)){this.bypassSecondCal=true}this.updateNumNights();if(this.calendarOverlay){this.calendarOverlay.hide()}if(this.bypassSecondCal&&!f&&(!this.getPageInDate()||!this.getPageOutDate())){this.bypassSecondCal=false}ta.overlays.Factory.destroyAnimatedDateCTA();if(!this.isSecondCalShown()&&!this.bypassSecondCal||(f&&ta.retrieve("metaUI.isMetaCalendarAutoadvancePredates"))){ta.widgets.calendar.trackInOutCalendarSelected(this.isIn);this.focusOtherCalendar()}else{this.hashHack()}this.removeErrorState();if(this.getPageInDate()&&this.getPageOutDate()){this.fireEvent("onRangeSelect",[this.crId,this.options.ext])}this.fireEvent("onSelect",[this,g])},next:function(){this.parent();this.resetStartRangeElem(true);var a=(this.currentMonth&&this.currentMonth.date?this.currentMonth.date.get("month"):"");ta.trackEventOnPage("DATEPICKER","NEXT_MONTH",(this.isIn?"Checkin":"Checkout"),a)},onCalendarOverlayKeyDown:function(a){if(this.options.submitOnEnter&&"enter"===a.key&&ta.isMetaHomepageIntegration2013()){var c=this.positionElement.getParent("form "),b="function"!==typeof this.options.submitOnEnter||this.options.submitOnEnter(a,c);if(b){c&&c.submit()}else{this.calendarOverlay.hide()}}if(a.key=="esc"||(ta.isMetaHomepageIntegration2013()&&!ta.retrieve("freeform_datepicker")&&a.key=="tab")){this.calendarOverlay.hide()}},onCalendarOverlayHide:function(b){if(this.isSecondCalShown()||ta.widgets.calendar.hasPageDates()){this.ensureValidDates()}ta.widgets.calendar.syncAllDatePickers();if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}if(this.options.captureKeyEvents&&this.keyEventListener){document.removeEvent("keydown",this.keyEventListener)}this.updateInputStyling(false);var g=this.getPageInDate();var e=this.getPageOutDate();var d=g&&g.getDate&&e&&e.getDate;if(this.isSecondCalShown()&&d){this.bypassSecondCal=true}var a=false;if((this.shouldFireOnSelect()||this.bypassSecondCal||(this.closedByDoc&&ta.has("guests_rooms_picker_3.enabled")))&&d&&this.closedByDocOrDateClick){var c=false;if(this.closedByDoc&&ta.has("guests_rooms_picker_3.enabled")){ta.store("calendarClosedByDocClick",true);c=true}this.fireEvent("onChangeDates");if(c){this.fireEvent("onRangeSelect",[this.crId,this.options.ext])}this.callOnSelect();this.trackSelect(true);if(ta.retrieve("ta.calendar.isPriceOverlayCalendar")){a=true}if(ta.commerce.persistentdatepicker){ta.commerce.persistentdatepicker.update()}if(ta.has("price_finder")){var f=document.getElements(".roomGuestsInfoWrap");if(f){f.forEach(function(h){h.removeClass("hidden")})}}}else{if(!this.closedByDoc){this.trackSelect(false)}}if(this.resetFireOnSelectCriteria&&this.isSecondCalShown()&&this.closedByDocOrDateClick){this.resetFireOnSelectCriteria()}if(a){this.parentOverlay.hide()}if(ta.has("guests_rooms_picker_3.enabled")&&!ta.has("hotels_left_filters_redesign")&&d){ta.widgets.calendar.displayStayInfoPicker()}},onCalendarOverlayShow:function(){ta.widgets.calendar.storePriorDates();this.inDate=this.getPageInDate();this.outDate=this.getPageOutDate();this.cursorLeftInitSel=false;this.bypassSecondCal=false;this.date=this.isIn?this.getPageInDate():this.getPageOutDate();if(ta.has("guests_rooms_picker_3.enabled")){this.setPredatesState();ta.widgets.calendar.updateGuestsRoomsPickerUI()}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.update();this.reposition();this.closedByDocOrDateClick=false;this.closedByDoc=false;var a=ta.id(this.positionElement).getParent("#hotels_lf_header_bar_wrap");if(ta.id(this.positionElement).getParent("#PERSISTENT_DATE_PICKER, #STATIC_DATE_PICKER_BAR.sticky")){ta.commerce.persistentdatepicker&&ta.commerce.persistentdatepicker.initCalendar(this)}else{if(ta.id(this.positionElement).getParent("#PERSISTENT_CHECK_RATES")||(a&&a.hasClass("fixed"))){var b=ta.id(this.positionElement).getCoordinates().top+29;if(typeof(isIPad)=="undefined"||!isIPad){b=b-window.getScrollTop()}if(a){b=this.positionElement.getCoordinates().bottom+7-(window.isTabletOnFullSite?0:window.getScrollTop())}ta.id(this.calendarOverlay.container).setStyles({position:"fixed",top:b,zindex:9997})}else{ta.id(this.calendarOverlay.container).setStyle("position","absolute")}}if(ta.retrieve("tablet_calendar_update.enabled")&&this.container){if(ta.retrieve("tablet_calendar_update_v2.enabled")){var f=window.innerWidth/document.documentElement.clientWidth;var c=Math.max(Math.min(Math.floor(150*f),150),100);this.container.setStyle("zoom",c+"%")}else{this.container.setStyle("zoom","150%")}if(this.calendarOverlay&&this.calendarOverlay.position){this.calendarOverlay.position()}}if(this.options.captureKeyEvents){try{this.keyEventListener=this.onCalendarOverlayKeyDown.bind(this);document.addEvent("keydown",this.keyEventListener)}catch(d){}}ta.id(this.positionElement).removeClass("date_picker_error");this.positionElement.blur();this.initTracking();this.updateInputStyling(true);window.fireEvent("onCalendarOverlayShow",this)},onDocumentClick:function(a){this.closedByDocOrDateClick=true;this.closedByDoc=true},onOutDateCalShow:function(a){ta.store("ta.calendar.isOutDateTrigger",true);this.calendarOverlay.show(a)},prev:function(){this.parent();this.resetStartRangeElem(false);var a=(this.currentMonth&&this.currentMonth.date?this.currentMonth.date.get("month"):"");ta.trackEventOnPage("DATEPICKER","PREV_MONTH",(this.isIn?"Checkin":"Checkout"),a)},removeErrorState:function(){if(ta.id("NO_DATES_ERROR")){ta.id("NO_DATES_ERROR").hide()}if(ta.id("calPnt")){ta.id("calPnt").removeClass("errorState")}var a=ta.find("#CHECK_RATES_CONT .date_picker_calendar_wrap");if(a){a.removeClass("errorState")}},resetDatepickerOnHover:function(){var d=this.getPageInDate();var c=this.getPageOutDate();var a=this.positionElement;if(!this.isIn){a=a.id.replace("date_picker_out","date_picker_in");if(a){a=ta.id(a)}}ta.widgets.calendar.updateDateDisplay(a,d,c);this.updateHoverElem();if(d){d=d.valueOf()}if(c){c=c.valueOf()}var b=document.getElements(".date_picker_calendar.overlay .calendar .today");var e=document.getElements(".date_picker_calendar.overlay .calendar .day");e.forEach(function(f){var g=f.getAttribute("value");if(g){g=parseInt(g);f=f.getParent();f.className="";if(d&&d==g){f.addClass("start")}else{if(c&&c==g){f.addClass("end")}}if(d&&c&&d<=g&&g<=c){f.addClass("prevSel")}}}.bind(this));b.addClass("today")},resetFireOnSelectCriteria:function(){ta.widgets.calendar.removeInOutCalendarSelected(this.isIn);ta.widgets.calendar.removeInOutCalendarSelected(!this.isIn)},resetStartRangeElem:function(e){if(!this.oneSelected){return}this.startRangeElem=false;this.clearSelectedDays();if(ta.util.i18n.isRtl()){e=!e}e?this.monthOffset++:this.monthOffset--;var b=this.calendarOverlay.container.getElements(".month");if(e){b.shift()}else{b.pop()}b.some(function(g,f){if(g){var h=ta.id(g).getElement("."+this.options.inDateClass);if(h){this.startRangeElem=h;return true}}return false},this);if(!this.startRangeElem){var a=false;if(this.monthOffset>0){var d=0;a=ta.id(b[d]).getElements("td");if(ta.util.i18n.isRtl()){a.reverse()}}else{var c=b.length-1;a=ta.id(b[c]).getElements("td");if(!ta.util.i18n.isRtl()){a.reverse()}}if(a){a.some(function(g,f){if(this.isValidDateElem(g)){this.startRangeElem=g;return true}return false},this)}}},selectLeftRightButtons:function(){var a={};if(this.options.useClassicSkin){a.leftIdle="classicLeftBtn";a.leftInactive="";a.rightIdle="classicRightBtn";a.rightInactive=""}else{a.leftIdle="sprite-date_picker-btnLeftIdle";a.leftInactive="sprite-date_picker-btnLeftInactive";a.rightIdle="sprite-date_picker-btnRightIdle";a.rightInactive="sprite-date_picker-btnRightInactive"}return a},setPageDates:function(b,a){ta.widgets.calendar.storePriorDates();if(b){ta.widgets.calendar.setPageInDate(b)}if(a){ta.widgets.calendar.setPageOutDate(a)}},setPermanent:function(b){if(this.calendarOverlay){this.calendarOverlay.options.permanent=b;this.calendarOverlay.options.pinnable=(b?ta.overlays.PINNABLE_ALWAYS:ta.overlays.PINNABLE_NEVER);var a=this.positionElement;if(this.positionElement&&!this.positionElement.hasClass("isPreDatesPermanent")){a=this.positionElement.getParent(".isPreDatesPermanent")}if(a){a.removeClass("isPreDatesPermanent")}}},setPositionElement:function(){if((ta.has("guests_rooms_picker_3.enabled")&&!ta.has("guests_rooms_picker_4.enabled")&&!ta.has("hotels_rgpicker_outofcalendar")&&!ta.has("hotels_left_filters_redesign"))&&this.options.creatorElem&&!this.options.creatorElem.getParent(".geoChkRates")&&!this.options.creatorElem.getParent("#PERSISTENT_DATE_PICKER")&&(this.options.creatorElem.getParent(".filterControls")||this.options.creatorElem.getParent(".jfy_header_dates_holder")||this.options.creatorElem.getParent(".meta_chevron_module_2014")||this.options.creatorElem.getParent("#HotelDateSearch")||(this.options.creatorElem.getParent(".baseHotelInfoLeft")))){this.positionElement=$$(".miniMetaShowHdr")[0];if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$(".hr_pre_date_minimalist .title")[0]}if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$(".legend.metaDatesChosen")[0]}if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$(".ShowUserReviews #DATE_FIELDS")[0]}if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$(".p13n_header_tab_wrap .tab0")[0]}if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$("#STYLE2HEADER_V3 h1")[0]}if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$("#HLDatesHeader")[0]}if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$(".change_dates_button")[0];if(!this.positionElement||!this.positionElement.isVisible()){this.positionElement=$$(".changeStayInfoButton")[0]}}}else{var a="date_picker_in_";if(!this.isIn){a="date_picker_out_"}this.positionElement=ta.id(a+this.crId+this.options.ext);if(!this.positionElement&&this.options.creatorElem.getParent("#PERSISTENT_DATE_PICKER")){this.positionElement=$$("#PERSISTENT_DATE_PICKER .bestPricesMsg")[0]}}if(!this.positionElement){ta.util.error.record(null,"ta.widgets.SingleDateCalendar.setPositionElement - this.positionElement is undefined",null,{},"WARN")}},setPredatesState:function(){if(this.inDate&&this.outDate){this.calendarOverlay.container.removeClass("predates")}else{this.calendarOverlay.container.addClass("predates")}},shouldFireOnSelect:function(){if(!this.onSelect){return false}return this.isSecondCalShown()&&this.calendarOverlay&&this.calendarOverlay.closedByDocClick},showCalendarOverlay:function(a){if(!this.calendarOverlay){return}if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")){this.calendarOverlay.options.activate=ta.overlays.ACTIVATE_CLICK}this.calendarOverlay.show(a);ta.fireEvent("calendarShown")},trackSelect:function(c){var e=ta.id(this.positionElement).get("id");if(!e){var d="date_picker_in_";if(!this.isIn){d="date_picker_out_"}e=d+this.crId+this.options.ext}var i=e.indexOf("_persist")>0;e=e.substring(e.length-3,e.length);var b="START";var f="DATES";var h=-1;if(e=="ond"){f="RoomTab"}if(c){b="SELECT";if(ta.retrieve("ta.calendar.isPriceOverlayCalendar")){f="PRICE_CALENDAR"}else{if(this.inDate&&this.outDate){var g=ta.util.date.getDaysInRange(this.inDate,this.outDate)-1;if(g>ta.util.date.MAX_STAY_DURATION_DAYS){f="DATES_OVER_30_DAYS"}}}}if(this.isIn&&this.today&&this.inDate){h=ta.util.date.getDaysInRange(this.today,this.inDate)-1}else{if(!this.isIn&&this.inDate&&this.outDate){h=ta.util.date.getDaysInRange(this.inDate,this.outDate)-1}}if(ta.retrieve("cal_xsell")){f="CalXSell"}if(f){f="|"+f}if(i){f="|Persistent"+f}if(ta.retrieve("isPricesTabDatePicker")){ta.remove("isPricesTabDatePicker");f+="|Tabs"}if(this.isIn){f="CheckIn"+f}else{f="CheckOut"+f}var a=this.getTrackingPrefix()+ta.widgets.calendar.getTrackingString();ta.widgets.calendar.trackCalendarEvent(a,b,f,h)},getTrackingPrefix:function(){return this.options.isVR?"VR_":""},updateDatepickerOnHover:function(d){var f=this.getPageInDate();var e=this.getPageOutDate();var b;if(this.isIn){f=d;if(e&&d.getTime()>=e.getTime()){e=null}b=this.positionElement}else{e=d;if(f&&d.getTime()<=f.getTime()){f=null}b=this.positionElement.id.replace("date_picker_out","date_picker_in");if(b){b=ta.id(b)}}ta.widgets.calendar.updateDateDisplay(b,f,e);f=this.getPageInDate();if(f){f=f.valueOf()}e=this.getPageOutDate();if(e){e=e.valueOf()}d=d.valueOf();var a=this.isIn?"end":"start";var c=document.getElements(".date_picker_calendar.overlay .calendar .today");var g=document.getElements(".date_picker_calendar.overlay .calendar .day");g.forEach(function(h){var i=h.getAttribute("value");if(i){i=parseInt(i);h=h.getParent();if(h.hasClass(a)){h.className="";h.addClass(a);if(this.isIn&&i<d||!this.isIn&&i>d){h.addClass("invalidPrevSel")}}else{h.className=""}if((this.isIn&&e&&e>=i&&i>=d&&e!=d)||(!this.isIn&&f&&f<=i&&i<=d&&f!=d)){h.addClass("prevSel")}}}.bind(this));c.addClass("today")},updateHoverElem:function(b){if(!this.calendarOverlay){return}var a="msdp_hover";var c=this.calendarOverlay.container.getElement("."+a);if(c){c.removeClass(a)}if(b&&b.getParent()){b.getParent().addClass(a)}},updateInputStyling:function(b){var a=this.positionElement.getParent();if(a){b?a.addClass("dualFieldOn"):a.removeClass("dualFieldOn")}},updateNumNights:function(){if(!ta.has("guests_rooms_picker_3.enabled")||!ta.widgets.calendar.hasPageDates()){return}var a=ta.widgets.calendar.getNumberOfNights(),b=$$(".grp-nights-value");if(b&&b.length>0){b.each(function(c){c.set("html",a)});ta.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".stayInfoContainer.nights",a)}},updatePrevNext:function(){var d=this.currentMonth.date;var c=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date;var h=ta.util.date.inSameMonth(d,this.options.firstDate);var g=ta.util.date.inSameMonth(c,this.options.lastDate);var f=function(n,m,l){if(!m||m.length==0){if(l==n.tagName){return n}}else{if(n.className&&(!l||l==n.tagName)){var o=-1;do{o=n.className.indexOf(m,o+1);if(o>=0&&(o==0||n.className.charCodeAt(o-1)==32)&&(o+m.length==n.className.length||n.className.charCodeAt(o+m.length)==32)){return n}}while(o>=0)}}for(var k=0;k<n.childNodes.length;k++){var j=f(n.childNodes[k],m,l);if(j){return j}}return null};var b=ta.id(f(this.container,"prev"));var a=ta.id(f(this.container,"next"));if(ta.util.i18n.isRtl()){b=ta.id(f(this.container,"next"));a=ta.id(f(this.container,"prev"));h=ta.util.date.inSameMonth(c,this.options.lastDate);g=ta.util.date.inSameMonth(d,this.options.firstDate)}var e=this.selectLeftRightButtons();if(h){b.addClass(e.leftInactive).removeClass(e.leftIdle).setStyle("cursor","default")}else{b.addClass(e.leftIdle).removeClass(e.leftInactive).setStyle("cursor","pointer")}if(g){a.addClass(e.rightInactive).removeClass(e.rightIdle).setStyle("cursor","default")}else{a.addClass(e.rightIdle).removeClass(e.rightInactive).setStyle("cursor","pointer")}},updateSelectedDays:function(c,b){this.clearSelectedDays();var a=this.startRangeElem;this.includeElemInRange(a,this.options.selectedHoverClass);if(c.getTime()>this.newInDate.getTime()){this.updateSelectedDaysHelper(a,b.parentNode,true,this.options.selectedHoverClass);this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionStartClass);this.options.selectionEndClass&&ta.id(b.parentNode).addClass(this.options.selectionEndClass)}else{this.updateSelectedDaysHelper(a,b.parentNode,false,this.options.selectedHoverClass);this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionEndClass);this.options.selectionEndClass&&ta.id(b.parentNode).addClass(this.options.selectionStartClass)}},updateSelectedDaysHelper:function(e,j,g,h){if(!e||e==j){return}var f="nextSibling";var k="firstChild";if(!g){f="previousSibling";k="lastChild"}var d=false;if(this.isValidDateElem(e[f])){d=e[f]}else{var a=e.parentNode;if(a&&a[f]){d=a[f][k]}else{if(a&&ta.id(a).getParent(".month")){var c=ta.id(a).getParent(".month");if(ta.util.i18n.isRtl()){f=(f=="previousSibling")?"nextSibling":"previousSibling"}var i=c[f];if(!i){return}var b=ta.id(i).getElements("td");if(!g){b.reverse()}b.some(function(m,l){if(this.isValidDateElem(m)){d=m;return true}return false},this)}}}this.includeElemInRange(d,h);this.updateSelectedDaysHelper(d,j,g,h)}})})();ta.widgets.tabContainer=function(d,i){var a=d.getElements(".current");if(a.length!=1){throw new Error("You must have exactly one tab with a class of 'current'.")}else{a=a[0]}var g=a.className.match(/tab(\d+)/);if(g!=null&&g.length>=2){var b=Number(g[1])}else{return}if($("HOMEPAGE")&&window.location.hash){var h=window.location.hash.match(/t(\d)/);if(h&&h.length>0){b=parseInt(h[1]);a.removeClass("current");d.getElements(".tab")[b].addClass("current")}}var c=d.getElements(".tabContainerHead .tab");if(c.length==0){return}var f=d.getElements(".tabContainerBody .tabContent");return new TabSet(c,f,{show:b,onActive:function(l,m,j){var n=m.hasClass("xhr");if(n&&!m.hasClass("xhrComplete")){var e=m.getElement("a").href;if(e){var k=m;j.addEvent("onContentReplaced",function(){k.addClass("xhrComplete")});ta.util.element.replaceContent(l,j,e)}}if(m.hasClass("recordAction")){new Request({url:"/ActionRecord?action="+m.id}).send()}m.addClass("current");if(n&&l){l.stop()}},onBackground:function(j,k,e){k.removeClass("current")}})};ta.widgets.Carousel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{width:50,height:50,padding:5,num:7,offset:0,horizontal:true},initialize:function(a,b){this.setOptions(b);this.container=a;this.viewport=this.container.getElement(".viewport");this.leftKnob=this.container.getElement(".shiftLeft");this.rightKnob=this.container.getElement(".shiftRight");this.images=this.viewport.getElements("img");this.offset=this.options.offset;if(this.options.horizontal){this.viewport.setStyles({width:this.options.width*this.options.num+this.options.padding*(this.options.num-1),height:this.options.height})}else{this.viewport.setStyles({width:this.options.width+this.options.padding*2,height:this.options.height*this.options.num+this.options.padding*(this.options.num-1)})}this.leftKnob.addEvent("click",this.shiftLeft);this.rightKnob.addEvent("click",this.shiftRight);this.render()},render:function(){var a=this.offset+this.options.num;for(var b=this.images.length-1;b>=0;b--){if(b<this.offset||b>=a){this.images[b].setStyle("left",-999)}else{if(this.options.horizontal){this.images[b].setStyle("left",(this.options.width+this.options.padding)*(b-this.offset))}else{this.images[b].setStyles({top:(this.options.height+this.options.padding)*(b-this.offset),left:0})}}}if(this.offset==0){this.leftKnob.addClass("disabled")}else{this.leftKnob.removeClass("disabled")}if(this.offset==this.images.length-this.options.num){this.rightKnob.addClass("disabled")}else{this.rightKnob.removeClass("disabled")}},shiftLeft:function(){var a=this.offset;this.offset=Math.max(0,this.offset-this.options.num);if(this.offset!=a){this.render()}},shiftRight:function(){var a=this.offset;this.offset=Math.min(this.offset+this.options.num,this.images.length-this.options.num);if(this.offset!=a){this.render()}}});define("ta/util/ActionRecord",["vanillajs","ta/util/Deferred","utils/ajax","ns-exporter","ta/Core/TA.Record"],function(f,g,h,i,d){var b={record:function e(m,l,k){return j("/ActionRecord",m,l,k)},recordPlus:function a(m,l,k){return j("/ActionRecordPlus",m,l,k)},recordPid:function c(k){new h("/ActionRecord?pid="+k)}};function j(p,r,o,l){var n=new g();if(!o){o={}}var q={url:o.url||p,method:o.method||"get",data:{action:r},success:function(k){o.onSuccess&&o.onSuccess(k);n.resolve(k)},error:function(k){o.onFailure&&o.onFailure(k);n.reject(k)}};for(var m in o){if(o.hasOwnProperty(m)&&!q.hasOwnProperty(m)){q[m]=o[m]}else{if(m=="data"){for(m in o.data){if(o.data.hasOwnProperty(m)){q.data[m]=o.data[m]}}}}}if(l){var s=d._toEvtParams(l);for(m in s){if(s.hasOwnProperty(m)){q.data[m]=s[m]}}}h(q);if(l){d._trackEventAfterAjax(l)}return n.promise()}i.exportTo(b,"ta.util.action");return b});define("ta/util/Partials",["ta/Core/TA.Store","ta/util/Error","ta/Browser","ta/Core/TA.Record","lib/jquery-amd","utils/ajax","utils/resourceLoader","ns-exporter"],function(w,j,i,u,h,n,q,v){var m=1000;var t=12;var p=0;var a=/<\!-- incomplete\: ([\w, ]*) -->/;var d=/<\!-- failed\: ([\w, ]*) -->/;var l=/<\!-- error -->/;var c=/<\!-- no Oauth Token -->/;var s=false;var f=[];function y(){p=0}function k(){var A=f.shift();if(A){b.apply(this,A)}}function e(A,D,B,C){f.push(arguments);if(p===0&&s){k()}}function b(B,E,C,D){if(p>t||B.length==0){o();return}p++;if(w.has("fb.partial.extraJS")){q.load(w.remove("fb.partial.extraJS"),{forceType:"js"})}if(w.has("fb.partial.extraCSS")){q.load(w.remove("fb.partial.extraCSS"),{forceType:"css"})}var A=w.remove("facebook.authcode.param");var F=h.extend({parts:B.join(","),requestUrl:w.retrieve("page.urlSafe")},E||{});if(A!=null){F.FBAuthCode=A}n({url:"/MultiPartAjax",method:"POST",data:F,dataType:"html",success:function(G){g(E,B,C,D,null,null,G)}})}function x(H,E,F){var G=F||{};p=0;if(!E||E.href==null){j.record(null,"handlePartialPaging elmt.href null:"+E,null,null);return false}/parts=([\w,]+)/.test(E.href);var D=RegExp.$1.split(",");w.store("partial.event.element",E);w.store("partial.event.params",F);var C=w.remove("facebook.authcode.param");var A=h.extend({requestUrl:w.retrieve("page.urlSafe")},G);var B=h.extend({},A);if(C!=null){A.FBAuthCode=C}n({url:E.href,method:"POST",data:A,dataType:"html",success:function(I){w.store("fb.partial.isHandlePartialPaging",true);g(B,D,"facebook",false,H,E,I)}});return false}function g(E,K,J,G,P,C,H){if(G){var F=g.bind(this,E,K,J,false,P,C,H);G(F,H,K,E,J,G);return}if(H.match(c)){if(w.remove("fb.partial.isHandlePartialPaging")){ta.support.Facebook.pageDataAvailable(P,C,E,H)}return}if(H.match(l)){if(w.has(J+".onPartialsError")){w.remove(J+".onPartialsError").forEach(function(Q){Q()})}return}var N=[];var I=[];if(H.match(a)){N=RegExp.$1.split(",")}if(H.match(d)){I=RegExp.$1.split(",")}if(w.has(J+".onDataAvail")){w.remove(J+".onDataAvail").forEach(function(Q){Q()})}var O=[];var B=null;var M=/<style[^>]*>([\s\S]*?)<\/style>/gi;while((B=M.exec(H))){O.push(B[1])}if(O.length>0){O=O.join("\n");var L=document.createElement("style");L.type="text/css";document.getElementsByTagName("head")[0].appendChild(L);if(i.isIE()&&!i.isIE11orHigher()){L.styleSheet.cssText=O}else{L.appendChild(document.createTextNode(O))}}var D=[];H=H.replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(Q,S,R){D.push(R+"\n");return""});D.forEach(function(R){if(window.execScript){window.execScript(R)}else{var Q=document.createElement("script");Q.setAttribute("type","text/javascript");Q.text=R;document.head.appendChild(Q);document.head.removeChild(Q)}});H=H.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi,"");var A=h("#PARTIAL_DATA");if(!A.length){A=h('<div id="PARTIAL_DATA" style="display:none"></div>');A.appendTo(document.body)}A.append(h("<div></div>").html(H).children());setTimeout(function(){r(K,J,N,I,A[0],E)},0)}function r(D,E,C,B,A,F){D.forEach(function(J){var M=E+".data.onAvail."+J;var O=C.indexOf(J);var I=B.indexOf(J)>=0;var N=w.remove(M);if(N){for(var L=0,K=N.length;L<K;L++){if(N[L](A,(O>=0),I)===false){N[L]=null}}N=N.filter(function(P){return !!P});if(O>=0){if(N.length>0){w.store(M,N)}else{C.splice(O,1);O=-1}}}if(O<0&&!I){w.keep("partials.pageProperties",J)}});var H="partials.data.onPage";var G=w.remove(H);if(G&&G.length){G.forEach(function(I){I()})}if(C.length>0){setTimeout(b.bind(this,C,F,E),m)}else{o()}}function o(){if(!s){s=true;var B=w.remove("partials.pageProperties");if(B&&B.length>0){var A="-"+B.sort().join("-")+"-";u.trackEventOnPage("social","show",A)}}y();k()}var z={incompleteDataRegex:a,failedDataRegex:d,partialsErrorRegex:l,noOauthTokenRegex:c,requestMorePartials:e,requestPartials:b,handlePartialPaging:x,handleLightbox:x};v.exportTo(z,"ta.util.partials");return z});define("ta/support/Facebook",["ta/Core/TA.Store","ta/util/Error","ta/util/ActionRecord","ta/Core/TA.Record","ta/util/Pending","ta/util/Partials","ta/util/Decoder","ta/util/Cookie","lib/jquery-amd","utils/ajax","ns-exporter"],function(f,S,ah,K,g,E,b,C,O,Q,i){var X="fb.login.stat.cache";var h=false;var ab=["email","user_hometown","user_friends","user_likes","user_location","user_status","user_photos"];var ao;var an=/<\!-- PREEMPTIVE RESPONSE -->/;var ap=/<\!-- no Oauth Token -->/;var A=4;var k=[];var c=false;var s=false;var W=false;function l(aq){if(c===false){s=true;c=aq}var ar=f.retrieve("facebook.data.request");if(W||k.length||(ar&&ar.length)){r()}}function r(){W=true;if(c&&!h){window.fbAsyncInit=ak;var aq=document.createElement("script");aq.setAttribute("type","text/javascript");aq.src=c;aq.async=true;document.head.appendChild(aq);c=false}}function j(aq){if(h){aq()}else{k.push(aq);r()}}function Y(){try{k.forEach(function(ar){ar()})}catch(aq){S.record(aq,"Error calling dequeueForFBReady")}k=[]}function q(aq){setTimeout(function(){g.lock("fb.revoke.lb",function(){g.unlock("fb.revoke")})},aq)}function w(aq){if(f.retrieve("facebook.session.available")){aq()}else{f.keep("facebook.onSessionAvail",aq);if(!h){r()}}}function R(aq){if(f.retrieve("facebook.session.available")===false){aq()}else{f.keep("facebook.onSessionUnavail",aq);if(!h){r()}}}function ak(){if(f.has("facebook.available")){return}g.multilock("facebook.data.canDisplay",p,2);if(f.has("facebook.iptiming")){ao={timers:f.retrieve("facebook.iptiming"),sent:{}}}if(!f.retrieve("facebook.invalidFBCreds")){n(true)}al();FB.init({appId:f.retrieve("facebook.appId"),status:!s,cookie:true,xfbml:!s,version:f.retrieve("facebook.apiVersion"),frictionlessRequests:!s,oauth:true});h=true;Y();if(!f.retrieve("facebook.disableLogin")){if(f.retrieve("facebook.skip.session.check")=="true"){J()}else{FB.getLoginStatus(d)}}else{if(!f.has("facebookuserid")){aj()}}}function u(at){var aq=f.retrieve("facebook.authFailed");var au=f.retrieve("facebook.authSuccess");var ar=at.authResponse;if(!ar){if(aq){aq()}return null}if("connected"===at.status){ar.uid=f.store("fb.auth.userId",ar.userID);ar.token=f.store("fb.auth.token",ar.accessToken);if(au){au()}return ar}if(aq){aq()}return null}function d(ar){var aq=u(ar);if(aq){if(f.has("cached.facebookuid")&&f.retrieve("cached.facebookuid")!==""+aq.uid){S.record(null,"Mismatched Facebook uid between cached value and authResponse. cached: "+f.retrieve("cached.facebookuid")+", response: "+aq.uid);f.store("facebook.preFailed",true);f.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()});H(v(aq));return}if(f.retrieve("facebook.invalidFBCreds")&&!f.retrieve("facebook.signout.process")){f.store("facebook.AuthCode.onAvail",J);H(v(aq))}else{J()}}else{if(!f.retrieve("facebook.invalidFBCreds")){f.store("facebook.preFailed",true);C.setOneTimeCookieOnFQDN("FacebookAuthCode2","NoFBSessionAvailable");Q("/ActionRecord?action=fb_cached_token_no_session")}aj()}}function n(aq){if(f.remove("facebook.data.initialRequest.failed")){V({pre:aq})}else{g.lock("facebook.data.initialRequest",V.bind({},{pre:aq}))}}function V(ar){if(!f.has("facebook.data.request")){return}if(ao&&!ao.timers.partials){ao.timers.partials=new Date().getTime()}var aq=f.retrieve("facebook.data.request");E.requestPartials(aq,O.extend({},ar||{},f.retrieve("facebook.data.params")),"facebook",D)}function H(au){var aq=f.retrieve("facebook.AuthCode.onAvail");if(aq!=null){f.store("facebook.authcode.param",au);C.setOneTimeCookieOnFQDN("FacebookAuthCode2",au);aq()}var at=f.retrieve("facebook.AuthCode.onAvail.needsReload");if(at!=null){C.setOneTimeCookieOnFQDN("FacebookAuthCode2","ConflictedFBAccount");if("function"!==typeof at){S.record(null,"needsReload was not a function.")}at();return}var ar=f.retrieve("facebook.AuthCode.onAvail.paging");if(ar!=null){f.store("facebook.authcode.param",au);C.setOneTimeCookieOnFQDN("FacebookAuthCode2",au);ar()}}function v(ar){var au=ae(ar.signedRequest).code;var at=f.remove("facebook.taServerTime");var aq=at-3600;var av=null;if(au&&!isNaN(aq)){av=au.split(".")}if(av!=null&&av.length>3&&!isNaN(av[3])&&av[3]<aq){S.record(null,"Facebook sending up expired Code: ",null,{code:au,serverTime:at})}return au}function ae(at){if(!at){return null}var aq=at.split(".",2);var au=aq[1];if(au){var ar=b.base64Decoder(au);try{return JSON.decode(ar)}catch(av){S.record(null,"couldn't parse Facebook SignedRequest to JSON object after decode ",null,{signedRequest:at,decoded:ar})}}else{S.record(null,"Facebook SignedRequest TA received doesn't contain data",null,{signedRequest:at})}}function D(aq,ar,at,aw,au,av){if(ar.match(an)&&f.remove("facebook.preFailed")){return}if(ar.match(ap)){delete aw.pre;var ax=E.requestPartials.bind(E,at,aw,au,av);f.store("facebook.AuthCode.onAvail",ax);ad()}f.store("facebook.data.handler",aq);if(f.retrieve("facebook.data.isShowDataOnce")){p()}else{g.unlock("facebook.data.canDisplay")}}function ad(){var aq=f.retrieve("fb.noOauthToken.counter");if(aq==null){aq=0}if(aq<A){f.store("fb.noOauthToken.counter",aq+1);FB.getLoginStatus(ac)}}function ac(ar){var aq=u(ar);if(aq){if(f.has("cached.facebookuid")&&f.retrieve("cached.facebookuid")!==""+aq.uid){S.record(null,"Mismatched Facebook uid between cached value and authResponse. cached: "+f.retrieve("cached.facebookuid")+", response: "+aq.uid);f.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()})}H(v(aq))}}function G(av,ar,au,aq){var at=E.handlePartialPaging.bind(E,av,ar,au);f.store("facebook.AuthCode.onAvail.paging",at);ad()}function p(){f.remove("facebook.data.handler")();if(!f.retrieve("facebook.data.isShowDataOnce")){f.store("facebook.data.isShowDataOnce",true);if(ao){var aq=new Date().getTime();y("GetPartials",aq-this.timers.partials);y("LoadAll",aq-this.timers.started)}}}function al(){f.store("facebook.available",true);if(f.has("facebook.onAvail")){f.remove("facebook.onAvail").forEach(function(aq){aq()})}}function J(){var aq=f.retrieve("facebook.session.available");f.store("facebook.session.available",true);if(ao){y("LoadPage",this.timers.loaded-this.timers.started)}if(f.has("facebook.onSessionAvail")){f.remove("facebook.onSessionAvail").forEach(function(ar){ar()})}if(!aq){g.unlock("facebook.data.canDisplay")}n(false)}function aj(){f.store("facebook.session.available",false);if(ao){y("LoadPage",this.timers.loaded-this.timers.started)}if(f.has("facebook.onSessionUnavail")){f.remove("facebook.onSessionUnavail").forEach(function(aq){aq()})}O("#HEAD .FB_login_button").on("click",function(){Q("/ActionRecord?action=FBC_Masthead")});O("#WoF_SigninLander .fbcBtnsmall").on("click",function(){Q("/ActionRecord?action=WoF_SigninLander")})}function ai(ar,au,at){var aq=f.retrieve("facebook.permissions");if(aq){if(aq.indexOf(ar)==-1){return at?at():null}return au?au():null}else{FB.api("/me/permissions",function(av){var aw=false;av.data.forEach(function(ax){if(ax.permission==ar&&ax.status==="granted"){aw=true}});if(aw&&au){au()}else{if(!aw&&at){at()}}})}}function z(aq,at,ar){U([aq],at,ar)}function ag(ar,aq){if(f.retrieve("facebook.session.available")&&ar){ar()}else{if(aq){aq()}}}function P(ar,aq){U()}function U(aD,aq,av,at,ar,aA,aF){var aA=!!aA;aD=(aD&&aD.length?aD:[]);if(ar!=null&&ar.length>0){f.store("facebook.flow",ar)}else{f.store("facebook.flow","FBC")}var aw=userLoggedIn?"Connect":"Login";var ax=aw=="Login"?"":f.retrieve("facebook.isFBC")=="true"?"Upgrade":"New";var az=(aF&&aF.pid)||f.retrieve("facebook.trackingpid");C.setPIDCookie(az);function au(aG,aH){return O.extend({module:aG,action:aH},az&&{value:az}||{})}ah.record("FacebookConnect",null,au("social",aw+"Attempt"+ax));var aE=function(){C.setPIDCookie(az);ah.record("FacebookConnect",null,au("social",aw+"Success"+ax));var aG={action:aw,userType:ax};if(aq){aq(aG)}};if(!userLoggedIn||!userFbConnected||at){B(aD,aE,av,at,aA,aF);return}var aC=B.bind({},aD,aE,av,aA,aF);var aB=function(){if(aE){aE()}};for(var ay=aD.length-1;ay>=0;--ay){aB=ai.bind({},aD[ay],aB,aC)}ag(aB,aC)}function N(ar,aq){var au={};var at=O("."+ar).prop("value");if(!at||!at.match(/.+\@.+\..+/)){O("."+aq).removeClass("hidden");return}if(at){au.email=at}L(null,null,false,au)}function am(au,aq,aw){if(!h){return}var av=function(ay){try{var ax=u(ay);if(!ax||!ax.token){aq&&aq(ax);return}var az=v(ax);if(az){C.setOneTimeCookieOnFQDN("FacebookAuthCode2",az);au&&au(ax)}else{aq&&aq(ax)}}catch(aA){S.record(aA,"fb.basicLogin callback failed")}};try{var ar=aw||{scope:ab.join(",")};FB.login(av,ar)}catch(at){S.record(at,"fb.basicLogin failed")}}function B(at,ax,aq,aw,ar,av){var au=aw;FB.login(function(az){var ay=u(az);if(ay&&ay.token){I();f.store("facebook.AuthCode.onAvail",function(){f.store("facebook.uid",ay.uid);L(au,ax,ar,av)});H(v(ay))}else{if(aq){aq()}}},{scope:ab.join(",")})}function I(){var aq=f.retrieve("facebook.trackingpid");if(aq){C.setPIDCookie(aq)}}function L(au,ax,ar,at){var av=!f.retrieve("facebook.session.available")||!userLoggedIn||!userFbConnected;at||(at={});var aq=at.pid;if(au!=null){av=av||au}if(av){var aw={flow:f.retrieve("facebook.flow"),noreload:ar};aq&&O.extend(aw,{pid:aq});f.store("facebook.session.available",true);f.store("registration.action","FB_CONNECT");ta.run("ta.overlays.registration.logAndPost",{},aw,"FBC-start",O.extend(at,{action:"FB_CONNECT"}))}ax&&ax()}function T(aq,ar){f.store("facebook.flow",aq);U(null,null,null,ar)}function M(){FB.logout(function(){window.location.reload()})}function t(aq){FB.logout(function(ar){userLoggedIn=false;f.store("facebook.session.available",false);f.store("facebook.isFBC",false);if(aq){aq(ar)}})}function x(){FB.logout(function(){ta.overlays.registration.post({action:"FB_LOGIN"})})}function a(){FB.api({method:"Auth.revokeAuthorization"})}function m(ay,aw,aA,av,at,aD,ax,au,aB,aq,az,aC,ar){FB.ui({method:"feed",message:ay,picture:aD,link:aw,name:aA,to:aB,caption:av,description:at,display:aq,properties:az,actions:[{name:ax,link:au}]},function(aE){if(aE&&aE.post_id){if(aC){aC(aE)}}else{if(aE&&!aE.post_id){S.record(null,"Facebook postWall error response from facebook",null,null)}else{if(ar){ar(aE)}}}})}function F(av,aq,ax,ay,at,aw,ar,au){FB.login(function(aA){var az=u(aA);if(az){if(az.token){Q("/ActionRecord?action=POSTTOWALL_GRANTED");m(av,aq,ax,ay,at,aw,ar,au)}}},{scope:"publish_stream"})}function aa(ar,at,aq){FB.login(function(av){var au=u(av);if(au){if(au.token){f.store("facebook.AuthCode.onAvail",function(){L(null,at)});H(v(au))}else{aq&&aq()}}},{scope:ar})}function e(ar,at,au,aq){f.store("facebook.flow",ar);aa(at,au,aq)}function Z(){try{ag(function(){M()},function(){window.location.reload()})}catch(aq){S.record(aq,"signoutAction - fb signout failed");window.location.reload()}}function o(aq){j(function(){FB.Event.subscribe("auth.statusChange",aq)})}function y(at,aq){if(!ao||ao.sent[at]){return}ao.sent[at]=true;aq=Math.round(aq/1000);var ar;if(aq<=10){ar=aq.toString()}else{if(aq>10&&aq<=15){ar="11-15"}else{if(aq>15&&aq<=20){ar="16-20"}else{ar="21+"}}}at+="_";at+=f.retrieve("facebook.session.available")?"IP_":"NonIP_";at+=ar+"_"+ao.timers.servletName;if(ao.timers.firstPage){at+="_FirstPage"}ah.record(at)}var af={loadSdkLite:l,enqueueForFBReady:j,dequeueForFBReady:Y,ipRevoke:q,enqueueForFBAvailable:w,enqueueForFBUnavailable:R,init:ak,transformToAuthResponse:u,receiveCode:H,getCodeFromOAuthResponse:v,parseFBSignedRequest:ae,dataAvailable:D,checkStatusAndGetCode:ac,pageDataAvailable:G,showData:p,sessionAvailable:J,havePermission:ai,requirePermission:z,ifLoggedIn:ag,loginButton:P,login:U,addEmailLogin:N,basicLogin:am,doLogin:B,fbcRegistration:L,loginWithFlow:T,logout:M,logoutNoRefresh:t,restart:x,revoke:a,postWall:m,publishStream:F,loginRequestSpecificPermission:aa,loginWithFlowAndRequest:e,signOutComplete:Z,enqueueListenForFBAuthChange:o};i.exportTo(af,"ta.support.Facebook");return af});require(["ta/rollupAmdShim"],function(a){a.install(["ta/util/extend"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"fb_graph",files:{js3:{src:{ta:{util:{extend:1}}}}},_:{baseUrl:"/"}})};define("ta/util/extend",["vanillajs","ns-exporter"],function(c,d){var a={};var b=function(e){this.constructor=e};a.extend=function(k,g){var f={};var l,m,j,h,e;for(h=1,e=arguments.length;h<e;h++){m=arguments[h];for(j in m){if(m.hasOwnProperty(j)){f[j]=m[j]}}if(m.hasOwnProperty("constructor")){f.constructor=m.constructor}}l=f.hasOwnProperty("constructor")?f.constructor:function(){return k.apply(this,arguments)};b.prototype=k.prototype;l.prototype=new b(l);l.prototype.__super__=k.prototype;for(j in f){l.prototype[j]=f[j]}return l};d.exportTo({extend:a.extend},"ta.util");return a});(function(d){d.fb||(d.fb={});var b=new RegExp(["User is already associated","Permissions error"].join("|"));var a=new RegExp(["Timeline is not activated","Requires extended permission","An unexpected error has occurred","An unknown error has occurred","load-error: unknown","Error validating access token","Object at URL.*requires an object of og:type","Could not retrieve data from URL","^unknown error"].join("|"));var c=/Temporarily Blocked/;d.fb.graph={api:function(i,k,j,g){var f=Array.prototype.slice.call(arguments);var e=d.util.Deferred();k||(k="get");j||(j={});g||(g={});g.recordErrors=(g.recordErrors!==false);(function h(l){FB.api(i,k,j,function(n){if(n&&!n.error){e.resolve(n)}else{var o={name:"None",message:"No FB.api response"};var m="ERROR";if(n&&n.error){o.name=n.error.type;o.message=(typeof n.error==="string")?n.error:n.error.message}if(l&&o.message.match("has og:type of '(?:tripadvisortravelmap|civ)")){j.scrape=true;h(false);return}if(a.test(o.message)){m="WARN"}if(g.recordErrors&&!b.test(o.message)){this.recordError(o,{FB_API_ARGS:f,FB_API_RESPONSE:n,FB_AUTH_RESPONSE:FB.getAuthResponse()},m)}e.reject(o)}}.bind(this))}.call(this,true));return e.promise()},remove:function(f,e){e||(e={});e.method="delete";return this.api("/"+f,"delete",e)},recordError:function(g,h,e){var f="ta.fb.graph.api";if(c.test(g.message)){f+=" blocked feature"}if(d.util.error){d.util.error.record(g,f,null,h,e)}return this}}}(ta));(function(a){a.fb.graph.Base=a.util.extend(Object,{constructor:function b(d,c){this.set(d);this.options=c||{};this.connections||(this.connections={})},set:function(d){for(var c in d){d.hasOwnProperty(c)&&(this[c]=d[c])}return this},api:function(c,f,e){if(!(this.id&&this.accessToken)){var d={name:"Missing auth credentials",message:"Facebook Graph object API calls require an id and access token"};a.fb.graph.recordError(d,{FB_ID:this.id,FB_ACCESS_TOKEN:this.accessToken,FB_API_ARGS:arguments},"WARN");return a.util.Deferred().reject(d)}c||(c="");if(/^\//.test(c)){c=c.slice(1)}e||(e={});e.access_token=this.accessToken;return a.fb.graph.api("/"+this.id+"/"+c,f,e)},getConnection:function(c){if(this.connections[c]){return new a.util.Deferred().resolve(this.connections[c])}return this.api(c).success(function(d){this.connections[c]=d.data;return a.util.Deferred().resolve(d.data)},this)},getClientConnection:function(c){if(!this.connections[c]){this.connections[c]=[];this.connections[c].all=false;this.connections[c].clientCount=0}return this.connections[c]},evictConnection:function(c){if(this.connections[c]){delete this.connections[c]}}})}(ta));ta.fb.graph.Application=ta.util.extend(ta.fb.graph.Base);(function(){ta.fb.openFeedDialog=function(b){var a=new ta.util.Deferred();b||(b={});b.method="feed";FB.ui(b,function(c){if(c&&c.post_id){a.resolve(c)}else{a.reject(c)}});return a.promise()}}());(function(a){a.fb.graph.mixin||(a.fb.graph.mixin={});var e=true;var b=true;var d=new RegExp(["Timeline is not activated","Requires extended permission"].join("|"));var c=300;a.fb.graph.mixin.OpenGraph={recordOpenGraph:function(g){var f=this.options.MapAction;if(f){Math.random()>0.2||f.record(g)}return this},getActions:function(f,g){f=this.options.appName+":"+f;var h=this.getClientConnection(f);if(h.all||(!g&&h.length>h.clientCount)){return a.util.Deferred().resolve(h)}return this.api(f,"get",{offset:h.length,limit:c}).success(function(i){Array.prototype.push.apply(h,i.data);if(!i.paging||(i.paging.previous&&!i.paging.next)){h.all=true}return a.util.Deferred(h)})},publishAction:function(g,j,i,h){if(!(a.retrieve("feature.ogPublish")&&e&&b)){return a.util.Deferred().reject("Publishing open graph actions is disabled.")}var f=this.options.appName;var k=this.options.ref;g=f+":"+g;h||(h={});h[j]=(!(/^http/).test(i)?"http://"+this.options.hostname:"")+i;if(k){h.ref=k+(h.ref?"__"+h.ref:"")}if(!a.retrieve("feature.openGraphLocationTagging")){delete h.place}var l=this.api(g,"POST",h).success(function(m){var o=this.getClientConnection(g);var n={id:m.id,data:{}};n.data[j]={url:h[j]};o.splice(o.clientCount,0,n);o.clientCount++;this.recordOpenGraph("OpenGraph_"+g)},this).failure(function(m){if(d.test(m.message)){e=false}});return l},publishLocatedAction:function(i,h,g,f){f||(f={});f.place=(!(/^http/).test(g)?"http://"+this.options.hostname:"")+g;return this.publishAction(i,h,g,f)},deleteActionsByObject:function(h,j,i){var g=this;if(+i!=i){i=(!(/^http/).test(i)?"http://"+this.options.hostname:"")+i}var k=Array.prototype.each?"each":"forEach";return(function f(l){return g.getActions(h,{next:l}).success(function(r){if(!r.all){return f(true)}var m=a.util.Deferred();var q=[];var p,n,o;for(o=0;o<r.length;o++){p=r[o];n=p.data[j];if(n&&(n.url==i||n.id==i)){q.push(p)}}if(!q.length){return m.resolve()}q[k](function(s){a.fb.graph.api(s.id,"delete").success(function(){q.splice(q.indexOf(s),1);var t=r.indexOf(s);r.splice(t,1);if(t<r.clientCount){r.clientCount--}if(!q.length){m.resolve()}}).failure(function(){m.reject()})});return m.promise()},this)}(false))},scrape:function(f){return a.fb.graph.api("/","post",{id:f,scrape:true})},setPublishState:function(f){e=!!f;b=!!f}}}(ta));(function(a){a.fb.graph.mixin||(a.fb.graph.mixin={});a.fb.graph.mixin.Feed={postLink:function(){},postStatus:function(){},postCheckin:function(){},postPhoto:function(){},postVideo:function(){},postFeed:function(b){return this.api("feed","POST",b)}}}(ta));(function(a){a.fb.graph.User=a.util.extend(a.fb.graph.Base,a.fb.graph.mixin.OpenGraph,a.fb.graph.mixin.Feed)}(ta));ta.fb.graph.User.prototype.inviteFriends=(function(b){var d=50;function a(e,f,i,h,g){var j=e.splice(0,d);g||(g=[]);FB.ui({method:"apprequests",message:f||"",title:i||"",new_style_message:true,to:j.join(",")},function(k){if(k&&k.to&&k.to.length){g.push.apply(g,k.to);if(!e.length){a(e,f,i,h,g)}else{h.resolve(g,k)}}else{h.reject(g,k)}})}return function c(f,g,h){var e=b.util.Deferred();a(f,g,h,e);return e.promise()}}(ta));ta.fb.graph.User.prototype.getAppRequests=function(a){if(!a&&this.appRequests){return ta.util.Deferred().resolve(this.appRequests)}return this.api("apprequests").success(function(b){this.appRequests=b},this)};ta.fb.graph.User.prototype.recordAndDeleteAppRequests=function(d,c,f){var a=this;d||(d=[]);if(!c){var b=window.location.search.match(/[?&](?:ref|fb_source)=([^&]*)/);c=b&&b[1]}function e(h){var j=[];var i=0;var g=ta.util.Deferred();h.each(function(l){var k="";ta.fb.graph.api("/"+l,"get").success(function(m){if(m&&m.from&&m.from.id){k=m.from.id}}).always(function(){ta.fb.graph.api("/"+l,"delete",null,{recordErrors:false});j.push((f?f+"_":"")+"AppRequestId_"+l+"_"+k);i++;if(i==h.length){if(a.options.MapAction&&j.length){a.options.MapAction.record(j.join(",")).success(function(){g.resolve()}).failure(function(){g.reject()})}else{g.resolve()}}})});return g.promise()}if(c=="bookmarks"){return this.getAppRequests().success(function(g){g.data.each(function(h){var i=h.id.split("_")[0];~d.indexOf(i)||d.push(i)})}).always(function(){return e(d)})}return e(d)};(function(a){var b=10000;a.fb.graph.TAUser=a.util.extend(a.fb.graph.User,{locationToOgType:function(c){return/^g(?:eo)?|10004/.test(c)?"city":/^a(?:ttraction)?|10021/.test(c)?"attraction":/^e(?:atery)?|10022/.test(c)?"restaurant":/^h(?:otel)?|^lodging|10023/.test(c)?"hotel":null},pin:function(c,f,m){m||(m={});var k=a.util.Deferred();var e=false;var d,h,i,l;if(c){d=this.locationToOgType(c.type);h=c.url}if(!(d&&c.url&&f&&f.length)){return k.reject()}i=!!(this.location&&this.location.latitude&&this.location.longitude);l=!!(this.hometown&&this.hometown.latitude&&this.hometown.longitude);var j=Array.prototype.each?"each":"forEach";var g=0;f[j](function(o){var q=o=="been"?"pin":o;var p={};var r=false;if(a.retrieve("feature.ogRefContainsFbid")){p.ref="fbid="+this.id}if(q=="pin"){var n={};var s;if(i){n.lat=this.location.latitude;n.lng=this.location.longitude}else{if(l){n.lat=this.hometown.latitude;n.lng=this.hometown.latitude}}s=a.travelmap.util.getDistance(c,n,this.locale);if(s){p.distance=s.value;p.distance_unit=s.unit;p.cur_loc_used=i}}else{if(q=="going"){p.end_time="5000-01-01"}}if(m.suppressFeed||(q=="pin"&&f.length>1)){p.no_feed_story=1}if(m.suppressMap||d!="city"||q=="going"||!c.redistributable||q=="pin"&&f.length>1){r=true}this[r?"publishAction":"publishLocatedAction"](q,d,h,p).failure(function(){e=true}).always(function(){if(++g==f.length){k[e?"reject":"resolve"]()}})},this);return k.promise()},visit:function(e,h,g,d){var c=a.util.Deferred();var f={};var i=h.join(",");f.tags=i;if(g){f["fb:explicitly_shared"]=true}this.publishLocatedAction("visit","city",e,f);return c.promise()},removePin:function(e,j){var c=a.util.Deferred();var d=false;var g,f;if(e){g=this.locationToOgType(e.type);f=e.url}if(!(g&&e.url&&j&&j.length)){return c.reject()}var i=Array.prototype.each?"each":"forEach";var h=0;j[i](function(k){var l=k=="been"?"pin":k;var m={};this.deleteActionsByObject(l,g,f).failure(function(){d=true}).always(function(){if(++h==j.length){c[d?"reject":"resolve"]()}})},this);return c.promise()},removeBadge:function(c){var d=false;var f,e;if(c){var f="badge";var e="/MemberTravelMap?ns=badge&badgeId="+c.id}if(!(f&&e)){return new a.util.Deferred().reject()}return this.deleteActionsByObject("earn",f,e)},rate:function(c){var g="rate";var f="attraction";var e=c.url;var d={};if(a.retrieve("feature.ogRefContainsFbid")){d.ref="fbid="+this.id}return this[c.redistributable?"publishLocatedAction":"publishAction"](g,f,e,d)},review:function(e,h,c){var g="review";var f="";if(e.indexOf("/Attraction")==0){f="attraction"}else{if(e.indexOf("/Hotel")==0){f="hotel"}else{if(e.indexOf("/Restaurant")==0){f="restaurant"}}}var d={title:h,body:c};d["fb:explicitly_shared"]=true;return this.publishAction(g,f,e,d)},earnBadge:function(c,f,i){var h="earn";var g="badge";var e="/MemberTravelMap?ns=badge&badgeId="+c;var d={};if(f){d["fb:explicitly_shared"]=true;e+="&story_type=badge_explicit_og"}if(i){d.no_feed_story=true}return this.publishAction(h,g,e,d)},endorseFriend:function(d,c){var h="endorse";var g="friend";var f="/MemberTravelMap?ns=friend&serial="+d;var e={city:"http://"+this.options.hostname+c};return this.publishAction(h,g,f,e)},updateMap:function(c){this._needToScrapeMap=true;if(this._intervalID&&!c){return a.util.Deferred().resolve()}this._intervalID||(this._intervalID=window.setInterval(this.scrapeMap.bind(this),b));return this.options.MapAction.getTravelMapMetaData().always(function(d){var h="publish";var g="map";var f="/MemberTravelMap?ns=map&uid="+this.options.guid;var e={};if(d&&d.tmTotalDistance){e={total_distance:Math.round(d.tmTotalDistance),distance_unit:d.tmDistanceUnit}}if(a.retrieve("feature.ogRefContainsFbid")){e.ref="fbid="+this.id}if(c){e["fb:explicitly_shared"]=true;f+="&story_type=map_explicit_og"}return this.publishAction(h,g,f,e)},this)},shareMapLink:function(){var c={};c.name=tm.hub.messages.myTravelMap;c.link="http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid+"&story_type=map_link";c.picture="http://"+this.options.hostname+"/img2/facebook/dlRecentPinned.jpg";return this.postFeed(c)},scrapeMap:function(c){if(this._needToScrapeMap||c){this._needToScrapeMap=false;return this.scrape("http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid)}return a.util.Deferred().resolve()}})}(ta));ta.common.wisdomoffriends={reloadASAP:function(){window.location.reload()},showWelcome:function(){ta.store("wof.showWelcome",true)}};define("ta/popups/SlotSet",["vanillajs","api-mod","ta/util/Error"],function(d,c,a){function b(){this.nW=525;this.nH=460;this.nXI=24;this.nYI=24;this.totalSlots=20;this.slots=[];try{if(screen.width>1024){this.nW=800;this.nH=600;this.nXI=80;this.nYI=40}else{if(screen.width>800){this.nW=620;this.nH=500;this.nXI=60;this.nYI=30}}}catch(f){this.error=f;a.record(this.error,"slot set",null,{"slot set":"general"})}this.getOpenSlot=function(l){if(!l||l<0||l>this.totalSlots){l=0}var k=function(q){try{var m=false;var o=false;try{o=this.slots[q].occupied}catch(p){}if(!o){m=true}else{try{var i=o.windowObject;if(!i||i.closed){m=true}}catch(p){m=true}}}catch(p){a.record(p,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:q})}if(m){this.slots[q].occupied=null;var n=this.slots[q];n.slotPos=q;return n}return false}.bind(this);try{var g,j;for(g=l-1;g>=0;g-=1){j=k(g);if(j){return j}}for(g=l;g<this.slots.length;g++){j=k(g);if(j){return j}}}catch(h){a.record(h,"get open slot",null,{totalSlots:this.totalSlots})}return false}}return b});define("ta/popups/Slot",["vanillajs"],function(a){function b(e,d,f,c){this.x=e;this.y=d;this.w=f;this.h=c;this.occupied=null}return b});define("ta/popups/PopupSlotSet",["vanillajs","api-mod","ta/util/Error","ta/popups/SlotSet","ta/popups/Slot"],function(d,c,a,b,e){function f(){c.mixin(this,new b());this.nX=500;var h=1160;try{if(screen.width<1660){if(screen.width>1024&&screen.width<1280){h=960}else{if(screen.width<=1024){h=740}}this.nX=screen.width-h}this.nY=!isNaN(window.screenTop)?window.screenTop:!isNaN(window.screenY)?window.screenY:0}catch(j){this.error=j;this.nY=0;a.record(this.error,"slot set",null,{"slot set":"popup"})}for(var g=0;g<this.totalSlots;g++){this.slots[g]=new e(this.nX,this.nY,this.nW,this.nH);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}return f});define("ta/popups/PopunderSlot",["vanillajs","api-mod","ta/popups/Slot"],function(c,b,d){function a(f,m,i,k,g,e,j,l){b.mixin(this,new d(f,m,i,k));this.tx=g;this.ty=e;this.tw=j;this.th=l}return a});define("ta/popups/PopunderSlotSet",["vanillajs","api-mod","ta/util/Error","utils/browserutils","ta/popups/PopupSlotSet","ta/popups/PopunderSlot"],function(e,d,b,g,f,c){function a(){d.mixin(this,new f());try{this.nX=(window.screenLeft||window.screenX);this.nY=(window.screenTop||window.screenY)}catch(j){this.error=j;this.nX=200;this.nY=200}this.w=1;this.h=1;this.x=5000;this.y=5000;this.totalSlots=4;try{if(g.ie7){this.w=250;this.h=100}if(g.safari||g.chrome){this.w=85;this.h=100}if(typeof(this.nX)=="undefined"){this.nX=0;this.nY=0;this.x=this.nX+window.screen.availWidth-this.w;this.y=this.nY+window.screen.availHeight-this.h}else{this.x=this.nX+window.getWidth()-this.w;this.y=this.nY+window.getHeight()-this.h}if(g.ie7){this.y=this.y-95;this.x=this.x+13}else{if(g.safari||g.chrome){this.y=this.y-16}}}catch(j){this.error=j}if(this.error){b.record(this.error,"slot set",null,{"slot set":"popunder"})}for(var h=0;h<this.totalSlots;h++){this.slots[h]=new c(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}return a});define("ta/popups/TAPopWindow",["vanillajs","api-mod","ta/util/Error","ta/Core/TA.Store","ta/util/Cookie","utils/browserutils","ta/Core/TA.Record","ta/Browser"],function(g,f,c,d,b,i,e,h){function a(j){this.options={name:"TAWin",url:"",windowHook:false,customWidth:false,customHeight:false,toolbar:1,location:1,directories:1,status:1,menubar:h.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:false,alwaysLowered:false,widthOffset:8,heightOffset:164,delayLoad:false};this.init=function(p,s){var m,r,l;f.merge(this.options,s);this.type=p;this.assignSlot();if(this.options.customWidth){this.width=this.options.customWidth}if(this.options.customHeight){this.height=this.options.customHeight}if(this.options.widthOffset!=null){this.widthOffset=this.options.widthOffset}if(this.options.heightOffset!=null){this.heightOffset=this.options.heightOffset}if(this.options.delayLoad){this.delayLoad=this.options.delayLoad}if(this.options.windowHook){this.windowObject=this.options.windowHook;if(!d.has("checkrates.add_holding_windows")){this.windowObject.refresh()}return true}if(d.has("checkrates.chrome_dates_entry_holding")){this.options.scrollbars=0}this.url=this.options.url;this.assignWinArgs();try{if(this.type==j.windowType.HOLDING){b.setPIDCookie(28962)}if(i.chrome&&this.options.inTab){var o=Math.random().toString(36).substring(7);if(this.options.popunder){m=document.createElement("a");m.href=this.url;m.target=o;document.body.appendChild(m);r=document.createEvent("MouseEvents");r.initMouseEvent("click",false,true,window,0,0,0,0,0,true,false,false,true,0,null);m.dispatchEvent(r);m.parentNode.removeChild(m);this.windowObject=window.open(this.url,o);return}else{this.windowObject=window.open(this.url,o);return}}if(d.has("checkrates.use_chrome_provider_on_shift_click")){m=document.createElement("a");m.href=this.url;document.body.appendChild(m);r=document.createEvent("MouseEvents");r.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,true,false,0,null);this.windowObject=m.dispatchEvent(r);m.parentNode.removeChild(m)}else{if(this.type==j.windowType.HOLDING&&d.has("popunder.popunder_by_self_focus")){window.open("javascript:window.focus()","_self","")}var k=i.chrome&&i.version>31;if(k){this.windowObject=window.open("","_blank")}else{if(this.options.popunder){if(i.ie8||i.ie9||i.ie10||i.ie11){this.windowObject=window.open("pages/blank.html","_blank",this.winArgs);window.document.focus()}else{if(i.safari&&i.Platform.name!=="ios"){this.windowObject=window.open("","_blank",this.winArgs);if(this.windowObject){var q=window.open("","_blank");q.close()}window.focus()}else{if(i.firefox){this.windowObject=window.open("","_blank",this.winArgs);window.open("","_self","");window.focus()}else{this.windowObject=window.open("","_blank",this.winArgs)}}}}else{this.windowObject=window.open("","_blank",this.winArgs)}}l=this.windowObject;if(l&&this.isTAWindow()){if(this.type==j.windowType.CHECK_RATE){j.pollForPartnerLoad(l,new Date(),this.options.name,j.extractSlotFromCommerceUrl(this.options.url))}if(!this.delayLoad){j.redirectToUrl(this.windowObject,this.url)}}else{if(!l&&i.ie&&this.type===j.windowType.CHECK_RATE&&this.url&&d.has("ta.ie_commerce_popup_block_fix")){b.setPIDCookie(38822);window.location=this.url}}}}catch(n){this.errorOpening=n;c.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}try{l=this.windowObject;if(l&&this.isTAWindow()){if(this.type==j.windowType.HOLDING){this.moveBehindMain(l)}}}catch(n){this.errorMoving=n;c.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}};this.repurpose=function(n,l,o){if(this.type==j.windowType.HOLDING){this.type=j.windowType.CHECK_RATE;this.slot.occupied=false;this.assignSlot();this.url=n;if(l){this.width=l;this.options.widthOffset=0}if(o){this.height=o;this.options.heightOffset=0}var k=this.windowObject;if(k&&this.isTAWindow()){try{if(!this.options.inTab){k.moveTo(0,0);k.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset);k.moveTo(this.x,this.y)}if(!this.delayLoad&&!this.options.keepFocus){k.focus()}if(!this.delayLoad){k.location=this.url}}catch(m){c.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}}return this}return false};this.assignWinArgs=function(){this.winArgs="toolbar="+this.options.toolbar;this.winArgs+=",location="+this.options.location;this.winArgs+=",directories="+this.options.directories;this.winArgs+=",status="+this.options.status;this.winArgs+=",menubar="+this.options.menubar;this.winArgs+=",resizable="+this.options.resizable;this.winArgs+=",copyhistory="+this.options.copyhistory;this.winArgs+=",scrollbars="+this.options.scrollbars;this.winArgs+=",width="+this.width;this.winArgs+=",height="+this.height;this.winArgs+=",left="+this.x;this.winArgs+=",top="+this.y;this.winArgs+=",screenx="+this.x;this.winArgs+=",screeny="+this.y;if(this.options.alwaysRaised){this.winArgs+=",alwaysRaised"}if(this.options.alwaysLowered){this.winArgs+=",alwaysLowered"}};this.assignSlot=function(){if(this.type==j.windowType.HOLDING){this.slot=j.getPopunderSlots().getOpenSlot();this.width=this.slot.tw;this.height=this.slot.th;this.x=this.slot.tx;this.y=this.slot.ty}else{this.slot=j.getPopupSlots().getOpenSlot();this.width=this.slot.w+this.options.widthOffset;this.height=this.slot.h+this.options.heightOffset;this.x=this.slot.x;this.y=this.slot.y}this.slot.occupied=this};this.moveBehindMain=function(m){if(!d.has("popunder.popunder_by_self_focus")||d.has("popunder.popunder_by_self_focus_shift_ctrl")){if(d.has("checkrates.cr_popunder_by_shift_ctrl")&&i.version>23){j.openCloseTab()}else{if(d.has("checkrates.chrome_dates_entry_holding")&&!(d.has("checkrates.belligerent_hw")&&i.version>22)){try{var k=window.open("about:blank");if(k){k.focus();k.close()}}catch(l){c.record(l,"holdingWindow - Chrome blur failed")}}}}m.blur();m.opener=self;m.moveTo(this.slot.x,this.slot.y);m.resizeTo(this.slot.w,this.slot.h);if(!this.delayLoad){m.location=this.url}window.focus();if(!f.hasClass(document.activeElement,"globalNav2011_reset")){e.trackEventOnPage("checkrates","no_focus_on_main",i.version,1)}};this.isTAWindow=function(){var m=true;try{var k=this.windowObject.location;this.windowObject.status="";if(k===null||k===""){m=false}}catch(l){m=false}return m}}return a});require(["ta/rollupAmdShim"],function(a){a.install(["ta/popups/PopUtil"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-popups",files:{js3:{src:{ta:{popups:{PopUtil:1}}}}},_:{baseUrl:"/"}})};define("ta/popups/PopUtil",["vanillajs","ns-exporter","utils/browserutils","ta/util/Cookie","ta/util/Error","ta/Core/TA.Record","ta/Browser","ta/Core/TA.Store","ta/popups/PopupSlotSet","ta/popups/PopunderSlotSet","ta/popups/TAPopWindow"],function(e,p,q,b,f,m,o,k,i,h,a){var n=[];var c=null;var g=null;var j=2;function d(s,u){u=u||{};var r=new a(l);r.init(s,u);if(!r.errorOpening&&!r.errorMoving&&r.windowObject){try{if(k.has("checkrates.add_holding_windows")&&u.windowHook&&u.windowHook.location&&u.windowHook.location.href.test(/RuleBasedPopunder/)){n.unshift(r)}else{n.push(r)}if(!u.windowHook&&s==l.windowType.HOLDING){this.trackPopunder(u.url,l.numPopundersCheck())}return r}catch(t){f.record(t,"Window Popup - could not register new window")}}return false}var l={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4,COOKIE:5},maxPopunders:4,tryHoldingWindows:function(r,s){try{var w=true;for(var t=0;t<s;t++){var v=this.launchHoldingWindow(r);if(!v.windowObject){w=false}}if(w){return true}}catch(u){f.record(u,"try two hw")}return false},getPopunderSlots:function(){if(c===null){c=new h()}return c},getPopupSlots:function(){if(g===null){g=new i()}return g},createCheckRatesWindow:function(r){return d(this.windowType.CHECK_RATE,r)},createHoldingWindow:function(r){return d(this.windowType.HOLDING,r)},createVFMWindow:function(r){return d(this.windowType.VFM,r)},createCookieConsentWindow:function(r){return d(this.windowType.COOKIE,r)},getHoldingWindowSet:function(){var v=[];for(var s=0;s<n.length;s++){var r=n[s];if(r&&r.type==this.windowType.HOLDING){var t=r.windowObject;if(t&&"closed" in t){if(!t.closed){v[v.length]=r}else{if(k.has("checkrates.add_holding_windows")&&t.closed){var u=window.cookieDomain;if(u){b.write("CommercePopunder","SuppressAll",0,u)}}}}}}return v},attemptHoldingWindowWNumChecked:function(){},openCloseTab:function(){var t,u;if(k.has("popunder.popunder_by_self_closing_tab")){try{u=document.createElement("a");u.href="http://"+window.location.hostname+"/vpages/tab.html";document.body.appendChild(u);t=document.createEvent("MouseEvents");t.initMouseEvent("click",false,true,window,0,0,0,0,0,true,false,false,true,0,null);u.dispatchEvent(t);u.parentNode.removeChild(u)}catch(x){f.record(x,"self-closing tab blur method failed")}}else{if(k.has("checkrates.cr_popunder_by_shift_ctrl")&&q.version>23){try{u=document.createElement("a");u.href="about:blank";u.target="popunderwindowhelper";document.body.appendChild(u);t=document.createEvent("MouseEvents");var v=true;var s=true;t.initMouseEvent("click",v,s,window,0,0,0,0,0,true,false,false,true,0,null);u.dispatchEvent(t);u.parentNode.removeChild(u);window.open("about:blank","popunderwindowhelper").close()}catch(x){f.record(x,"shift-ctrl blur method failed")}}else{var r=k.retrieve("checkrates.popunder");if(k.has("checkrates.belligerent_hw")&&r&&q.version>22){var w=window.open("about:blank");if(w){w.close()}k.remove("checkrates.popunder");try{if(r.windowObject&&r.isTAWindow()){r.moveBehindMain(r.windowObject)}}catch(x){f.record(x,"holding window blur")}}}}},attemptHoldingWindow:function(r){if(this.useShiftClick()){return}if(k.has("checkrates.add_holding_windows")){var s=this.numPopundersCheck();if(s<this.maxPopunders){this.launchHoldingWindow(r)}}else{if(j>this.getHoldingWindowSet().length){this.launchHoldingWindow(r)}}},launchHoldingWindow:function(r){if(!r){return false}var s=k.retrieve("checkrates.holdingWindowURI");if(k.has("checkrates.avlb_popup_win")){s="http://"+window.location.hostname+"/AlsoViewedLB?checkRatesType=checkRates&avlbType=popup&d="+r}if(s){k.store("checkrates.HWtracking","date");var t={url:s};return this.createHoldingWindow(t)}return false},launchAddHoldingWindow:function(t,r){var s=r||{};s.url=t;return this.createHoldingWindow(s)},popunderReminder:function(s){var r={windowHook:s};this.createHoldingWindow(r)},numPopundersCheck:function(){try{var v=this.getHoldingWindowSet();var s=0;var r=b.readRaw("CommercePopunder");var u=r?r.match(/\d+/):null;if(!r||!u){s=v.length}else{s=Math.max(v.length,parseInt(u[0],10))}return s}catch(t){f.record(t,"CommercePopunder - numPopundersCheck")}},trackPopunder:function(y,x){try{if(!x||!y){return}var t="CommerceEnhancedPopunder";if(y.match(/AlsoViewedLB/)){t="AlsoViewedLB"}else{var r=y.match(/RuleBasedPopunder\?Rule=\d+/);if(r){var u=r[0].match(/\d+/);t="RuleBasedPopunder_"+u[0]}}var s="OpenWindow";var w=k.retrieve("checkrates.HWtracking");if(w){s="OpenWindow_"+w;k.remove("checkrates.HWtracking")}m.trackEventOnPage("CommercePopunder",s,t,x,true)}catch(v){f.record(v,"CommercePopunder - trackPopunder")}},getProviderWindowDims:function(r,u){var s=null;var w=null;var v=null;var t=null;if(r=="hotels.com"){s=975}if(screen.width>=1280){s=1000;w=897;if(!u){v=0;t=0;if(q.chrome){w-=50}else{if(q.firefox){w-=87}else{if(q.ie){s-=12;w-=179}}}}}return{customWidth:s,customHeight:w,widthOffset:v,heightOffset:t}},useShiftClick:function(){if(k.has("checkrates.chrome_provider_on_shift_click")){var s=this.getProviderWindowDims();var r=66;if(((window.outerHeight>s.customHeight)||(window.outerWidth>s.customWidth))&&((window.outerHeight<(screen.height-r))&&(window.outerWidth<(screen.width-r)))){k.store("checkrates.use_chrome_provider_on_shift_click",true);return true}}if(!k.has("checkrates.cr_provider_on_mousedown")){k.remove("checkrates.use_chrome_provider_on_shift_click")}return false},expandSidebarWindow:function(t,r,s){m.trackEventOnPage("traffic_acquisition_sidebar","any",r,1);if(s=="true"){window.moveTo(0,0);window.resizeTo(screen.width,screen.height)}document.getElementById("SliderHolder").style.display="none";document.getElementById("PAGE").style.marginLeft="0px"},cookieSettingsPanel:function(u){if(u){u.stop()}var r={en:451,en_UK:834,en_IE:835,en_ZA:2635,sv:720,no:721,da:1199,fr:1197,fr_BE:6409,fr_CH:6410,de:1201,de_AT:2719,de_CH:6431,el:1198,it:1202,it_CH:6432,es:1200,pl:1208,nl:1209,nl_BE:6411,fi:2968,hu:3049,cs:3128,sk:3233,pt_PT:13938,"default":451};var s=r[window.posLocale]||r["default"];var t={customWidth:830,customHeight:620,name:"Cookie Consent Tool",url:"http://info.evidon.com/pub_info/"+s+"?v=1&nt=0",scrollbars:1,menubar:0,toolbar:0,left:0,top:0};l.createCookieConsentWindow(t)},newWindowFromExitPop:function(s,r){var t=window.open(r,"_blank","height="+screen.height+",width="+screen.width+",toolbar=yes,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes");if(window.focus){t.focus()}},pollForPartnerLoad:function(s,t,u,v,r){if(s){setTimeout(function(){var x=null;var w=new Date().getTime()-t.getTime();try{x=s.document}catch(y){}if(!x){m.trackEventOnPage("COMMERCE_CLICK","PROVIDER_LOADED",(r||window.pageServlet||"")+"|"+(v||"")+"|"+(u||""),w)}else{if(w>20000){m.trackEventOnPage("COMMERCE_CLICK","PROVIDER_TIMEOUT",(u||""),w)}else{if(s.closed){m.trackEventOnPage("COMMERCE_CLICK","PROVIDER_CLOSED",(u||""),w)}else{l.pollForPartnerLoad(s,t,u,v,r)}}}},100)}},extractSlotFromCommerceUrl:function(s){if(!s){return 0}var r=s.match("[&|\\?]slot=([^&]*)");return r?r[1]:0},redirectToUrl:function(r,t){if(r){if(k.retrieve("commerce_history_injection.enabled")&&r.history&&r.history.pushState){try{r.history.pushState({fromBackClick:true},"",window.location.href);m.trackEventOnPage("COMMERCE_HISTORY_INJECT","history_injected","")}catch(s){f.record(s,"commerce history injection failed",null,null,"WARN")}}r.location=t}else{window.location=t}},beforePopTargetBlankIE:function(t){var s,u,r;if(!t||!t.href||t.target!=="_blank"){return true}if(!o.isIE10Metro()){if(!o.isIE9orHigher()){r=window.getSize();if(r){u=window.open(t.href,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+r.x+",height="+r.y)}}else{u=window.open(t.href,"_blank")}}if(!u||u.closed||typeof u.closed==="undefined"){t.target="";b.setPIDCookie(38821);return true}else{return false}},attemptOpenUrlNewTab:function(s){var t;if(!o.isIE10Metro()){if(q.ie&&!o.isIE9orHigher()){var r=window.getSize();if(r){t=window.open(s,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+r.x+",height="+r.y)}}else{t=window.open(s,"_blank")}}if(!t||t.closed||typeof t.closed==="undefined"){b.setPIDCookie(38821);window.location=s;return false}return t}};p.exportTo(l,"ta.popups.PopUtil");return l});define("ta/util/String",[],function(){var a={getColumns:function(d){if(!d||!d.length){return 0}var b=0;for(var c=0;c<d.length;c++){b+=(d[c]>=8192&&d[c]<65279)||(d[c]>65280&&d[c]<65376)?2:1}return b},abbreviate:function(d,b){if(arguments.length>2){for(var c=2;c<arguments.length;c++){b-=a.getColumns(arguments[c])}}if(d.length-b<3){return d}return d.slice(0,b)+"&#8230;"},stripHTMLFromText:function(b){return new Element("DIV",{html:b}).get("text")}};return a});define("typeahead/TypeAhead.utils",["vanillajs","ta/util/Deferred","utils/ajax"],function(b,d,c){var a={};a.query=function(f,k,e,m,o,l,g,j,n,h,i){return function(q){var p=d();var r={query:q,action:"API",startTime:this.startTime,uiOrigin:this.name,source:this.name,interleaved:true,geoPages:!o,flightsToPages:!o,nearPages:false,details:true,types:k||"geo,hotel,eat,attr,vr",link_type:m||k||"geo,hotel,eat,attr",max:l||12,neighborhood_geos:j?true:false,requiredFields:g};if(e!==""){r.nearby=true;r.local=true;r.parentids=e}else{r.global=true}if(h&&h!==""){r.scopeFilter=h}if(i&&Object.prototype.toString.call(i)==="[object Array]"&&i.length>0){r.filter=i.join(",")}new c({method:"GET",url:"/TypeAheadJson",data:r}).always(function(s){if(n){s&&s.results&&s.results.length>0&&p.resolve(s)||p.reject(JS_location_not_found)}else{s&&p.resolve(s)||p.reject(JS_location_not_found)}});return p.promise()}};return a});define("typeahead/TypeAhead.views",["vanillajs","ta/util/Deferred","utils/object/set-props"],function(b,c,a){var d={};d.iconMap={ALL:"sprite-typeahead-all",GEO:"sprite-typeahead-destination",HOTELOVERVIEW:"sprite-typeahead-destination",HOTEL:"sprite-typeahead-hotel",ATTRACTION:"sprite-typeahead-attraction",EATERY:"sprite-typeahead-restaurant",VACATION_RENTAL:"sprite-typeahead-vr",FLIGHTS_TO:"sprite-typeahead-flight",AIRPORT:"sprite-typeahead-flight",AIRLINE:"sprite-typeahead-flight",THEME_PARK:"sprite-typeahead-themepark",VACATION_PACKAGE:"sprite-typeahead-hotel",SMART_DEAL:"sprite-typeahead-hotel",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"sprite-typeahead-neighborhood",TRAVEL_GUIDE:"sprite-typeahead-travel-guide"};d.iconFontMap={ALL:"ui_icon globe-world",GEO:"ui_icon map-pin-fill",HOTELOVERVIEW:"ui_icon map-pin-fill",HOTEL:"ui_icon hotels",ATTRACTION:"ui_icon attractions",EATERY:"ui_icon restaurants",VACATION_RENTAL:"ui_icon vacation-rentals",FLIGHTS_TO:"ui_icon flights",AIRPORT:"ui_icon flights",THEME_PARK:"ui_icon amusement-parks",VACATION_PACKAGE:"ui_icon hotels",SMART_DEAL:"ui_icon hotels",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"ui_icon neighborhoods",TRAVEL_GUIDE:"ui_icon guides",AIRLINE:"ui_icon flights",KEYWORD:"ui_icon search",TAG:"ui_icon search",ACTIVITY:"ui_icon activities"};var g={PAGE:true,BLENDER_PAGE:true,NEAR_POI:true,VACATION_PACKAGE:true,SMART_DEAL:true,FLIGHTS_TO:true};var f={FLIGHTS_TO:true,VACATION_PACKAGE:true};d.escapeHTML=function(j){return j.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00A0/g,"&nbsp;").replace(/"/g,"&quot;")};var i=function(l,k){var j={};var m=[];l.forEach(function(n){var o=n.type;j[o]=j[o]||[];j[o].push(n)});k.forEach(function(o){var p=j[o];if(p){for(var n=0;n<p.length;n++){m.push(p[n])}}});return m};d.configTypeAheadOptionsForSortingByPOIType=function(l,k){var j=l.postResultsFnList||[];j.push(function(n){var m=c();n.results=i(n.results,k);m.resolve(n);return m.promise()});l.postResultsFnList=j;l.listTemplate=function(o){var n=o.results;var m=[];if(n.length>0){m.push("<ul>");n.forEach((function(){var q="";return function(s){if(q!=s.type){q=s.type;var r=[s.rendered];r.push('<span class="label">');r.push(s.title);r.push('<img src="/img2/x.gif" class="icon hidden" alt="">');r.push("</span>");s.rendered=r.join("")}}})());var p=(function(){var q="";var r=document.createElement("div");return function(t){var s='<li class="typeahead-choice '+d.escapeHTML(t.title.toLowerCase())+'">'+t.rendered+"</li>";if(q!=t.type){q=t.type;r.innerHTML=s;r.firstChild.className+=" first";s=r.innerHTML}return s}})();m.push(n.map(p).join(""));m.push("</ul>")}return m.join("")}};var e={showChildren:false,tagLabels:null,poiClasses:"",geoClasses:""};d.itemTemplate=function(k){k=a(e,k);var l=k.useIconFont;var j=l?d.iconFontMap:d.iconMap;return function(u,t){var w=[];var y;if(u.isNeighborhood){y=j.NEIGHBORHOOD}else{y=u.data_type=="TAG"?j[u.data_type]:j[u.type]}t=t||{};var q=u.icon_type||u.data_type;if(q&&f[q.toUpperCase()]){y=j[q.toUpperCase()]}if(!l&&y&&q&&g[q]){y+="-list"}if(y){var z=(l?"":"sprite-image ")+"leftIcon "+y;w.push('<div class="'+z+'"></div>')}var B;if(k.tagLabels){var r=k.tagLabels;if(u.isChild&&u.parent&&u.parent.moved){B=r.newLocation}else{if(u.moved===true){B=r.moved}else{if(u.closed===true){B=r.closed}}}if(B){w.push('<span class="search-tagged-poi" >'+B+"</span>")}}var o=u.details||u;var p=o.highlighted_name||o.name||"";var s=u.data_type==="TAG"||u.scope==="local_tag"||u.scope==="overview"||k.simpleChild&&u.isChild;var v=s?"":o.geo_name||"";if(t.HTMLEscape){p=d.escapeHTML(p);v=d.escapeHTML(v)}var n="poi-name "+k.poiClasses;if(!v){n+=" no-geo"}var A="geo-name "+k.geoClasses;w.push('<span class="'+n+'">');if(k.debug){w.push('<span class="debug">');w.push(typeof u.order==="number"?u.order:"??");w.push("("+(typeof u.score==="number"?u.score:"??")+")");w.push("&nbsp;</span>")}w.push(p);w.push("</span>");w.push('<span class="'+A+'">'+v+"</span>");w.push();if(k.showChildren&&u.isChild){w.unshift('<div class="child">');w.push("</div>");var x=u.lastChild?j.CHILD_BOTTOM:j.CHILD_TOP;var m="sprite-image childIcon leftIcon "+x;w.unshift('<div class="'+m+'"></div>')}return w.join("")}};d.configureTypeAheadForSegmentedResults=function(j,m){var u=m||{};var p=u.boldSearchQuery;var v=u.groupByScope;var o=j.postResultsFnList||[];var q="search";var r="history";var t="suggested";var n="overview";var s="global";var l="local";var k=function(x){var w={};var y=function(z){if(z.type&&z.type.toUpperCase()==="SEARCH"&&z.name){return q}else{if(z.scope=="history"){return r}else{if(z.scope=="suggested"){return t}else{if(z.scope=="overview"){return n}else{if(z.scope&&z.scope.lastIndexOf("local",0)===0){return l}else{if(v&&z.scope=="global"){return l}else{return s}}}}}}};x.forEach(function(A){var B=y(A);if(B==="history"&&A.isChild){return}var z=w[B]=w[B]||[];z.push(A)});return w};o.push(function(x){var w=c();if(u.debug){x.results.forEach(function(z,y){z.order=y})}x.results=(function(C){var D=[];C.forEach(function(G){D.push(G);if(G.children){var I=G.children.length;for(var H=0;H<I;H++){var J=G.children[H];J.scope=G.scope;J.parent=G;D.push(J)}}});var z=k(D);var A=[];var F=[n,r,t,l,s,q];for(var B=0;B<F.length;B++){var E=F[B];var y;if(E==l){y=z[E]?[].concat.apply([],h(z[E])):[]}else{y=z[E]}if(y){A=A.concat(y)}}return A})(x.results);w.resolve(x);return w.promise()});j.postResultsFnList=o;j.listTemplate=function(A){var C=[];var B=A.results;var z=k(B);var G=false;var H=false;var x=false;var D=B.length==0;var F=!(A.query&&A.query.query)&&(!z[l]||z[l].length===0)&&(!z[s]||z[s].length===0);var w=function(K,N){var M="resultContainer"+(N?" "+N:"");C.push('<ul class="'+M+'">');for(var L=0;L<K.length;L++){var J=K[L];if(!J){continue}C.push('<li class="'+(J.wrapperCSS||"")+'">');C.push(J.rendered);C.push("</li>")}C.push("</ul>")};if(z[n]&&z[n].length>0){x=true;if(u.overviewLabel){C.push('<div class="title overview">'+u.overviewLabel+"</div>")}w(z[n],"overview")}if(z[r]&&z[r].length>0){G=true;if(u.historyLabel){C.push('<div class="title history">'+u.historyLabel+"</div>")}w(z[r],A.query?null:"history bold_names")}if(z[t]&&z[t].length>0){C.push('<div class="title history">'+u.suggestedLabel+"</div>");w(z[t],"suggested")}if(!F&&u.localLabel&&(z[l]&&z[l].length>0||(u.noResultsMessage&&!x))){H=true}if(z[l]&&z[l].length>0){H=true;w(z[l],"local")}else{if(H&&u.showNoResultsMessage){C.push('<div class="no-results">'+u.noResultsMessage+"</div>")}}if(z[s]&&z[s].length>0){if(u.globalLabel&&(H||G)){C.push('<div class="title global">'+u.globalLabel+"</div>")}w(z[s],"global")}if(!F&&z[q]&&z[q].length>0){var I=z[q][0];var E=A.query&&A.query.query||"";var y="search resultContainer";if(I.noResults){y+=" noResults"}if(p){C.push('<ul class="'+y+'"><li class="searchRow">'+I.name.replace("%","<b>"+d.escapeHTML(E)+"</b>")+"</div></li></ul>")}else{C.push('<ul class="'+y+'"><li class="searchRow">'+d.escapeHTML(I.name.replace("%",E))+" &raquo;</div></li></ul>")}}if(D&&!F&&u.showNoResultsMessage&&u.noResultsMessage){C.push('<div class="no-results">'+u.noResultsMessage+"</div>")}return C.join("")};return u};d.simpleItemTemplate=function(){return function(j){return[j.details.name,'<span class="addr">',j.details.address,"</span>"].join("")}};d.simpleListTemplate=function(j){return function(m){if(!m.results||!m.results.length){return'<div class="noResults">'+j+"</div>"}var l=m.results||[];var k=["<ul>"];var n;l.forEach(function(o){k.push("<li>");if(o.title!==n){n=o.title;k.push('<span class="label">',n,'<img src="/img2/icons/typeahead/',o.type.slice(0,1).toLowerCase(),'.gif"/></span>')}k.push(o.rendered);k.push("</li>")});k.push("</ul>");return k.join("")}};d.ptptListTemplate=function(q){var y=['<div class="typeahead-choices">'];var u={};var l={history:true};var m=CDNHOST+"/img2/x.gif";function r(z){var B=z.scope=="history";var A=z.type?z.type.toLowerCase():"";var s=B?"history":A;return{historyScope:B,choiceType:A,headerType:s}}var x=q.results;var k=x.length;for(var p=0;p<k;p++){var o=x[p];var w=r(o);var j="typeahead-choice "+w.choiceType;var n=false;if(!(w.headerType in u)){j+=" first";u[w.headerType]=true;n=true}if(w.historyScope){j+=" history"}y.push('<div class="'+j+'">');y.push('<img src="'+m+'" class="icon" alt="">');y.push('<span class="cutoff">');y.push(o.rendered);y.push("</span>");if(w.historyScope){y.push('<img src="'+m+'" class="history_icon" alt="">')}y.push("</div>");var v=x[p+1];var t=v&&r(v);if(t&&l[w.headerType]&&t.headerType!=w.headerType){y.push('<div class="divider"></div>')}}y.push("</div>");return y.join("")};var h=function(l){var j={};var o=0;var q;for(var m=0;m<l.length;m++){var k=l[m];var n=/(global|local)(_(.*))?/.exec(k.scope);var r=n&&n.length>3?n[3]:k.scope;if(k.isChild&&q){j[q].push(k);continue}q=r==="tag"||r==="keyword"?"common_group":k.type;if(!j[q]){j[q]=[o++,q]}j[q].push(k)}var p=function(t){var s=[];var w=[];var v;for(v in t){if(t.hasOwnProperty(v)){w.push(t[v])}}w=w.sort(function(y,x){if(y.length<=1){return -1}if(x.length<=1){return 1}if(y[1]!=x[1]){if(y[1]=="common_group"){return -1}if(x[1]=="common_group"){return 1}}return y[0]-x[0]});for(var u=0;u<w.length;u++){s.push(w[u].slice(2))}return s};return p(j)};return d});define("lib/TypeAhead",["lib/jquery-amd","api-mod","ta/util/Deferred","utils/ajax","ta/common/Search","ta/Core/TA.Record","ta/Browser","utils/browserutils","ta/util/String","ns-exporter","typeahead/TypeAhead.utils","typeahead/TypeAhead.views"],function(Q,g,M,R,Y,L,al,ak,d,m,ad,ah){var h={};var K={results:null,showOnEmpty:false,integrate:false,highlight:false,maxItems:5,types:["geo","eatery","hotel","attraction"],linkType:"url",predicate:null,minChars:null,sort:null,shouldReplace:true,getMatchingKey:function(am){return am.value},bottom:false};var ae={minChars:1,search:null,itemTemplate:function(am){return am&&am.value},listTemplate:function(an){var am=an.results?an.results:an;return'<div class="typeahead-choices">'+am.map(function(ap,ao){return'<div class="typeahead-choice">'+ap.rendered+"</div>"}).join("")+"</div>"},errorTemplate:function(am){return'<div class="message">'+am+"</div>"},resolveSelection:function(am){return am&&am.value},equal:function(an,am){return an.value==am.value},shouldSubmit:function(){return true},validator:null,containerClass:"typeahead-container",itemSelector:".typeahead-choice",errorClass:"error",defaultTextClass:false,defaultValue:null,width:true,showOnFocus:true,searchOnFocus:true,onUserFocus:null,autoSelectFirst:false,selectOnBlur:true,assumeOnBlur:true,onUserBlur:null,restoreOnFocus:false,cycleInput:true,autopopulateHighlighted:true,selectInputText:true,onSelect:null,onRestore:null,onSync:null,onRender:null,onShow:null,onHide:null,onError:null,nextField:null,offsetY:0,offsetX:0,syncro:null,containerParent:document.body,positionRelative:false,unselectOnEscape:false,cacheResults:false,autoHighlightFirst:false,ignoreKeysWhenInvisible:false,name:"unknown",geoId:undefined,startEventOn:"focus",queryLengthLimit:100,postResultsFnList:null,jpFirefoxIME:false,jpFirefoxIMEInterval:500,clearDefaultTextOnFocus:true,focusOnCreation:false,searchParams:null,errorOnSearchFailure:"error",enableQueryDelay:false,throttleRequests:false,doSelectionBeforeLogging:false,highlightInputOnFocus:false,staticResults:null,isOverlay:true,selectFirstOnMouseOut:false},ag=8,aa=9,P=13,t=16,o=17,q=18,N=20,r=27,D=37,ab=38,H=39,J=40,E=46,F=91,f="click",y="enter",z="tab";var a=function(am){return(am&&am.searchSessionId)?am.searchSessionId:"no_search_session_id"};var n;var I=function(){if(n){if(typeof n.abort==="function"){try{n.abort()}catch(am){}}n=null}};var s=function(am){n=am};var X=function(an){I();var am=M();var aq=this.getSearchParams();var ao=this;aq.query=an;aq.action="API";aq.uiOrigin=this.options.name;aq.source=this.options.name;aq.startTime=this.options.startTime;aq.searchSessionId=a(this.options);var ap={method:"GET",url:"/TypeAheadJson",data:aq};if(this.options.throttleRequests){ap.beforeSend=function(ar){s(ar)}}R(ap).always(function(ar,at){if(ar){if(ar.status!=="error"&&at!=="abort"){am.resolve(ar)}}else{am.reject(ao.options.errorOnSearchFailure)}});return am.promise()};var W=function(){return this.source.value};var k=function(ao){var am=0;for(var an=this.source.value.length-1;an>=0;an--){am++;var ap=this.source.value.charCodeAt(an);if((ap>=19968&&ap<=40959)||(ap>=12352&&ap<=12543)||(ap>=44032&&ap<=55295)){am++}if(!ao&&am>=this.options.minChars){return true}}return ao?am:false};var x=function(){var an=this.source;var am=undefined;if(this.hasDefaultText()){if(this.options.clearDefaultTextOnFocus===true){am=an.value.length}else{am=0}}else{if(this.options.highlightInputOnFocus){am=an.value.length}}if(am!==undefined){setTimeout(function(){if(document.activeElement==an){an.setSelectionRange(0,am)}},0)}};var l=function(ao){if(this.hasDefaultText()&&this.options.clearDefaultTextOnFocus!==true){g.removeClass(this.source,this.options.defaultTextClass);this.source.value=""}if(this.options.startEventOn==="type"){p.call(this)}if(this.options.ignoreKeysWhenInvisible&&!this.visible){return}switch(ao.keyCode){case P:ao.preventDefault();ao.stopPropagation();if(this.selectedIndex>=0){this.select(true,y,ao);G.call(this)}else{if(this.options.assumeOnBlur&&this.results&&this.results.length){if(typeof this.options.assumeOnBlur=="function"){this.setSelectedIndex(this.options.assumeOnBlur(this))}else{this.setSelectedIndex(0)}af.call(this);this.select(true,y,ao);G.call(this)}if(this.options.shouldSubmit()){if(!this.options.validator||this.options.validator(ao)){if(this.options.onSubmit){var an=Y.getUrlFromForm(this.source.form);var am=event?event.type:"";this.options.onSubmit(this,an,true,am)}this.abortSearch();this.hide();this.source.form.submit()}}}break;case J:this.highlightNextChoice();ao.preventDefault();ao.stopPropagation();break;case ab:this.hightlightPreviousChoice();ao.preventDefault();ao.stopPropagation();break;case r:this.restore();this.hide();break;case aa:if(this.options.selectOnTab&&this.selectedIndex>=0&&!this.ignoreSelectOnTab){ao.preventDefault();ao.stopPropagation();this.select(true,z,ao);G.call(this)}else{this.tabPressed=true}break}if(this.options.onKeyDown){this.options.onKeyDown(ao,this)}};var Z=function(am){setTimeout(V.bind(this),0)};var c=function(am){if(am){switch(am.keyCode){case aa:case t:case o:case q:case N:case D:case ab:case H:case J:case F:case P:case r:return}}V.call(this)};var j=function(){var am=this.source.value;if(this.intervalHandler){window.clearTimeout(this.intervalHandler)}if(!this.options.enableQueryDelay||this.lastQueryTime+500<=new Date().getTime()){this.intervalHandler=null;this.search()}else{this.intervalHandler=setTimeout(function(){if(!this.aborted&&this.source.value===am){this.search()}}.bind(this),this.options.throttleRequests?50:300)}};var C=function(){var am=this.results&&this.results.length===0;return !this.hasDefaultText()&&k.call(this)&&this.source.value!==this.query&&(this.selectedIndex<0||!this.results||am||this.source.value!==this.results[this.selectedIndex].value)};var V=function(){I();var am=k.call(this,true);if(!C.call(this)&&am<this.options.minChars){if(am===0){if(typeof this.options.clearquery==="function"){this.options.clearquery(this)}}this.selected&&g.removeClass(this.selected,"selected");g.removeClass(this.source,this.options.errorClass);this.results=null;this.error=null;this.setSelectedIndex(-1);this.selected=null;this.query=null;this.staticResultsShown=null;var an=this.source&&(!this.source.value||T(this.source.value).trim().length==0);if(this.shouldShowStaticResults()&&(an||this.hasDefaultText())){this.showStaticResultsIfEnabled()}else{this.hide()}}else{j.call(this,this.query)}};var U=function(am){if(!(this.results&&this.results.length)){return}this.setSelectedIndex(this.selectedIndex+am);if(this.selectedIndex>=this.results.length){this.setSelectedIndex(this.options.cycleInput?-1:0)}else{if(this.selectedIndex<(this.options.cycleInput?-1:0)){this.setSelectedIndex(this.results.length-1)}}af.call(this)};var af=function(am){this.ignoreSelectOnTab=am&&this.options.selectFirstOnMouseOut;this.selected&&g.removeClass(this.selected,"selected");if(-1===this.selectedIndex){this.selected=null;this.options.autopopulateHighlighted&&this.query&&(this.source.value=this.query);this.options.selectInputText&&this.source.select(false)}else{this.selected=this.items[this.selectedIndex];g.addClass(this.selected,"selected");this.options.autopopulateHighlighted&&this.results&&(this.source.value=this.options.resolveSelection(this.results[this.selectedIndex]))}};var e=function(ao,an){if(!an){return false}for(var am=0;am<an.length;++am){var ap=an[am];if(ap&&ap.match(ao)){return true}}return false};var B=function(aw,aH,ay,aF,au,aE,av,aD,aI,az,aq,aB,aC,ar,an,ax,at,ap,am){var aG={action:"RECORD",eventType:aw,uiOrigin:aI,global:aD<=1,scope:aD>1?aD:undefined,fromHistory:aB,hadHistory:aC,type:ax.type,value:aH,indexInType:ax.indexInType?ax.indexInType:0,tagId:ax.tagId?ax.tagId:0,source:aI,startTime:az,selDepth:ay,isChild:ax.isChild,totalNum:aF,userInteractionType:aE,errors:av,query:aq,dataType:ax.data_type,url:ax.url,searchSessionId:ap};var ao;if(typeof au==="function"){if(at){au();if(typeof an==="function"){ao=an}}else{ao=function(){au();if(typeof an==="function"){an()}}}}if(typeof ar==="function"){aG=ar(aG,ax,am)}var aA={method:"GET",url:"/TypeAheadJson",data:aG};R(aA).always(function(aJ){ao()})};var p=function(){if(!this.startNotificationSent){this.startNotificationSent=true;this.options.startTime=Date.now();var am=this.options.geoId;var an=this.options.name;var ap=this.options.staticResults&&this.options.staticResults.history&&this.options.staticResults.history.results&&this.options.staticResults.history.results.length;var ao={method:"GET",data:{action:"RECORD",eventType:"start",uiOrigin:this.options.name,startTime:this.options.startTime,source:an,linkedTypeAhead:this.options.linkedTypeAhead?this.options.linkedTypeAhead.options.startTime:void 0,global:!am,hadHistory:ap,scope:am,searchSessionId:a(this.options)},url:"/TypeAheadJson"};R(ao);if(this.options.trackingName&&h.entryEventRecorded==false){h.entryEventRecorded=true;L.trackEventOnPage("desktop_typeahead","typeahead_entry",this.options.trackingName)}}};var O=function(an){if(this.hasDefaultText()&&this.options.clearDefaultTextOnFocus===true){g.removeClass(this.source,this.options.defaultTextClass);this.source.value=""}x.call(this);if(!this.autoFocusing){if(this.options.onUserFocus){this.options.onUserFocus(this)}var am=this.lastSuccessfulQuery!==this.query;if(this.options.showOnFocus&&(!am)){this.show()}if(this.options.restoreOnFocus){this.restore()}if(this.options.showOnFocus&&this.options.searchOnFocus&&this.query&&!this.results&&!this.error&&k.call(this)){this.search()}else{this.showStaticResultsIfEnabled()}if(this.options.jpFirefoxIME){aj.call(this)}}if(this.options.startEventOn==="focus"){p.call(this)}this.autoFocusing=false};var aj=function(){if(this.source==document.activeElement){var am=function(){V.call(this);if(this.jpTypeAheadTimerId){clearTimeout(this.jpTypeAheadTimerId)}this.jpTypeAheadTimerId=setTimeout(am.bind(this),this.options.jpFirefoxIMEInterval)};am.call(this)}};var A=function(aq,am){if(this.checkMenuInteraction()){return}this.hide();var an=this.tabPressed;this.tabPressed=false;if(!this.options.restoreOnFocus&&!this.query){this.results=null;this.error=null;this.setSelectedIndex(-1);this.selected=null;this.items=[];if(this.container){this.container.innerHTML=""}}var ap=this.options.selectOnBlur&&-1!==this.selectedIndex;if(ap){this.select(an,an?z:undefined,aq)}var ao=this.options.autoSelectFirst?0:-1;if(this.options.assumeOnBlur&&ao===this.selectedIndex&&this.results&&this.results.length){if(typeof this.options.assumeOnBlur=="function"){this.setSelectedIndex(this.options.assumeOnBlur(this))}else{this.setSelectedIndex(0)}af.call(this);!ap&&this.select(an,an?z:undefined,aq)}if(this.source&&this.source.value===""){this.source.value=this.options.defaultValue;if(this.options.defaultTextClass){g.addClass(this.source,this.options.defaultTextClass)}}if(this.options.onUserBlur){this.options.onUserBlur(this,aq)}if(this.jpTypeAheadTimerId){clearTimeout(this.jpTypeAheadTimerId)}};var ac=function(an,am){if(!an){return null}if(typeof am==="string"){for(;an&&an.tagName!="html";an=an.parentNode){if(g.hasClass(an,am)||(typeof an.tagName==="string"&&an.tagName.toUpperCase()===am.toUpperCase())){return an}}return null}else{return an.parentNode}};var w=function(am){if(this.options.autoHighlightFirst){this.setSelectedIndex(0)}else{this.setSelectedIndex(-1)}af.call(this)};var b=function(ap,aq){var an=aq.target;var ao=ac(an,this.options.itemSelector);if(ao){an=ao}if(this.selected&&this.selected===an){return}for(var am=this.items.length-1;am>=0;am--){if(this.items[am]===an){this.setSelectedIndex(am);af.call(this,ap);return}}};var G=function(){var am=this.source.tabIndex,ao;if(false===this.options.nextField){return}if(this.options.nextField){if(typeof this.options.nextField==="string"){this.options.nextField=g.find(this.options.nextField)}else{if(typeof this.options.nextField==="function"){ao=this.options.nextField(this)}else{ao=this.options.nextField}}}if(false===ao){return}if(!ao&&am){am=parseInt(am,10)+1;ao=g.find("[tabindex="+am+"]",this.source.form)}if(!ao){for(var an=this.source.form.elements.length-1;an>=0;an--){var ap=this.source.form.elements[an];if(this.source===ap){ao=this.source.form.elements[an+1];break}}}ao&&ao.focus()};var v=function(){this.options.syncro&&this.options.syncro.sync(this,{query:this.query,value:this.source.value,result:this.selectedIndex>=0&&this.results[this.selectedIndex]})};var ai=function(){(document.activeElement===this.source&&!this.aborted&&this.show())||A.call(this)};var u=function(){var an,am,ar,at;var aq=arguments[0]||{};var ao=1;var ap=arguments.length;for(;ao<ap;ao++){if((an=arguments[ao])!=null){for(am in an){ar=aq[am];at=an[am];if(aq===at){continue}aq[am]=at}}}return aq};var S=function(ao,ax){this.setSource(ao);this.lastQueryTime=0;var an=false;this.checkMenuInteraction=function(){return an};if(!ae.containerParent){ae.containerParent=document.body}this.options=u({},ae,ax);this.options.postResultsFnList=this.options.postResultsFnList||[];if(this.options.postResultsFn){this.options.postResultsFnList.unshift(this.options.postResultsFn);delete this.options.postResultsFn}if(this.options.staticResults){for(var av in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(av)){continue}var au=this.options.staticResults[av];this.addStaticResults(av,au)}}this.staticResultsShown=null;this.setSelectedIndex(-1);this.selected=null;this.visible=false;this.lastSuccessfulQuery="";if(!this.options.defaultValue&&this.options.defaultValue!=""){this.options.defaultValue=this.source.getAttribute("data-defaultValue")||this.source.defaultValue}var am={"class":this.options.containerClass};if(this.options.isOverlay){var aw="position: absolute";if(g.hasClass(document.body,"rtl")){aw+="; right: -999em"}else{aw+="; left: -999em"}aw+="; "+(typeof this.options.positionRelative==="string"?this.options.positionRelative:"top")+":-999px";am.style=aw}this.container=g.createElement("div",am);this.options.containerParent.appendChild(this.container);var aq=function(ay){an=true;ay.stopPropagation();ay.preventDefault()};var at=function(ay){an=false;ay.stopPropagation();ay.preventDefault();this.select(true,f,ay);G.call(this)};this.containerHandlers={mousedown:g.bind(aq,this),click:g.bind(at,this)};if(window.FastClick){this.containerHandlers.touchstart=g.bind(b,this,false);this.containerHandlers.touchend=g.bind(at,this)}for(var ar in this.containerHandlers){g.addEvent(this.container,ar,this.containerHandlers[ar])}if(true===this.options.width&&!this.options.cssPositioning){this.container.style.width=g.getSize(this.source).x+"px"}g.bindAll(this,"cleanUp","show","hide","processResults","renderResults","renderError");this.options.syncro&&this.options.syncro.add(this);var ap=document.activeElement===this.source;if(this.options.showOnFocus&&ap){if(this.hasDefaultText()){if(this.options.clearDefaultTextOnFocus===true){g.removeClass(this.source,this.options.defaultTextClass);this.source.value=""}else{g.addClass(this.source,this.options.defaultTextClass)}}if(this.options.searchOnFocus&&this.source.value!==this.options.defaultValue&&k.call(this)){this.query&&(this.source.value=this.query);this.search()}}if(!al.isIE11orHigher()){if("onpagehide" in window){window.addEventListener("pagehide",this.cleanUp,false)}else{g.addEvent(window,ak.ie?"unload":"beforeunload",this.cleanUp)}}if(this.options.jpFirefoxIME){aj.call(this)}if(this.options.startEventOn==="creation"||(this.options.startEventOn==="focus"&&ap)){p.call(this)}if(this.options.focusOnCreation===true){this.autoFocusing=true;this.source.focus()}x.call(this)};S.prototype.getInputText=W;S.prototype.getInputLength=k;S.prototype.searchFn=X;S.prototype.setGeoId=function(am){this.options.geoId=am;this.clearCache();this.lastSuccessfulQuery="";this.results=null};var T=function(am){return am&&am.replace(/\s+/g," ")};S.prototype.setSource=function(am,ao){if(!am||(this.source&&!ao)){return}this.source=am;this.source.autocomplete="off";this.handlers={keyup:g.bind(c,this),focus:g.bind(O,this),blur:g.bind(A,this)};if(window.FastClick){this.handlers.touchstart=g.bind(b,this,false)}this.handlers.keydown=g.bind(l,this);for(var an in this.handlers){g.addEvent(this.source,an,this.handlers[an])}this.source.addEventListener&&this.source.addEventListener("paste",Z.bind(this));this.source.addEventListener&&this.source.addEventListener("cut",Z.bind(this))};S.prototype.getNormalizedQuery=function(){if(this.query){return T(this.query)}else{return this.query}};S.prototype.reset=function(){if(this.options.defaultTextClass){g.addClass(this.source,this.options.defaultTextClass)}g.removeClass(this.source,this.options.errorClass);this.error=null;this.container&&this.render("");this.source.value=this.options.defaultValue||""};S.prototype.getChosenResult=function(){var an=null;if(this.source&&this.source.value&&this.results){var ap=this.source.value;for(var ao=0;ao<this.results.length;ao++){var am=this.results[ao];if(ap.toLowerCase()===d.stripHTMLFromText(am.name).toLowerCase()){an=am;break}}}return an};S.prototype.clearResults=function(){this.query="";this.render("")};S.prototype.search=function(ap,au){this.selected=null;this.lastQueryTime=Date.now();this.setSelectedIndex(-1);this.query=this.source.value;var ar=this.getNormalizedQuery();this.aborted=false;if(this.options.cacheResults&&this.resultsCache&&this.resultsCache[ar]){this.processResults(this.resultsCache[ar],true);if(false!==ap){ai.call(this)}au&&au()}else{var at;if(this.query.length<=this.options.queryLengthLimit){if(this.options.search){at=this.options.search(this.query,this)}else{at=X.call(this,this.query)}}else{var am=M();var aq={results:[],query:{query:this.query}};am.resolve(aq);at=am.promise()}at=at.success(this.integrateStaticResults.bind(this));var an=this.options.postResultsFnList;for(var ao=0;ao<an.length;ao++){at=at.success(an[ao])}at=at.success(this.processResults).failure(this.renderError);if(false!==ap){at.always(g.bind(ai,this))}au&&at.always(au)}};S.prototype.processResults=function(at,ao){var ar=this.options.itemTemplate,an=this;ao=this.options.forceProcessResults||ao;var am=!!at.results;if(!am){at={results:at,query:{query:this.query}}}var ap=at.results;if(this.options.cacheResults&&am){var aq=T(at.query&&at.query.query?at.query.query:this.getNormalizedQuery());if(!this.resultsCache){this.resultsCache={}}this.resultsCache[aq]=at}if(ao||this.getNormalizedQuery()!==T(this.lastSuccessfulQuery)){this.results=ap;this.error=null;this.setSelectedIndex(-1);if(this.options.autoHighlightFirst){this.setSelectedIndex(0)}ap.forEach(function(av,au){av.index=au;av.rendered=ar(av);if(an.options.onProcessResult){an.options.onProcessResult(av,au,an)}})}this.renderResults(at,null,ao)};S.prototype.processResultsForce=function(am){this.processResults(am,true)};S.prototype.renderResults=function(at,ap,ao){if(ao||this.getNormalizedQuery()!==T(this.lastSuccessfulQuery)){var an=this;var ar=at.results?at.results:at;this.lastSuccessfulQuery=at.query&&at.query.query?at.query.query:null;g.removeClass(this.container,this.options.errorClass);g.removeClass(this.source,this.options.errorClass);var am=this.options.listTemplate(at);if(ap){var aq=Q(this.options.errorTemplate(ap)).add(Q(am));am=Q("<div></div>").append(aq).get(0)}this.render(am);this.items=g.select(this.options.itemSelector,this.container);this.items.forEach(function(au){g.addEvent(au,"mouseover",b.bind(an,true));if(an.options.selectFirstOnMouseOut){g.addEvent(au,"mouseout",w.bind(an))}});if(this.selectedIndex>=0){af.call(this)}else{this.options.autoSelectFirst&&this.highlightNextChoice()}this.options.onRender&&this.options.onRender(this,ar)}};S.prototype.setSelectedIndex=function(am){this.selectedIndex=am;if(this.options&&this.options.onSetSelectedIndex){this.options.onSetSelectedIndex(am,this)}};S.prototype.renderError=function(am,an){if(an&&this.results){this.renderResults(this.results,am)}else{this.results=null}this.error=am;g.addClass(this.container,this.options.errorClass);g.addClass(this.source,this.options.errorClass);!an&&this.render(this.options.errorTemplate(am));this.options.onError&&this.options.onError(this,am)};S.prototype.render=function(am){if(!this.container){return}if(typeof am==="string"){this.container.innerHTML=am}else{if(typeof am==="object"){this.container.innerHTML="";this.container.appendChild(am)}}};S.prototype.show=function(){if(!this.container||this.visible||!this.container.childNodes.length){return this}var aq=g.getPosition(this.source);var am=g.getSize(this.source);var ap=aq.x||aq.left;var ao=aq.y||aq.top;if(this.options.cssPositioning){this.container.style.right="";this.container.style.left="";this.container.style.top=""}else{if(this.options.positionRelative){if(g.hasClass(document.body,"rtl")){this.container.style.right="auto"}else{this.container.style.left=(this.options.offsetX||0)+"px"}if(typeof this.options.positionRelative==="string"){this.container.style[this.options.positionRelative]=(am.y+(this.options.offsetY||0))+"px"}else{this.container.style.top=(am.y+(this.options.offsetY||0))+"px"}}else{this.container.style.right="auto";this.container.style.left=ap+(this.options.offsetX||0)+"px";if(this.options.positionAbove){var an=g.getSize(this.container);this.container.style.top=(ao-an.y+(this.options.offsetY||0))+"px"}else{this.container.style.top=(ao+am.y+(this.options.offsetY||0))+"px"}}}this.visible=true;this.hasBeenShown=true;this.options.onShow&&this.options.onShow(this);if(this.options.onResize){this._resizeCb=this.options.onResize.bind(null,this);g.addEvent(window,"resize",this._resizeCb)}return this};S.prototype.hide=function(){if(!this.visible||!this.container){return false}if(this.options.isOverlay){if(g.hasClass(document.body,"rtl")){this.container.style.right="-999em"}else{this.container.style.left="-999em"}this.container.style[typeof this.options.positionRelative==="string"?this.options.positionRelative:"top"]=-999}this.visible=false;this.options.onHide&&this.options.onHide(this);if(this._resizeCb){g.removeEvent(window,"resize",this._resizeCb);this._resizeCb=null}return this};S.prototype.highlightNextChoice=function(){U.call(this,1)};S.prototype.hightlightPreviousChoice=function(){U.call(this,-1)};S.prototype.select=function(am,ap,az){this.hide();if(this.selectedIndex<0||!this.results){return}this.source.value=this.options.resolveSelection(this.results[this.selectedIndex]);if(this.error){g.removeClass(this.container,this.options.errorClass);g.removeClass(this.source,this.options.errorClass);this.error=null;this.renderResults(this.results)}var au;if(this.options.onSelect){au=this.options.onSelect.bind(this.options,this.results[this.selectedIndex],this.source.value,this,am,ap,az)}if(am){var aA=this.results[this.selectedIndex];var ay=0;if(this.results){ay=this.results.length}var av=this.lastSuccessfulQuery?this.lastSuccessfulQuery:this.query;var ax=aA.scope==="history";var ar=this.options.loggingOverride;if(ar){ar=ar.bind(this)}var at=this.options.onSelectNavigate;if(at){at=at.bind(this)}var aw=this.staticResultsShown&&this.staticResultsShown.history;var aq=this.options.doSelectionBeforeLogging;var ao=a(this.options);var an=Y.getUrlFromForm(this.source.form);if(aA.type==="SEARCH"){B("search_bttn",undefined,undefined,undefined,au,ap,null,this.options.geoId,this.options.name,this.options.startTime,av,ax,aw,ar,at,aA,aq,ao,an)}else{B("select",aA.value,this.selectedIndex+1,ay,au,ap,null,this.options.geoId,this.options.name,this.options.startTime,av,ax,aw,ar,at,aA,aq,ao,an)}}else{if(au){au()}}v.call(this);return this};S.prototype.restore=function(){this.query&&this.query.length&&(this.source.value=this.query);this.setSelectedIndex(-1);if(this.selected){g.removeClass(this.selected,"selected");this.selected=null}this.options.autoSelectFirst&&this.highlightNextChoice();this.options.onRestore&&this.options.onRestore(this.query);v.call(this);return this};S.prototype.sync=function(ao){var am=this;if(this.query&&this.query!==ao.query){this.results=null;this.error=null}this.query=ao.query;ao.value&&(this.source.value=ao.value);this.setSelectedIndex(-1);this.selected&&g.removeClass(this.selected,"selected");var an=function(){if(am.results&&am.results.length){var ap=am.results.some(function(ar,aq){if(am.options.equal(ar,ao.result)){am.setSelectedIndex(aq);return true}return false});if(!ap&&am.options.assumeOnBlur){am.setSelectedIndex(0)}if(am.selectedIndex>=0){am.selected&&g.removeClass(am.selected,"selected");am.selected=am.items[am.selectedIndex];g.addClass(am.selected,"selected");am.source.value=am.options.resolveSelection(am.results[am.selectedIndex]);am.options.onSelect&&am.options.onSelect(am.results[am.selectedIndex],am.source.value,am,false)}}am.options.onSync&&am.options.onSync(am.query,am.source.value,am.selectedIndex>=0&&am.results[am.selectedIndex])};if(!this.results){this.query&&(this.source.value=this.query);this.search(false,an)}else{an()}};S.prototype.cleanUp=function(){this.container=null;this.item=null;this.selected=null;this.source=null;this.setSelectedIndex(-1);this.query=null;this.staticResultsShown=null;this.results=null;this.error=null;this.timeoutHandler=null;this.clearCache()};S.prototype.clearCache=function(){this.resultsCache=null};S.prototype.abortSearch=function(){this.aborted=true;if(this.timeoutHandler){clearTimeout(this.timeoutHandler)}};S.prototype.hasDefaultText=function(){return this.source&&this.source.value===this.options.defaultValue};S.prototype.integrateStaticResults=function(aJ){var aB=aJ.results||aJ;if(!g.isArray(aB)){aB=[]}var ar=(aJ.query&&aJ.query.query)||this.query;var ao=false;if(aJ.normalized&&aJ.normalized.query){ar=aJ.normalized.query;ao=true}var an=aB.length>0&&aB[aB.length-1];if(an&&an.type=="SEARCH"){aB.length-=1}else{an=null}var aG=this.getStaticResultsMatchingQuery(ar,ao);if(!aG||!aG.length){return aB}var aA={};for(var aF=0;aF<aG.length;aF++){var au=aG[aF];var az=[];for(var aE=0;aE<au.results.length;aE++){var av=au.results[aE];var aL=au.getMatchingKey(av);if(!aA.hasOwnProperty(aL)){az.push(av);aA[aL]=[aF,az.length-1]}}au.results=az}for(var aD=0;aD<aB.length;aD++){var aI=aB[aD];var ay=false;for(var aH=0;aH<aG.length&&!ay;aH++){var at=aG[aH];var aL=at.getMatchingKey(aI);var aq=aA[aL];if(aq&&aq[0]==aH){if(at.shouldReplace&&!aI.isChild){aI.scope=at.results[aq[1]].scope}at.results[aq[1]]=aI;aB[aD]=null;ay=true}}}var ap=[];for(var aH=0;aH<aG.length;aH++){var at=aG[aH];if(!au.bottom){for(var aD=0;aD<at.results.length;aD++){var aC=at.results[aD];aC&&ap.push(aC)}}}ap.push.apply(ap,aB.filter(function(aM){return !!aM}));for(var aH=0;aH<aG.length;aH++){if(au.bottom){var at=aG[aH];for(var aD=0;aD<at.results.length;aD++){var aC=at.results[aD];aC&&ap.push(aC)}}}var am=ap;if(an){am.push(an)}if(aJ.results){aJ.results=am}else{aJ=am}var aw={};for(var ax in aG){if(aG.hasOwnProperty(ax)){var au=aG[ax];if(au.results&&au.results.filter(function(aM){return aM!=null}).length){aw[ax]=true}}}this.staticResultsShown=aw;var aK=M();aK.resolve(aJ);return aK.promise()};var i=function(am){return am.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")};S.prototype.getStaticResultsMatchingQuery=function(au,aw){if(!au||!au.length){return[]}var an=[];var ao=new RegExp("\\b"+i(au),"i");var av=function(aB){return"<b>"+aB+"</b>"};var ar=this;for(var aA in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(aA)){continue}var ax=this.options.staticResults[aA];if(au.length<ax.minChars||!ax.integrate){continue}var at=ax.results;var az=[];for(var ap=0;ap<at.length&&(!ar.options.maxResults||az.length<ar.options.maxResults)&&az.length<ax.maxItems;ap++){var ay=at[ap];if(!ay){continue}var am=ay.name;if(aw&&ay.normalized_name){am=ay.normalized_name}if(am&&am.match(ao)||e(ao,ay.aliases)){if(ax.highlight){ay=u({},ay);ay.name=ay.name.replace(ao,av)}az.push(ay)}}if(az.length){var aq=u({},ax);aq.results=az;an.push(aq)}}return an};S.prototype.shouldShowStaticResults=function(){var an=!!this.query&&this.query.length>0;var am=this.lastSuccessfulQuery!==this.query;if(this.options.showOnFocus&&(!an||am)){for(var ap in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(ap)){continue}var ao=this.options.staticResults[ap];if(ao.showOnEmpty){return true}}}return false};S.prototype.getSearchParams=function(){if(this.options.searchParams){if(typeof this.options.searchParams==="function"){return this.options.searchParams(this)}else{return this.options.searchParams}}else{return{}}};S.prototype.showStaticResultsIfEnabled=function(){if(!this.shouldShowStaticResults()){return}var am={};var ao=[];for(var au in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(au)){continue}var ar=this.options.staticResults[au];if(ar.showOnEmpty){var ap=ar.results.slice(0,ar.maxItems);if(ar.sort){ap=ap.sort(ar.sort)}am[au]=true;ao=ao.concat(ap)}}this.staticResultsShown=am;var av=M(true);setTimeout(function(){av.resolve({results:ao})},0);var aw=av.promise();var aq=this.options.postResultsFnList;for(var an=0;an<aq.length;an++){aw=aw.success(aq[an])}var at=this;aw=aw.success(this.processResultsForce.bind(this));aw.always(function(){at.show()})};S.prototype.addStaticResults=function(am,aq){this.options.staticResults=this.options.staticResults||{};if(!aq||!aq.results){delete this.options.staticResults[am];return}var an=function(ar,au){var at=u({},ar);if(ar.urls){ar.urls.some(function(av){if(av.url_type==au.linkType){at.url=av.url;return true}return false})}return at};var ap=u({},K,aq);var ao=[].concat(ap.results.filter(function(ar){return !ap.types||!ap.types.length||ar.type&&ap.types.indexOf(ar.type.toLowerCase())>-1}).map(function(ar){return an(ar,ap)}).filter(function(ar){return !ap.predicate||ap.predicate(ar)}));if(!ao.length){delete this.options.staticResults[am];return}ap.results=ao;if(!ap.minChars){ap.minChars=this.options.minChars}this.options.staticResults[am]=ap};S.utils=ad;S.views=ah;if(h.entryEventRecorded==undefined){h.entryEventRecorded=false}m.createNs(h,"ta.tracking","typeahead");m.exportTo({TypeAhead:S},window);return S});define("utils/urlutils",["vanillajs","utils/asdf-encoder"],function(e,c){var d=window.asdf||((global&&global.asdf)?global.asdf:c.asdf);function f(l,j,m){var k=new RegExp("(-"+j+"([0-9]+))|([?&]"+m+"=([0-9]+))");var n=k.exec(l);if(n){if(typeof n[2]!=="undefined"){return Number(n[2])}if(typeof n[4]!=="undefined"){return Number(n[4])}}return void (0)}function h(j){return f(j,"d","detail")||f(j,"g","geo")}function i(l){var k={};var o=l.split("#")[0].split("?")[1]||"";var n=o.split("&");for(var m=0;m<n.length;m++){var j=n[m].split("=");if(j[0]){k[decodeURIComponent(j[0])]=decodeURIComponent(j[1])}}return k}function b(l){var k=[];for(var j in l){if(l.hasOwnProperty(j)){k.push(encodeURIComponent(j)+"="+encodeURIComponent(l[j]))}}return k.join("&")}function a(j){return location.protocol+"//"+location.hostname+j}function g(j){j=j||"";if(j.indexOf("http")===-1){j=a(j)}return j.replace("http://","https://")}return{asdf:d,getUrlArgNumeric:f,getUrlPageLoc:h,getUrlQueryArgs:i,toQueryString:b,https:g}});define("utils/errorutils",["utils/store","ta/util/Cookie","utils/browserutils","ta","lib/jquery-amd","mixins/Events"],function(h,s,v,k,g,m){var x="page_loaded",r="dom_ready",d="not_loaded";var l=new m("error","beforeSend");var j=0,a=3000,n=s.readRaw("JS_ERROR_HANDLING"),u={eMsg:"msg",eStak:"stack",eUrl:"url"},c=function(z){if(!z||!z.indexOf){return false}var A=window.CDNHOST||"";if(window.IS_DEBUG&&A==""){return z.match(/(js3\/|js\/)/)!=null}else{return z.indexOf(A)==0}},p=function(){var A=v.Platform.ios||v.Platform.android,z=s.readRaw("TAmobilemode")==="main";return A&&!z},b=function(A){if(!p()){return}for(i in u){var z=u[i];A[z]=A[i]}A.file=A.url||(document?document.URL:null);A.site=window.SITE_VERSION;A.loaded=d},q=function(A){if(!A||!A.indexOf){return false}var z="noPage";try{z=window.location.href}catch(B){}if(A===z){return true}return false},f=function(){var z="";g.each(document.getElementsByTagName("script"),function(A,D){if(!D){return}var C=D.src;if(c(C)){var B="";if(z!=""){B=", "}C=C.substring(C.indexOf("/js")+1);z=z+B+C}});if(z.length>a){z=z.substring(0,a)}return z},o=function(z){var A="";g.each(z,function(C,B){A=A+C+": "+B+"\n"});window.alert(A)},e=function(z){if(console){console.error(z)}},y=function(z){if(typeof z!="undefined"&&z!==null){return z.toString().replace(/[\r\n]/g,"")}return"null or undefined"},t=function(F){var G="";try{if(arguments&&arguments.callee&&!v.chrome&&!v.firefox&&!v.safari){var I=[];var A=arguments.callee.caller;A=A.caller;var D=0;while(A&&D++<20){var B=A.toString();if(B.match(/onErrorFunc/)){A=A.caller;continue}var z=B.length;var C=z>100?100:z;var J=B.substring(0,C);J=J.replace(/(\n|\r|\'|\")/g,"");J+="::";I.push(J);A=A.caller}return I.join(" ")}}catch(E){G="-arguments.callee issue"}if(F&&F.stack){var H=F.stack.split("\n");H=H.map(function(L){var K=L.lastIndexOf("/");if(K>0){L=L.substr(K+1)}return L});return H.join()}return"none"+G},w=function(I,z){var E="_extraInfoError_:Problem storing extra info.";var G={};var J="";try{var H=g.type(z);var B={};if(H==="array"||(H==="object"&&z.callee!=null)){for(var D=0;D<z.length;D++){var A=z[D];var F=typeof A;if(F==="string"||F==="number"||F==="boolean"){B[D]=A}else{B[D]=typeof A}}z=B}G=g.extend(I,z||{});J=JSON.stringify(G);if(J){if(J.length>a){J=J.substring(0,a)}return J.replace(/[\r\n]/g,"")}}catch(C){}try{G=I;J=JSON.stringify(G);if(J){if(J.length>a){J=J.substring(0,a)}return J.replace(/[\r\n]/g,"")}}catch(C){}return E};return{domIsReady:function(){d=r},record:function(P,A,K,M,G){try{if(!P){P=new Error("Stub error to build stack.")}if(h.has("ta.error.record.inFlight")||j>9){return}j++;h.add("ta.error.record.inFlight",true);var I=false;try{I=g("body").hasClass("js_logging")||p()}catch(S){}if(!I){return}if(IS_DEBUG&&console.error){console.error("JS_ERROR_RECORD: "+A,P)}var V=true;if(M&&M.hasOwnProperty("error_script")&&!c(M.error_script)&&!q(M.error_script)){V=false}var F={};var U=false;try{if(K||window.event){K=K||window.event;U=document.getElementById(K.target);F.eTarg=this.getSelectorString(U)}}catch(J){}if(typeof(debugCacheKey)!="undefined"){F.key=debugCacheKey}var z=window.pageServlet;if(!z){z="unknown"}F.servlet=z;if(!G||typeof G!="string"){G="ERROR"}if(!V){G="WARN";F.warnReason="externalError"}else{if(!IS_DEBUG&&j>1){G="WARN";F.warnReason="notFirstJSError"}}var Y={extraInfoError:"Problem storing extra info"};var X="";var E={};try{var C="";try{C=window.navigator.userAgent}catch(L){}var D="";var B="";if(U){if(typeof U.id!=="function"){D=U.id}B=U.className}var Q="";if(typeof serverPool!="undefined"&&serverPool){Q=serverPool}var N="";if(window.MooTools){N+="MooTools "}if(window.jQuery||k.jquery){N+="jQuery ";G="WARN";F.warnReason="jquery"}E={TARGET_ID:D,TARGET_CLASS:B,PAGE_UID:k.uid,INTERNAL_JS:f(),CLIENT_POOL:Q,COOKIES_ENABLED:s.canSet(),JS_LIBS:N};if(!V){E.INTERNAL_ERROR="false"}if(j>1){E.PRIOR_JS_PAGE_ERRORS=j-1}}catch(R){M=Y}F.xInfo=w(E,M);try{F.eUrl=window.location.href}catch(J){}var H="No Error";try{if(P){if(Object.prototype.toString.call(P)===Object.prototype.toString.call(new Error)){H=P.name+"-"+P.message}else{if(typeof P==="object"){H="non-Error object "+Object.prototype.toString.call(P)+" passed, sample properties - ";var W=0;for(prop in P){if(P.hasOwnProperty(prop)){H+=prop.substring(0,30)+": "+(P[prop]&&P[prop].toString?P[prop].toString().substring(0,20):P[prop])+", ";if(++W>4){break}}}}else{H="non-Object error passed: "+(""+P).substring(0,30)}}H=H.replace(/[\r\n]/g,"")}}catch(J){}F.eMsg=H;var O="";try{O=y(A).substring(0,150);F.eBlk=O}catch(J){}try{if(O.indexOf("window.onerror")!=0){var T=t(P);if(T){F.eStak=T}}}catch(J){}try{l.emit("beforeSend",F)}catch(J){}F.eLogLevel=G;b(F);g.ajax({url:"/JSErrorRecord",method:"POST",data:F});if(IS_DEBUG){(window.ERRORS||(window.ERRORS=[])).push(F)}if(n){if(n.match(/alert/)){o(F)}if(n.match(/console/)&&console){e(F)}}h.remove("ta.error.record.inFlight");if(IS_DEBUG&&P&&G==="ERROR"&&false){throw P}l.emit("error",H,A,G)}catch(J){F={eBlk:"JSErrorRecord Error",servlet:z,eLogLevel:"ERROR",eMsg:"no error retrieved"};b(F);g.ajax({url:"/JSErrorRecord",method:"POST",data:F})}},getSelectorString:function(A){if(!A){return""}var z=[A];while(typeof A!="undefined"&&A&&typeof A.parentNode!="undefined"){z.push(A=A.parentNode)}z=z.map(function(C){if(C&&C.tagName){var B=C.tagName;if(C.id){B+="#"+C.id}if(C.className){B+="."+C.className}return B}return""});z=z.reverse().join(">");z=z.replace(/\s+/g,".");return z},on:l.on.bind(l),off:l.off.bind(l)}});define("overlays/options/autosizePage",["lib/jquery-amd","api-mod"],function(b,a){return function(d,c){return function(){this.domParent=b("<div></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,overflow:"auto"})[0];function e(){var g=a.getCoords(this.container);var f=a.getSize(window);this._scrollTop||(this._scrollTop=a.scrollTop());b(document.body).css("overflow","hidden");if(g.height+d*2>f.y){b(this.container).css({top:d,marginTop:0})}window.scrollTo(0,0)}this.on("append",function(){b(document.body).append(this.domParent)});this.on("show",e);this.on("positionDirty",e);this.on("hide",function(){b(document.body).css("overflow","auto");b(this.domParent).remove();window.scrollTo(0,this._scrollTop);delete this._scrollTop})}}});define("overlays/styles/spinnershade",["lib/jquery-amd"],function(a){return function(c,b){return function(){this.loading=function(f){if(f===void 0){return a(this.container).hasClass("wait")}a(this.container).toggleClass("wait",f)};var e='<div class="spinnerImage"></div>';if(window.AnimationEvent){e='<div class="cssLoadingSpinner">'+e;for(var d=1;d<=8;d++){e+='<div class="cssLoadingSpinner_step'+d+'"></div>'}e+="</div>"}this.spinner=document.createElement("div");a(this.spinner).attr({"class":"spinnershade "+c}).html(e);this.container.appendChild(this.spinner);b===false||this.loading(true)}}});define("ta/registration/RegOverlay",["ta","lib/jquery-amd","api-mod","ns-exporter","utils/urlutils","utils/errorutils","overlays/Overlay","overlays/position","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/options/autosizePage","overlays/styles/modal","overlays/styles/windowshade","overlays/styles/spinnershade"],function(g,z,f,j,i,x,E,n,K,l,w,h,m,b){var o=null;var H=null;var B=null;var c=null;var d=function(){var L=z("#overlayRegFrame");if(!L.length){return}o&&o.loading&&o.loading(false);L.css("display","")};var r=function(N,L){var P=z("#overlayRegFrame");if(!P.length){return}var M=o?o.container:null;if(!M){x.record(null,"No overlay parent element found.");return}var O={frame:P[0],overlay:M,width:N,height:L};c(O)};var v=function(R){var O=z(window);var Q=O.length?O.width():981;var N=R.width?R.width:0;N=N>Q?Q-20:N;var L=R.height?R.height:0;var P=z(R.frame);var M=z(R.overlay);if(N>100){P.css("width",N);M.css("width",N)}if(L>100){P.css("height",L);M.css("height",L)}o.emit("positionDirty")};var A=function(L){var N={};try{N=JSON.parse(L)}catch(M){x.record(M,"Error parsing controller result data: "+L);return{}}if("object"!==typeof N){x.record(null,"Parsed controller result is not an object.");return{}}return N};var J=function(L){if(H){H(L);H=null}};var p=function(L){if(B){B(L);B=null}};var I=function(P){F.close();var L=P.resultData||"";if(L){var S=A(L);J(S)}else{J({})}if(P.jsCallback){C(P.jsCallback)}var O=P.fireEvent||"";if(g.hasEventListener&&g.hasEventListener(name)){g.fireEvent&&g.fireEvent(O)}else{f.fireEvent(document,O)}f.fireEvent(document,"regOverlay:success");try{var N=z("#USER_PREFS")[0]===undefined;if(!g.util||!g.util.partials||("function"!==typeof g.util.partials.requestPartials)||N){return}var Q={ifb:true};var M=g.retrieve("attractions_shopping_cart_whitelisted_servlet_flag");if(typeof M!=="undefined"){Q.shoppingCartWhitelistedServlet=M}g.util.partials.requestPartials(["IP_HEADER"],Q,"facebook",null)}catch(R){x.record(R,"Could not request IP partial.")}};var C=function(M){if(!M){return}if("string"===typeof M){if(0===M.indexOf("function")){M=y(M)}else{M=s(M)}}if("function"===typeof M){try{M()}catch(L){x.record(L,"Unable to trigger js callback from registration overlay.")}}};var s=function(M){var Q=M.split(".");var P;for(var O=0,L=Q.length;O<L;O++){var N=Q[O];if(0===O){P=window[N];continue}if(P&&(N in P)){P=P[N]}else{return null}}return P};var y=function(M){var L=/^function\s*\(\s*\)\s*{(.*)}/.exec(M);if(L&&L[1]){try{return new Function(L[1])}catch(N){x.record(N,"RegOverlay failed to parse js callback: "+L[1])}}};var a=function(N){var P=N||window.event;if(!P){return}if(!P.origin||(0!==P.origin.indexOf("https"))||(-1===P.origin.indexOf("tripadvisor"))){return}if(!P.data||(-1===P.data.indexOf("action"))){return}var M;try{M=JSON.parse(P.data)}catch(P){return}var O=M.hasOwnProperty("action")?M.action:null;if(!O){return}switch(O){case"successClose":I(M);break;case"reloadWindow":location.reload(true);break;case"fwdToRelativeUrl":var L=M.url?M.url:"";if(!L){x.record(null,"No url specified to forward to.")}if(0!==L.indexOf("/")){x.record(null,"Cannot forward to absolute url: "+L)}window.location=L;break;case"resizeFrame":r(M.width,M.height);break;case"domReady":d();break;case"dismiss":F.close();break;default:return}};var u=function(){if(g.store){g.store("member_gating_cta_shown",true)}};var G=function(){if(g.retrieve){return g.retrieve("member_gating_cta_shown")}return false};var e=function(N){if(N){o=N;return}var Q="no_padding";var M='<div id="overlayRegFrameWrap"></div>';var R=[h(null,"center",Q,"","",M),n.topCenter([0,100],false,true),m("dark"),K,b("light"),w(20)];o=new E(null,R);var O=z(o.container);if(!O){x.record(null,"No overlay parent element found.");return}var L=300;var U=200;var T=z(window);var S=T.length?T.width():981;var P=T.length?T.height():600;L=L>S?S-20:L;O.css("left",Math.floor((S-L)/2));O.css("width",L);O.css("top",Math.floor((P-U)/6));O.css("height",U)};var k=function(N,M,L){e(L);o.on("show",function(){var O=z("#overlayRegFrameWrap");if(!O.length){x.record(null,"The registration iframe wrapper was missing.");return}g.trackEventOnPage("regoverlay","show_overlay",window.modelLocId||"",M,false);var P=document.createElement("iframe");z(P).prop("src",N).prop("id","overlayRegFrame").prop("class","overlayRegFrame").prop("scrolling","no").css("border","none").css("display","none");O.append(P)});o.on("hide",function(O){if(O.trigger==="close-button"){g.trackEventOnPage("regoverlay","closed",window.modelLocId||"",M,false)}o=null;p(O)});o.show()};var D=function(L){if(!L||"object"!==typeof L){x.record(null,"Options object is invalid.");return false}if(!L.hasOwnProperty("flow")||!L.flow){x.record(null,"Options object missing required flow field.");return false}if(!L.hasOwnProperty("pid")||!L.pid){x.record(null,"Options object missing required pid field.");return false}return true};var t=function(){var L=false;z.ajax({url:"/AuthCheck",data:{},async:false,type:"GET",timeout:1000,success:function(M){if("string"!==typeof M){return}if("true"===M.trim()){L=true}}});return L};var q=function(L){for(var M in L){if((false!==L[M])&&!L[M]){delete L[M]}}};var F={attachListener:function(){if(window.addEventListener){window.addEventListener("message",a,false)}else{window.attachEvent("onmessage",a)}},show:function(Q,O,M){D(M);B=M.onClose;H=M.onSuccess;if(M.loggedInBypass&&t()){J({});return}if(M.customResizeFn){c=M.customResizeFn}else{c=v}F.attachListener();if(!M.userRequestedForce&&g.on){g.on("metaFocusShow",F.close());g.on("preMetaFocusShow",F.close())}var P={flow:M.flow,pid:M.pid,mcid:M.mcid,locationId:M.locationId,stateToken:M.stateToken,jsCallback:M.jsCallback,requireSecure:!!M.requireSecure,expectedUser:M.expectedUser,forceDesktop:("forceDesktop" in M)?M.forceDesktop:false,preVerificationToken:M.preVerificationToken,returnTo:""};if(M.extraQueryParams){P=z.extend(P,M.extraQueryParams)}q(P);var L=z.param(P);var N=i.https("/RegistrationController?"+L);if(M.userRequestedForce){k(N,M.pid,M.customOverlay);return}if(!G()){u();k(N,M.pid,M.customOverlay)}else{J({})}},close:function(){if(o){o.hide()}},showFullScreen:function(P,N,M){D(M);if(!M.hasOwnProperty("returnTo")||!M.returnTo){x.record(null,"Options object missing required returnTo field.");return}var O={flow:M.flow,pid:M.pid,mcid:M.mcid,locationId:M.locationId,stateToken:M.stateToken,jsCallback:M.jsCallback,returnTo:M.returnTo,requireSecure:!!M.requireSecure,fullscreen:true};if(M.extraQueryParams){O=z.extend(O,M.extraQueryParams)}q(O);var L=z.param(O);window.location=i.https("/RegistrationController?"+L)},showForMobile:function(O,N,M){if(!M.customOverlay){var L=[h(null,"center","no_padding mobile_reg_overlay","","",'<div id="overlayRegFrameWrap"></div>'),n.framed(null,null,true),b("light")];M.customOverlay=new E(null,L).on("show",function(){z(M.customOverlay.close).css("display","block")}).on("positionDirty",function(){this._scrollTop||(this._scrollTop=f.scrollTop());window.scrollTo(0,0)}).on("hide",function(){window.scrollTo(0,this._scrollTop);delete this._scrollTop});if(!M.customResizeFn){M.customResizeFn=function(R){var P=R.height;var Q=z(document);if(Q.height()>P){P=Q.height()}z("#overlayRegFrame").css("height",P+"px").css("width",z(window).width());o.emit("positionDirty");z(M.customOverlay.container).css("position","absolute")}}}this.show(O,N,M)}};j.exportTo(F,"ta.registration.RegOverlay");return F});define("ta/backbone/ModuleLoader",["lib/jquery-amd","ns-exporter","utils/resourceLoader","ta/Core/TA.Event","mixins/mixin","ta/util/ajax","ta/util/Error","ta/registration/RegOverlay"],function(c,f,h,d,g,e,b,i){var a=null;(function(j){if(window.IS_DEBUG){window.onerror=function(){}}a=j(window,ta)})(function(n,k,m){var j=false;function o(r,q){if(j||n.bbapp){r();return true}if(jsDesktopBackboneAsset===m){q();return false}h.load(jsDesktopBackboneAsset,{serial:true},function(){j=true;r()})}function p(q){this._module=q;this._stepIdx=0;this._steps=["backbone","parseParams","bootstrap","assets","checkResponse","app","login","refetch","init"];this.resolve=this.resolve.bind(this);this.reject=this.reject.bind(this)}p.prototype.log=function(q){var r=[].slice.call(arguments,1);var s="ModuleLoader:"+this._module+":"+(q?this._steps[this._stepIdx]+":"+q:"run");r.unshift(s);n.IS_DEBUG&&console.log.apply(console,r);d.fireEvent(s,this._el)};p.prototype._backbone=function(){o(this.resolve)};p.prototype._parseParams=function(){if(typeof this._params=="function"){this._params=this._params();this.resolve()}else{if(typeof this._params=="string"){var q=this._params.split("::");var r=q.pop();q=q.shift();require&&require([q],function(s){s[r]&&s[r](function(t){this._params=t;this.resolve()}.bind(this))}.bind(this))}else{this.resolve()}}};p.prototype._bootstrap=function(){var q=g({modules:this._module,token:JS_SECURITY_TOKEN,authenticator:"DEFAULT",d:n.modelLocId,g:n.modelGeoId},this._params);new e({method:"POST",url:"/ModuleBootstrap",data:q,aplus:true}).then(function(r){if(!r||r.code!==200){this.reject();return}if(r.text.indexOf("_modulesResponseData")<0){b.ajaxFailure("Invalid ModuleBootstrap response",r,{contentLength:r.text.length});this.reject();return}this._root=c("<div>").html(r.text);this.resolve()}.bind(this),this.reject)};p.prototype._assets=function(){var t=this._root.find("script").get();var q=[];for(var s=t.length-1;s>=0;s--){var u=t[s].getAttribute("src");if(u){q.unshift(u);t[s].parentNode.removeChild(t[s])}else{c.globalEval(t[s].text)}}h.load(q,{serial:true},this.resolve);t=this._root.find("link").get();for(var r=t.length-1;r>=0;r--){h.load(t[r].href,{forceType:"css"})}};p.prototype._checkResponse=function(){this._appName=n._backboneAppName;this._data=n._modulesResponseData;delete n._backboneAppName;delete n._modulesResponseData;if(!this._data){this.reject();return}this._needLogin=false;this._actions={};this._data.actions.forEach(function(q){if(q.status=="FAILURE.AUTHORIZATION_MEMBER"){this._needLogin=true;this._actions[q.resource]=q.params}},this);this.resolve()};p.prototype._app=function(){require([this._appName,"Logging"],function(r,q){q.debug("initializing app",this._appName);var s=new Date().getTime();if(!n.bbapp){n.bbapp=new r();n.bbapp.init({token:JS_SECURITY_TOKEN},this._data);q.debug("Initialized modules/backbone in "+(new Date().getTime()-s)+"ms")}else{n.bbapp.context.patch(this._data)}this.resolve()}.bind(this))};p.prototype._login=function(){if(!this._needLogin){this.resolve();return}this.log("run");i.show(null,null,{flow:"CORE_COMBINED",pid:-1,userRequestedForce:true,onSuccess:this.resolve,onClose:function(q){q.trigger&&this.reject()}.bind(this)})};p.prototype._refetch=function(){if(!this._needLogin){this.resolve();return}var r;for(var q in this._actions){r=this._actions[q];n.bbapp.context.batchAction({action:{name:"FETCH",resource:q,params:r,id:"refetch"}})}n.bbapp.context.commitActions({success:this.resolve})};p.prototype._init=function(){if(typeof this._entryPoint!="string"){this._entryPoint.appendChild(this._root.get(0));this.resolve()}else{require&&require([this._entryPoint],function(q){var r=this._args.slice();r.unshift(this._el);q.init&&q.init.apply(q,r);this.resolve()}.bind(this))}};p.prototype.run=function(t,s,r,q){if(this._running){return}this._running=true;this._success=[];this._failure=[];this._entryPoint=t;this._params=s;this._el=r;this._args=q;if(this._stepIdx>=this._steps.length){this._stepIdx=this._steps.length-1}this.log();this.log("start");this["_"+this._steps[this._stepIdx]]();return this};p.prototype.success=function(q){if(!this._running){q();return this}this._success.push(q);return this};p.prototype.failure=function(q){if(!this._running){q();return this}this._failure.push(q);return this};p.prototype.resolve=function(){this.log("success");this._stepIdx++;if(this._stepIdx<this._steps.length){this.log("start");this["_"+this._steps[this._stepIdx]]()}else{this._running=false;this._success.forEach(function(q){q()})}};p.prototype.reject=function(){this._running=false;this.log("failure");this._failure.forEach(function(q){q()})};var l={};return function(s,v,u,t,w){var r=Array.prototype.slice.call(arguments,4);var q=l[s];if(w||!q){q=l[s]=new p(s)}return q.run(v,u,t,r)}});f.exportTo({ModuleLoader:a},"ta.backbone");return a});define("tamgfooter/tamgFooter",["vanillajs","ns-exporter","utils/ajax","ta/Core/TA.Record","ta/util/Error"],function(c,e,d,f,a){var b={};b.openUrl=function(h){var g=window.open(h);g.opener=null};b.getTAMGFooterViaAjax=function(j,i,g,h,k){d({url:"/TAMGFooterAjax",success:function(m){var n=document.getElementById("TAMGFooterHolder");if(n){n.innerHTML=m}var l="RuleBasedFooter_"+k;f.trackEventOnPage("Footer","OpenFooter",l,1,true)},data:{a:"SHOW_FOOTER",dis:j,loc:i,"new":g,serv:h},evalScripts:true,method:"get"})};b.getFullDisclaimerText=function(){d({url:"/TAMGFooterAjax",success:function(h){try{document.getElementById("PDISCLAIMER").innerHTML=h}catch(g){a.record(g,"Fail to find element (id PDISCLAIMER)")}},data:{a:"SHOW_FULL_DISCLAIMER"},evalScripts:true,method:"get"})};b.setTAMGFooterCookie=function(j){var i=null;var h=new Date(Date.now()+1000*60*60*24*7);document.cookie="hideTAMGFooter="+escape(j)+";expires="+h.toGMTString()+";path=/"+(i?";domain="+i:"");var g=document.getElementById("TAMGFooterHolder");if(g){g.style.display="none"}};e.exportTo(b,window)});require(["ta/rollupAmdShim"],function(a){a.install(["ta/util/ReCaptcha","ta/util/GeeTest","utils/memberAudit"],["ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-captcha",files:{"js-amd":{src:{utils:{memberAudit:1}}},js3:{src:{ta:{util:{GeeTest:1,ReCaptcha:1}}}}},_:{baseUrl:"/"}})};define("ta/util/ReCaptcha",["vanillajs","ns-exporter","ta/Core/TA.Record"],function(g,j,e){var h=false;var i={};var k={};var m="";var f="";var l=function(n){if(n<0){return 300}switch(n){case 0:return 0;case 1:return 250;case 2:return 500;case 3:return 1000;default:return 2000}};var d=function(n,o){if(require.defined("ta/util/Error")){require("ta/util/Error").record(n,o)}else{if(ta.merror&&ta.merror.recordError&&("function"===typeof ta.merror.recordError)){ta.merror.recordError(o,null,null,null,n)}}};var b=function(){e.trackEventOnPage("captcha","recaptcha","displayed")};var a=function(o,n){var p=document.getElementById(n);if(!p||("INPUT"!==p.tagName)){d(null,"The recaptcha input id was not found on the page: "+n);return}p.value=o||""};var c={init:function(t,q,p,n,o){try{k[n]=o;if(h){return}if(!t){d(null,"No language specified for recaptcha.")}if(q){m=q}if(p){f=p}var s=document.createElement("script");s.type="text/javascript";s.async=true;s.defer=true;s.src="https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl="+t;document.getElementsByTagName("head")[0].appendChild(s);h=true}catch(r){d(r,"Could not inject recaptcha script on to page.")}},reset:function(n){if(!n){d(null,"No reset key specified.");return}if(i[n]||(0===i[n])){try{if(("undefined"!==typeof grecaptcha)&&grecaptcha&&grecaptcha.reset&&("function"===typeof grecaptcha.reset)){grecaptcha.reset(i[n])}}catch(o){d(o,"Error resetting recaptcha object: "+n)}}},resetAll:function(){for(var n in i){if(i.hasOwnProperty(n)){c.reset(n)}}},clear:function(){i={}},checkGrecaptcha:function(){if(("undefined"!==typeof grecaptcha)&&grecaptcha&&grecaptcha.render&&("function"===typeof grecaptcha.render)){return true}return false},checkCaptchaRendered:function(n){return !!(i[n]||(0===i[n]))},showSync:function(q,o,p){var n=0;var r=window.setInterval(function(){if(++n>=40){window.clearInterval(r);d(null,"Recaptcha JS was not loaded on the page.");return}if("undefined"===typeof grecaptcha){return}c.show(q,o,p);window.clearInterval(r)},250)},showAll:function(o){for(var n in k){if(k.hasOwnProperty(n)){c.show(o,n,k[n])}}},waitForElm:function(r,o,p){var n=0;var q=function(){if(++n>=5){window.clearInterval(s);d(null,"Recaptcha element id was not loaded on the page."+o);return}var t=document.getElementById(o);if(t){window.clearInterval(s);c.show(r,o,p)}};var s=window.setInterval(q,250)},show:function(w,x,u,t){try{if(("undefined"===typeof grecaptcha)||!grecaptcha||!grecaptcha.render||("function"!==typeof grecaptcha.render)){d(null,"Recaptcha JS was not loaded on the page.");return}if(!w||!x||!u){d(null,"Please pass a site key, element id, and input id.");return}var s=document.getElementById(x);if(!s){c.waitForElm(w,x,u);return}if(i[x]&&("object"===typeof i[x])){return}var n=0;var q=l(n);var v=document.getElementById("captchaSpinner");var p=function(){if(n==1){if(null!==v){v.style.display="block"}}if(++n>=5){window.clearTimeout(o);v.style.display="none";d(null,"Couldn't load recaptcha");require(["utils/memberAudit"],function(z){z.recordMemberAuditLog("CAPTCHA_FAILED",f,null,{reason:"Google Timeout"})});var y=document.getElementById("captchaError");if(null!==y){y.className="captchaError errorMsg warning wrap";y.innerHTML=m}return}if("undefined"===typeof i[x]){i[x]=grecaptcha.render(x,{sitekey:w,theme:"light",type:"image",tabindex:0,size:t?"compact":"normal",callback:function(z){a(z,u)},"expired-callback":function(){c.reset(x)}});q=l(n);o=window.setTimeout(p,q)}else{window.clearTimeout(o);v.style.display="none"}};var o=window.setTimeout(p,q);b()}catch(r){d(r,"Error loading recaptcha.")}}};j.exportTo(c,"ta.util.ReCaptcha");return c});define("ta/util/GeeTest",["vanillajs","ns-exporter","ta/Core/TA.Record"],function(g,k,d){var h=false;var j="float";var i={};var c="";var e=function(l,m){if(require.defined("ta/util/Error")){require("ta/util/Error").record(l,m)}else{if(ta.merror&&ta.merror.recordError&&("function"===typeof ta.merror.recordError)){ta.merror.recordError(m,null,null,null,l)}}};var a=function(){d.trackEventOnPage("captcha","geetest","displayed")};var f=function(m){var l=m.getElementsByClassName("gt_guide_tip");if(l&&l.length>0&&c){l[0].innerHTML=c}};var b={init:function(o,l){try{if(h||("undefined"!==typeof Geetest)&&Geetest){return}j=l?l:j;c=o;var n=document.createElement("script");n.type="text/javascript";n.async=true;n.defer=true;n.src="https://api.geetest.com/get.php?callback=ta.util.GeeTest.onloadCallback";document.getElementsByTagName("head")[0].appendChild(n);h=true}catch(m){e(m,"Could not inject geetest script on to page.")}},reset:function(l){try{if(i[l]&&("function"===typeof i[l].refresh)){i[l].refresh()}}catch(m){e(m,"Error resetting recaptcha object: "+l)}},resetAll:function(){for(var l in i){if(i.hasOwnProperty(l)){b.reset(l)}}},clear:function(){i={}},showSync:function(o,m,n){var l=0;var p=window.setInterval(function(){if(++l>=40){window.clearTimeout(p);e(null,"GeeTest JS was not loaded on the page.");return}if("undefined"===typeof Geetest){return}b.show(o,m,n);window.clearTimeout(p)},250)},show:function(o,l,n){try{if(("undefined"===typeof Geetest)||!Geetest){e(null,"GeeTest JS was not loaded on the page.");return}if(!o||!l){e(null,"Please pass a site key and element id.");return}var p=document.getElementById(l);if(!p){e(null,"The geetest element id was not found on the page: "+l);return}if(i[l]&&("object"===typeof i[l])&&!n){return}i[l]=new Geetest({gt:o,product:j,https:true});i[l].onReady(function(){f(p)}).appendTo(p);a()}catch(m){e(m,"Error loading geetest captcha.")}},onloadCallback:function(){}};k.exportTo(b,"ta.util.GeeTest");return b});define("utils/memberAudit",["vanillajs","ta","utils/ajax","utils/urlutils","utils/errorutils"],function(b,a,c,e,f){var d=function(k,i,h,g){try{c({type:"POST",url:e.https("/MemberAuditLogger"),error:function(m){var n=m&&m.code?m.code:"";var l=m&&m.status?m.status:"";var o=m&&m.text?m.text:"";f.record(null,"Ajax post request failure(recordMemberAuditLog), code: "+n+", status: "+l+", text: "+o)},data:{action:"MemberAuditLogger",token:i,recordType:k,registrationSessionUid:h,map:JSON.stringify(g)},xhrFields:{withCredentials:true}})}catch(j){f.record(j,"Failed to send an Ajax request to MemberAuditLogger.")}};return{recordMemberAuditLog:d}});define("ta/maps/opener",["vanillajs","api-mod","ta/Core/TA.Event","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/options/closeOnEscape","overlays/styles/windowshade","overlays/utils"],function(i,h,j,b,k,c,a,l,e,m){var g,f,n;var d=function(){if(g){f=1;g.hide()}};j.on("mapOverlayOpened",function(){d();n&&setTimeout(ta.mapsv2.Factory.closeFromOtherThanX,1);n=0});j.on("mapOverlayClosed",d);return{open:function(q,r,u,s){if(q==2){if(!g){var p,o=h.hasClass(document.body,"tablet_desktop"),v=0;if(!o){v=20;p=e()}g=new b(0,[k(0,"center",0,0,0,m.loadingSpinnerHtml()),c.framed([v,v]),a,l,p]);g.on("hide",function(){if(!f){n=1}f=0})}f=n=0;g.show()}var t=q==2?"ta.mapsv2.Factory.createPOIMapViaHashRedirect":"ta.maps.Factory.createFloatMapDelay";j.run(t,{},null,null,r,u,s)}}});ta.servlet.Member={memberBenefitsSubscribe:function(a){ta.servlet.Member.processMOSubscribeRequest(a);return false},memberGuideRequest:function(a){processGuideRequest(a)},memberTOGForm:function(a){processTOGForm(a)},processMOSubscribeRequest:function(a){if(!loggedIn){new Event(a).preventDefault();return false}var d=$("MEMONLY_SUBS_FORM");d.elements.action.value="subscribe";var c={url:"/TravelGuides",data:d,onFailure:function(f){alert(f.status+"\n"+f.responseText)}};c.onSuccess=ta.servlet.Member.subscribeRequestResFunc;var b=window["validate"+d.id];new Event(a).preventDefault();new Request(c).send()},subscribeRequestResFunc:function(a){if(a!=""){for(subtype in subtypes){if(subtyperes[subtype].test(a)){if(subtype=="tw"&&ta.retrieve("tcd.refresh")){window.location.reload()}var g=document.getElementById(subtype+"Optin");g.setAttribute("checked","true");g.setAttribute("disabled","true");var c=document.getElementById(subtype+"OptinLbl");c.innerHTML="<b>"+headings[subtype]+"</b> "+tamg_thanks;var f=document.getElementById("OPTINTEXT");f.style.display="none"}}var j={};for(subtype in subtypes){var d=document.getElementById(formids[subtype]);j[subtype]=d.checked}var h=true;var i=true;for(subtype in j){if(subtyperes[subtype].test(a)){h=false}if(!j[subtype]){i=false}}if(i){var e=document.getElementById("NLSUBMITDIV");e.style.display="none"}if(h){var b=document.getElementById("OPTINTEXT");b.innerHTML='<div class="alert">'+no_selection_error+"</div>";b.style.display="block"}}},addTripWatchLocation:function(event,elmt,updateTxt){var mElmt=new Element(elmt);new Event(event).stop();new Request({url:elmt.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocation"),onSuccess:function(txt,xml){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){ta.overlays.showInLightbox(data.ERROR);return}else{if(data.ALERT){ta.overlays.showInLightbox(data.ALERT);return}}}var spanElt=new Element("span");spanElt.set("html",updateTxt);mElmt.hide();spanElt.inject(mElmt,"after")}}).send()},addTripWatchLocationReload:function(a){new Request({url:a.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocationReload"),onSuccess:function(b,c){window.location.reload()}}).send()}};ta.servlet.Tourism=(function(){var e=window.modelGeoId||0;var k=1;var d=null;var c=200;var a=0;var m=[];var f=false;var g=function(n){var o="modules_visible_"+n;m.each(function(q,p){if(ta.util.element.isScrolledIntoView(q)){ta.trackEventOnPage("Tourism",o,q.getAttribute("data-module"),0,true);m.splice(p,1)}})};var h=function(){var n=Math.floor(window.getSize().y/c)*c;a=n;while(n>=c){j(n);n-=c}};var l=function(){var n=Math.floor(window.getScroll().y/c)*c;if(n>a){a=n;j(n)}};var j=function(n){ta.trackEventOnPage("Tourism","Engagement","scroll"+n,n,true)};var b=function(){if(!f){var n=ta.id("FORUM_CONTENT");if(n&&ta.util.element.isScrolledIntoView(n)){n.load("/TourismForumContentAjax?geo="+e);f=true}}};var i=function(){var o=null;if(ta.retrieve("tourism.promo_bookastay_tourism")){o=ta.find(".highlightsSection .viator_promo")}else{o=ta.find(".highlightsSection .comparePrices")}if(o){var p=function(){if(n()){q();window.removeEvent("scroll",p)}};var n=function(){return o.getCoordinates().top<window.getHeight()+window.getScroll().y};var q=function(){if(ta.retrieve("tourism.promo_bookastay_tourism")){ta.trackEventOnPage("pcb_campaign","promo_bookastay_tourism","",0)}else{if(ta.retrieve("tourism.pcb_dummy_bookastay_tourism")){ta.trackEventOnPage("pcb_dummy","pcb_dummy_bookastay_tourism","",0)}else{ta.trackEventOnPage("pcb_price","pcb_price_tourism_in_view","",0)}}};if(n()){q()}else{window.addEvent("scroll",p)}}};return{init:function(o){if(o&&o>0){e=o}m=ta.select("[data-module]");var p=ta.find(".weatherUnits .selected");d=p&&p.getAttribute("data-unit");g("load");h();i();window.addEvent("scroll",function(){g("scroll");l();b()});var n=ta.find(".navLinks .guides");if(n){ta.trackEventOnPage("Tourism","Nav","guide-nav-show-"+n.getAttribute("data-label"),0)}},showNextChildPage:function(){k++;var n=ta.find(".popularCities");if(n&&e>0){var o={geo:e,offset:k-1,desktop:true};new Request({url:"/TourismChildrenAjax",data:o,method:"get",evalScripts:true,onSuccess:function(q){var p=n.innerHTML+q;n.innerHTML=p;if(k>=ta.retrieve("tourism.popularCitiesMaxPage")){ta.select(".morePopularCities").destroy()}}}).send()}},linkClick:function(o,p,n){var q=new Event(n||window.event);if(q.target){var r=q.target;if(!r.href){r=r.getElement("a")||r.getParent("a")}if(r&&r.getAttribute("data-trk")){p=r.getAttribute("data-trk")}if(r&&r.href){ta.setEvtCookie("Tourism",o,p,0,r.href)}}},trackImpressionEvent:function(){var n=ta.find(".restaurants");var o=document.documentElement.clientHeight;if(n&&n.getPosition().y-o<0){ta.trackEventOnPage("Tourism","Impression_Test","tours_and_tickets")}},nonLinkClick:function(p,q,o){var r=new Event(o||window.event);if(r.target){var n=r.target;if(n&&n.getAttribute("data-trk")){q=n.getAttribute("data-trk")}ta.trackEventOnPage("Tourism",p,q,0)}},noFriendTease:function(o){if(!o||(ta.retrieve("facebook.session.available"))==false){return}var n=o.toString();if(n!="not_authorized"){this.showNoFriendTease()}else{this.showFBConnectTease()}},showNoFriendTease:function(){this.showFirstOfSelect(".travelersReviewed","block");this.showFirstOfSelect(".geoBox.wrap","none");this.showFirstOfSelect(".FBCover","none");this.showFirstOfSelect(".downloadAppSection.wrap","none");this.showFirstOfSelect(".FBThumb","block");this.showFirstOfSelect(".firstOfFriends","block");this.showFirstOfSelect(".findAPlace","block")},showFBConnectTease:function(){this.showFirstOfSelect(".geoBox.wrap","block");this.showFirstOfSelect(".FBCover","block")},showFirstOfSelect:function(o,n){var p=ta.find(o);if(p){p.style.display=n}},friendsLoaded:function(){this.showFirstOfSelect(".travelersReviewed","none");this.showFirstOfSelect(".FBThumb","none");this.showFirstOfSelect(".firstOfFriends","none");this.showFirstOfSelect(".findAPlace","none");var r=ta.select(".highlight #FRIEND_GRID .item");if(r.length==0){return}var t=document.getElement(".downloadAppSection");if(t){t.destroy()}var s=6;var q=ta.select(".highlight .geoBox .item");var o=q.length;if(r.length<=s){o=s*2}else{if(r.length<=s*2){o=s}else{o=0}}if(o==0){var p=document.getElement(".highlight .geoBox");if(p){p.destroy()}}else{if(o<q.length){for(var n=q.length-1;n>=o;n--){q[n].destroy()}}}var p=ta.id("FRIEND_GRID");if(p){p.style.display="block"}},toggleWeatherUnit:function(p,n,o){if(o==d){return}d=o;n.getSiblings().toggleClass("selected");n.toggleClass("selected");ta.select(".weatherInfo .temps").toggleClass("hidden")},showGeoDescription:function(p,n){var o=ta.retrieve("tourism.fullDescription");if(o){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 dg descriptionLB",content:"<p>"+o+"</p>"})}},trackTourismFollowEventOnPage:function(n){if(!ta.has("tourism_followed")){ta.store("tourism_followed",true);ta.trackEventOnPage("tourism_follow","click")}if(window.event){window.event.cancelBubble=true}else{n.stopPropagation()}},trackTourismFollowEventOnNextPage:function(n){ta.setEvtCookie("tourism_follow","click","",0,"/twsubscriptions");if(window.event){window.event.cancelBubble=true}else{n.stopPropagation()}},showTourismBrandBubble:function(){if(window.setTimeout){window.setTimeout(function(){ta.servlet.Tourism.showTourismBrandBubbleContent()},1000)}},showTourismBrandBubbleContent:function(){var o=ta.id("tourismBrandBubble");if(o&&o.getStyle("display")=="none"){o.setStyle("opacity",0);o.setStyle("display","block");var n=new Fx.Tween(o,{duration:1000,property:"opacity"});n.start(0,1)}},hideTourismBrandBubble:function(){if(window.setTimeout){window.setTimeout(function(){ta.servlet.Tourism.hideTourismBrandBubbleContent()},8000)}},hideTourismBrandBubbleContent:function(){var o=ta.id("tourismBrandBubble");if(o&&o.getStyle("display")=="block"){var n=new Fx.Tween(o,{duration:1000,property:"opacity"});n.start(1,0);if(window.setTimeout){window.setTimeout(function(){ta.id("tourismBrandBubble").setStyle("display","none")},1000)}}},clickDestinationResourceLink:function(n){this.clickTourismLink("destination_"+n.toLowerCase()+"_link")},clkDestRsrceLnkId:function(n,o){this.clickTourismLinkWithId("destination_"+n.toLowerCase()+"_link",o)},clickTourismLink:function(n){ta.trackEventOnPage("dmo_tourism_links",n)},clickTourismLinkWithId:function(n,o){ta.trackEventOnPage("dmo_tourism_links",n,o,o)},clickTrvlGuideLink:function(s,q,o,p,n,r,t){if(n=="TripList"){ta.trackEventOnPage("Tourism",o,p)}else{ta.trackEventOnPage("Traveler_Guide",o,p);ta.setEvtCookie("TravelGuides","guideClick",r,t,q.href)}},trkDmoClick:function(n){ta.trackEventOnPage("Tourism","DMO",n)},trkDmoContentClick:function(q,o,n){var p=encodeURIComponent((o||""));ta.trackEventOnPage("DMO_content_click",p,n,q)}}})();ta.widgets.slider={handleSeparation:10,isRtl:function(){return ta.util.i18n.isRtl()},getValue:function(c,b){var a="";if(this.isRtl()){if(c.style.right&&c.style.right.trim()!=""){a=c.style.right}else{a=b.style.left}}else{a=c.style.left}if(a!=""){return a.toFloat()}return 0},resetHooks:function(e){var d=e.hasClass("slider_redesign")?e:e.getElement(".slider_redesign");var c=d.className;var b=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));var a=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));return this.setHooks(e,b,a)},setHooks:function(q,e,g,d,f){var m=q.hasClass("slider_redesign")?q:q.getElement(".slider_redesign");var h=m.className;var o=parseInt(h.match(/steps_(\d+)/)[1]);var k=parseFloat((h.match(/min_(\d+)/)[1]).replace("_","."));if(d&&k!=d){m.removeClass("min_"+k);m.addClass("min_"+d);k=d}var n=parseFloat((h.match(/max_(\d+)/)[1]).replace("_","."));if(f&&n!=f){m.removeClass("max_"+n);m.addClass("max_"+f);n=f}if(e<k){e=k}if(g>n){g=n}var i=parseInt(h.match(/width_(\d+)/)[1])-this.handleSeparation;var c=m.hasClass("maxAllInclusive");var p=i/(o-1);var a=(n-k)/(o-1);var l=(e-k)/a;var r=(g-k)/a;this.updateEnd(m.getElement(".handle-left"),this.isRtl()?r:l,p,true);this.updateEnd(m.getElement(".handle-right"),this.isRtl()?l:r,p,false);this.updateBar(m.getElement(".slider-range"),l,r,p,"set");var b=c&&(g>=n);if(m.id=="priceSelect"){this.priceUpdate(q,e,g,b)}else{if(m.id=="ratingSelect"){this.ratingUpdate(q,e,g,b)}else{if(m.id=="bedroomsSelect"){this.bedroomsUpdate(q,e,g,b)}else{this.simpleUpdate(q,e,g,b)}}}var t=q.getElement(".minMax");var s=t.value;var j=this.updateMinMax(t,l,r,a,o,k);return s!=j},updateMinMax:function(f,g,b,a,c,e){var d=(g<=0?0:g*a+e)+","+(b>=(c-1)?999999:b*a+e);f.value=d;return d},updateEnd:function(d,c,e,b){var a=c*e+(this.isRtl()^b?0:this.handleSeparation);if(this.isRtl()){d.setStyle("right",a+"px");d.setStyle("left","")}else{d.setStyle("left",a+"px");d.setStyle("right","")}return a},updateBar:function(b,g,d,f){if((g>d)){g^=d;d^=g;g^=d}var a=g*f;var c=(d*f+this.handleSeparation)-a;if(c<0){c*=-1}var e=this.isRtl()?"right":"left";if(this.isRtl()){b.setStyle("right",a)}else{b.setStyle("left",a)}b.setStyle("width",c)},initSliderInfo:function(e){var d={};var c=e.className;d.width=parseInt(c.match(/width_(\d+)/)[1])-this.handleSeparation;d.steps=parseInt(c.match(/steps_(\d+)/)[1]);d.min=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));d.max=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));d.stepSize=(d.max-d.min)/(d.steps-1);d.maxAllInclusive=e.hasClass("maxAllInclusive");d.snapDistance=d.width/(d.steps-1);d.rangeBar=e.getElement(".slider-range");d.minMax=e.getElement(".minMax");d.startMinMax=d.minMax.value;d.singleValue=e.hasClass("singleValue");var f=e.getParent().getElement(".handle-left");var b=e.getParent().getElement(".handle-right");var g=this.getValue(f,b);var a=this.getValue(b,f);if(this.isRtl()){g-=this.handleSeparation}else{a-=this.handleSeparation}d.leftStep=this.getClosestStep(g,d);d.rightStep=this.getClosestStep(a,d);return d},setSliderTarget:function(b,a){if(b.hasClass("handle-left")){a.target=b.getParent().getElement(".handle-left");if(this.isRtl()){a.limits=[a.rightStep+(a.singleValue?0:1),a.steps-1]}else{a.limits=[0,a.rightStep-(a.singleValue?0:1)]}a.isLeftHook=true}else{a.target=b.getParent().getElement(".handle-right");if(this.isRtl()){a.limits=[0,a.leftStep-(a.singleValue?0:1)]}else{a.limits=[a.leftStep+(a.singleValue?0:1),a.steps-1]}a.isLeftHook=false}return a},handleMouseDown:function(f,a){var d=new Event(f);if(d){d.stop();var c=ta.id(d.target);if(c){var b=this.initSliderInfo(c.getParent());b=this.setSliderTarget(c,b);b.snapCallBack=a.bind(this);b.dragHandle=this.handleMouseMove.bind(this);b.upHandle=this.handleMouseUp.bind(this);document.addListener("mousemove",b.dragHandle);document.addListener("mouseup",b.upHandle);document.addListener("touchmove",touchHandler);document.addListener("touchend",touchHandler);b.offset=c.getParent().getCoordinates().left+10+(b.isLeftHook?0:this.handleSeparation);ta.store("slider_info",b)}}},getClosestStep:function(a,b){return Math.round(a/b.snapDistance)},handleMouseMove:function(d){d=new Event(d);var b=ta.retrieve("slider_info");if(b&&b.target){var c=d.page.x-b.offset;var a=this.getClosestStep(c,b);if(this.isRtl()){a=b.steps-a-1}if(a<b.limits[0]){a=b.limits[0]}else{if(b.limits[1]<a){a=b.limits[1]}}this.sliderDrag(d,a,b,c)}d.stop()},sliderDrag:function(d,g,j,i){if(d){d.stop();var a=j.isLeftHook?g:j.leftStep;var h=j.isLeftHook?j.rightStep:g;this.updateEnd(j.target,g,j.snapDistance,j.isLeftHook);this.updateBar(j.rangeBar,a,h,j.snapDistance);this.updateMinMax(j.minMax,a,h,j.stepSize,j.steps,j.min);ta.store("slider_info",j);if(j.snapCallBack){var b=(this.isRtl()?h:a)*j.stepSize+j.min;var f=(this.isRtl()?a:h)*j.stepSize+j.min;var c=j.maxAllInclusive&&(f==(j.steps-1)*j.stepSize+j.min);j.snapCallBack(j.target,b,f,c)}}},handleMouseUp:function(b){b=new Event(b);if(b){b.stop()}var a=ta.remove("slider_info");if(a){document.removeListener("mousemove",a.dragHandle);document.removeListener("mouseup",a.upHandle);document.removeListener("touchmove",touchHandler);document.removeListener("touchend",touchHandler);a.dragHandle=null;a.upHandle=null;if(a.minMax.value!=a.startMinMax){sliderMoved()}}},currencyUpdate:function(){ta.util.error.record({name:"Deprecated",message:"ta.widgets.Slider.currencyUpdate will be going away soon and should not be used."},"Slider JS Cleanup",null,null,"WARN");var b=ta.id("l1currency");if(!b){return}var f=ta.retrieve("ta.currencyHash");if(!f){return}var h=f[parseInt(b.value)];var k=ta.id("pricePeriod_w");if((k!=null)&&k.checked){var j=ta.retrieve("ta.weekCurrencyHash");if(j){h=j[parseInt(b.value)]}}var i=ta.id("priceSelect").getParent();var a=i.getElement(".slider_redesign");var g=a.className;var d=currencyCodes[parseInt(i.getElement("select").value)];var c=ta.has("hacform.slider.price.min")?ta.remove("hacform.slider.price.min"):h.selMin;var e=ta.has("hacform.slider.price.max")?ta.remove("hacform.slider.price.max"):h.selMax;a.className=g.replace(/steps_\d+/,"steps_"+h.steps);ta.widgets.slider.setHooks(i,c,e,h.min,h.max)},priceUpdate:function(f,d,b,a){if(!f.hasClass("prcRng")){f=f.getParent(".prcRng")}var g=ta.id("l1currency");var e=currencyCodes[parseInt(g.value)];f.getElement(".s_min").innerHTML=ta.util.currency.formatCurrency(d,e);var c=ta.util.currency.formatCurrency(b,e);if(a){c+="+"}f.getElement(".s_max").innerHTML=c},ratingUpdate:function(g,e,c,b){if(!g.hasClass("tvrRtg")){g=g.getParent(".tvrRtg")}var a=e.toPrecision(2);var h=c.toPrecision(2);g.getElement(".s_min").innerHTML=a;g.getElement(".s_max").innerHTML=h;var d=g.getElement(".sLeft .lmtImg").src;g.getElement(".sLeft .lmtImg").src=d.replace(/\d.\d/,a);var f=g.getElement(".sRight .lmtImg").src;g.getElement(".sRight .lmtImg").src=f.replace(/\d.\d/,h)},bedroomsUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=(c==0?js_filter_studio:c);d.getElement(".s_max").innerHTML=(b==0?js_filter_studio:(b+(a?"+":"")))},simpleUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=c;d.getElement(".s_max").innerHTML=b+(a?"+":"")}};function touchHandler(c){var d=c.changedTouches,e=d[0],a="";switch(c.type){case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var b=document.createEvent("MouseEvent");b.initMouseEvent(a,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);e.target.dispatchEvent(b);c.preventDefault()}if(!window.sliderMoved){window.sliderMoved=function(){if(!window.slidersReady){return}ta.servlet.HACSearch.adjustTopValueState();var a=window.pageServlet=="LocalMapsRedesign";filtersChanged(null,a)}};(function(){var b=new Class({Implements:[Options,Events],URL_SAVE_CONTROLLER:"/SavesAjax",parentName:null,parentFolderId:0,entityId:0,entityType:5,securityToken:"",guideId:0,tripGuideId:0,savedItems:{},sessionSavedItems:[],isUserLoggedIn:false,options:{savesTree:null},initialize:function(c){this.setOptions(c);if(this.options.savesTree){this.setSavesTree(this.options.savesTree)}this.addEvent("saveCompleteForTracking",this.trackSuccessfullSave);ta.on("regUpdateMember",function(){ta.widgets.Saves.setLoggedIn(true);ta.widgets.SavesButtons.refresh()});this.securityToken=window.JS_SECURITY_TOKEN||""},refresh:function(c){this.setOptions(c);if(this.options.savesTree){this.setSavesTree(this.options.savesTree)}},openSavesHoverRegflow:function(c){var f=ta.widgets.Saves;var e=1;if(c&&c.target&&c.target.getParent(".listing")){e=c.target.getParent(".listing").get("data-rankInList")}ta.trackEventOnPage("HoverSave","saveIntent",f.entityId,e,false);ta.store("registration.ga_module","SavesHover");if(f.isUserLoggedIn){f.refreshLoggedInHoverSaves()}else{var d={flow:"CORE_COMBINED",pid:39766,userRequestedForce:true,onSuccess:function(){ta.widgets.Saves.refreshLoggedInHoverSaves()}};ta.call("ta.registration.RegOverlay.show",c,c.target,d)}},openMastheadRegflow:function(c){ta.store("registration.ga_module","Masthead");ta.overlays.registration.connect({flow:"MASTHEAD"},"SIGNUP")},trackSuccessfullSave:function(e,c,d){if(!e){return}ta.trackEventOnPage("HoverSave","saveComplete",c,1,false);new Request({url:"/ActionRecord?action=Save_Completed"}).send()},setSavesTree:function(){},getSavesTree:function(c){if(this.options.savesTree&&!c){return this.options.savesTree}else{}},_logAjaxError:function(e,f,c,d){var g=new Error();g.name=f;g.message=e&&e.error||c;ta.util.error.record(g,d,null,null,"WARN")},saveCall:function(f,d){var h=this;this.entityType=f;this.entityId=d;for(var c in this.sessionSavedItems){if(this.entityId==this.sessionSavedItems[c]){this.showSaved();return}}var g={action:"SAVE_ITEM",entity:this.entityId,type:this.entityType,token:this.securityToken};var e=new Request({url:this.URL_SAVE_CONTROLLER,data:g,onRequest:function(){h.fireEvent("saveComplete",[true,d,f])},onSuccess:function(i){var k=false;i=JSON.decode(i);if(!i){return}if(i.error){if(i.error=="DUPITEM"){h.fireEvent("saveComplete",[k,d,f]);h.fireEvent("saveCompleteForTracking",[k,d]);ta.widgets.SavesButtons.refresh()}h._logAjaxError(i,"saves save item","Error while calling SAVE_ITEM with entityId: "+d+" and entityType: "+f+".","saveCall");return}else{k=true}var j;if(k&&i.id){j=i.id}h.fireEvent("saveComplete",[k,d,f,j,i.folderid,h.btn]);h.fireEvent("saveCompleteForTracking",[k,d,j,i.folderid,h.btn]);h.entityId=0;h.btn=null}}).send();return e},unsaveCall:function(g,c,e){var h=this;e=e||5;var f={action:"DELETE_ITEM",id:g,token:this.securityToken};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onRequest:function(){h.fireEvent("unsaveComplete",[true,g,c,e])},onSuccess:function(i){if(i!=""){i=JSON.decode(i);if(!i||i.error){h._logAjaxError(i,"saves unsave item","Unknown error while deleting : "+g,"unsaveCall")}}h.fireEvent("unsaveComplete",[i,g,c,e])}}).send();return d},saveGuideCall:function(c){var e=this;var d={action:"SAVE_GUIDE",guideid:c,token:this.securityToken};new Request({url:this.URL_SAVE_CONTROLLER,data:d,onSuccess:function(g){var i=true;var h=null;var f=null;g=JSON.decode(g);if(!g||g&&g.error){i=false;e._logAjaxError(g,"saves save guide","Unknown error while saving guide : "+c,"saveGuideCall")}else{h=g.folder;f=g.items}this.guideId=0;e.fireEvent("saveGuideComplete",[i,h,f]);ta.trackEventOnPage("GuideSave","saveComplete",c,1,false);new Request({url:"/ActionRecord?action=Guide_Save_Completed"}).send()}}).send()},saveTripGuideCall:function(c){var e=this;var d={action:"SAVE_TRIP_GUIDE",guideid:c,token:this.securityToken};new Request({url:this.URL_SAVE_CONTROLLER,data:d,onSuccess:function(g){var i=true;var h=null;var f=null;g=JSON.decode(g);if(!g||g&&g.error){i=false;e._logAjaxError(g,"saves save tripguide","Unknown error while saving tripguide : "+c,"saveTripGuideCall")}else{h=g.folder;f=g.items}this.guideId=0;e.fireEvent("saveTripGuideComplete",[i,h,f]);ta.trackEventOnPage("TripGuideSave","saveComplete",c,1,false);new Request({url:"/ActionRecord?action=Trip_Guide_Save_Completed"}).send()}}).send()},getSavesCall:function(d){var e=this;var c={action:"FETCH_ALL_ITEMS",};if(!d&&this.options.savesTree){e.fireEvent("retrievedSaves",[this.options.savesTree])}new Request({url:this.URL_SAVE_CONTROLLER,data:c,method:"GET",onSuccess:function(f){f=JSON.decode(f);if(!f||f&&f.error){e._logAjaxError(f,"saves get saves","Unknown error while fetching items.","getSavesCall")}else{e.savedItems=f}e.fireEvent("retrievedSaves",[f])}}).send()},moveCall:function(g,c,e){var h=this;var f={action:"MOVE_ITEM",id:g,folder:c,token:this.securityToken};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(i){if(i!=""){i=JSON.decode(i);if(!i||i.error){h._logAjaxError(i,"saves move item","Unknown error while moving : "+g,"moveCall")}}h.fireEvent("moveComplete",[i,g,c,e])}}).send();return d},addNoteCall:function(f,c,h){var g=this;var e={action:"ADD_NOTE",id:f,note:c,token:this.securityToken};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:e,onSuccess:function(i){if(i!=""){i=JSON.decode(i);if(!i||i.error){g._logAjaxError(i,"saves add note","Unknown error while adding note to : "+f,"addNoteCall")}}g.fireEvent("addNoteComplete",[i,f,c]);if(typeof h=="function"){h(i,f,c)}}}).send();return d},addFolderNoteCall:function(c,d,h){var g=this;var f={action:"ADD_FOLDER_NOTE",id:c,note:d,token:this.securityToken};var e=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(i){if(i!=""){i=JSON.decode(i);if(!i||i.error){g._logAjaxError(i,"saves add folder note","Unknown error while adding folder note to : "+c,"addFolderNoteCall")}}g.fireEvent("addFolderNoteComplete",[i,c,d]);if(typeof h=="function"){h(i,c,d)}}}).send();return e},createFolderCall:function(c,g){var f=this;var e={action:"CREATE_FOLDER",name:c,token:this.securityToken};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:e,onSuccess:function(i){if(i!=""){i=JSON.decode(i);if(!i||i.error){f._logAjaxError(i,"saves create folder","Unknown error while creating folder named : "+c,"createFolderCall")}}var h=i&&i.folderid?i.folderid:"";var j=i&&i.foldername?i.foldername:"";f.fireEvent("createFolderComplete",[i,h,j]);if(typeof g=="function"){g(i,h,j)}}}).send();return d},deleteFolderCall:function(c,g){var f=this;var e={action:"DELETE_FOLDER",id:c,token:this.securityToken};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:e,onSuccess:function(h){if(h!=""){h=JSON.decode(h);if(!h||h.error){f._logAjaxError(h,"saves delete folder","Unknown error while deleting folder : "+c,"deleteFolderCall")}}f.fireEvent("deleteFolderComplete",[h,c]);if(typeof g==="function"){g(h,c)}}}).send();return d},renameFolderCall:function(c,d,h){var g=this;var f={action:"RENAME_FOLDER",id:c,name:d,token:this.securityToken};var e=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(i){if(i!=""){i=JSON.decode(i);if(!i||i.error){g._logAjaxError(i,"saves rename folder","Unknown error while renaming folder of : "+c,"renameFolderCall")}}g.fireEvent("renameFolderComplete",[i,c,d]);if(typeof h==="function"){h(i,c,d)}}}).send();return e},refreshLoggedInHoverSaves:function(){var c=ta.widgets.Saves;if(c.guideId!=0){c.saveGuideCall(c.guideId)}else{if(c.tripGuideId!=0){c.saveTripGuideCall(c.tripGuideId);c.tripGuideId=0}else{c.saveCall(c.entityType,c.entityId)}}},setLoggedIn:function(c){this.isUserLoggedIn=c}});if(!ta.widgets.Saves){ta.widgets.Saves=new b()}var a=new Class({Implements:[Options,Events],lastBtnClicked:null,options:{isGuidePage:false,listingClass:"listing"},initialize:function(c){this.setOptions(c);this.PAGE=ta.id("PAGE");ta.widgets.Saves.addEvent("saveComplete",this.setBtnSavedState.bind(this));ta.widgets.Saves.addEvent("unsaveComplete",this.setBtnUnsavedState.bind(this));ta.widgets.Saves.addEvent("retrievedSaves",this.setAllBtnStates.bind(this));ta.widgets.Saves.addEvent("saveGuideComplete",this.onGuideSaved.bind(this));ta.widgets.Saves.addEvent("saveTripGuideComplete",this.onTripGuideSaved.bind(this));ta.queueForReady(function(){var d=ta.id("SAVE_ALL_BUTTON");if(d){d.addEvent("click",function(g){var f=this.get("data-guideid");var e=this.get("data-tripguideid");if(f){ta.widgets.Saves.guideId=f;ta.widgets.Saves.btn=this;ta.call("ta.overlays.Factory.openSavesHoverRegflow",g)}else{if(e&&!this.hasClass("saved")){ta.widgets.Saves.tripGuideId=e;ta.widgets.Saves.btn=this;ta.call("ta.overlays.Factory.openSavesHoverRegflow",g)}}g.preventDefault()})}})},refresh:function(){ta.widgets.Saves.getSavesCall()},bindListingEvents:function(){var d=this;var c=$$("."+this.options.listingClass);if(!c||!c.length){return}c.removeEvents("mouseenter").removeEvents("mouseleave").addEvents({mouseenter:function(){d.overHover(this)},mouseleave:function(){d.outHover(this)}})},setBtnSavedState:function(d,e,h,i,c,f){var g=this.getBtnsByEntityId(e,h);if(g.length){this.showSaved(g,i)}if(this.lastBtnClicked&&e==this.lastBtnClicked.get("data-locationid")){this.showSaveAlert(this.lastBtnClicked)}},setBtnUnsavedState:function(c,g,d,f){var e=this.getBtnsByEntityId(d,f);if(e.length){this.showUnsaved(e,g)}},setAllBtnStates:function(c){var e=this;if(!c){c=ta.widgets.Saves?ta.widgets.Saves.savedItems:{}}Object.each(c,function(h,f){var g=e.getBtnsByEntityId(h.entityId,h.entityType);if(g&&g.length){e.showSaved(g,f)}});ta.select(".savesHover").each(function(f){e.bindBtnEvents(f)});var d=ta.id("HEADING_GROUP");if(d){d.getElements(".savesContainer, .savesHover").setStyles({visibility:"visible",display:"block"})}if(this.options.isGuidePage){this.setGuideSaveState()}if(!isTabletOnFullSite){this.bindListingEvents()}},setGuideSaveState:function(e){var d=ta.id("GUIDE_DETAIL");if(!d){return}var c=d.getElements(".savesHover");var f=c.filter(".saved");if(e===true||c.length==f.length){ta.id("SAVE_ALL_BUTTON")&&ta.id("SAVE_ALL_BUTTON").hide();ta.id("ALL_SAVED_BUTTON")&&ta.id("ALL_SAVED_BUTTON").show()}else{if(e===false||c.length!=f.length){ta.id("ALL_SAVED_BUTTON")&&ta.id("ALL_SAVED_BUTTON").hide();ta.id("SAVE_ALL_BUTTON")&&ta.id("SAVE_ALL_BUTTON").show()}}},onGuideSaved:function(e,d,c){var f=this;if(e){this.setGuideSaveState(true);if(c&&c.length){c.each(function(h,g){var j=f.getBtnsByEntityId(h.entityid);f.showSaved(j,h.id)})}}},onTripGuideSaved:function(e,d,c){var f=this;if(e){ta.store("tripGuideSavedFolder",d.folderid);f.swapSaveText(ta.widgets.Saves.btn);ta.widgets.Saves.btn.addClass("saved");if(c&&c.length){c.each(function(h,g){var j=f.getBtnsByEntityId(h.entityid);f.showSaved(j,h.id)})}}},bindBtnEvents:function(e){var j=this;var f=e.getParent();var m=f.getElement(".saveOptions");e.removeEvents();if(m){m.getElement(".btn-delete").removeEvents()}if(e.hasClass("saved")){var i=e.get("data-locationid");var h=e.get("data-entity-type")||5;var l=e.get("data-saveitemid");if(e.hasClass("savesHover-confirm-delete")){e.addEvent("click",function(){if(!m.isDisplayed()){j.showPositionedTip(this)}else{j.hidePositionedTip(m)}});m.getElement(".btn-delete").addEvent("click",function(){ta.widgets.Saves.unsaveCall(l,i,h);j.hidePositionedTip(m)})}else{e.addEvent("click",function(){ta.widgets.Saves.unsaveCall(l,i,h)})}j.closeHoverAlert(e)}else{var c=e.getParent(".savesContainer");if(c){var g=c.getElement(".hoverAlert");if(g){var d=false;e.addEvent("mouseenter",function(){if(!d){ta.trackEventOnPage("HoverSave","saveHover",i,1,false);d=true}j.showHoverAlert(e)});e.addEvent("mouseleave",function(){j.closeHoverAlert(e)})}var k=c.getElement(".saveAlert");if(k){j.closeSaveAlert(k)}}e.addEvent("click",function(p){var n=this.get("data-locationid");if(!n){return}var o=this.get("data-entity-type");if(!o){o=5}ta.widgets.Saves.entityId=n;ta.widgets.Saves.entityType=o;ta.widgets.Saves.btn=this;j.lastBtnClicked=this;ta.widgets.Saves.openSavesHoverRegflow(p);ta.trackEventOnPage("Saves","HoverButton",n,o)})}},overHover:function(e){e=ta.id(e);if(!e.hasClass("promoted")){if(!ta.isMetaHotels2013()&&!ta.has("meta.mini_meta_on_accommodations")){e.setStyle("background-color","#f1f1f1")}else{var d=e.getElement(".metaDisclaimer");if(d){d.setStyle("visibility","visible")}}}var c=e.getElement(".savesHover");if(c&&!c.hasClass("saved")&&c.hasClass("invisible")){c.removeClass("invisible")}var f=e.getElement(".hideHover");if(f&&f.hasClass("invisible")){f.removeClass("invisible")}},outHover:function(e){e=ta.id(e);if(!e.hasClass("promoted")){if(!ta.isMetaHotels2013()&&!ta.has("meta.mini_meta_on_accommodations")){e.setStyle("background-color","#fff")}else{e.removeClass("hoverShadow");var d=e.getElement(".metaDisclaimer");if(d){d.setStyle("visibility","hidden")}}}var c=e.getElement(".savesHover");if(c&&!c.hasClass("vr-heartContainer")&&!c.hasClass("saved")&&!c.hasClass("invisible")){c.addClass("invisible")}var f=e.getElement(".hideHover");if(f&&!f.hasClass("invisible")){f.addClass("invisible")}},getBtnsByEntityId:function(e,h){var c=ta.select(".savesHover-"+e);if(!c){return c}if(!h){return c}var g=[];var d;for(var f=0;f<c.length;f++){d=c[f].get("data-entity-type")||5;if(d==h){g.push(c[f])}}return g},showUnsaved:function(c,i){var e=this;if(c){if(c.length){c.each(function(l){e.showUnsaved(l,i)});return}if(c.hasClass("saved")){this.swapSaveText(c)}c.removeClass("saved");c.removeProperty("data-saveitemid");var f=c.getElement(".sprite-star_green");if(f){var g="sprite-star_gray";var k="sprite-star_green";f.addClass(g).removeClass(k)}if(c.getElement(".vr-icon")){var h=c.getElement(".vr-icon");if(h.hasClass("saved")){h.removeClass("saved");h.addClass("save");ta.vr.actionRecord("Unsave_VRR")}}var j=c.getElement(".sprite-hoverArrow");if(j){j.hide();var d=c.getElement(".vr_button_silver_border");if(d){d.removeClass("vr_button_silver_border").addClass("vr_button_silver")}}this.bindBtnEvents(c)}},showSaved:function(c,i){var e=this;if(c){if(c.length){c.each(function(m){e.showSaved(m,i)});return}if(!c.hasClass("saved")){this.swapSaveText(c)}c.addClass("saved");c.set("data-saveitemid",i);c.removeClass("invisible");var l=c.getElement(".sprite-save");if(l){l.hide()}var f=c.getElement(".sprite-star_gray");if(f){var g="sprite-star_green";var k="sprite-star_gray";f.addClass(g).removeClass(k)}if(c.getElement(".vr-icon")){var h=c.getElement(".vr-icon");if(h.hasClass("save")){h.removeClass("save");h.addClass("saved");if(h.hasClass("initial")){h.removeClass("initial")}else{ta.vr.actionRecord("Save_Success_VRR")}}}var j=c.getElement(".sprite-hoverArrow");if(j){j.show();var d=c.getElement(".vr_button_silver");if(d){d.removeClass("vr_button_silver").addClass("vr_button_silver_border")}}this.bindBtnEvents(c)}},swapSaveText:function(d){var c;var e;if(d.hasClass("vr-heartContainer")){c=d.getElement(".vr-saved");e=d.getElement(".vr-unsaved")}else{c=d.getElement(".saves-hover-txt-saved");e=d.getElement(".saves-hover-txt")}if(c){this.toggleVisibility(c)}if(e){this.toggleVisibility(e)}},toggleVisibility:function(c){var d=!ta.has("fall_2013_hr_saves_right");var f=d?c.isVisible():c.getStyle("visibility")!=="hidden";if(f){if(d){c.hide()}else{c.setStyle("visibility","hidden")}}else{if(d){var e;if(c.getParentBySelector("#why_ta_saves")){e="block"}else{e="inline"}c.show(e)}else{c.setStyle("visibility","visible")}}},hidePositionedTip:function(c){if(c){c.hide()}},showPositionedTip:function(d,c){var e=d.getParent();var f=e.getElement(".saveOptions");if(!f){if(typeof c=="function"){c()}return}f.show()},showSaveAlert:function(g){var c=g.getParent(".savesWrap");var h=c?c.getElement(".saveAlert"):null;if(!h){return}if(ta.has("meta.full_meta_photos")&&!ta.has("meta.full_meta_photos_v3")){if(ta.id("SAVES")){var f=32;var d=-5;h.setStyles({top:f,left:d}).show()}}else{h.show()}var e=this;setTimeout(function(){e.closeSaveAlert(h,h)},5000)},closeSaveAlert:function(c){c=ta.id(c);if(c){c.hide()}},showHoverAlert:function(d){var c=d.getParent(".savesWrap");var e=c?c.getElement(".hoverAlert"):null;if(!e){return}e.show()},closeHoverAlert:function(d){var c=d.getParent(".savesWrap");var e=c?c.getElement(".hoverAlert"):null;e=ta.id(e);if(!e){return}if(e){e.hide()}},assetsLoaded:function(){if(ta.id("SAVES")){ta.id("SAVES").setStyle("top",ta.id("HEADING").getTop()-123);ta.id("SAVES").show()}},assetsLoadedHeader:function(){var d=ta.id("SAVES");var c=ta.id("HR_HACKATHON_CONTENT");if(d&&c&&!ta.has("meta.full_meta_photos")&&!ta.has("feature.hr_css_reduction")){d.setStyle("top",c.getCoordinates().top);d.show()}},loadSavesButton:function(d,g,e,c,f){if(!ta.retrieve("saves_button_"+d)){ta.store("saves_button_"+d,true);if(ta.id("saves_placeholder_"+d)){new Request({url:"/SavesButtonAjax",onSuccess:function(i){try{if(i&&i.trim()!="BAD_REQUEST"){ta.id("saves_placeholder_"+d).innerHTML=i;ta.select(".savesHover-"+d).each(function(j){ta.widgets.SavesButtons.bindBtnEvents(j);j.removeClass("invisible")})}else{ta.util.error.record(null,"Failed to load saves button BAD_REQUEST",null,{DBLE_ID:d},"WARN")}}catch(h){ta.util.error.record(h,"Failed to load saves button",null,{DBLE_ID:d})}},data:{pop:g,del:e,dble:d,head:c,referringServlet:f},evalScripts:true,method:"get"}).send()}}},loadAllSavesButtons:function(){if(!ta.has("SAVES_BUTTONS_LOADED")&&typeof saveLocationsOnPage!="undefined"){ta.store("SAVES_BUTTONS_LOADED",true);window.removeEvent("scroll",ta.widgets.SavesButtons.loadAllSavesButtons);new Request({url:"/SavesButtonAjax",onSuccess:function(f){try{if(f&&f.trim()!="BAD_REQUEST"){var d=JSON.decode(f);if(d){d.each(function(g){var e=ta.id("saves_placeholder_"+g.id);if(e){e.innerHTML=ta.util.escaping.escapeHTMLSafe(g.html)}});ta.select(".savesHover").each(function(e){ta.widgets.SavesButtons.bindBtnEvents(e)})}}else{ta.util.error.record(null,"Failed to load saves buttons BAD_REQUEST",null,null,"WARN")}}catch(c){ta.util.error.record(c,"Failed to load saves buttons")}},data:{locations:saveLocationsOnPage.join()},evalScripts:true,method:"post"}).send()}}});if(!ta.widgets.SavesButtons){ta.widgets.SavesButtons=new a({})}})();ta.overlays||(ta.overlays={});ta.overlays.BACKDROP_NEVER=0;ta.overlays.BACKDROP_ALWAYS=1;ta.overlays.Overlay=new Class({Implements:[Options,Events],Binds:["_hide","show","hide","destroy","hideByClickOnDocument"],options:{requestData:null,showCloseButton:false,noPadding:false,noCpu:false,closeButtonClass:"close",closeLink:"",showArrow:false,arrowClassLeft:null,arrowClassRight:null,arrowClass:"ttarrow",style:"typeO",innerDivClass:"inner",backdrop:ta.overlays.BACKDROP_NEVER,backdropZIndex:"default",permanent:false,permanent_except_same:false,type:"",isChild:false,remoteContent:null,maintainCrPageServlet:false,keepElementInDocument:false,requestMethod:"get",zIndex:1001,positionType:"absolute",draggable:false,draggingClass:"dragging",title:null,onscroll:null,noScroll:false,noScrollY:false,backdropClickClose:false,backdropColor:"#000",backdropOpacity:0.6,offsetRight:0,offsetLeft:0,offsetTop:0,offsetBottom:0,closeOnDocumentClick:false,track:false,positionByOffsets:false,useTransparentOverlayPadding:false,transparentOverlayPaddingValue:0},initialize:function(k,b){this.noScroll=k.noScroll||k.noScrollY;if(k.noScroll){this.overflowToHide="overflow"}else{if(k.noScrollY){this.overflowToHide="overflow-Y"}}if(this.noScroll){var a=k.onShow;k.onShow=function(){if(a){a()}ta.find("body").setStyle(this.overflowToHide,"hidden")};var j=k.onClose;k.onClose=function(){if(j){j()}ta.find("body").setStyle(this.overflowToHide,"")}}this.setOptions(k);this.source=ta.id(b);this.visible=false;this.backdropOn=false;this.closedByDocClick=false;var h=this.options.style+" overlay oldoly";if(this.options.backdrop==ta.overlays.BACKDROP_ALWAYS){h+=" withBackdrop"}else{h+=" noBackdrop"}this.container=new Element("div",{styles:{position:this.options.positionType,left:"-999em",top:"-999em",fontSize:this.options.fontSize||".75em",zIndex:this.options.zIndex},"class":h});if(k.blockSelect){this.container.onselectstart=function(){return false}}this.container.overlay=this;ta.store("overlays.current",this);this._useIframeShim=Browser.ie6;if(this.options.title){this.header=new Element("h1",{"class":"title",html:this.options.title}).inject(this.container);if(this.options.draggable){var i=this.options.draggingClass;var d=function(){};if(this._useIframeShim){d=this.positionShim.bind(this)}if(this.options.useTransparentOverlayPadding){d=this.transparentOverlayPadding.bind(this)}this.drag=new Drag(this.container,{handle:this.header,preventDefault:true,stopPropagation:true,onSnap:function(e){e.addClass(i)},onDrag:d,onComplete:function(e){e.removeClass(i)}})}}this.inner=new Element("div",{"class":this.options.innerDivClass}).inject(this.container);this.inner.id="overlayInnerDiv";var f=this;if(f.options.onscroll){f.inner.addEvent("scroll",function(){f.options.onscroll(f.inner)})}if(this._useIframeShim){this.shim=new IframeShim(this.container,{browsers:true})}if(this.options.useTransparentOverlayPadding){this.transparentOverlayPadding=new Element("div",{"class":"overlayPadding",styles:{position:"absolute","z-index":this.options.zIndex-1}});this.transparentOverlayPaddingValue=this.options.transparentOverlayPaddingValue}var c;if(this.options.content){this.inner.setContent(this.options.content)}else{if(this.options.remoteContent){this.loadRemoteContent(this.options.remoteContent)}else{if(this.source&&(c=this.source.getElement(".overlayContents"))){if(c){this.inner.set("html",c.innerHTML);c.dispose();this.runBehaviorOnFirstShow=true}}}}if(this.options.showCloseButton){this.addCloseButton()}else{if(this.options.setCloseButton){this.setCloseButton()}}if(this.options.showArrow){this.arrow=new Element("div",{styles:{position:"absolute"},"class":this.options.arrowClass}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}if(this.options.noPadding){if(this.header){this.container.addClass("noPad")}else{this.inner.addClass("noPad")}}if(this.options.noCpu){if(this.header){this.container.addClass("no_cpu")}else{this.inner.addClass("no_cpu")}}this.container.addEvent("trash",this.destroy);if("g_logFactoryMisuse" in window){try{ta.util.error.record(Error(),"Debug: Overlay on "+window.pageServlet)}catch(g){}}},addCloseButton:function(){var a=this.options.closeButtonClass;if(ta.has("checkrates.add_holding_windows")){a+=" no_cpu"}this.closeBtn=new Element("div",{styles:{position:"absolute",fontSize:"92.5%",cursor:"pointer"},html:this.options.closeLink,"class":a,events:{click:(function(){this.fireEvent("onClose",this)}).bind(this)}}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}},setCloseButton:function(){if(this.options.closeButtonClass){this.closeBtn=this.container.getElement("."+this.options.closeButtonClass);if(this.closeBtn){this.closeBtn.addEvents({click:(function(){this.fireEvent("onClose",this);this.hide()}).bind(this)})}}},destroy:function(){this.container.overlay=null;if(this.shim){this.shim.destroy();this.shim=null}if(this.transparentOverlayPadding){this.transparentOverlayPadding.destroy();this.transparentOverlayPadding=null}},position:function(){if(this.shim){(function(){this.positionShim()}).delay(10,this)}if(this.transparentOverlayPadding){(function(){this.positionTransparentOverlayPadding()}).delay(10,this)}},positionTransparentOverlayPadding:function(){var b=this.container.getCoordinates();if(!b||!b.left){return}var a=this.transparentOverlayPaddingValue;this.transparentOverlayPadding.setStyles({left:b.left-a,top:b.top-a})},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top})},show:function(a){if(typeof(overlayCss)!="undefined"&&!ta.retrieve("ta.overlayCssAsset")){if(this.options.waitForCss){ta.store("ta.overlayCssAsset",ta.css(overlayCss,{onLoad:function(){this._show(a)}.bind(this)}))}else{ta.store("ta.overlayCssAsset",ta.css(overlayCss));this._show(a)}}else{this._show(a)}},_show:function(f){if(this.visible){return}if(f){new Event(f).preventDefault()}this.closedByDocClick=false;var a=ta.util.URL.parse(this.options.remoteContent);if(!this.options.maintainCrPageServlet&&typeof crPageServlet!=="undefined"&&a&&a.test(/\/{1}(\w*)$/)){ta.store("crPageServlet_orig",crPageServlet);crPageServlet=RegExp.$1}$$(".overlay").each(function(c){if(c.overlay){if(c.overlay==this){return}if(this.parentOverlay&&c.overlay==this.parentOverlay){return}if(c.overlay.options.permanent){return}if(c.overlay.options.permanent_except_same&&c.overlay.options.type!=this.options.type){return}c.overlay.hide(f)}},this);var d=ta.id(this.options.parentContainer||document.body);d.adopt(this.container);if(this.shim&&this.shim.shim){d.adopt(this.shim.shim);var e=this.container.getCoordinates();if(e){this.shim.shim.setStyles({display:"block",width:e.width,height:e.height})}}if(this.transparentOverlayPadding){d.adopt(this.transparentOverlayPadding);var e=this.container.getCoordinates();if(e){var b=this.transparentOverlayPaddingValue*2;this.transparentOverlayPadding.setStyles({display:"block",width:e.width+b,height:e.height+b})}}if(this.options.backdrop==ta.overlays.BACKDROP_ALWAYS){this.enableBackdrop()}this.position();if(this.options.closeOnDocumentClick){document.addEvent("click",this._hide.bind(this))}this.visible=true;this.fireEvent("onShow",this);ta.fireEvent("onOverlayShow",this);if(ta.has("overlay.onShow")){ta.remove("overlay.onShow").each(function(c){c.call(this)},this)}return this},_setPosition:function(a){if(this.options.parentContainer){var c=Math.abs(this.container.getPosition().x-this.container.offsetLeft);var d=Math.abs(this.container.getPosition().y-this.container.offsetTop);var b={};if(a.left!==undefined){b.left=Math.abs(a.left-c)}if(a.top!==undefined){b.top=Math.abs(a.top-d)}if(a.bottom!==undefined){b.right=Math.abs(a.right-c)}if(a.right!==undefined){b.bottom=Math.abs(a.bottom-d)}this.container.setStyles(Object.merge(a,b))}else{this.container.setStyles(a)}},_hide:function(b){if(this.noScroll){ta.find("body").setStyle(this.overflowToHide,"")}if(!b||this.container.containsEvent(b)){return}if(this.options.pinnable==ta.overlays.PINNABLE_HOVER||this.options.pinnable==ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE){var a=b.target;while(a){if(a==this.source){return}else{a=a.parentElement}}}document.removeEvent("click",this._hide);this.hide(b)},hideByClickOnDocument:function(a){if(ta.retrieve("overlay.dontCloseOnClick")){return}this.closedByDocClick=true;this.hide(a)},hide:function(a){if(window.flyout){window.flyout.hide()}if(this.backdropOn){this.disableBackdrop()}if((this.options.keepElementInDocument&&this.container.style.left=="-999em")||(!this.options.keepElementInDocument&&!this.container.inDocument())){return this}if(this.shim){this.shim.hide().dispose()}if(this.transparentOverlayPadding){this.transparentOverlayPadding.hide().dispose()}this.container.setStyles({left:"-999em",top:"-999em"});if(!this.options.keepElementInDocument){this.container.dispose()}this.visible=false;this.fireEvent("onHide",!a);ta.fireEvent("onOverlayClose",this);if(!this.options.maintainCrPageServlet&&ta.has("crPageServlet_orig")){ta.run("ta.meta.linkTracking.restoreCRPageServlet")}if(this.options.closeFunction&&typeof this.options.closeFunction==="function"){this.options.closeFunction(a)}if(this.noScroll){ta.find("body").setStyle(this.overflowToHide,"")}return this},calculateBackdropHeight:function(){return Math.max(window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight),document.body.scrollHeight)},configureBackdrop:function(){var b={"class":"overlayBG"};var a;if(this.options.backdropZIndex==="behindOverlay"){a=this.options.zIndex-1}else{if(ta.retrieve("tablet_calendar_update.enabled")){b.events={click:function(d){this.fireEvent("backdropClick",d)}.bind(this)};if(document.getElement(".overlayBG")){this.options.backdropOpacity=0.01}var c=document.getElements(".overlay").length;a+=c*2}else{a=this.options.isChild?10000:9997}}this.backdrop=new Element("div",b);this.backdrop.setStyles({position:"fixed",left:0,top:0,width:"100%",height:this.calculateBackdropHeight(),backgroundColor:this.options.backdropColor,zIndex:a,opacity:this.options.backdropOpacity,filter:"alpha(opacity="+Math.floor(this.options.backdropOpacity*100)+")"});if(this.options.backdropClickClose){this.backdrop.addEvent("click",function(){this.fireEvent("onClose",this);this.hide()}.bind(this))}},updateBackdrop:function(){this.backdrop.setStyles({width:"100%",height:this.calculateBackdropHeight()})},enableBackdrop:function(){try{if(this.backdropOn){return}if(!this.backdrop){this.configureBackdrop()}if(Browser.ie6){var a=this.container;$$("select").each(function(d){if(!a.contains(d)){d.setStyle("visibility","hidden")}else{d.setStyle("visibility","visible")}})}ta.store("overlays.current",this);this.updateBackdrop();if(this.container.inDocument()){this.backdrop.inject(this.container,"before")}else{this.backdrop.inject(document.body)}this.backdropOn=true;if(this.options.backdropZIndex==="behindOverlay"){}else{if(ta.retrieve("tablet_calendar_update.enabled")){var b=document.getElements(".overlay").length;this.container.setStyle("z-index",parseInt(this.backdrop.getStyle("z-index"))+1)}else{this.container.setStyle("z-index",this.options.isChild?"10002":"9998")}}if(ta.overlays.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #424242")}else{this.container.setStyle("border","5px solid rgba(64,64,64,0.8)")}}}catch(c){ta.util.error.record(c,"Error setting the border property - enableBackdrop")}},disableBackdrop:function(){try{if(!this.backdropOn){return}this.backdrop.dispose();if(ta.retrieve("overlays.current")==this){ta.remove("overlays.current");if(Browser.ie6){$$("select").setStyle("visibility","visible")}}else{if(Browser.ie6&&ta.retrieve("overlays.current")&&!ta.retrieve("overlays.current").backdropOn){$$("select").setStyle("visibility","visible")}}this.backdropOn=false;this.container.setStyle("z-index","1001");if(ta.overlays.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #b2b2b2")}else{this.container.setStyle("border","5px solid rgba(128,128,128,0.6)")}}}catch(a){ta.util.error.record(a,"Error unsetting the border property - disableBackdrop")}},loadRemoteContent:function(c,a){var b={url:ta.util.URL.parse(c),method:this.options.requestMethod,data:this.options.requestData,onSuccess:this.loadRemoteSuccess.bind(this),onFailure:this.loadRemoteFailure.bind(this),evalScripts:true};this.options.track&&(b.trackEvent=this.options.track);if(!a&&!this.options.hideSpinner){new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{onload:this.position.bind(this),"class":"anim_loop"}).inject(this.inner)}new Request(b).send();return this},loadRemoteSuccess:function(b){if(typeof b==="string"){var a=document.head||ta.select("head")[0];b=b.replace(new RegExp("<style.*?>((.|\n)*?)</style.*?>","g"),function(c,d){var e=document.createElement("style");e.type="text/css";if(e.styleSheet){e.styleSheet.cssText=d}else{e.appendChild(document.createTextNode(d))}a.appendChild(e);return""})}this.cachedWidth=null;this.inner.setContent(b);this.position();if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}this.fireEvent("onLoad",this);this.cachedWidth=this.container.getSize().x;if(this.backdropOn){this.updateBackdrop()}return this},loadRemoteFailure:function(a){this.inner.addClass("ajax_failed");this.inner.setStyle("width","383px");this.inner.setStyle("padding","14px 24px 14px 14px");this.inner.set("text",JS_Ajax_failed);this.fireEvent("onLoadRemoteFailure",a)}});ta.overlays.getCurrent=function(){var a=$$(".overlay.oldoly").shift();return a&&a.overlay};ta.overlays.safeCloseCurrent=function(){var a=ta.overlays.getCurrent();return a&&a.hide()};ta.overlays.safeCloseFromDom=function(c){c=ta.id(c);var a=c&&c.getParent(".overlay");var b=a&&a.overlay;return b&&b.hide()};ta.overlays.isDHTMLCRRedesign2012=function(){if(ta.has("overlays.isDHTMLCRRedesignBasic")){return ta.retrieve("overlays.isDHTMLCRRedesignBasic")}var a=$$(".overlay");var b=a.hasClass("rgba_flyout");ta.store("overlays.isDHTMLCRRedesignBasic",b);return b};ta.overlays.AbsoluteOverlay=new Class({Extends:ta.overlays.Overlay,options:{xOffset:0,yOffset:0,toWindow:true,repositionOnScroll:false,autoShow:true,stayOpen:false,hideOnDocumentClick:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();this.parent(a,b);if(this.options.showCloseButton&&!this.options.stayOpen){this.closeBtn.addEvent("click",this.hide)}if(this.options.hideOnDocumentClick){document.addEvent("click",this.hideByClickOnDocument.bind(this))}if(this.options.autoShow){this.show()}},show:function(a){this.parent(a);if(this.options.repositionOnScroll){window.addEvent("scroll",this.delayedScroll.bind(this))}},hide:function(a){this.parent(a);if(this.options.repositionOnScroll){window.removeEvent("scroll",this.delayedScroll.bind(this))}if(this.options.hideOnDocumentClick){document.removeEvent("click",this.hideByClickOnDocument.bind(this))}},hideByClickOnDocument:function(d){if(!d||!d.page){return false}d=new Event(d);var c=d.page;var b=this.inner.getCoordinates();var a=c.y>=b.top&&c.y<=b.bottom&&c.x>=b.left&&c.x<=b.right;if(!a){this.parent(d)}},delayedScroll:function(){this.position.delay(500,this)},position:function(){this.container.setStyles({left:this.options.xOffset,top:this.options.yOffset+(this.options.toWindow?window.getScrollTop():0)});this.parent()}});ta.overlays.AbsoluteBottomOverlay=new Class({Extends:ta.overlays.Overlay,initialize:function(a,b){this.parent(Object.merge({positionType:"fixed"},a),b);if(this.options.showCloseButton&&!this.options.stayOpen){this.closeBtn.addEvent("click",this.hide)}thisOverlay=this;if(this.options.horizontalScroll){window.addEvent("scroll",function(){var c=window.getScroll().x*-1;thisOverlay.container.setStyle("left",(c))})}},position:function(){this.parent();this.reposition();this.flyIn()},reposition:function(){this.container.setStyles({top:null,left:null});if(!this.options.flyFromRight){if(this.options.horizontalScroll){leftValue=window.getScroll().x*-1}else{leftValue=window.getCoordinates().width/2-this.container.getWidth()/2}this.container.setStyles({bottom:0,left:leftValue})}else{this.container.setStyles({bottom:10,right:10})}},flyIn:function(){if(this.options.flyFromRight){this.container.setStyle("right",-window.getCoordinates().width)}else{this.container.setStyle("bottom",-this.container.getHeight())}var a=new Fx.Tween(this.container,{duration:"1000",transition:"quad:out"});if(this.options.flyFromRight){a.start("right",10)}else{a.start("bottom",0)}},show:function(a){this.parent(a);if(!this.options.flyFromRight){window.addEvent("resize",this.reposition.bind(this))}this.container.removeClass("overlay");this.reposition()}});ta.overlays.CenteredOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["hideByClickOnDocument","position","hide","show"],options:{delayedPosition:false,autoShow:true,attachCloseEvent:true,xOffset:-1,yOffset:-1,absoluteOffset:false,fixed:false},initialize:function(b,c){b=b||{};b.showCloseButton=[b.showCloseButton,true].pick();b.fixed&&(this.options.positionType="fixed");this.parent(b,c);if(this.source){var a=this.source.getParentBySelector(".overlay");if(a){this.container.setStyle("z-index",a.getStyle("z-index")+1);this.parentOverlay=a.overlay}}if(this.options.showCloseButton&&this.options.attachCloseEvent){this.closeBtn.addEvent("click",this.hide)}this.options.autoShow&&this.show()},position:function(d){var b=ta.retrieve("ta.overlays.CenteredOverlay.position.iters");if(!b){b=0}var f=this.container.getCoordinates();if(f.height<=14&&b<10){ta.store("ta.overlays.CenteredOverlay.position.iters",b+1);this.position.delay(100,this,true);return}var a=this.options.xOffset;var e=this.options.yOffset;if(a===-1){a=Math.max(5,(window.tabletOnFullSite?window.innerWidth:window.getWidth())-f.width)/2;!this.options.fixed&&(a+=window.getScrollLeft())}else{!this.options.absoluteOffset&&(a-=f.width/2)}if(e===-1){e=Math.max(20,(window.tabletOnFullSite?window.innerHeight:window.getHeight())-f.height)/2;!this.options.fixed&&(e+=window.getScrollTop())}else{!this.options.absoluteOffset&&(e-=f.height/2)}if(ta.util.i18n.isRtl()){this.container.setStyles({left:null,right:a,top:e})}else{this.container.setStyles({left:a,top:e})}this.parent()},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})},positionTransparentOverlayPadding:function(){var d=this.container.getCoordinates();if(!d||((ta.util.i18n.isRtl()&&!d.right)||!d.left)){return}var b=this.transparentOverlayPaddingValue;var a=this.transparentOverlayPaddingValue*2;if(ta.util.i18n.isRtl()){this.transparentOverlayPadding.setStyles({left:null,right:d.right-b,top:d.top-b,width:d.width+a,height:d.height+a})}else{this.transparentOverlayPadding.setStyles({left:d.left-b,top:d.top-b,width:d.width+a,height:d.height+a})}}});ta.overlays.showInLightbox=function(a,b){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},b)).loadRemoteSuccess(a)};ta.overlays.loadInLightbox=function(b,a){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},a)).loadRemoteContent(b)};var lightbox={deactivate:function(){var a=ta.retrieve("overlays.current");a&&a.hide()}};ta.overlays.CouponOverlay=new Class({Extends:ta.overlays.CenteredOverlay,initialize:function(a,b){this.parent(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,fixed:true,waitForCss:true,onClose:function(){ta.remove("suppressMetaFocus")}},a),b);this._opaqueBG=null;this._opaqueImg=null;if(Browser.name==="ie"){this._enableOpaqueBG()}window.addEvent("resize",this.position.bind(this))},hide:function(a){if(this._opaqueBG){this._opaqueBG.dispose();this._opaqueBG=null;this._opaqueImg=null}this.parent(a);return this},position:function(){this.parent();if(this._opaqueBG){var a=this.container.getCoordinates();this._opaqueBG.setStyles({top:Math.max(20,window.getHeight()-a.height)/2+window.getScrollTop(),left:Math.max(5,window.getWidth()-a.width)/2,width:a.width,height:a.height});this._opaqueImg.setStyles({width:a.width,height:a.height})}},_enableOpaqueBG:function(){if(this._opaqueBG){return}var a=this.options.isChild?9999:9996;this._opaqueBG=new Element("div",{"class":"printCouponBackground"});this._opaqueImg=new Element("img",{src:"/img2/generic/site/white_1x1.png"});var b=this.container.getCoordinates();this._opaqueBG.setStyles({top:Math.max(20,window.getHeight()-b.height)/2+window.getScrollTop(),left:Math.max(5,window.getWidth()-b.width)/2,width:b.width,height:b.height,zIndex:a,position:"fixed"});this._opaqueImg.setStyles({width:b.width,height:b.height});this._opaqueImg.inject(this._opaqueBG);if(this.container.inDocument()){this._opaqueBG.inject(this.container,"before")}else{this._opaqueBG.inject(document.body)}}});ta.overlays.showCouponInLightbox=function(b,d){var c=new ta.overlays.CouponOverlay(d);var a=c.loadRemoteSuccess(b);c.show();return a};ta.overlays.ACTIVATE_NEVER=0;ta.overlays.ACTIVATE_CLICK=1;ta.overlays.ACTIVATE_HOVER=2;ta.overlays.ACTIVATE_FOCUS=3;ta.overlays.ACTIVATE_HOVER_DELAY=4;ta.overlays.ACTIVATE_BOTH=5;ta.overlays.ACTIVATE_CLICK_ALTERNATE=6;ta.overlays.ACTIVATE_BOTH_DELAY=7;ta.overlays.ACTIVATE_CLICK_TOGGLE=8;ta.overlays.PINNABLE_NEVER=0;ta.overlays.PINNABLE_ALWAYS=1;ta.overlays.PINNABLE_CLICK=2;ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE=3;ta.overlays.PINNABLE_HOVER=4;ta.overlays.BACKDROP_PINNED=2;ta.overlays.RelativeOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["overrideHoverDelayOnce","overridePinnableOption","_hide","show","hide","disable","destroy","hideNow","showWithDelay","hideWithDelay","_pin","prolongVisibility","showOrHide","_bothEnter","_bothEnterWithDelay","_bothClick"],options:{activate:ta.overlays.ACTIVATE_NEVER,pinnable:ta.overlays.PINNABLE_NEVER,activateHoverDelayTime:300,hoverDelayTime:250,pointArrowToSource:false,autoShow:true,ignoreFirstClickAfterHover:false,ignoreFirstClick:false,closeFunction:false,showFunction:false,closeButtonFunction:false},initialize:function(b,c){this.parent(b,c);this.debug_sticky=ta.retrieve("debug.stickyOverlays");this.container.addClass("relative");var a=this.source&&(this.source.getParentBySelector(".overlay")||this.source.getParentBySelector(".ui_overlay"));if(a){this.container.setStyle("z-index",parseInt(a.getStyle("z-index"),10)+2);this.parentOverlay=a.overlay}this.enabled=true;if(this.options.showCloseButton&&this.closeBtn){this.closeBtn.addEvent("click",(function(){try{if(this.options.closeButtonFunction&&typeof this.options.closeButtonFunction==="function"){this.options.closeButtonFunction()}}catch(f){}this.hideNow()}).bind(this));if(this.options.smartCloseButton){this.closeBtn.hide()}}switch(this.options.activate){case ta.overlays.ACTIVATE_CLICK:this.source.addEvent("click",this.show);break;case ta.overlays.ACTIVATE_CLICK_TOGGLE:this.source.addEvent("click",this.showOrHide);break;case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.container.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_FOCUS:this.source.addEvent("focus",this.show);break;case ta.overlays.ACTIVATE_CLICK_ALTERNATE:this.source.addEvent("mouseenter",this.prolongVisibility);this.container.addEvent("mouseenter",this.prolongVisibility);this.source.addEvent("mouseleave",this.hide);this.container.addEvent("mouseleave",this.hide);this.source.addEvent("click",this.showOrHide);break;case ta.overlays.ACTIVATE_BOTH:this.source.addEvent("mouseenter",this._bothEnter);this.container.addEvent("mouseenter",this._bothEnter);this.source.addEvent("mouseleave",this.hide);this.container.addEvent("mouseleave",this.hide);this.source.addEvent("click",this._bothClick);this.ignoreNextClick=b.ignoreFirstClickAfterHover&&b.ignoreFirstClick;break;case ta.overlays.ACTIVATE_BOTH_DELAY:this.source.addEvent("mouseenter",this._bothEnterWithDelay);this.container.addEvent("mouseenter",this._bothEnter);this.source.addEvent("mouseleave",this.hideWithDelay);this.container.addEvent("mouseleave",this.hide);this.source.addEvent("click",this._bothClick);this.ignoreNextClick=b.ignoreFirstClickAfterHover&&b.ignoreFirstClick;break}switch(this.options.pinnable){case ta.overlays.PINNABLE_CLICK:case ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE:this.source.addEvent("click",this._pin);break}if(typeof this.options.remoteLink!="undefined"&&this.options.remoteLink!=null){this.loadRemoteContent(this.options.remoteLink)}else{if(this.source){var e=this.source.getElement(".overlaySrc");if(e){if(e.get("tag")=="a"){this.loadRemoteContent(e.href)}else{this.loadRemoteContent(e.get("text"));e.dispose()}}else{if(!this.options.content&&this.source.get("tag")=="a"){this.loadRemoteContent(this.source.href)}}}}var d=this.source&&ta.id(this.source.id+"_CONTENTS");if(d){this.inner.set("html",d.innerHTML);d.dispose();this.runBehaviorOnFirstShow=true}if(this.options.autoShow){this.show()}else{if(this.options.delayShow){this.showWithDelay()}}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},overrideHoverDelayOnce:function(a){this.overriddenHoverDelayTime=a},overridePinnableOption:function(a){if(a===true){this.source.addEvent("click",this._pin);this.container.addEvent("click",this._pin)}else{if(a===false){this.source.removeEvent("click",this._pin);this.container.removeEvent("click",this._pin);this.unpin()}}},show:function(b){b=b||window.event;if(b){new Event(b).stop()}if(!this.enabled){return}var a=this.visible;this.parent(b);clearTimeout(this.showTimeout);if((this.options.activate==ta.overlays.ACTIVATE_HOVER||this.options.activate==ta.overlays.ACTIVATE_HOVER_DELAY||this.options.activate==ta.overlays.ACTIVATE_BOTH||this.options.activate==ta.overlays.ACTIVATE_BOTH_DELAY)&&this.hideTimer){clearTimeout(this.hideTimer);this.hideTimer=null}if(a){return}if(this.runBehaviorOnFirstShow){this.runBehaviorOnFirstShow=false;if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}}this.cachedWidth=this.container.getSize().x;switch(this.options.pinnable){case ta.overlays.PINNABLE_HOVER:this._pin();break}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_CLICK_TOGGLE:case ta.overlays.ACTIVATE_FOCUS:if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.addEvent("click",this.hideByClickOnDocument.bind(this))}break}if(this.options.showFunction){this.options.showFunction()}return this},hide:function(c){if(this.debug_sticky){return this}c=c||window.event;if(!this.visible){return}if(window.flyout){window.flyout.hide()}if(c){var b=new Event(c);if(b.target&&b.target.tagName=="option"){return}if(Browser.ie&&b.target&&b.target.tagName=="select"&&this.container.getElements("select").contains(b.target)){return}if(ta.page&&ta.page.usingUnifiedDates&&ta.find&&ta.find(".ui_modal.date_picker_modal",document.body)){return}}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:case ta.overlays.ACTIVATE_CLICK_ALTERNATE:case ta.overlays.ACTIVATE_BOTH:case ta.overlays.ACTIVATE_BOTH_DELAY:if(!this.hideTimer){var a=this.options.hoverDelayTime;if(this.overriddenHoverDelayTime!==undefined){a=this.overriddenHoverDelayTime;delete this.overriddenHoverDelayTime}this.hideTimer=this.hide.delay(a,this);return}else{clearTimeout(this.hideTimer);this.hideTimer=null}break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_CLICK_TOGGLE:case ta.overlays.ACTIVATE_FOCUS:if(c&&this.container.containsEvent(c)){return}if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.removeEvent("click",this.hide)}break}return this.hideNow()},hideNow:function(a){if(!this.visible){return this}if(this.backdropOn){this.disableBackdrop()}if(this.shim){this.shim.hide().dispose()}if(this.transparentOverlayPadding){this.transparentOverlayPadding.hide().dispose()}if(!this.options.positionByOffsets){this.container.setStyles({left:"-999em",top:"-999em"}).dispose()}else{this.container.dispose()}this.visible=false;if(this.options.pinnable==ta.overlays.PINNABLE_CLICK||this.options.pinnable==ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE||this.options.pinnable==ta.overlays.PINNABLE_HOVER){this.unpin()}this.fireEvent("onHide",!a);if(this.options.closeFunction){this.options.closeFunction()}return this},_pin:function(a){this.pin();this.toggleBackdrop(true)},pin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.removeEvent("mouseenter",this.show);this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_BOTH:this.source.removeEvent("mouseenter",this._bothEnter);this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.removeEvent("mouseenter",this.showWithDelay);this.source.removeEvent("mouseleave",this.hideWithDelay);break;case ta.overlays.ACTIVATE_BOTH_DELAY:this.source.removeEvent("mouseenter",this._bothEnterWithDelay);this.source.removeEvent("mouseleave",this.hideWithDelay);break}this.container.removeEvent("mouseenter",this.show);this.container.removeEvent("mouseleave",this.hide);this.pinned=true;if(this.options.smartCloseButton&&this.closeBtn){this.closeBtn.show()}return this},toggleBackdrop:function(a){if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.enableBackdrop()}},unpin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_BOTH:this.source.addEvent("mouseenter",this._bothEnter);this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);break;case ta.overlays.ACTIVATE_BOTH_DELAY:this.source.addEvent("mouseenter",this._bothEnterWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);break}this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.disableBackdrop()}this.pinned=false;if(this.options.smartCloseButton&&this.closeBtn){this.closeBtn.hide()}return this},showWithDelay:function(a){a=a||window.event;clearTimeout(this.showTimeout);if(this.visible){return this.show(a)}else{this.showTimeout=this.show.delay(this.options.activateHoverDelayTime,this)}},hideWithDelay:function(a){a=a||window.event;if(!this.visible){clearTimeout(this.showTimeout)}else{return this.hide(a)}},prolongVisibility:function(){if(this.visible&&this.hideTimer){clearTimeout(this.hideTimer);this.hideTimer=null}},showOrHide:function(a){if(this.blockShowOrHide){return}if(this.visible){return this.hideNow(a)}else{return this.show(a)}},_bothEnter:function(a){this.ignoreNextClick=this.options.ignoreFirstClickAfterHover;return this.show(a)},_bothEnterWithDelay:function(a){this.ignoreNextClick=this.options.ignoreFirstClickAfterHover;return this.showWithDelay(a)},_bothClick:function(a){if(this.ignoreNextClick){a=a||window.event;if(a){new Event(a).stop()}this.ignoreNextClick=false;return this}else{return this.showOrHide(a)}}});ta.overlays.RelativeOverlayHorizontal=new Class({Extends:ta.overlays.RelativeOverlay,options:{arrowHeight:0,arrowLeftForce:0,arrowTopForce:0,allowRightArrowPos:false,allowBelowBottomEdge:false,mirrorIfRtl:false},initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Overlay without specifying direction.")}return}if(a.mirrorIfRtl&&ta.util.i18n.isRtl()){a.onRight=!a.onRight;if(a.offsetLeft){a.offsetRight=-a.offsetLeft;a.offsetLeft=0}else{if(a.offsetRight){a.offsetLeft=-a.offsetRight;a.offsetRight=0}}}this.parent(a,b)},position:function(){if(this.options.onRight){this.positionRight()}else{this.positionLeft()}this.parent()},adjustTop:function(f,i){try{this.source=ta.id(this.source);var k=f+this.options.offsetTop;if(!this.options.allowBelowBottomEdge){var g=window.getScrollTop()+window.getHeight();var j=document.getElementById("tamgFooter");if(j){if(j.offsetHeight){g=g-j.offsetHeight}else{if(j.clientHeight){g=g-j.clientHeight}}}if(k+i.height>=g){k=g-i.height-1;if((this.crDHTML_BASIC||this.crDHTML_PNG24)&&this.options.showArrow){var b=this.container.getElement(".check_availability");var d=this.container.getElement(".username");if(b||d){var a=b?b:d;var c=a.getCoordinates().height}k=g-i.height+c-9}}}return k}catch(h){ta.util.error.record(h,"adjustTop: RelativeOverlayHorizontal")}},positionLeft:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var a=ta.id("PAGE").getCoordinates();var h=this.container.getCoordinates();if(!this.flipped&&d.left-a.left-(this.cachedWidth||h.width)<0){this.flipped=true;this.options.onRight=true;if(this.arrow){this.arrow.className=this.options.arrowClassLeft}this.positionRight();return}if(ta.overlays.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){this.positionLeftOrRight(d,b,a,h,"left")}else{var f=this.adjustTop(d.top,h)-b;d.left=d.left-this.options.offsetLeft;this._setPosition({left:null,right:window.getWidth()-d.left+(this.options.xoffset||0),top:f});if(this.options.pointArrowToSource&&this.options.arrowHeight){this.setArrowPosition(d,b,a,h,"left",f)}}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},positionRight:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var h=this.container.getStyle("margin-bottom").toInt();var a=ta.id("PAGE").getCoordinates();var i=this.container.getCoordinates();if(!this.flipped&&a.right-d.right-(this.cachedWidth||i.width)<0){this.flipped=true;this.options.onRight=false;if(this.arrow){this.arrow.className=this.options.arrowClassRight}this.positionLeft();return}d.right=d.right-this.options.offsetRight;if(ta.overlays.isDHTMLCRRedesign2012()&&(this.container.getElement(".check_availability")||this.container.getElement(".username"))){this.positionLeftOrRight(d,b,a,i,"right")}else{var f=this.adjustTop(d.top,i)-b;this.container.setStyles({right:null,left:d.right+(this.options.xoffset||0),top:f});if(this.options.pointArrowToSource&&this.options.arrowHeight){this.setArrowPosition(d,b+h,a,i,"right",f)}}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},setArrowPosition:function(j,e,h,g,a,d){if(a==="left"){this.arrow.setStyle("left",this.options.arrowLeftForce);var i=(d<j.top?j.top-d:0);var b=Math.max(-1,i+(j.height/2).toInt()-(this.options.arrowHeight/2));var f=g.height-this.options.arrowHeight-e-3;this.arrow.setStyle("top",Math.min(b,f))}else{if((a==="right")&&(this.options.allowRightArrowPos)){if(this.options.arrowTopForce){this.arrow.setStyle("top",this.options.arrowTopForce)}else{if(this.options.arrowRightForce){this.arrow.setStyle("right",this.options.arrowRightForce)}var i=(d<j.top?j.top-d:0);var b=Math.max(-1,i+(j.height/2).toInt()-(this.options.arrowHeight/2));var f=g.height-this.options.arrowHeight-e-3;this.arrow.setStyle("top",Math.min(b,f))}}else{if(a==="right"){ta.util.error.record("setArrowPosition with dir === right is only supported with options.allowRightArrowPos set")}}}},positionLeftOrRight:function(q,l,y,x,r){try{var d=this.container.getElement(".check_availability");var g=this.container.getElement(".username");if(!ta.retrieve("isDaoDao")){var i=this.adjustTop(q.top,x)}else{var i=q.top}var v=d?d:g;var t=v.getCoordinates().height;var m=16;var k=i-t+m/2;var n=false;if(d){var f=window.getScrollTop();var h=ta.id("PERSISTENT_CHECK_RATES");if(h){f+=h.getCoordinates().height}if((i-0.5*x.height)<f){k=f;if((q.bottom-f)>32){k=f}else{if((q.bottom-f)<=32){k=q.bottom-32}}n=true}}var p=d?k:k+5;if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic,{onLoad:function(){this.position()}.bind(this)})}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24,{onLoad:function(){this.position()}.bind(this)})}if(this.crDHTML_BASIC){var b=d?(q.right+13):(q.right-45);if(r=="left"){b=q.left+13}var a=-16}if(this.crDHTML_PNG24){var b=d?(q.right+20):(q.right-45);if(r=="left"){var b=window.getWidth()-q.left+20}var a=d?-21:-24}if(r=="left"){this._setPosition({right:b,left:null,top:p})}else{this._setPosition({right:null,left:b,top:p})}if(this.arrow){this.arrow.setStyle("display","block");var j=d?16:0;if(n){this.arrow.setStyle("top",(q.bottom-p-32))}else{this.arrow.setStyle("top",t-j)}if(r=="left"){this.arrow.setStyle("left",(x.width-13))}else{this.arrow.setStyle("left",a)}try{q=this.source.getCoordinates();x=this.container.getCoordinates();var u=window.getScrollTop()+window.getHeight();var o=q.top-x.top-m/2;var j=d?0:20;if(i+x.height>=u&&o>0){this.arrow.setStyle("top",o+j);if(q.bottom+m/2>=x.bottom){this.container.setStyle("top",p+m*2);this.arrow.setStyle("top",o-m*2+j)}}else{if(o<=0&&!n){this.container.setStyle("top",p-t+m)}}}catch(w){ta.util.error.record(w,"bottomEdge - Reposition arrow and container: RelativeOverlayHorizontal")}}}catch(w){ta.util.error.record(w,"positionLeftOrRight: RelativeOverlayHorizontal")}}});ta.overlays.RelativeOverlayRight=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:true},a),b)}});ta.overlays.RelativeOverlayLeft=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:false},a),b)}});ta.overlays.RelativeOverlayVertical=new Class({Extends:ta.overlays.RelativeOverlay,options:{flipPadding:0,allowFlip:true,arrowWidth:0},initialize:function(a,b){if(a.below==null){if(IS_DEBUG){alert("ERROR: Attempting to create Vertical Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){this.options.below?this.positionBelow():this.positionAbove();this.parent()},positionBelow:function(){if(this.options.positionType=="fixed"){var p=this.source.getBoundingClientRect();var f=p.left;var q=p.bottom;if(this.options.positionAsPercent){f=(f/window.innerWidth*100)+"%";q=(q/window.innerHeight*100)+"%"}this._setPosition({left:f,top:q});return}var r=this.options.positionSource?this.options.positionSource.getCoordinates():this.source.getCoordinates();var m=this.container.getCoordinates();var n=this._styleValueToPixel(this.container.getStyle("margin-left"));var j=this._styleValueToPixel(this.container.getStyle("margin-right"));var d=this.container;var b;if(this.options.leftEdge){b=this.options.leftEdge}else{if(this.options.justify=="right"){b=r.left+r.width-m.width}else{b=this.options.centered?r.left+(r.width/2)-(m.width/2):r.left}}var k=window.getHeight()+window.getScrollTop();var i=r.bottom;if(this.options.offsetTop){i-=this.options.offsetTop}if(this.options.scrollContainer){i-=this.options.scrollContainer.scrollTop}if(this.options.allowFlip&&!this.flipped&&k-m.height-i<0&&r.top-m.height>0){this.options.below=false;this.flipped=true;d.addClass("relAbove").removeClass("relBelow");i=r.top-m.height-this.options.flipPadding;if(this.options.scrollContainer){i-=this.options.scrollContainer.scrollTop}}else{d.addClass("relBelow").removeClass("relAbove")}b-=this.options.offsetLeft;var e=this.adjustEdge(b-n,m.width);this._setPosition({left:e,top:i+(this.options.yoffset||0)});if(this.options.pointArrowToSource&&this.options.arrowWidth){var o=(e<r.left?r.left-e:0);var g=(r.width/2).toInt()-(this.options.arrowWidth/2);var h=o+g;var a=m.width-this.options.arrowWidth-n-j;this.arrow.setStyles({right:"",left:Math.min(h,a)})}},_styleValueToPixel:function(a){var b=a&&a.toInt();return !b?0:b},positionAbove:function(){var n=this.options.positionSource?this.options.positionSource.getCoordinates():this.source.getCoordinates();var j=this.container.getCoordinates();var k=this._styleValueToPixel(this.container.getStyle("margin-left"));var i=this._styleValueToPixel(this.container.getStyle("margin-right"));var d=this.container;var b;if(this.options.justify=="right"){b=n.left+n.width-j.width}else{b=this.options.centered?n.left+(n.width/2)-(j.width/2):n.left}var l=window.getScrollTop();var h=n.top-j.height-this.options.flipPadding;if(this.options.offsetTop){h-=this.options.offsetTop}if(this.options.scrollContainer){h-=this.options.scrollContainer.scrollTop}if(this.options.allowFlip&&!this.flipped&&h-l<0){this.options.below=true;this.flipped=true;d.addClass("relBelow").removeClass("relAbove");h=n.bottom;if(this.options.scrollContainer){h-=this.options.scrollContainer.scrollTop}}else{d.addClass("relAbove").removeClass("relBelow")}b-=this.options.offsetLeft;if(this.options.positionByOffsets){this._setPosition({position:this.options.positionType,top:this.options.offsetTop,right:this.options.offsetRight,bottom:this.options.offsetBottom,left:this.options.offsetLeft})}else{var e=this.adjustEdge(b-k,j.width);this._setPosition({left:e,top:h+(this.options.yoffset||0)});if(this.options.pointArrowToSource&&this.options.arrowWidth){var m=(e<n.left?n.left-e:0);var f=(n.width/2).toInt()-(this.options.arrowWidth/2);var g=m+f;var a=j.width-this.options.arrowWidth-k-i;this.arrow.setStyles({right:"",left:Math.min(g,a)})}}},adjustEdge:function(d,c){var a=ta.id("PAGE").getCoordinates();if(d+c>=a.right){var b=this._styleValueToPixel(this.container.getStyle("margin-right"));d=a.right-c-b-1}else{if(d<0){d=0}}return d},hideNow:function(a){this.parent(a);if(this.flipped){this.flipped=false;this.options.below=!this.options.below}}});ta.overlays.RelativeOverlayBelow=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:true},a),b)}});ta.overlays.RelativeOverlayAbove=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:false},a),b)}});ta.overlays.RelativeOverlayIn=(function(a){return new Class({Extends:a.overlays.RelativeOverlay,options:{xOffset:0,yOffset:0,center:false},initialize:function(b,c){this.parent(b,c)},position:function(){if(this.options.center){var d=this.source.getCoordinates();var e=this.container.getCoordinates();this._setPosition({left:d.left+(d.width/2)-(e.width/2)+this.options.xOffset,top:d.top+(d.height/2)-(e.height/2)+this.options.yOffset})}else{var b=this.source.getPosition();this._setPosition({left:b.x+this.options.xOffset,top:b.y+this.options.yOffset})}this.parent()}})}(ta));(function(){function e(g){if(!g){return null}if(g.get("tag")=="a"){return g.href}var f=g.getElement("a");if(f){return f.href}f=g.getElement(".overlaySrc");if(f){return f.get("text")}return null}var c={left:ta.overlays.RelativeOverlayLeft,right:ta.overlays.RelativeOverlayRight,above:ta.overlays.RelativeOverlayAbove,below:ta.overlays.RelativeOverlayBelow};function b(m,p,i,q){if(p||window.event){new Event(p||window.event).preventDefault()}var o=m.hyphenate().split("-"),k=o.indexOf("h")>=0,h=o.indexOf("lb")>=0,f=o.indexOf("remote")>=0,n=o.indexOf("click")>=0,g=Object.merge({showCloseButton:true},q),l=null,j;switch(o.shift()){case"rel":l=c[o.shift().toLowerCase()];if(h){g.pinnable=ta.overlays.PINNABLE_ALWAYS}break;case"center":l=ta.overlays.CenteredOverlay;break}if(l===null){return null}if(k){g.activate=ta.overlays.ACTIVATE_HOVER}else{if(n){g.activate=ta.overlays.ACTIVATE_CLICK}}if(h){g.backdrop=ta.overlays.BACKDROP_ALWAYS}if(f){g.remoteContent=e(i)}j=new l(g,i);if(i){i.overlay=j}return j}ta.overlays.Factory={_magic:b,relRightRemoteHLB:function(f,g){g=ta.id(g);if(g.get("tag")!="div"){g=g.getParent()}var h=e(g);if(h==null){return}new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay rgba_flyout",showCloseButton:true},g)},relRightRemoteHLB_Commerce:function(h,f){if(h||window.event){new Event(h||window.event).preventDefault()}f=ta.id(f);var g=e(f);if(g==null){return}f.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:true},f)},relBelowRemoteHLB_Commerce:function(h,f){f=ta.id(f);if(h||window.event){new Event(h||window.event).preventDefault()}var g=e(f);if(g==null){return}f.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:true},f)},relBelowRemoteHLB_CommCopy:function(h,f){f=ta.id(f);if(h||window.event){new Event(h||window.event).preventDefault()}var g=e(f);if(g==null){return}f.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:true,onLoad:function(){if(ta.meta&&ta.meta.update){ta.meta.update.updateCRForm("_pop")}else{ta.commerce.checkrates.updateCRForm("_pop")}}},f)},relBelowRGBA:function(j,g){if(j){j.stop()}var h="rgba_flyout";var i=true;var f="rgba_arrow";f=f+" rgba_arrow_png24";g.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,style:h,showArrow:i,arrowClass:f,showCloseButton:true},g)},relAboveH_PriceSaver:function(g,f){f=ta.id(f);g.stop();f.onmouseover=null;new ta.overlays.RelativeOverlayAbove({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,centered:true,showArrow:true,style:"typePS",arrowClass:"ldarrow",arrowWidth:20,yoffset:5,flipPadding:15,waitForCss:true,fontSize:".7em"},f)},relRight_SavingsAlert:function(h,g){g=ta.id(g);h.stop();g.onclick=null;var f={showCloseButton:false,activate:ta.overlays.ACTIVATE_CLICK,showArrow:true,arrowClass:"arrow",style:"typeSA",waitForCss:true,fontSize:".7em",allowBelowBottomEdge:true};if(ta.util.i18n.isRtl()){new ta.overlays.RelativeOverlayLeft(f,g)}else{new ta.overlays.RelativeOverlayRight(f,g)}},relRightH_SavingsAlert:function(j,g,i){g=ta.id(g);j.stop();g.onmouseover=null;var h="typeSA";if(i){h+=" ie8"}var f={showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,showArrow:true,arrowClass:"arrow",style:h,waitForCss:true,fontSize:".7em",allowBelowBottomEdge:true};if(ta.util.i18n.isRtl()){new ta.overlays.RelativeOverlayLeft(f,g)}else{new ta.overlays.RelativeOverlayRight(f,g)}},relBelow:function(g,f){if(g){g.stop()}f.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},f)},relAbove:function(g,f){if(g){g.stop()}f.onclick=null;new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},f)},relRight:function(g,f){if(g){g.stop()}f.onclick=null;new ta.overlays.RelativeOverlayRight({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},f)},relLeft:function(g,f){if(g){g.stop()}f.onclick=null;new ta.overlays.RelativeOverlayLeft({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},f)},relBelowH_Media:function(g,f){if(g){g.stop()}f.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},f)},relAboveH_Media:function(g,f){if(g){g.stop()}f.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},f)},relAboveH:function(g,f){f.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER},f)},relAboveTAMGFooter:function(h,f){f.onmouseover=null;var g=ta.id("PAGE");if(g){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 vdg ovrFooter "+f.className},f)}},relRightH:function(g,f){f.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER},f)},relLeftH:function(g,f){f.onmouseover=null;new ta.overlays.RelativeOverlayLeft({activate:ta.overlays.ACTIVATE_HOVER},f)},imageLightbox:function(i,f){f.onclick=null;var g="<div><img src="+f.getAttribute("href")+"></div>";var h=new ta.overlays.CenteredOverlay({showCloseButton:true,backdrop:ta.overlays.BACKDROP_ALWAYS}).loadRemoteSuccess(g);f.addEvent("click",h.show)},microMetaOverlay:function(s,i,m,h,p,u,j,t){try{i.onmouseover=null;i.onclick=null;if(s){s.stop()}var f="";if(ta.meta&&ta.meta.update){f=ta.meta.update.buildUrl("MicroMetaAjax",m,true,false,"QC_Meta_Micro|Button")}else{if(typeof(dd)!=="undefined"&&dd.commerce&&dd.commerce.checkrates){f=dd.commerce.checkrates.getMicroMetaUrl(s,m)}else{ta.util.error.record(null,"microMetaOverlay : no meta js");return}}f+="&lowContentID="+h;if(j){f+="&xSellPlacement="+j}var o=i.className.match(/noDelayFirst/);var r=i.className.match(/delayOpen/);var n=ta.retrieve("delayedFirst");var g=!r||(o&&!n);var k="Above Fold Also Viewed";if(ta.id(i).getParent("#MMXS_LIST")){k="State Opt Also Viewed"}else{if(ta.id(i).getParent("#HORIZONTAL_CROSS_SELL_LIST")){k="HorizXSell"}else{if(ta.id(i).getParent("#hotel_flyout")){k="Scooter"}else{if(ta.id(i).getParent("#HSCS_ROW")){k="prodp13n_hr_similar_xsell"}else{if(window.mapDivId&&ta.id(i).getParent("#"+window.mapDivId)){k="Maps"}}}}}if(k=="Scooter"){f+="&from="+k}var v={activate:(u)?ta.overlays.ACTIVATE_CLICK:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:(u)?ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE:ta.overlays.PINNABLE_CLICK,backdrop:(u)?ta.overlays.BACKDROP_NEVER:ta.overlays.BACKDROP_PINNED,showCloseButton:!u,closeOnDocumentClick:u,positionByOffsets:false,positionType:"absolute",offsetTop:0,offsetRight:"",offsetBottom:"",offsetLeft:155};Object.merge(v,t);var l=new ta.overlays.RelativeOverlayBelow({style:"micro_meta_flyout gray",activate:v.activate,pinnable:v.pinnable,backdrop:v.backdrop,autoShow:g,delayShow:r,showCloseButton:v.showCloseButton,closeOnDocumentClick:v.closeOnDocumentClick,closeButtonClass:"roundOuterClose",onShow:function(){if(ta.util&&ta.util.element){ta.util.element.makeTextFitOneLine(".micro_meta_price_with_fee",true)}if(u){ta.trk("Meta_Micro_Providers_Displayed")}else{ta.trackEventOnPage("Meta_Micro_Providers_Displayed",k,p)}ta.overlays.Factory.logTrackingTree();if(v.onshow){v.onshow()}},onHide:v.onhide,positionByOffsets:v.positionByOffsets,positionType:v.positionType,offsetTop:v.offsetTop,offsetRight:v.offsetRight,offsetBottom:v.offsetBottom,offsetLeft:v.offsetLeft,trigger:i,onLoad:function(){ta.fireEvent("MicroMetaHacComplete");if(v.onload){v.onload()}}},i);l.loadRemoteContent(f,false);ta.store("delayedFirst",true)}catch(q){ta.util.error.record(q,"micro meta overlay")}},microMetaExpandedSize:0,microMetaMore:function(k,l,g){try{var h=ta.id("micro_meta_remaining_"+l);if(!h){return}h.removeClass("hidden");function j(){var m=ta.id("micro_meta_more");if(!m){return}m.addClass("invisible")}if(g){j()}else{ta.meta.linkTracking.actionRecord("MICRO_META_EXPAND_MORE");if(h.getSize().y!=ta.overlays.Factory.microMetaExpandedSize){h.addClass("expanding");ta.overlays.Factory.microMetaExpandedSize=h.getSize().y;h.removeClass("expanding")}h.addClass("show");new Fx.Tween(h,{duration:"long",property:"height"}).start(0,ta.overlays.Factory.microMetaExpandedSize);window.setTimeout(j,1000);if(ta.retrieve("ibdm_impression_tracking")){var f=document.getElement(".micro_meta_first_block");if(f&&ta.meta&&ta.meta.treeTrack&&ta.meta.treeTrack.hasTrackingTree(f)){ta.trk("n_more_sites",false,f)}}}}catch(i){ta.util.error.record(i,"Micro meta expand failed.")}},isOverlayCreatedAlready:function(g,f){if(typeof f!="undefined"){var h=g.getElement(".overlaySrc");if(h){h.dispose();return false}else{return true}}return false},relRightRemoteHLB_optionalDelay_showArrow:function(r,p,v,u){try{p=ta.id(p);if(p.get("tag")!="div"){p=p.getParent()}var j=null;if(typeof v!="undefined"){j=v}if(null==j){j=e(p)}if(j==null&&ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.clearCalendarFlyouts();j=e(p)}if(j==null){return}var q=p.getElement(".overlaySrc");var t=j.match(/-d(\d+)\?/);if(t){t=t[1]}if(ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates()){try{if(!ta.retrieve("date.picker.calendarflyout.allCleared")){ta.widgets.calendar.clearCalendarFlyouts()}if(r&&r.type=="mouseover"&&p){if(!p.hasClass("datedClickAdded")){p.addEvent("click",ta.overlays.Factory.relRightRemoteHLB_optionalDelay_showArrow.bind(this,null,p,j));p.addClass("datedClickAdded")}return}var m=ta.retrieve("scooterObj");if(m){m.slideOut()}if(t){ta.overlays.Factory.metaCheckRatesOverlay_allProviders(t,p)}return}catch(z){ta.util.error.record(z,"meta session dates parse issue")}}if(ta.overlays.Factory.isOverlayCreatedAlready(p,v)){return}var h=p.className.match(/noDelayFirst/),l=p.className.match(/delayOpen/),g=ta.retrieve("delayedFirst"),w=!l||(h&&!g),k="rgba_flyout",n=true,f="rgba_arrow",o="close",i;if(ta.has("hotels.redesignEnabled")&&(pageServlet==="Hotels"||pageServlet==="HACSearch")){k+=" gray";f="rgba_arrow_gray_lft_png24";o="roundOuterClose"}if(ta.has("daodao_noPop_single_cr_button")){k+=" no_cpu"}if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_PNG24){i=f+" rgba_arrow_png24_right";f=f+" rgba_arrow_png24"}var x=ta.overlays.BACKDROP_PINNED;if(ta.has("daodao_ror_backdrop_type")){x=ta.retrieve("daodao_ror_backdrop_type")}var A=(l?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER);if(ta.retrieve("daodao_show_cr_flyout_only_on_click")||window.FastClick){A=ta.overlays.ACTIVATE_CLICK}var s={metaReferer:window.pageServlet};var y=new ta.overlays.RelativeOverlayRight({activate:A,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:x,style:k,showArrow:n,arrowClass:f,arrowClassLeft:f,arrowClassRight:i,closeButtonClass:o,showCloseButton:true,autoShow:w,delayShow:!w,smartCloseButton:ta.isMetaHotels2013(),remoteLink:v,requestData:s,onLoad:function(){if(t&&u){var B=this.inner.getElementById("CHECK_RATE_FLYOUT");if(B){var C=B.get("onclick");B.set("onclick",u+";"+C)}}if(!ta.has("metaDatePickerEnabled")){if(ta.meta&&ta.meta.update){ta.meta.update.updateCRForm("_pop")}else{ta.commerce.checkrates.updateCRForm("_pop")}}},onShow:function(){ta.store("metaDateSearchOverlay",this);if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}else{if(ta.meta&&ta.meta.update){ta.meta.update.updateCRForm("_pop")}else{ta.commerce.checkrates.updateCRForm("_pop");ta.commerce.checkrates.checkCRLimitsHelper(y)}}if(ta.retrieve("meta_guests_field_v2.enabled")){var B=document.querySelector(".adultsText");if(B&&ta.widgets.calendar.updateAdultsDisplay){ta.widgets.calendar.updateAdultsDisplay(B)}}ta.store("ta.hlb_el",p);if(ta.page&&ta.page.usingUnifiedDates){this.haveDatesHandler=(function(){if(ta.page.hasDates("STAYDATES")){this.hideNow()}}).bind(this);ta.page.on("dateSelected",this.haveDatesHandler)}},onHide:function(){if(ta.retrieve("metaDateSearchOverlay")==this){ta.remove("metaDateSearchOverlay")}ta.widgets.calendar.closeCalendarWidgets();if(ta.retrieve("meta_guests_field_v2.enabled")){ta.commerce.meta.disableAdultsPicker(this)}ta.store("ta.hlb_el",null);if(this.haveDatesHandler&&ta.page){ta.page.off("dateSelected",this.haveDatesHandler)}}},p);y.metaLocId=t;ta.store("delayedFirst",true);ta.widgets.calendar.trackCalendarFlyout(p,y,q)}catch(z){ta.util.error.record(z,"relRightRemoteHLB_optionalDelay_showArrow: Factory")}},relLeftRemoteHLB_optionalDelay_helper:function(t,h,p,u){try{h=ta.id(h);if(h.get("tag")!="div"){h=h.getParent()}var i=null;if(typeof u!="undefined"){i=u}if(null==i){i=e(h)}if(i==null&&ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.clearCalendarFlyouts();i=e(h)}if(i==null){return}var s=h.getElement(".overlaySrc");var m=i.match(/-d(\d+)\?/);if(m){m=m[1]}if(ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates()){try{if(!ta.retrieve("date.picker.calendarflyout.allCleared")){ta.widgets.calendar.clearCalendarFlyouts()}if(t&&t.type=="mouseover"){if(!h.hasClass("datedClickAdded")){h.addEvent("click",ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper.bind(this,null,h,p,i));h.addClass("datedClickAdded")}return}var g=ta.retrieve("scooterObj");if(g){g.slideOut()}if(m){ta.overlays.Factory.metaCheckRatesOverlay_allProviders(m,h)}return}catch(q){ta.util.error.record(q,"meta session dates parse issue")}}if(ta.overlays.Factory.isOverlayCreatedAlready(h,u)){return}var o=h.className.match(/noDelayFirst/);var r=h.className.match(/delayOpen/);var n=ta.retrieve("delayedFirst");var f=!r||(o&&!n);var k=ta.has("daodao_ror_backdrop_type")?ta.retrieve("daodao_ror_backdrop_type"):ta.overlays.BACKDROP_PINNED;var j=(r?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER);if(ta.retrieve("daodao_show_cr_flyout_only_on_click")||window.FastClick){j=ta.overlays.ACTIVATE_CLICK}var l=new ta.overlays.RelativeOverlayLeft({activate:j,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:k,style:"rgba_flyout gray",showArrow:p,arrowClass:"rgba_arrow_gray_rgt_png24",arrowClassLeft:"rgba_arrow_gray_lft_png24",showCloseButton:true,closeButtonClass:"roundOuterClose",autoShow:f,delayShow:!f,smartCloseButton:ta.isMetaHotels2013(),remoteLink:u,onLoad:function(){if(!ta.has("metaDatePickerEnabled")){if(ta.meta&&ta.meta.update){ta.meta.update.updateCRForm("_pop")}else{ta.commerce.checkrates.updateCRForm("_pop")}}},onShow:function(){ta.store("overlay.lastElmt.className",h.className);if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}else{if(ta.meta&&ta.meta.update){ta.meta.update.updateCRForm("_pop")}else{ta.commerce.checkrates.updateCRForm("_pop");ta.commerce.checkrates.checkCRLimitsHelper(l)}}if(ta.retrieve("meta_guests_field_v2.enabled")){var v=document.querySelector(".adultsText");if(v&&ta.widgets.calendar.updateAdultsDisplay){ta.widgets.calendar.updateAdultsDisplay(v)}}},onHide:function(){ta.widgets.calendar.closeCalendarWidgets();if(ta.retrieve("meta_guests_field_v2.enabled")){ta.commerce.meta.disableAdultsPicker(this)}}},h);ta.store("delayedFirst",true);ta.widgets.calendar.trackCalendarFlyout(h,l,s)}catch(q){ta.util.error.record(q,"relLeftRemoteHLB_optionalDelay_showArrow: Factory")}},relLeftRemoteHLB_optionalDelay_showArrow:function(g,h,f){ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper(g,h,true,f)},hotelsMapCROverlay:function(g,h,f){ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper(g,h,false,f)},fbFriendOverlay:function(f){f.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,style:"s2 mg"},f)},albumsLB:function(q,h,m,f,g,j,o,i,l,p,k){if(q||window.event){new Event(q||window.event).preventDefault()}var n=require("ta/media/viewerScaffold");if(n){n.load({detail:m,geo:f,filter:g,ff:j,albumId:o,evtDelegates:p,lbShowRac:k})}else{ta.util.error.record(null,"Missing ta/media/viewerScaffold for albumViewerOverlay")}return false},photosLB:function(f,j){try{if(f||window.event){new Event(f||window.event).preventDefault()}j=ta.id(j);if(j.get("tag")!="a"){if(j.hasClass("fkASDF")&&(j.get("tag")=="span"||j.get("tag")=="div"||j.get("tag")=="li")){j=ta.id(j)}else{j=j.getParent("a")}}var i="";if(j.className){i=j.className.match(/u_([^ ]*)/)[1]}else{if(j.href.match(/\/?LocationPhoto.*/)){i=j.href}}ta.overlays.Factory._mediaLBLoadAssets();var g="QC_Meta_Mini";if(ta.has("photo.viewer.jsAssetsLoaded")){i=i.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");i=i.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");i=i.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(i.match(/\?/)){i=i+"&small=true"}else{i=i+"?small=true"}}i=i+"&area="+g;var k=i;try{i=ta.commerce.meta.tracking.updateUrlWithTiming(i,g)}catch(l){ta.util.error.record(l,"problem updating url with timing in Factory.photosLB");i=k}if(ta.meta&&ta.meta.update&&window.pageServlet){i=i+"&metaReferer="+window.pageServlet}var h=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.photoLBHelper,j);h.loadRemoteContent(i);ta.store("photo.viewer.lightbox",h);ta.commerce.meta.tracking.resetTimingLockForNavArea(g)}else{ta.util.error.record(null,"photo gallery - no assets to load");ta.overlays.Factory.viewerFallback.delay(2000,this,[null,j])}}catch(l){ta.util.error.record(l,"photo gallery overlay",null,{photoUrl:i});ta.commerce.meta.tracking.resetTimingLockForNavArea(g)}return false},viewerFallback:function(g){var f=ta.remove("photo.viewer.lightbox");if(f){f.hide()}if(g&&g.href&&g.href.match(/LocationPhotos/)){window.location=g.href}else{return ta.servlet.Popup.photoGallery(null,g)}},photoLBCounter:1,photoLBHelper:function(g){var f=ta.retrieve("photo.viewer.initData");if(ta.overlays.Factory.photoLBCounter>16){ta.overlays.Factory.photoLBCounter=1;try{ta.overlays.Factory.viewerFallback.delay(2000,this,g)}catch(h){}return}if(!f||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.photoLBHelper.delay(500)}else{ta.overlays.Factory.photoLBCounter=1;if(ta.retrieve("ta.photos.viewer.initializeOnSecondTab")){ta.store("photo.viewer.secondaryView",true);ta.photos.viewer.photoViewerInit(ta.retrieve("photo.viewer.secondaryViewer.data"))}else{ta.photos.viewer.photoViewerInit(f)}}},mediaLBAutoOpen:function(g){try{ta.overlays.Factory._mediaLBLoadAssets();if(!ta.has("photo.viewer.jsAssetsLoaded")){ta.util.error.record(null,"auto-open media lightbox - no assets to load")}else{g=g.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");g=g.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");g=g.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(g.match(/\?/)){g=g+"&small=true"}else{g=g+"?small=true"}}var f=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.mediaLBAutoOpenHelper,g);f.loadRemoteContent(g);ta.store("photo.viewer.lightbox",f)}}catch(h){ta.util.error.record(h,"ta.overlays.factory.autoOpenMediaLB failed",null,{photoUrl:g})}return false},mediaLBAutoOpenHelper:function(h){var f=ta.retrieve("photo.viewer.initData");var g=16;if(ta.overlays.Factory.photoLBCounter>g){ta.overlays.Factory.photoLBCounter=1;ta.util.error.record(null,"ta.overlays.factory.autoOpenMediaLBHelper is giving up after "+g+" attempts.",null,{photoUrl:h});return}if(!f||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.mediaLBAutoOpenHelper.delay(500,this,h)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(f)}},_mediaLBLoadAssets:function(){if(!ta.has("photo.viewer.jsAssetsLoaded")&&typeof cssPhotoViewerAsset!="undefined"&&typeof jsPhotoViewerAsset!="undefined"){ta.store("photo.viewer.jsAssetsLoaded",true);Asset.css(cssPhotoViewerAsset,{media:"screen, print"});if(!ta.photos.viewer){Asset.javascript(jsPhotoViewerAsset)}if(typeof TALSO=="undefined"){Asset.javascript(jsPhotoViewerTALSOAsset)}if(typeof jsPhotosAsset!="undefined"&&!ta.servlet.Photos){Asset.javascript(jsPhotosAsset)}}},_mediaLBCreateOverlay:function(g,i){var h={backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",backdropClickClose:true,onLoad:function(){this.position();if(g){g(i)}},onHide:function(){var j=ta.remove("photo.viewer.lightbox");if(j){j.hide()}ta.meta.linkTracking.restoreCRPageServlet();document.removeEvent("keydown",ta.remove("photo.viewer.keydownListener"));if(ta.retrieve("photo.viewer.refreshOnClose")){window.location=window.location}if(ta.has("translationOverlay")){ta.retrieve("translationOverlay").hide()}if(ta.retrieve("hotels.datesChanged")&&(ta.has("meta.mini_meta_on_accommodations")||(ta.retrieve("hotels.redesignEnabled")&&ta.isMetaHotelsRequest&&ta.isMetaHotelsRequest()))){ta.commerce.minimeta.doMetaDateSearch();ta.remove("hotels.datesChanged")}else{if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){ta.commerce.minimeta.ajax.resetAjaxCall();ta.commerce.minimeta.ajax.send(false,true);ta.remove("hotels.datesChanged")}}ta.widgets.calendar.closeCalendarWidgets()},permanent:true};if(ta.retrieve("checkrates.meta_ui_post_click_prices")){h.onShow=function(){var j=ta.retrieve("meta.baseLocationId");if(j){ta.commerce.meta.updateProvAreaFromLightBox(j)}}}var f=new ta.overlays.CenteredOverlay(h);return f},AccDetail:function(l,i,f){if(l){l.stop()}i=i.getParent();var k=location.pathname;if(k.length>0){if(k.charAt(0)=="/"){k=k.substring(1)}var j=k.indexOf("-");if(j>=0){k=k.substring(0,j)}}var h=f;var g=function(){var m=ta.id("overlay_description").get("text");if(m.length>1000){ta.id("overlay_description").setStyle("height",210)}};if(memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")){ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS))}new ta.overlays.CoverOverlay({yOff:35,onLoad:g,style:"s3 dg rgba_gry",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showCloseButton:true,delayShow:true,requestData:{d:h,tab:"descript",from:k},remoteContent:"/LocationTab"},i);return false},memberOverlay:function(t,j,r){if(t){t.stop()}j.onclick=null;j.onmouseover=null;var q="";var f="";var n="";var o=false;var h=false;var g=true;var p="rgba_arrow_png24";if(j.id&&j.id!=""){var l=j.id.split("-");for(var m=0;m<l.length;m++){var k=l[m];if(k.match(/\bUID_([0-9A-F]+)\b/)){q=RegExp.$1}else{if(k.match(/\bSRC_(\d+)\b/)){f=RegExp.$1}else{if(k.match(/\bCATID_(\d+)\b/)){n=RegExp.$1}else{if(k.match("FUS")){o=true}else{if(k.match("PATT")){h=true}}}}}}}else{if(require.defined("ta/util/xpath")){ta.util.error.record(null,"memberOverlay - elmt.id check",null,{passedElement:require("ta/util/xpath").nodePath(j)})}}var s="";if(typeof(footprintGet)!="undefined"){s=footprintGet()}if(memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")){ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS))}new ta.overlays.RelativeOverlayRight({style:r||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:g,arrowClass:p,showCloseButton:true,autoShow:false,delayShow:true,remoteContent:"/MemberOverlay?uid="+q+"&c="+n+"&src="+f+"&fus="+o+"&partner="+h+"&LsoId="+s},j);return false},memberOverlayBelow:function(v,j,t,r,s){if(v){v.stop()}j.onclick=null;j.onmouseover=null;var q="";var f="";var n="";var o=false;var h=false;var g=true;var p="rgba_arrow_up_png24";if(j.id&&j.id!=""){var l=j.id.split("-");for(var m=0;m<l.length;m++){var k=l[m];if(k.match(/\bUID_([0-9A-F]+)\b/)){q=RegExp.$1}else{if(k.match(/\bSRC_(\d+)\b/)){f=RegExp.$1}else{if(k.match(/\bCATID_(\d+)\b/)){n=RegExp.$1}else{if(k.match("FUS")){o=true}else{if(k.match("PATT")){h=true}}}}}}}else{if(require.defined("ta/util/xpath")){ta.util.error.record(null,"memberOverlay - elmt.id check",null,{passedElement:require("ta/util/xpath").nodePath(j)})}}var u="";if(typeof(footprintGet)!="undefined"){u=footprintGet()}if(memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")){ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS))}new ta.overlays.RelativeOverlayBelow({style:t||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:g,arrowClass:p,allowFlip:false,showCloseButton:true,autoShow:false,delayShow:true,offsetRight:s,offsetTop:r,remoteContent:"/MemberOverlay?uid="+q+"&c="+n+"&src="+f+"&fus="+o+"&partner="+h+"&LsoId="+u},j);return false},dropdownMiniMetaOverlayHotel:function(f,h,n,j){var m="hotel_"+j;var i=ta.id(m);if(i){var k=i.getElement(".chevron");if(k){h=k}var l=i.getElement(".dropdownMiniMeta");if(l){l=l.clone();l.set("class","dropdownMiniMeta");var g={offsetLeft:260,trigger:h};if(ta.util.i18n.isRtl()){g={offsetLeft:4}}ta.store("meta.dropdownHotelsActive",m);ta.overlays.Factory.dropdownMiniMetaOverlay(f,h,n,l,g)}}},dropdownMiniMetaOverlayHotelReview:function(g,f,k,j){var l=document.getElement(".skv3 .dropdownMiniMeta");if(!l){l=document.getElement(".dropdownMiniMeta")}if(!l){ta.trackEventOnPage("LP_Chevron_Dropdown_No_Data","0");var i=document.getElement(".LowestPrice.minOffer");if(i){i.click();return false}}l=l.clone();l.set("class","dropdownMiniMeta");if(!j){j=22}var h={offsetLeft:j};ta.overlays.Factory.dropdownMiniMetaOverlay(g,f,k,l,h)},dropdownMiniMetaOverlay:function(g,f,i,j,h){if(dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")){ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS))}if(g){g.stop()}if(j){ta.overlays.Factory.createDropdownMiniMetaOverlay(g,f,i,j,h);ta.store("pcr.disabled",true);return true}return false},loadDropdownCSS:function(){if(window.dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")){ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS))}},createDropdownMiniMetaOverlay:function(f,j,o,m,h){var g="rgba_flyout gray dropdownMiniMeta";var l=true;var i=-5;var n=function(p){p=ta.id(p);if(p.getParent(".persistentCR")){return"PCR"}else{if(p.getParent(".photosOverlay")||p.getParent("#LOC_PHOTO_ALBUMS")){return"Photo_Lightbox"}else{if(p.getParent(".amenities_lightbox")){return"Amenities_Lightbox"}else{if(p.getParent("#CHECK_RATES_LB")){return"Photo_LB"}}}}};switch(n(j)){case"PCR":l=false;g+=" pcrLightBox";i=-45;break;case"Photo_Lightbox":l=false;g+=" photoAmenitiesLightBox";break;case"Amenities_Lightbox":l=false;break;default:g+=" miniMetaLightBox"}var k=0;if(h){if(h.offsetLeft){k=h.offsetLeft}if(h.offsetTop){i=h.offsetTop}}new ta.overlays.RelativeOverlayBelow(Object.merge(h,{style:g,activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:l,showCloseButton:o,closeButtonClass:"roundOuterClose",arrowClass:"rgba_gray_arrow_up",offsetTop:i,offsetLeft:k,allowFlip:false,closeOnDocumentClick:true,content:m}),j)},createFacebookCTACallout:function(m,g,l,k,i,h){try{g.removePropertyEvent("mouseover","ta.overlays.Factory.createFacebookCTACallout")}catch(j){g.onmouseover=function(){}}var n=(Browser.ie7||Browser.ie8)?" ie78":"";var f={activate:ta.overlays.ACTIVATE_HOVER_DELAY,style:"s4 dg rgba_gry update2012 facebookCTAFlyout"+n,showArrow:true,centered:true,pointArrowToSource:true,showCloseButton:false,delayShow:true,innerDivClass:"inner",hoverDelayTime:0,noPadding:true,content:"<div class='onsite_cta_overlay_content'><b>"+l+"</b><br />"+i+"<br /><br /><b>"+k+"</b><br />"+h+"</div>"};new ta.overlays.RelativeOverlayBelow(f,g)},tcNavDetailOverlay:function(h,g,f){if(h){h.stop()}new ta.overlays.RelativeOverlayBelow({style:f||"typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:true,arrowClass:"rgba_arrow_png24",showCloseButton:true,content:ta.id("INLINE_NAV_DETAIL").innerHTML},g);return false},amexSettingsOverlay:function(m,k,f,g,i,j,l){if(m){m.stop()}var h;if(ta.has(i)){h=ta.retrieve(i);h.inner.setContent(ta.id(g).innerHTML);h.show()}else{h=new ta.overlays.RelativeOverlayBelow({style:f,activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:true,arrowClass:"rgba_arrow_png24",showCloseButton:false,content:ta.id(g).innerHTML,offsetLeft:j,offsetTop:l,allowFlip:false},k);ta.store(i,h)}return false},menuBLimps:function(g,f){var k=$(g);if(k){if(!k.getAttribute("blimped")){var j=k.getChildren();if(j){for(var h=0;h<j.length;h++){var l=j[h].getAttribute("data-imp");if(l){ta.t4b.bl_imp_tracking.queueImpression(l,f)}}ta.t4b.bl_imp_tracking.flushImpressions();k.setAttribute("blimped",true)}}}},mcNavOverlay:function(n,g,m,l,f,o,j,i,k){var h;if(n){n.stop()}if(ta.has(f)){h=ta.retrieve(f);h.inner.setContent(ta.id(l).innerHTML);h.show()}else{if(!(ta.util.i18n.isRtl()^i)){h=new ta.overlays.RelativeOverlayLeft({style:m,activate:ta.overlays.ACTIVATE_BOTH,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:true,arrowClass:"rgba_arrow_png24",showCloseButton:false,hoverDelayTime:250,content:ta.id(l).innerHTML,offsetLeft:-o,offsetTop:j,allowFlip:false,showFunction:function(){ta.overlays.Factory.menuBLimps(l,k)}},g);ta.store(f,h)}else{h=new ta.overlays.RelativeOverlayRight({style:m,activate:ta.overlays.ACTIVATE_BOTH,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:true,arrowClass:"rgba_arrow_png24",showCloseButton:false,hoverDelayTime:250,content:ta.id(l).innerHTML,offsetRight:o,offsetTop:j,allowFlip:false,showFunction:function(){ta.overlays.Factory.menuBLimps(l,k)}},g);ta.store(f,h)}}return false},createPairedCalendar:function(h,g,f){return ta.overlays.createPairedCalendar(h,g,f)},createPairedCalendarGeo:function(){},_injectAd:function(f){if(ta.has("ads.gptEnabled")){return}var g=ta.id(f);try{if(g){injectAdsTargeted(g)}}catch(h){ta.util.error.record(h,"AlsoViewedLB: error injecting ad into elemId="+f)}},createDatedPairedCalendar:function(i,g,f){if(!f){f={}}if(i){new Event(i).preventDefault()}g=ta.id(g);var h=g.getParent("form");f.validate=true;f.overlayOptions={onShow:function(){ta.overlays.toggleOffSearchAll(h)}};new ta.overlays.PairedCalendar(g,f);ta.overlays.toggleOffSearchAll(h)},recordVRCrossSell:function(){try{var g=ta.id("VR_CROSS_SELL");if(g){var f=g.innerHTML.indexOf("setPID");var i=g.innerHTML.substr(f+7,5);new Request({url:"/ActionRecord?action=VR_CROSS_SELL_"+i}).send()}}catch(h){ta.util.error.record(h,"VR Cross Sell - ActionRecord failed")}},launchAVLBCompleteFn:function(g){ta.overlays.Factory._loadAVCSS();var f=function(){ta.overlays.Factory._injectAd("ALSO_VIEWED_AD")};var h=function(k){var i="alsoViewedTest avStandalone";if(ta.has("ta.avlb_hero_photos")){i="avlb_hero_photos"}var j;j=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:i,onShow:f.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell}).loadRemoteSuccess(k);var m=false;if(j.inner){var l=ta.id("emptyAlsoViewed");if(l){m=true}else{ta.store("alsoViewedLB",true)}}else{m=true}if(m){j.hide();ta.store("commerce.pwrOverlay",j)}if(ta.meta&&ta.meta.cr){ta.meta.cr.removePCR()}else{ta.commerce.checkrates.removePCR()}};new Request({url:g,onSuccess:h,evalScripts:true}).send()},_loadAVCSS:function(){if(typeof(avlbCss)!="undefined"&&!ta.retrieve("ta.avlbCss")){ta.store("ta.avlbCss",Asset.css(avlbCss))}if(typeof(avlbTestCss)!="undefined"&&!ta.retrieve("ta.avlbTestCss")){ta.store("ta.avlbTestCss",Asset.css(avlbTestCss))}if(typeof(VRCrossSellCss)!="undefined"&&!ta.retrieve("ta.VRCrossSellCss")){ta.store("ta.VRCrossSellCss",Asset.css(VRCrossSellCss))}if(typeof(avlb_hero_photos)!="undefined"&&!ta.retrieve("ta.avlb_hero_photos")){ta.store("ta.avlb_hero_photos",Asset.css(avlb_hero_photos))}},_loadChkMoreCSS:function(){ta.overlays.Factory._loadAVCSS();if(typeof(chkMoreCss)!="undefined"&&!ta.retrieve("ta.chkMoreCss")){ta.store("ta.chkMoreCss",Asset.css(chkMoreCss))}if(typeof(chkMoreSpritesCss)!="undefined"&&!ta.retrieve("ta.chkMoreSpriteCss")){ta.store("ta.chkMoreSpriteCss",Asset.css(chkMoreSpritesCss))}},loadGeoCrAutoBroadenOverlay:function(f,i){var h=ta.retrieve("gcrab.cssPath");if(h&&!ta.retrieve("gcrab.css")){ta.store("gcrab.css",Asset.css(h))}var g=new ta.overlays.CenteredOverlay({permanent:true,style:"gcrabLb",noPadding:true,absoluteOffset:true,yOffset:(Math.max(20,window.getHeight()-540)/2)+window.getScrollTop(),xOffset:Math.max(5,window.getWidth()-965)/2,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",content:'<div style="background-color:#EEE;"><img style="padding:150px;display:block;width:79px;margin:auto;" src="'+ta.util.imageServer("/img2/meta_sprites/loadingAnim.gif")+'"></div>',onClose:function(){ta.trackEventOnPage("MetaGeoLightBox","unload","CloseButton",0,false)}},f);ta.commerce.meta.loadGeoCrAutoBroadenContents(g,i)},tamgShowLightbox:function(h,g,i){var f="tripadvisor.com";if(typeof cookieDomain!="undefined"){f=cookieDomain.substring(1,cookieDomain.length)}new Asset.css(i);new Request({url:"/TAMGFooterAjax",onSuccess:function(j){ta.overlays.showInLightbox(j,{style:"s0 TAMG_All"})},data:{a:"SHOW_GROUP_OVERLAY",dom:f},evalScripts:true,method:"get"}).send()},currencyPickerPopup:function(i,g,f){if(i){i.stop()}g.onclick=null;var h="/StaticVelocityPage?t=currency_picker.vm";new Asset.css(globalCurrencyPickerCSS);if(ta.retrieve("currency_format_using_icu4j_cldr.featureEnabled")=="true"){new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:h,style:"global_currency_picker_overlay currency_format_using_icu4j_cldr dropMenu",onShow:function(){ta.fireEvent("mastheadFlyoutOpened")}},g)}else{new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:h,style:"global_currency_picker_overlay dropMenu",onShow:function(){ta.fireEvent("mastheadFlyoutOpened")}},g)}ta.trackEventOnPage("CurrencyPicker","Open",f);return false},intlPopup:function(i,g){if(i){i.stop()}g.onclick=null;flagsUrl=document.location.pathname;var h="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){h+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){h+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){h+="&geo="+modelGeoId}if(window.flagsSettings){for(var f=0;f<flagsSettings.length;f++){h+="&"+flagsSettings[f]+"=true"}}h+="&useHreflangs="+(ta.util.URL.getServletNameFromUrl(window.location.pathname)==="ShowTopic");if(window.pageFeature){h+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS,{async:true,onLoad:function(){var j="dropMenu";var k=ta.overlays.ACTIVATE_CLICK;new Request({url:h,onSuccess:function(l){var m=new Element("div",{html:l});ta.overlays.Factory.fixFlagsFlyout(m);new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:k,content:m,style:j,onShow:function(){ta.fireEvent("mastheadFlyoutOpened")}},g)}}).send()}});return false},fixFlagsFlyout:function(g){if(ta.retrieve("flag_links.useHrefLangs")){var f=g.getElements("a.flag_link");f.forEach(function(i){var k=document.getElement("link[hreflang="+(i.get("hreflang"))+"]");if(k!=null){var j=k.get("href");if(typeof(j)=="string"){i.href=j}else{i.parentNode.style.display="none"}}else{i.parentNode.style.display="none"}});var h=g.getElements("li.region");h.forEach(function(i){var j=i.getElements("li.flag_item");var k=i.style.display;i.style.display="none";j.forEach(function(l){if(l.style.display!="none"){i.style.display=k}})})}},showRecentLocationEmailOverlay:function(){setPID(3833);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(f){if(!f.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(f,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"share_overlay"},evalScripts:true,method:"get"}).send()},expandRecentlyViewed:function(){for(var f=4;f<7;f++){var h=ta.id("recently_viewed_"+f);if(h&&h.hasClass("hidden")){h.removeClass("hidden")}}var g=ta.id("RECENTLY_VIEWED_MORE");if(g){g.addClass("hidden")}},showRecentlyViewedCompareOverLay:function(){ta.util.cookie.setPIDCookie(4898);var g=window.location.protocol+"//"+window.location.hostname+"/CompareHotels?detail=",f=0,h;for(f=0;f<7;f++){h=ta.id("recently_viewed_"+f);if(h){g=g+h.get("locid");f+=1;break}}for(;f<7;f++){h=ta.id("recently_viewed_"+f);if(h){g=g+"&compareHotelId="+h.get("locid")}}if(typeof(compareHotelCSS)!="undefined"&&!ta.retrieve("ta.compareHotelCssAsset")){ta.store("ta.compareHotelCssAsset",Asset.css(compareHotelCSS))}new Request({url:g,onSuccess:function(i){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:i})}}).send()},clearRecentLocations:function(){var g=ta.id("RECENTLY_VIEWED_LIST");if(g){var f=g.getNext(".bxDivider");g.dispose();if(f){f.dispose()}}new Request({url:"/RecentlyViewedAjax?a=clear"}).send()},removeParticularLocation:function(f,g,q){var j=ta.id("recently_viewed_"+q);if(j){var p=j.get("locid");j.dispose();new Request({url:"/RecentlyViewedAjax?a=remove&locID="+p}).send();for(;q<7;++q){j=ta.id("recently_viewed_"+q);if(j&&j.hasClass("hidden")){j.removeClass("hidden");break}}for(;q<7;++q){j=ta.id("recently_viewed_"+q);if(j&&j.hasClass("hidden")){return}}var k=ta.id("RECENTLY_VIEWED_MORE");if(k&&!k.hasClass("hidden")){k.addClass("hidden")}var o=$$("li.rv_item");var n=0;var h=false;if(o){n=o.length;for(var l=0;l<n;l++){if(!o[l].hasClass("geoItem")){h=true}}}if(!h){var m=ta.id("RV_SAVE");if(m){m.dispose()}}if(n===0){j=ta.id("RECENTLY_VIEWED_LIST");if(j){j.dispose()}}else{if(n===1){j=ta.id("COMPARE_HOTELS");if(j){j.getParent().addClass("hidden")}}}}},showSendMessage:function(m,h){var l;if(m){m.preventDefault()}if(h){h=ta.id(h)}if(h){if(ta.has("overlays.sendmessage.loading")){return}else{ta.store("overlays.sendmessage.loading",true);ta.remove.delay(500,null,"overlays.sendmessage.loading")}if(typeof(privateMsgCSS)!="undefined"&&!ta.retrieve("ta.privateMsgCssAsset")){ta.store("ta.privateMsgCssAsset",Asset.css(privateMsgCSS))}var i;if(h.get("tag")=="span"&&h.hasClass("fkASDF")){i=h.className.match(/u_([^ ]*)/)[1]}else{i=h.href}if(i){var k=ta.retrieve("overlays.sendmessage");if(k&&i.match(/notyou=1/)){window.location="/NewsletterSignOut-e__2F__MemberSignIn"}else{if(k){return}}var f=parseInt(l,10)==1?"cc":"cm";var g=f=="cm"&&typeof(footprintGet)!="undefined"?footprintGet():null;if(g){i+="&LsoId="+g}l=h.get("id");if(!ta.registration.isAuthorized("SEND_MESSAGE")){var j={flow:"CONTENT_SUBMISSION",pid:473,userRequestedForce:true,onSuccess:function(){if(l){ta.overlays.Factory.showSendMessage(null,l)}}};ta.call("ta.registration.RegOverlay.show",{type:"dummy"},h,j);return false}ta.common.sendmessage.communityLightbox(i)}}},showConnectOverlay:function(h,f,g,j,i){ta.overlays.registration.connect(g,j,i)},showAirlineTipsOverlay:function(i,h,l){try{var g="/AirlineTips?d="+modelLocId;if(l){g=g+"&filterLang="+l}var j=false;var f=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_NEVER,style:"s3 dg nopadding",permanent:true,zIndex:"9997",showCloseButton:true,remoteContent:g,onLoad:function(){if(f.inner){var m=ta.id("emptyTips");if(m){j=true}}else{j=true}if(j){f.hide()}}},h)}catch(k){ta.util.error.record(k,"showTipsOverlay")}},_loadSummaryCss:function(){if(typeof(conceptsCss)!="undefined"&&!ta.retrieve("ta.conceptsCssAsset")){ta.store("ta.conceptsCssAsset",Asset.css(conceptsCss))}},showReviewSummary:function(l,i,k,g){if(k&&g){ta.overlays.Factory.showSummaryTranslation(l,i,k);return}var j=null;var h=null;var f=null;if(l){l.stop()}if(i.id&&i.id!=""){j=i.id.replace("concept_","").replace(/_/g," ");ta.store("topconcepts.lastconcept",j);f="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+j;if(k){f+="&autotrans=true"}}else{ta.util.error.record(null,"showReviewSummary - elmt.id check");return}ta.overlays.Factory._loadSummaryCss();h=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding",autoShow:false,permanent:true,showCloseButton:true,remoteContent:f,onLoad:function(){ta.store("topconcepts.overlay."+j,this);this.show()}},i);i.onclick=h.show;return false},showSummaryTranslation:function(m,i,l){ta.util.cookie.setPIDCookie(16007);if(m){m.stop()}var g="s3 dg nopadding";ta.overlays.Factory._loadSummaryCss();var k="/MachineTranslation?";var j;if(i.id&&i.id!=""){if(i.id.indexOf("trans_")!=-1){j=i.id.replace("trans_","").replace(/_/g," ")}else{j=i.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",j);k+="page=summary&";k+="d="+modelLocId+"&";k+="concept="+j;k+="&sl=en&tl="+l}var f="topconcepts.overlay."+j;var h=ta.retrieve(f);if(h){h.hide()}h=new ta.overlays.CenteredOverlay({style:g,showCloseButton:true,remoteContent:k,onLoad:function(){ta.store(f,this);this.show()}},i)},toggleConceptSnippetTranslation:function(n,h){var m=null;var k=null;var l=null;var j=null;var f=null;if(n){n.stop()}if(h){ta.util.cookie.setPIDCookie(4111);l=h.id.replace(/[^_]*_(.*)/,"$1");m=ta.id("SUMMARYOVERLAY_"+l);if(m){k=m.getElements(".snippetText");for(var g=0;g<k.length;g++){if(k[g].isDisplayed()){k[g].hide()}else{k[g].show("inline")}}}j=ta.id("trans_"+l);f=ta.id("en_"+l);if(j.hasClass("activeButton")){j.removeClass("activeButton");j.addClass("inactiveButton")}else{j.removeClass("inactiveButton");j.addClass("activeButton")}if(f.hasClass("activeButton")){f.removeClass("activeButton");f.addClass("inactiveButton")}else{f.removeClass("inactiveButton");f.addClass("activeButton")}if(ta.overlays.Factory.storeReviewSummaryContent){ta.overlays.Factory.storeReviewSummaryContent(l.replace(/_/g," "),m.getParent().get("html"))}}},reviewTranslate:function(k,i,g){if(ta.servlet&&ta.servlet.Reviews){ta.servlet.Reviews.openTranslation(i,g)}else{ta.util.error.record(null,"reviewTranslate: Deprecated factory method");ta.util.cookie.setPIDCookie(16009);ta.overlays.Factory._loadSummaryCss();var h=ta.has("photo.viewer.lightbox");var j=1001;if(h){j=10001}var f=new ta.overlays.CenteredOverlay({style:"dg cb_overlay withClose ui_modal flat_bottom",zIndex:j,noPadding:true,backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"ui_close_x",centered:true,showCloseButton:true,remoteContent:g,onLoad:function(){this.show()}});ta.store("translationOverlay",f)}},createFriendActivityOverlay:function(g,h,j){var f;return new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){j&&ta.util.pending.lock("friendActivityOverlay.pageAction",function(){f=setTimeout(function(){new Request({url:"/ActionRecord?action="+j}).send()},400)})},onHide:function(){clearTimeout(f)},content:h},g)},createFriendActivityLightbox:function(f){return new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 mg friendActivity",content:f})},createCouponAnnouncementOverlay:function(i,p,g,r,o,k,l,q,n,h){ta.util.error.record(null,"createCouponAnnouncementOverlay: Deprecated factory method");ta.util.cookie.setPIDCookie(k);ta.css(o);var f={};f.act=i;if(l){f.act+="-"+l}else{if(window.pageServlet){f.act+="-"+pageServlet}}var m;if(n&&n!="false"){m="amex"}else{m="couponDetail"}ta.trackEventOnPage("SpecialOffer","click",window.pageServlet);var j="/CouponAjax?"+(p?"couponId="+p+"&":"")+(g?"announcementId="+g+"&":"")+(q?"locale="+q+"&":"")+(n?"isAmex="+n+"&":"")+(h?"showLocs="+h+"&":"")+"locationId="+r+"&listing=true";new Request({url:j,data:f,onSuccess:function(t){var s=ta.overlays.showCouponInLightbox(t,{closeButtonClass:"roundOuterClose",style:m,delayedPosition:true});s.closeBtn.addEvent("click",ta.servlet.blcoupons.closeHandler)},evalScripts:true}).send()},postVideoLogin:function(g,f,h){if(h){ta.util.cookie.setPIDCookie(h)}ta.overlays.registration.connect({flow:"POST_VIDEO"},"SIGNIN")},fbLogin:function(){ta.support.Facebook.login()},iapFlyout:function(h,g,f){require(["pages/inappropriate_vote_stub"],function(i){i.open(h,g,f)})},iapOwnerFlyout:function(h,g,f){require(["pages/inappropriate_vote_stub"],function(i){f.owner=true;i.open(h,g,f)})},openSavesRegflow:function(){ta.widgets.Saves.openSavesRegflow()},openSavesHoverRegflow:function(){ta.widgets.Saves.openSavesHoverRegflow()},openMastheadRegflow:function(){ta.widgets.Saves.openMastheadRegflow()},createGuideOverlay:function(){ta.overlays.registration.connect({flow:"DESTINATION_GUIDE"},"SIGNUP")},createPostPhotosOverlay:function(){ta.overlays.registration.connect({flow:"POST_PHOTOS"},"SIGNUP")},popConditionsOverlay:function(){var f=ta.id("CONDITIONS");if(f){ta.overlays.showInLightbox(f.innerHTML)}},cancelCreateWARList:function(g){g.stopPropagation();var f=ta.retrieve("war.todolist.showOverlay");if(f){window.clearTimeout(f);ta.store("war.todolist.showOverlay",false)}},createNeighborhoodOverlay:function(k,i,f){if(ta.has("nbhdOverlay")){if(i){i.onclick=null}ta.retrieve("nbhdOverlay").show();return}var g=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,permanent:true,zIndex:"997",style:"nbhdOverlay typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,onShow:function(){if(f){ta.servlet.HACSearch.filter.update()}},onHide:function(){if(f){ta.servlet.HACSearch.filter.update()}}},"NEIGHBORHOOD_OVERLAY");var h=g.inner;var j=ta.id("NEIGHBORHOOD_FORM");if(h&&j){j.inject(h,"top");j.removeClass("hidden");ta.store("neighborhoodOverlayForm",j)}ta.store("nbhdOverlay",g)},createHACProgressOverlay:function(){try{if(ta.has("ta.hac.progress.overlay")){return ta.retrieve("ta.hac.progress.overlay")}var i=ta.id("HAC_PROGRESS_CONTAINER").dispose();var f=i.get("html");var h=new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",showCloseButton:false,permanent:true,content:f});ta.store("ta.hac.progress.overlay",h);return h}catch(g){ta.util.error.record(g,"createHACProgressOverlay")}},getFilterWaitOverlay:function(){var g=ta.retrieve("filters.waitDialog");if(!g){var f="mg s1 fatNotice";if(ta.isHotelsRedesign2011()||ta.has("hotels.redesignEnabled")){f=f+" fatNotice_2011"}g=new ta.overlays.CenteredOverlay({style:f,showCloseButton:false,autoShow:false,delayedPosition:true});g.inner.set("html","<b>"+JS_UpdatingYourResults+"</b>");ta.store("filters.waitDialog",g)}return g},showFilterWaitOverlay:function(g){var f=ta.overlays.Factory.getFilterWaitOverlay();if(f){if(g){f.show();f.position(false)}else{f.hide()}}},showUpdatingMessage:function(){var g=ta.overlays.Factory.getFilterWaitOverlay();g.show();if(ta.remove("filter.map")){g.container.setStyles({left:-9999,top:-9999});var h=ta.id(ta.retrieve("maps.container")).getCoordinates();var f=g.container.getCoordinates();g.container.setStyles({left:h.left+(h.width-f.width)/2,top:h.top+(h.height-f.height)/2})}if(ta.remove("filter.lockout")){g.enableBackdrop()}},createIpDeauthOverlay:function(g,f){new Request({url:"/ActionRecordPlus?action=DEAUTH_IP&id="+g,onSuccess:function(h){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:false}).loadRemoteSuccess(h);if(f){ta.support.Facebook.ipRevoke(10000)}},onFailure:ta.util.error.ajaxFailure.partial("partials:ip_disable")}).send()},createHotelStyleCategoryDescriptionOverlayAbove:function(i,g,f){var h=ta.id(f);g.onmouseover=null;if(h){new ta.overlays.RelativeOverlayRight({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,style:"ryokanOverlay",showArrow:true,pointArrowToSource:true,allowRightArrowPos:true,arrowHeight:29,arrowClass:"ryokanArrow",fontSize:".7em",offsetRight:-14,offsetTop:-10,waitForCss:true,content:new Element("div",{style:"width:300px; padding:12px;",html:h.getChildren()[0].get("html")})},g)}},storeBLSlideshowOverlayJSON:function(k,j,i,h,f){if(ta.localStorage){var g={locationId:i,pid:h,cssFile:f};ta.localStorage.setSessionKey("slideshowOverlayJson",g)}},loadBLSlideshowOverlay:function(i,h,g,f){if(window.t4bSlideshowCSS&&!ta.retrieve("ta.t4bSlideshowCSS")){ta.store("ta.t4bSlideshowCSS",new Asset.css(t4bSlideshowCSS))}new Request({url:"/BusinessListingsAjax",onSuccess:function(j){ta.overlays.showInLightbox(j,{backdrop:ta.overlays.BACKDROP_ALWAYS,style:"g s10px np"})},data:{act:"slideshow",detail:g,pid:f,servletName:pageServlet,flash:(Browser.Plugins.Flash.version>=10)},evalScripts:true,method:"get"}).send()},createFriendOfFriendOverlay:function(f,g){f.onclick=null;if(g){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_CLICK,style:"s2 mg",showCloseButton:true,content:g},f)}if(lazyImgs!=null){require("lib/LazyLoad").init({},lazyImgs,window.lazyHtml)}},CLOSE_BTN_RIGHT_OFFSET:15,ratingsFlyout:function(o,f,h,k){if(o){o.stop()}try{var j=f.get("class").match("rating(\\d)")[1];var l=ta.id("ratingsFlyout"+j).get("html");var n=null;var g="";if(h){n=ta.servlet.Reviews.ratingFlyoutScroll}var i="ratingOverlay dg s3 rgba_gry";if(k){g=" fixedHeight";i=i+" overlayWithScroll"}new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,content:l,innerDivClass:"ratingFlyout inner"+g,style:i,onscroll:n},f);new Request({url:"/ActionRecord?action=ratingsFlyout&pid=4304"}).send()}catch(m){ta.util.error.record(m,"showRatingsFlyout")}},getWhiteFlyout:function(n,h,k,l,g){if(n){n.stop()}if(!h||!k){return}var i="whiteFlyOut";var f=true;var j="flyout_white_arrow";var m="flyout_icon_close";new ta.overlays.RelativeOverlayRight({style:i,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:f,arrowClass:j,pointArrowToSource:true,showCloseButton:true,closeButtonClass:m,content:k,offsetRight:l,offsetLeft:-l,onRight:ta.util.i18n.isRtl()?false:true,offsetTop:g},h)},firstToReviewFlyout:function(l,f,k){try{var g=ta.id("locationId"+k);var h=g.getElement(".firstToReviewFlyout").innerHTML;var i=g.getElement(".propName");ta.overlays.Factory.getWhiteFlyout(l,i,h,-12,-20)}catch(j){ta.util.error.record(j,"ta.overlays.factory.firstToReviewFlyout")}},openTourismDescription:function(f){ta.servlet.Tourism.showGeoDescription(f)},memberPassportStampOverlay:function(h,f,g){if(!ta.has("passportStampsCSS")){ta.store("passportStampsCSS",new Asset.css(passportStampsCSS))}g.geos=g.geos.join(",");new ta.overlays.RelativeOverlayRight({style:"s3 dg rgba_gry memberPassportStamps",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/MemberPassportStamps",requestData:g},f);ta.trackEventOnPage("Reviews","reviews_in_cities");new Request({url:"/ActionRecord?action="+g.actionRecord}).send()},relRightLocalContent:function(h,f,g){f.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 og",content:ta.id(g).innerHTML},f)},cookieSettingsPanel:function(i,f){if(i){i.stop()}if(f&&f.onclick){f.onclick=null}var g={};g.en=451;g.en_UK=834;g.en_IE=835;g.en_ZA=2635;g.sv=720;g.no=721;g.da=1199;g.fr=1197;g.fr_BE=6409;g.fr_CH=6410;g.de=1201;g.de_AT=2719;g.de_CH=6431;g.el=1198;g.it=1202;g.it_CH=6432;g.es=1200;g.pl=1208;g.nl=1209;g.nl_BE=6411;g.fi=2968;g.hu=3049;g.cs=3128;g.sk=3233;g.pt_PT=13938;g["default"]=451;var h;if(posLocale in g){h="//info.evidon.com/pub_info/"+g[posLocale]+"?v=1&nt=0"}else{h="//info.evidon.com/pub_info/"+g["default"]+"?v=1&nt=0"}new ta.overlays.RelativeOverlayBelow({showCloseButton:true,noPadding:true,activate:ta.overlays.ACTIVATE_CLICK,content:new Element("iframe",{src:h,height:562,width:731,styles:{margin:"0"}})},f)},loadJFYHotelsFilter:function(r,y,p){if(r){r.stop()}var w=ta.retrieve("ta.p13n.filterOnHover");var J=ta.retrieve("ta.p13n.prodp13nIsTablet");if(typeof(w)!=="boolean"||typeof(J)!=="boolean"){return}function A(){var i;if(document.getElement(".horizontal_filters_wrap")){var O=document.getElement(".jfy_filter_bar_top");if(O){i=O.getElement(".options_size_limiter");if(i&&i.scrollHeight>95){var Q=O.getElement(".resizer_footer.hidden");if(Q){Q.removeClass("hidden")}}}}else{if(p==="neighborhood"){ta.overlays.Factory.fixLocationFilterFooter()}else{i=$$(".jfy_filter_bar .jfy_filter_bar_"+p+"_inner");if(i.length>0&&i[0].scrollHeight>95){var P=$$(".jfy_filter_bar .jfy_filter_"+p+"_footer.hidden");if(P.length>0){P[0].removeClass("hidden")}}}}}var t={};if(ta.retrieve("ta.p13n.jfyFilterSet")&&typeof ta.retrieve("ta.p13n.jfyFilterSet")==="object"){t=ta.retrieve("ta.p13n.jfyFilterSet")}var G=null;var M=(p==="price"&&!ta.widgets.calendar.hasPageDates()&&(pageServlet!="Restaurants"));var j;if(M){j=ta.retrieve("ta.p13n.priceFilterWithCalender.content");if(!j){j=$("jfy_filter_bar_price_predates");ta.store("ta.p13n.priceFilterWithCalender.content",j);j.parentNode.removeChild(j)}}else{j=ta.id("jfy_filter_bar_"+p)}if(!j){return}var x=undefined;var E=ta.id("EATERY_FILTERS_CONT");if(E||p!=="sort"){var l=document.createElement("div");l.className="jfy_filter_bar_top_arrow";x=document.createElement("div");x.className="jfy_filter_bar_top_spacer";x.insertBefore(l,null)}var z=document.createElement("div");var s="jfy_filter_bar jfy_filter_bar_"+p;z.className=s;var u=j.getElements(".all");if(u&&u.length>0){u.removeClass("hidden")}var K=j.getElements(".less");if(K&&K.length>0){K.removeClass("hidden");K.addClass("hidden")}var C=j.getElements(".sprite-tag_list_expand");if(C&&C.length>0){C.removeClass("hidden")}var o=j.getElements(".sprite-tag_list_compress");if(o&&o.length>0){o.removeClass("hidden");o.addClass("hidden")}if(p!=="price"&&p!=="hotel_class"){var N=j.getElementsByTagName("DIV")[0];N=ta.id(N);if(p==="neighborhood"){N=j.getElements(".jfy_filter_bar_neighborhood_inner")[0]}var n=false;var v=false;var m=[];var h=0;var H;if(N){var k=N.getElements(".jfy_tag_style");if(k){for(H=0;H<k.length;H++){if(k[H].hasClass("selected")){if(v){n=true;break}}else{v=true}}if(n){for(H=0;H<k.length;H++){if(k[H].hasClass("selected")){k[H].dispose();m[h]=k[H];h++}}for(H=m.length;H>0;H--){N.insertBefore(m[H-1],N.firstChild)}}}}}z.innerHTML=j.get("html");var B=document.createElement("div");if(x){B.insertBefore(x,null)}B.insertBefore(z,null);if(!t[p]){var I=ta.overlays.ACTIVATE_CLICK_ALTERNATE;var F=true;var L=1500;if(w){I=ta.overlays.ACTIVATE_BOTH_DELAY;if(!J){F=false;L=250}else{if(p==="sort"){F=false}}}var D=(p==="price")?ta.overlays.PINNABLE_CLICK:ta.overlays.PINNABLE_NEVER;var f=function(){A();if(p==="price"){if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}}else{if(p==="sort"){if(ta&&ta.p13n&&ta.p13n.wizard&&typeof(ta.p13n.wizard.justifyRightSortOption)=="function"){ta.p13n.wizard.justifyRightSortOption()}}}};var q=ta.retrieve("ta.p13n.header_placement_overlay_class")||"";var g="jfy_filter_bar_top dg jfy_filter_bar_top_"+p+" "+q;if(E){g=g+" restaurants_filter_overlay"}if(ta.retrieve("left_hotels_filters")){g=g+" left_hotels_filters"}G=new ta.overlays.RelativeOverlayBelow({pinnable:D,style:g,activate:I,showCloseButton:F,noPadding:true,content:B.innerHTML,centered:true,allowFlip:false,closeOnDocumentClick:true,activateHoverDelayTime:150,hoverDelayTime:L,autoShow:false,ignoreFirstClickAfterHover:w,ignoreFirstClick:w,onShow:f},y);G.adjustEdge=function(S,P){var R=ta.id("JFY_hotel_filters")||ta.id("EATERY_FILTERS_CONT");if(R&&R.getCoordinates){var Q=R.getCoordinates();var O=S;if(S<Q.left){O=Q.left}else{if(S+P>=Q.right){var i=this._styleValueToPixel(this.container.getStyle("margin-right"));O=Q.right-P-i-1}}var T=S-O;this.setJfyArrowOffset=function(){this.inner.getElements(".jfy_filter_bar_top_arrow").setStyle("left",T+"px")};this.setJfyArrowOffset();return O}};if(w){G.showWithDelay()}else{G.show()}t[p]=G}else{G=t[p];G.inner.innerHTML=B.innerHTML;G.container.removeClass("expanded");if(G.visible){A();G.setJfyArrowOffset()}if(M){if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}}G.enable()}if(J){ta.id("PAGE").addEvent("click",G.hide)}ta.store("ta.p13n.jfyFilterSet",t);if(!ta.retrieve("ta.p13n.filterOnHover")){ta.trk(p,false,r.target?r.target:r.srcElement)}},fixLocationFilterFooter:function(){var k=$$(".jfy_filter_bar .location_popular .jfy_filter_bar_neighborhood_inner");if(k.length>0&&k[0].scrollHeight>95){var h=$$(".jfy_filter_bar .location_popular .jfy_filter_neighborhood_footer.hidden");if(h.length>0){h[0].removeClass("hidden");$$("#jfy_filter_bar_neighborhood .location_popular .jfy_filter_neighborhood_footer.hidden").removeClass("hidden")}}var i=$$(".jfy_filter_bar .location_neighborhood .jfy_filter_bar_neighborhood_inner");if(i.length>0){if(i[0].scrollHeight>95){var g=$$(".jfy_filter_bar .location_neighborhood .jfy_filter_neighborhood_footer.hidden");if(g.length>0){g.removeClass("hidden");$$("#jfy_filter_bar_neighborhood .location_neighborhood .jfy_filter_neighborhood_footer.hidden").removeClass("hidden")}}if(k.length>0){$$(".jfy_filter_bar .location_neighborhood").addClass("hidden")}}var f=$$(".jfy_filter_bar .location_attraction .jfy_filter_bar_neighborhood_inner");if(f.length>0){if(f[0].scrollHeight>95){var j=$$(".jfy_filter_bar .location_attraction .jfy_filter_neighborhood_footer.hidden");if(j.length>0){j.removeClass("hidden");$$("#jfy_filter_bar_neighborhood .location_attraction .jfy_filter_neighborhood_footer.hidden").removeClass("hidden")}}if(k.length>0&&i.length>0){$$(".jfy_filter_bar .location_attraction").addClass("hidden")}}},loadJFYFilterPulldown:function(i,g){if(!ta.retrieve("ta.p13n.jfyFilterPulldown")){var h="p13n_filter_pulldown";var f=new ta.overlays.RelativeOverlayBelow({content:ta.id(h).innerHTML,activate:ta.overlays.ACTIVATE_CLICK_ALTERNATE,closeOnDocumentClick:true,style:"",noPadding:true},g);ta.store("ta.p13n.jfyFilterPulldown",f)}},adjustJFYOverlayPositions:function(){var g=ta.retrieve("ta.p13n.jfyFilterSet");var f=Object.values(g||{});Object.each(f,function(h){if(h.visible){h.hideNow();h.show()}})},loadMetaHotelsFilter:function(i,f,g,h){ta.hac.filters.loadMetaHotelsFilter(i,f,g,h)},updateMetaHotelsFiltersFromBreadcrumbs:function(i,g,f,h){ta.hac.filters.updateMetaHotelsFiltersFromBreadcrumbs(f,h)},closeAllActiveFilters:function(){ta.hac.filters.closeAllActiveFilters()},hideFilterOverlay:function(j,f,g){var h=ta.retrieve("ta.filters.overlaySet");if(h&&h[g]){var i=h[g];if(i.visible){i.hide()}}},simulateDatePickerClick:function(k,g,j,h,i,f){ta.overlays.Factory.loadDatePicker(k,g,j,h,i,f);k.stopPropagation();k.preventDefault();return false},loadVRDatePicker:function(l,g,j,h,i,f){if(!f){f={}}var k=Object.merge({calendarOptions:{isVR:true}},f);ta.overlays.Factory.loadDatePicker(l,g,j,h,i,k)},loadDatePicker:function(p,g,j,f,k,q){if(!q){q={}}if(ta.widgets.calendar.isShim){if(!g){return}g=ta.id(g);var r=g.getAttribute("data-dateType");if(!r){if(g.hasClass("out_date")){r="CHECKOUT";g.setAttribute("data-dateType",r)}else{r="CHECKIN";g.setAttribute("data-dateType",r);ta.find(".out_date",g.parentNode.parentNode).setAttribute("data-dateType","CHECKOUT")}}ta.page.gatherDates(g);return}new Asset.image(CDNHOST+"/img2/generic/site/loading_anim_gry_sml.gif");if(ta.has("isHotelsLander")||ta.isMetaHomepageIntegration2013()||ta.has("isHomepage2015")||ta.has("widget.customHotel")||ta.has("isDaoDaoHomePageUnforkCalendar")){if(ta.has("isHotelsLander")||j==1||ta.has("isDaoDaoHomePageUnforkCalendar")){q=Object.merge({calendarOptions:{selectionStartClass:"start",selectionEndClass:"end",postContent:function(){var s=Elements.from('<div id="SKIP_DATES"><span class="skip_dates_text"><span class="taLnk">'+ta.retrieve("multiDP.skipDates")+"</span></span></div>")[0];s.getElement(".taLnk").addEvent("click",function(){var u=ta.overlays.getCurrent(),v=u&&u.calendar;v&&v.clear();var t=ta.id("SUBMIT_HOTELS");if(t){t.focus()}ta.widgets.calendar.clearSessionDates(null,function(){if(ta.has("widget.customHotel")){ta.widget.hotels.changeDates()}});if(ta.has("isHotelsLander")){ta.overlays.Factory.trackSkipDatesEvent("Hotels_Lander","Calendar","Skip dates",0)}else{ta.overlays.Factory.trackSkipDatesEvent("Meta_Homepage","Calendar","Skip dates",0)}});return s},onSelect:function(t){if(!t.oneSelected){var s=ta.id("SUBMIT_HOTELS");s&&s.focus()}}}},q)}if(j==1&&ta.has("widget.customHotel")){q.calendarOptions=q.calendarOptions||{};q.calendarOptions.wrapper=Elements.from('<div class="calendar_wrapper"><div class="wrapper_header">'+ta.retrieve("multiDP.header")+'</div><div class="wrapper_inner"></div><div class="wrapper_footer">'+ta.retrieve("multiDP.footer")+"</div>")[0]}if(j==1||j=="vr"){q.calendarOptions=q.calendarOptions||{};q.calendarOptions.submitOnEnter=ta.retrieve("widget.customHotel")?ta.widget.CustomHotelsWidget.validate:ta.pages.home.validate}}else{if(ta.retrieve("checkrates.meta_ui_sk_box_v3")){q=Object.merge({calendarOptions:{selectionStartClass:"start",selectionEndClass:"end"}},q)}}g=ta.id(g);if((ta.has("guests_rooms_picker_3.enabled")&&!ta.has("guests_rooms_picker_4.enabled")&&!ta.has("hotels_rgpicker_outofcalendar")&&!ta.has("hotels_left_filters_redesign"))&&g&&!g.getParent(".geoChkRates")&&(g.getParent(".jfy_header_dates_holder")||g.getParent(".filterControls")||g.getParent(".meta_chevron_module_2014")||g.getParent("#HotelDateSearch")||g.getParent(".HotelHighlight"))){try{ta.meta.update.clearDatesBumpedMessage();q.calendarOptions=q.calendarOptions||{};var m,i,h;if(ta.has("guests_rooms_picker_3.enabled")){i=ta.id(document.getElement(".guestsRoomsDatePickerHeaderForInject.hidden"));m=i?new Element("div").adopt(i.clone()).get("html"):""}i=ta.id(document.getElement(".showPricesForInject.hidden"));h=i?new Element("div").adopt(i.clone()).get("html"):"";q.calendarOptions.wrapper=Elements.from('<div class="calendar_wrapper"><div class="wrapper_header">'+m+'</div><div class="wrapper_inner"></div><div class="wrapper_footer">'+h+"</div>")[0];q.calendarOptions.isGuestsRoomsCalendar=true}catch(l){ta.util.error.record(l,"error building content for guests rooms datepicker wrapper")}}if(!q.calendarOptions){q.calendarOptions={}}if(ta.has("calendar.default.postcontent")&&!q.calendarOptions.postContent){q.calendarOptions.postContent=ta.retrieve("calendar.default.postcontent")}if(q.calendarOptions.isholidayEnable){q.calendarOptions.holidaysOnCalendar=ta.retrieve("calendar.holidays")}q.calendarOptions.classicStyling=true;q.calendarOptions.flights=q.flights;q.calendarOptions.oneWayFlight=q.oneWayFlight;q.calendarOptions.multiCityFlight=q.multiCityFlight;if(q.oneWayFlight||q.multiCityFlight){q.calendarOptions.onSelect="ta.overlays.calendar.select";q.calendarOptions.oneWayStyling=true}if(q.flights){var o=new Date();o.setDate(o.getDate()+ta.util.date.MAX_DAYS_BEFORE_RETURN_FLIGHT);q.calendarOptions.lastDate=o}ta.fireEvent("onCalendarSelect",g);q.calendarOptions.onChangeDates=ta.widgets.calendar.onCalendarChangeDates;q.calendarOptions.onRangeSelect=ta.widgets.calendar.onCalendarRangeSelect;if(j=="vr"){var n=new Date();n.setMonth(n.getMonth()+18);n.setDate(1);q.calendarOptions.lastDate=n}ta.overlays.Factory.destroyAnimatedDateCTA();ta.overlays.Factory._loadAvailDateWidget(p,j,"calendar",f,k,q);if(ta.retrieve("load_date_picker_buttons")){return false}},destroyAnimatedDateCTA:function(){if(ta.isMetaHotels2013()||(ta.retrieve("hh_short_cell.enabled")&&ta.widgets.calendar.hasPageDates())){var f;if(ta.retrieve("animate_date_reformat")){f=ta.id("ANIMATED_DATE_CTA_REFORMAT")}else{f=ta.id("ANIMATED_DATE_CTA")}if(f){ta.servlet.HACSearch.destroyAnimatedDateCTA()}}},trackSkipDatesEvent:function(g,h,f,j){try{ta.trackEventOnPage(g,h,f,j,false)}catch(i){}},loadAdultsField:function(k,g,j,h,i,f){if(!f){f={}}if(!f.calendarOptions){f.calendarOptions={}}ta.overlays.Factory._loadAvailDateWidget(k,j,"adults",h,i,f)},_loadAvailDateWidget:function(n,h,g,f,j,o){var l="in",i,m;if(n){n=new Event(n)}if(n&&n.target&&ta.id(n.target).hasClass&&(ta.id(n.target).hasClass("out_date")||(ta.has("guests_rooms_picker_3.enabled")&&ta.id(n.target).hasClass("outDateTrigger")))){l="out"}o.calendarOptions.pickerOption=l;m=ta.widgets.calendar.getCalendarObjectKey(h,f,l);i=ta.retrieve(m);if(i&&i.calendar.positionElement&&ta.id(i.calendar.positionElement).getParent("#PAGE")){i.show(g)}else{try{i=new ta.commerce.AvailDataWidget(n,h,g,f,j,o)}catch(k){ta.util.error.record(k,"load availDateWidget init error")}}},onClickMetaCheckRatesOverlay_allProviders:function(i,g,h,f){ta.overlays.Factory.metaCheckRatesOverlay_allProviders(h,f)},metaCheckRatesOverlay_allProviders:function(m,h){if(ta.page&&ta.page.usingUnifiedDates){var s;try{s=require("xsell/metaLightbox")}catch(q){}if(s){var t={};var g=ta.maps&&ta.maps.mapsponsor&&ta.maps.mapsponsor.getSponsorForLocation&&ta.maps.mapsponsor.getSponsorForLocation(m);if(g){t.mapSponsorship=g}s.showMetaLightbox(m,"",t);return}}ta.overlays.Factory._recordLBOpen();ta.commerce.meta.clearStoredMiniData();if(ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&h&&ta.id(h).getParents){var r=ta.id(h).getParents();r.each(function(u){if(u.hasClass("premium_offers_area")){if(ta.meta&&ta.meta.treeTrack&&ta.meta.treeTrack.hasTrackingTree(u)){ta.trk("n_more_sites",false,u)}}else{if(u.hasClass("metaPriceInfo")||(u.hasClass("illisting")&&ta.retrieve("servlet.smartdeals"))){if(ta.meta&&ta.meta.treeTrack){ta.meta.treeTrack.logTreeImpression();ta.trk("n_more_sites",false,u)}}}})}if(ta.retrieve("metaCheckRatesOverlay")){ta.retrieve("metaCheckRatesOverlay").hide()}ta.remove("metaCheckRatesOverlay");if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}var o=ta.retrieve("pcr.overlay");if(o&&o.visible){o.hide()}var f="";if(ta.meta&&ta.meta.update){f=ta.meta.update.buildUrl("MetaCheckRatesAjax",m,false)}else{f=ta.commerce.checkrates.buildMetaHacUrl_allProviders(m,false,"lb_allProviders",true)}var p="metaCheckRatesOverlay";if(ta.retrieve("meta_lightbox_v3.enabled")){p+=" meta_lightbox_v3"}p+=" metaLightBoxChevron marketingTextLightBox";var j=window.location.hash==="#MAPVIEW"||(ta.id(window.mapDivId)&&ta.id(window.mapDivId).innerHTML!=="");if(j&&ta.retrieve("meta_lightbox_v3.enabled")){p+=" wide"}var k={style:p,backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:ta.retrieve("meta_lightbox_v3.enabled")?"closeOverlayLarge":"roundOuterClose",remoteContent:f,onLoad:function(){var z=false,v,y;ta.store("isLightboxOpen",true);try{if(!ta.meta||!ta.meta.update){var w="meta_lb_checkrates";z=new ta.commerce.CheckRatesData({type:w,evnt:null},m,m,true);ta.store("ta.commerce.MetaHacOverlay.crData."+z.vendorSetId,z);y=z.getVendorSet().getAllVendorIds();v=z.getVendorSet().getCheckedVendor();ta.commerce.checkrates.updateMetaProviders(z)}var u=document.getElement(".metaCheckRatesOverlay .roundOuterClose");if(u&&!u.hasClass("no_cpu")){u.className+=" no_cpu"}if(this.inner){ta.fireEvent("refreshedDOMContent",this.inner)}}catch(x){ta.util.error.record(x,"meta all providers overlay load issue")}if(ta.meta&&ta.meta.update){ta.meta.update.overlayRequest(m)}else{ta.commerce.checkrates.metaHacRequest(z,y,v)}},evalScripts:true,onClose:function(){ta.store("isLightboxOpen",false);var A="meta_lightbox",z,w;A="meta_lightbox_chevron";ta.trackEventOnPage(A,"close","");if(ta.retrieve("checkrates.meta_ui_post_click_prices")){var D=ta.retrieve("meta.baseLocationId");if(D&&m==D){if(ta.meta&&ta.meta.update){ta.meta.update.request(m)}else{if(w){ta.commerce.meta.updateProvAreaFromLightBox(w.vendorSetId)}}if(ta.has("metaCheckRatesUpdateDivInline")){ta.commerce.meta.updateInlineMeta(m)}}else{if(D){if(ta.has("ta.meta.navArea")){z=ta.retrieve("ta.meta.navArea")}var v=ta.id("MetaPricesTab");var x=false;if(v!=null&&v.hasClass("sprite-tab-active")){x=true}var F=ta.id("LOC_PHOTOS"),E=ta.id("AMENITY_LIGHTBOX"),u=false;if(F||E){u=true}var C=false;if(ta.has("metaCheckRatesUpdateDivInline")){if(x){if(!u){ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(D);C=true}else{try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Inline")}catch(B){ta.util.error.record(B,"problem locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Mini")}catch(B){ta.util.error.record(B,"problem locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}ta.commerce.meta.updateNavArea("QC_Meta_Mini");if(ta.meta&&ta.meta.update){ta.meta.update.request(m)}else{w=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+D);if(w){ta.commerce.meta.miniMetaAjax(null,w,1000)}}C=true;ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Inline");ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Mini");ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(D);ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Inline");ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Mini");try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Inline")}catch(B){ta.util.error.record(B,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Mini")}catch(B){ta.util.error.record(B,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}}}else{if(ta.meta&&ta.meta.update){ta.meta.update.request(D)}else{w=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+D);if(w!=null){ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.meta.miniMetaAjax(null,w,1000);C=true}}}}if(!ta.meta||!ta.meta.update){w=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+D);if(w!=null&&!C){ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.meta.miniMetaAjax(null,w,1000)}}ta.commerce.meta.updateNavArea(z)}}}if(ta.retrieve("metaCheckRatesOverlay")){ta.retrieve("metaCheckRatesOverlay").destroy()}ta.remove("metaCheckRatesOverlay");ta.widgets.calendar.removeMetaCalendarFromSync(m);ta.widgets.calendar.closeCalendarWidgets();if(!ta.retrieve("meta.isDeals")&&(!ta.servlet.hotelsMap||!ta.servlet.hotelsMap.isMapOpen())){if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldIssueAjax")){ta.remove("hotels.shouldIssueAjax");ta.commerce.minimeta.ajax.send()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){ta.commerce.minimeta.doMetaDateSearch()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldHideClassicPrices")){var y=document.getElements(".classicPrice");y.each(function(G){G.hide()})}}}};if(ta.retrieve("checkrates.meta_ui_sk_box")||ta.retrieve("checkrates.meta_ui_sk_box_v2")||ta.retrieve("checkrates.meta_ui_sk_box_v3")){k.absoluteOffset=true;if(ta.retrieve("tablet_maps_v1")&&ta.retrieve("maps_v2_open")&&(window.innerHeight>window.innerWidth)){var n=72;var i=ta.find(".flexCard");if(i){n=i.clientHeight+80}k.yOffset=n+window.getScrollTop()}else{k.yOffset=72+window.getScrollTop()}}k.trigger=h;var l=new ta.overlays.CenteredOverlay(k,null);l.metaLocId=m;ta.store("metaCheckRatesOverlay",l);if(ta.has("locationPhotoAlbumOverlayResizeHack")){ta.retrieve("locationPhotoAlbumOverlayResizeHack")()}},metaCheckRatesOverlay:function(g,f,p,k){ta.overlays.Factory._recordLBOpen();ta.commerce.meta.clearStoredMiniData();ta.store("metaCheckRatesOverlay",null);if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}var m=ta.retrieve("pcr.overlay");if(m&&m.visible){m.hide()}var o="";if(ta.meta&&ta.meta.update){if(!ta.has("ta.meta.request.locId")){return}o=ta.meta.update.buildUrl("MetaCheckRatesAjax",ta.retrieve("ta.meta.request.locId"),false)}else{o=ta.commerce.checkrates.buildMetaHacUrl(g,f,p,false)}var n="metaCheckRatesOverlay";if(ta.retrieve("meta_lightbox_v3.enabled")){n+=" meta_lightbox_v3"}n+=" metaLightBoxChevron";var h=window.location.hash==="#MAPVIEW"||(ta.id(window.mapDivId)&&ta.id(window.mapDivId).innerHTML!=="");if(h&&ta.retrieve("meta_lightbox_v3.enabled")){n+=" wide"}var i={style:n,backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:ta.retrieve("meta_lightbox_v3.enabled")?"closeOverlayLarge":"roundOuterClose",remoteContent:o,onLoad:function(){if(ta.meta&&ta.meta.update){if(!ta.has("ta.meta.request.locId")){return}ta.meta.update.overlayRequest(ta.retrieve("ta.meta.request.locId"))}else{ta.commerce.checkrates.updateMetaProviders(g);ta.commerce.checkrates.metaHacRequest(g,f,p)}var q=document.getElement(".metaCheckRatesOverlay .roundOuterClose");if(q){q.className+=" no_cpu"}},evalScripts:true,onClose:function(){var r=this.source&&this.source.getParent(".gcrabLb");var q="meta_lightbox_chevron";ta.trackEventOnPage(q,"close","");if(!r){ta.overlays.Factory.updateMiniMetaPlacements(g)}j.destroy();if(!r){ta.store("metaCheckRatesOverlay",null);if(ta.meta&&ta.meta.update){if(!ta.has("ta.meta.request.locId")){return}ta.widgets.calendar.removeMetaCalendarFromSync(ta.retrieve("ta.meta.request.locId"))}else{ta.widgets.calendar.removeMetaCalendarFromSync(g.vendorSetId)}ta.widgets.calendar.closeCalendarWidgets();if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldIssueAjax")){ta.remove("hotels.shouldIssueAjax");ta.commerce.minimeta.ajax.send()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")&&!ta.id("LOC_PHOTOS")&&pageServlet!="SmartDeals"){ta.commerce.minimeta.doMetaDateSearch();ta.remove("hotels.datesChanged")}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldHideClassicPrices")){var s=document.getElements(".classicPrice");s.each(function(t){t.hide()})}}}};if(!i.trigger){var l=ta.retrieve("ta.hlb_el");if(l){i.trigger=l}}if(ta.retrieve("checkrates.meta_ui_sk_box")||ta.retrieve("checkrates.meta_ui_sk_box_v2")||ta.retrieve("checkrates.meta_ui_sk_box_v3")){i.absoluteOffset=true;i.yOffset=72+window.getScrollTop()}var j=new ta.overlays.CenteredOverlay(i,k);ta.store("metaCheckRatesOverlay",j);if(ta.has("locationPhotoAlbumOverlayResizeHack")){ta.retrieve("locationPhotoAlbumOverlayResizeHack")()}},updateMiniMetaPlacements:function(i){var n=ta.retrieve("meta.baseLocationId"),k;if(!n&&ta.id("LOC_PHOTOS")){var r=ta.id("LOC_PHOTOS").getElement("#CHECK_RATE");if(r&&/id_(\d+)/.test(r.className)){n=RegExp.$1}}if(ta.has("ta.meta.navArea")){k=ta.retrieve("ta.meta.navArea")}if(n){var h=ta.id("MetaPricesTab");var j=false;if(h!=null&&h.hasClass("sprite-tab-active")){j=true}var s=ta.id("LOC_PHOTOS");var p=ta.id("AMENITY_LIGHTBOX");var g=ta.id("CHECK_RATES_LB");var f=false;if(s||p||g){f=true}var m=false;if(ta.has("metaCheckRatesUpdateDivInline")){if(j){if(f){try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Inline")}catch(l){ta.util.error.record(l,"problem locking timing in Factory.metaCheckRatesOverlay for QC_Meta_Inline")}try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Mini")}catch(l){ta.util.error.record(l,"problem locking timing in Factory.metaCheckRatesOverlay for QC_Meta_Mini")}ta.commerce.meta.updateNavArea("QC_Meta_Mini");if(ta.meta&&ta.meta.update){ta.meta.update.request(n)}else{if(typeof(dd)!=="undefined"&&dd.commerce&&dd.commerce.checkrates){dd.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),n,"checkrates")}}m=true;ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Inline");ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Mini");ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(n);ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Inline");ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Mini");try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Inline")}catch(l){ta.util.error.record(l,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Mini")}catch(l){ta.util.error.record(l,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}}else{if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.widgets.calendar.datesExist()){ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(n);m=true}}}else{if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.widgets.calendar.datesExist()){ta.commerce.meta.updateNavArea("QC_Meta_Mini");if(ta.meta&&ta.meta.update){ta.meta.update.request(n)}else{if(typeof(dd)!=="undefined"&&dd.commerce&&dd.commerce.checkrates){dd.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),n,"checkrates")}}m=true}}}if((ta.retrieve("checkrates.meta_ui_post_click_prices")||s)&&ta.widgets.calendar.datesExist()&&!m){ta.commerce.meta.updateNavArea("QC_Meta_Mini");var o=document.getElementById("CHECK_RATE");if(!ta.retrieve("checkrates.meta_ui_post_click_prices")&&s){o=s.getElement("#CHECK_RATE");if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){var q=s.getParent(".overlay");if(q&&q.overlay){q.overlay.addEvent("onHide",function(){ta.commerce.minimeta.doMetaDateSearch()})}}}if(ta.meta&&ta.meta.update){ta.meta.update.request(n)}else{if(typeof(dd)!=="undefined"&&dd.commerce&&dd.commerce.checkrates){dd.commerce.checkrates.checkRatesMiniMeta(null,o,n,"checkrates",true)}}}}else{if(i){ta.commerce.meta.updateInlineMeta(i.vendorSetId)}}ta.commerce.meta.updateNavArea(k)},_recordLBOpen:function(){if(!ta.remove("skipLBGARecord")){var f=ta.remove("meta.lightboxOpener")||(ta.retrieve("meta.calendarCR")?"calendar":"button");var g="meta_lightbox_chevron";ta.trackEventOnPage(g,"open",f)}},createTAListingPolicyOverlay:function(g,f,i,h){var j=ta.id(i);if(j!=null){new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",backdrop:ta.overlays.BACKDROP_ALWAYS,content:j.get("html"),isChild:h},null)}},miniMetaCrossSellMicroOverlay:function(r,i,m,h){try{i.onmouseover=null;i.onclick=null;var f;if(ta.meta&&ta.meta.update){f=ta.meta.update.buildUrl("MicroMetaAjax",m,true,false,"QC_Meta_Mini|Related_XSell")}else{var k=new ta.commerce.CheckRatesData({type:"checkrates",evnt:r},i,m,true);var j=k.getVendorSet().getCheckedContentID();var t=k.getVendorSet().getCheckedVendor();var s=ta.retrieve("meta.travelData");s=ta.commerce.checkrates.getTravelDataFromDOM();f=ta.commerce.checkrates.buildVarMetaHacUrl("MicroMetaAjax",k,j,t,true,null,"QC_Meta_Mini|Related_XSell",s)}f+="&lowContentID="+h;f+="&drop=true";var o=i.className.match(/noDelayFirst/);var q=i.className.match(/delayOpen/);var n=ta.retrieve("delayedFirst");var g=!q||(o&&!n);var l=new ta.overlays.RelativeOverlayBelow({style:"",allowFlip:false,activate:ta.overlays.ACTIVATE_HOVER_DELAY,autoShow:g,delayShow:q,offsetLeft:0,offsetTop:-20,showCloseButton:false},i);l.loadRemoteContent(f,false);ta.store("delayedFirst",true)}catch(p){ta.util.error.record(p,"ta.overlays.factory.miniMetaCrossSellMicroOverlay")}},installmentRateTip:function(g,f){f=ta.id(f);new ta.overlays.RelativeOverlayAbove({style:"",innerDivClass:"installmentRateTipOverlay",activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,allowFlip:true,content:"<span>"+ta.retrieve("meta.paymentsTipText")+"</span>"},f)},jfyMoreTagOverlay:function(g,f,i){if(g){new Event(g).stop()}var h=ta.id(i);h=h.clone();new ta.overlays.RelativeOverlayAbove({style:"moreTagOverlay",activate:ta.overlays.ACTIVATE_HOVER,showCloseButton:false,content:h.innerHTML},f)},tripTypeSelectOverlay:function(h,f){if(!f||!h){return}f.onclick=null;h.stop();ta.trackEventOnPage("Reviews_Controls","filter_dropdown","");var g=document.getElement(".tripTypeOverlayContents");if(!g){return}g.show();new ta.overlays.RelativeOverlayBelow({style:"tripTypeSelectOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:false,content:g,offsetTop:3},f)},languageFilterSelectOverlay:function(h,f){if(!f||!h){return}f.onclick=null;h.stop();var g=document.getElement(".languageList");if(!g){return}g.show();new ta.overlays.RelativeOverlayRight({style:"tripTypeSelectOverlay",activate:ta.overlays.ACTIVATE_HOVER,showCloseButton:false,content:g,offsetLeft:-13},f)},reviewLanguageOverlay:function(h,f){if(!f||!h){return}f.onclick=null;h.stop();var g=document.getElement(".languageList");if(!g){return}var i=f.getSize().x-16;new ta.overlays.RelativeOverlayBelow({style:"reviewLanguageOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:false,content:g,offsetTop:1,offsetLeft:i},f)},reviewSeasonOverlay:function(h,f){if(!f||!h){return}f.onclick=null;h.stop();var g=document.getElement(".seasonList");if(!g){return}new ta.overlays.RelativeOverlayBelow({style:"reviewLanguageOverlay",activate:ta.overlays.ACTIVATE_CLICK_TOGGLE,showCloseButton:false,content:g,offsetTop:1},f)},topDestinationsOverlay:function(h,f){if(!f||!h){return}f.onclick=null;h.stop();var g=document.getElement(".topDestinationsList");if(!g){return}new ta.overlays.RelativeOverlayBelow({style:"topDestinationsOverlay",activate:ta.overlays.ACTIVATE_CLICK_TOGGLE,showCloseButton:false,content:g,offsetTop:1},f)},installExitInterrupter:function(){},ipLearnMoreMenu:function(g,f){if(!f||!g){return}f.onclick=null;g.stop();new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,style:"dropMenu"},f);new Request({url:"/ActionRecord?action=FBIP-PersistentHeader-Flyout"}).send()},logTrackingTree:function(){var f=document.getElement(".micro_meta_flyout");if(f){var g=f.getElement(".impressionTrackingTree");if(g){ta.trkImpTree(g)}}},loadDatePickerOverlay:function(h,g,f){ta.call("ta.p13n.wizard.loadDatePickerOverlay",h,g,f)},racLBDelegates:function(){function f(){}function g(){}return{onLoad:f,onClose:g}},racGeoSearchDelegates:function(f){return{onLoad:function(){ta.restaurantAvailabilitySearch.init(f)}}},createSearchPageScopeSelect:function(f,g){if(!f||!g){return}return new ta.overlays.RelativeOverlayBelow({style:"geo_select_flyout",closeOnDocumentClick:true,content:g},f)},loadingMostRecentDraftOverlay:function(g,h){if(g){var f=new ta.overlays.CenteredOverlay({showCloseButton:false,backdrop:ta.overlays.BACKDROP_ALWAYS,content:g.innerHTML,backdropColor:"#FFF",backdropOpacity:0.8,style:"loadingMostRecentDraftOverlay"});h();setTimeout(function(){f.hide()},3000)}},restaurantFiltersOverlay:function(f){return new ta.overlays.CenteredOverlay({showCloseButton:true,innerDivClass:"filtersOverlay",style:"filtersOverlayContainer",closeButtonClass:"filtersOverlayClose",content:f,backdrop:ta.overlays.BACKDROP_ALWAYS,fixed:false,noScrollY:true})}};if("g_logFactoryMisuse" in window){var d=ta.overlays.Factory;for(var a in d){if(d.hasOwnProperty(a)&&typeof(d[a]=="function")){(function(g){var f=d[g];d[g]=function(){try{var k="";if(document.querySelector(".ui_overlay.inner_poi_map")){k=" map"}else{if(document.querySelector(".ui_overlay.albumLightbox")){k=" photos"}}var j=[].slice.call(arguments);for(var i=0;i<j.length;i++){var n=j[i];if(n&&n.tagName){var h=[],m=n;while(m&&m!=document.body){h.push("["+[m.tagName,m.id,m.className].join(",")+"]");m=m.parentNode}j[i]="[Element:"+h.join(",")+"]"}}ta.util.error.record(new Error(j.join(",")),"Factory."+g+" called on "+window.pageServlet+k)}catch(l){}f.apply(d,arguments)}})(a)}}}})();(function(a){Object.append(a,{injectReviewSummaryContentFromConcept:function(c){try{var b=ta.retrieve("topconcepts.rsContent")[c];if(!b){ta.util.error.record(null,"injectReviewSummaryContentFromConcept - no content")}ta.overlays.Factory.injectReviewSummaryContent(b)}catch(d){ta.util.error.record(d,"injectReviewSummaryContentFromConcept")}},injectReviewSummaryContent:function(c){try{var b=ta.retrieve("reviewSummaryOverlay");if(b){b.inner.setContent(c);b.show()}else{ta.util.error.record(null,"injectReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"injectReviewSummaryContent")}},storeReviewSummaryContent:function(d,c){var b=ta.retrieve("topconcepts.rsContent");if(!b){b={}}b[d]=c;ta.store("topconcepts.rsContent",b)},addSummaryBoxContentAndShow:function(d,g){try{var h=ta.retrieve("reviewSummaryOverlay");ta.overlays.Factory.injectReviewSummaryContent(g);var c=null;var k=ta.id("TRAV_SAY_TERMS");if(typeof(k)!=undefined&&k!=null){var b=k.clone(true,false);b.addClass("col1of2");c=new Element("div",{"class":"wrap bx02 rd_concepts"});c.adopt(b)}else{c=ta.id("SUMMARYBOX").clone(true,false)}var j=h.inner;j.getElement(".title").adopt(c);var l="concept_"+d.replace(/ /g,"_");var i=document.getElement(".overlay .rd_concepts ."+l);if(i){i.removeClass("taLnk").removeClass("hvrIE6").addClass("conceptSelected").onClick=""}Array.each(j.getElements(".rd_concepts .snippetText"),function(e){var n=ta.id(e);n.removeClass("snippetText");n.removeClass("sprite-middot");n.removeClass("trip_type_snippet");n.addClass("conceptBullet");var m=n.getElement(".taLnk");if(m){m.setProperty("onclick","ta.util.cookie.setPIDCookie(25223);ta.call('ta.overlays.Factory.showReviewSummaryV2',event, this);")}});ta.overlays.Factory.storeReviewSummaryContent(d,j.get("html"));ta.overlays.Factory.injectReviewSummaryContentFromConcept(d)}catch(f){ta.util.error.record(f,"updateReviewSummaryContent - request.onSuccess")}},updateReviewSummaryContent:function(c,b){try{if(ta.has("reviewSummaryOverlay")&&ta.has("topconcepts.rsContent")&&ta.retrieve("topconcepts.rsContent")[c]){ta.overlays.Factory.injectReviewSummaryContentFromConcept(c);return}if(ta.has("reviewSummaryOverlay")){new Request({url:b,onSuccess:function(e){ta.overlays.Factory.addSummaryBoxContentAndShow(c,e)},evalScripts:true,method:"get"}).send();return}else{ta.util.error.record(null,"updateReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"updateReviewSummaryContent")}},getReviewSummaryUrl:function(f,e,i,c){ta.store("topconcepts.lastconcept",f);if(typeof modelLocId=="undefined"||typeof modelGeoId=="undefined"){var h=(typeof modelLocId=="undefined")?"undefined":modelLocId;var d=(typeof modelGeoId=="undefined")?"undefined":modelGeoId;ta.util.error.record(null,"getReviewSummaryUrl",null,{locId:h,geoId:d})}if(i&&c){ta.util.cookie.setPIDCookie(16007);var g="/MachineTranslation?";if(e.id){var f;if(e.id.indexOf("trans_")!=-1){f=e.id.replace("trans_","").replace(/_/g," ")}else{f=e.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",f);g+="page=summary&";g+="d="+modelLocId+"&";g+="concept="+f;g+="&sl=en&tl="+i}return g}var b="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+f;if(i){b+="&autotrans=true"}return b},getReviewSummaryConcept:function(b){try{var c=b.id?b.id:b.className.match("(concept_[a-zA-Z0-9-_]+)")[1];return c.replace("concept_","").replace(/_/g," ")}catch(d){ta.util.error.record(d,"getReviewSummaryConcept",null,{id:b.id,"class":b.className})}return""},showReviewSummaryV2:function(h,e,g,c){if(h){h.stop()}var f=ta.overlays.Factory.getReviewSummaryConcept(e);var b=ta.overlays.Factory.getReviewSummaryUrl(f,e,g,c);if(ta.has("reviewSummaryOverlay")){ta.overlays.Factory.updateReviewSummaryContent(f,b);return}ta.overlays.Factory._loadSummaryCss();var d=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding rgba_gry",autoShow:false,permanent:true,showCloseButton:true,remoteContent:b,onLoad:function(i){try{ta.store("topconcepts.overlay."+f,this);ta.overlays.Factory.addSummaryBoxContentAndShow(f,this.inner.innerHTML);this.show()}catch(j){ta.util.error.record(j,"showReviewSummary - overlay onload")}}},e);ta.store("reviewSummaryOverlay",d)}})})(ta.overlays.Factory);ta.overlays.CalendarOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{showCloseButton:true,activate:ta.overlays.ACTIVATE_FOCUS,style:"typeO ocal",autoShow:false,autoShowCal:false,calendarOptions:null,flipPadding:25,zIndex:999,extraShow:null},initialize:function(a,b){this.input=a.getElement("input[type=text]");this.parent(b,this.input);this.input.overlay=this;this.dayField=a.getElement("input.day");this.monthField=a.getElement("input.month");this.source.addEvent("click",this.show);this.icn=a.getElement("span.icn");if(this.icn){this.icn.onclick="";this.icn.addEvent("click",this.show)}var c=a.className.search("first")>=0;this.calendar=new ta.widgets.Calendar(Object.merge({dualCalendar:true,choiceLink:"ta.overlays.calendarSelect",prevAction:"ta.overlays.calendarPrev",nextAction:"ta.overlays.calendarNext",onSelect:this.select.bind(this),onClear:this.clear.bind(this),isFirstCal:c},this.options.calendarOptions));this.inner.adopt(this.calendar.container);this.parentOverlay=a.getParent(".overlay");if(this.parentOverlay){this.parentOverlay=this.parentOverlay.overlay;this.options.isChild=true}if(this.options.autoShowCal){this.show()}},destroy:function(){this.parent();this.input.overlay=null},show:function(c,a){if(this.options.extraShow){this.options.extraShow(this)}this.input.addClass("selected");var b=this.visible;this.parent(c);if(b&&!a){return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.loadFields();this.calendar.update();this.calendar.reposition();return this},hide:function(a){if(!this.visible){return}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},hideNow:function(a){this.input.removeClass("selected");if(!this.visible){return this}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},select:function(a,b){if(b){new Event(b).preventDefault()}this.updateFields();if(!a.options.dontHideOnSelect){this.hide()}this.fireEvent("onSelect",[this,b])},hover:function(b,a){this.fireEvent("onHover",[b,this,a])},mouseout:function(a){this.fireEvent("onMouseOutOnDate",[this,a])},clear:function(a,b){b&&new Event(b).preventDefault();this.clearFields();this.hide();this.fireEvent("onClear",this)},loadFields:function(){var b=parseInt(this.dayField.value.replace(/^0/,""));var a=this.monthField.value.split(/\//);if(a.length!=2){return}var c=parseInt(a[1]);if(ta.retrieve("thai_buddhist_era_year")&&c>=(new Date().getFullYear()+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET)){c-=ta.util.date.THAI_BUDDHIST_YEAR_OFFSET}a=parseInt(a[0].replace(/^0/,""));this.calendar.selectedDate=ta.util.date.create(c,a-1,b);return this},updateFields:function(){if(!this.calendar.selectedDate){this.loadFields()}if(!this.calendar.selectedDate){return}var a=this.calendar.selectedDate.getMonth()+1;if(a<10){a="0"+a}this.dayField.value=this.calendar.selectedDate.getDate();this.monthField.value=a+"/"+this.calendar.selectedDate.getFullYear();var b=this.calendar.selectedDate.getFullYear();if(ta.retrieve("thai_buddhist_era_year")){b=b+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET}this.input.value=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),b);this.input.defaultValue=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),b);this.input.removeClass&&this.input.removeClass("placeholder")},clearFields:function(){if(this.options.calendarOptions&&!this.options.calendarOptions.clearToBlank){this.input.value=this.input.getAttribute("placeholderValue")||JS_DateFormat}else{if(this.input.value==this.input.defaultValue){this.input.value=""}}},clearDateFields:function(){this.calendar.selectedDate=null;this.dayField.value="";this.monthField.value="";this.clearFields()},resetFieldsIfBlank:function(){if(this.input.value==""){this.input.value=this.input.defaultValue}},validate:function(){var b=this.input.value.match(DATE_FORMAT.pattern);if(b){var c=parseInt(b[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(b[DATE_FORMAT.month].replace(/^0/,""));var d=parseInt(b[DATE_FORMAT.year].replace(/^0/,""));if(c>0&&c<32&&a>0&&a<13){if(c<10){c="0"+c}if(a<10){a="0"+a}if(d<100){d+=2000}this.dayField.value=c;this.monthField.value=a+"/"+d;this.loadFields();if(!this.calendar.isValid()){return sInvalidDates}}else{return sInvalidDates}}else{return sInvalidDates}return null}});ta.overlays.createCalendar=function(b,a){new Event(b).preventDefault();a.onfocus="";new ta.overlays.CalendarOverlay($(a).getParent(".cal"),{autoShowCal:true})};ta.overlays.createCustomCalendar=function(c,b,a){new Event(c).preventDefault();b.onfocus="";new ta.overlays.CalendarOverlay($(b).getParent(".cal"),{autoShowCal:true,calendarOptions:a})};ta.overlays.calendarSelect=function(f,e,a,c,b){if(ta.has("checkrates.calendarActionRecord")){ta.util.cookie.removePIDCookie();ta.meta.linkTracking.actionRecord(ta.retrieve("checkrates.calendarActionRecord"))}ta.id(b).getParent(".overlay").overlay.calendar.select(f,ta.util.date.create(e,a,c));if(ta.has("checkrates.meta_calendar_style_on_classic")&&(Browser.ie||Browser.chrome)){ta.popups.PopUtil.attemptHoldingWindow(ta.meta.cr.getPropIdFromCRElement(ta.id(b).getParent(".overlay").overlay.input))}};ta.overlays.calendarPrev=function(b,a){ta.id(a).getParent(".overlay").overlay.calendar.prev()};ta.overlays.calendarNext=function(b,a){ta.id(a).getParent(".overlay").overlay.calendar.next()};ta.overlays.PairedCalendar=new Class({Implements:[Options,Events],options:{validate:false,validateFun:function(){},allowSameDay:false,calendarOptions:null,defaultSpan:1,keepDelta:false,clearDatesId:"clearDates",overlayOptions:{},overlayFirstOptions:null,disallowChars:false,disableInvalidEndDates:false,showCalIfInvalid:false,clearOnRestart:false,allowReverse:false},initialize:function(b,a){this.setOptions(a);b=ta.id(b);this.form=b.get("tag")=="form"?b:b.getParent("form");var c=Object.merge({onSelect:this.adjustRange.bind(this)},this.options.overlayOptions);if(this.options.calendarOptions){c.calendarOptions=this.options.calendarOptions}this.form.getElements(".cal").each(function(d){var f;if(d.hasClass("first")&&this.options.overlayFirstOptions){f=new ta.overlays.CalendarOverlay(d,Object.merge(Object.clone(c),this.options.overlayFirstOptions))}else{f=new ta.overlays.CalendarOverlay(d,c)}f.input.onfocus="";if(this.options.disallowChars){f.input.addEvent("keypress",this.validateInput.bind(this))}if(d.hasClass("first")){this.before=f}else{this.after=f;if(ta.has("isDaoDaoCRRedesign")){var e=this.form.get("qc_area");this.after.qcArea=e;this.before.qcArea=e}}},this);if(ta.retrieve("isDaoDao")){ta.store("cal_in",this.before);ta.store("cal_out",this.after)}this.after.theOtherCal=this.before;this.before.theOtherCal=this.after;this.after.calendar.theOtherCal=this.before.calendar;this.before.calendar.theOtherCal=this.after.calendar;if(b===this.before.input||b===this.before.icn){this.after.loadFields();if(this.before.options.autoShowCal){this.before.show()}}else{if(b===this.after.input||b===this.after.icn){this.before.loadFields();if(this.after.options.autoShowCal){this.after.show()}}}if(this.form){this.form.calendar=this;if(this.options.validate){this.form.addEvent("submit",this.validate.bind(this));this.errorDiv=this.form.getElement(".error_msg")}}},getOverlayForCalendar:function(a){if(this.before.calendar==a){return this.before}if(this.after.calendar==a){return this.after}return null},adjustRange:function(c){this.requireFullLoad();if(this.form.searchAll){if(this.form.searchAll.type=="checkbox"){this.form.searchAll.checked=false}else{if(this.form.searchAll.type=="hidden"){this.form.searchAll.value="false"}}}var b=ta.id(this.options.clearDatesId);if(b){b.style.visibility="visible"}var h=false;if(this.options.clearOnRestart&&c===this.before){this.after.clearDateFields()}else{if(this.options.allowReverse&&c===this.after&&this.before.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()<this.before.calendar.selectedDate.getTime()){var k=this.before.calendar.selectedDate;this.before.calendar.selectedDate=this.after.calendar.selectedDate;this.after.calendar.selectedDate=k;this.before.updateFields();this.after.updateFields()}else{if(!this.sameDayEnabled()&&!this.options.disableInvalidEndDates&&this.after.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()==this.after.calendar.options.firstDate.getTime()){this.before.calendar.selectedDate=new Date(this.before.calendar.options.firstDate);if(this.options.keepDelta){this.options.defaultSpan=1}var k=new Date(this.after.calendar.options.firstDate);k.setDate(k.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=k;this.before.updateFields();this.after.updateFields()}else{if(c==this.before){if(this.options.keepDelta||!this.isBeforeValid()){var k=new Date(this.before.calendar.selectedDate);k.setDate(k.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=k;h=true}this.after.updateFields()}else{if(c==this.after){if(!this.isAfterValid()){var k=new Date(this.after.calendar.selectedDate);k.setDate(k.getDate()-this.options.defaultSpan);if(k.getTime()<this.before.calendar.options.firstDate.getTime()){k=new Date(this.before.calendar.options.firstDate.getTime())}this.before.calendar.selectedDate=k}this.before.updateFields()}}}if(this.options.keepDelta&&this.before.calendar.selectedDate){this.options.defaultSpan=ta.util.date.getDaysInRange(this.before.calendar.selectedDate,this.after.calendar.selectedDate)-1;if(this.sameDayEnabled()){if(this.options.defaultSpan<0){this.options.defaultSpan=0}}else{if(this.options.defaultSpan<1){this.options.defaultSpan=1}}}}}this.fireEvent("onUpdate",this);var g=ta.retrieve("calendar.onUpdateCallback");if(g){for(var f=0;f<g.length;f++){if(window[g[f]]){window[g[f]](this,c)}}}this.updateMinStay(this.before.calendar.selectedDate,this.after.calendar.selectedDate);try{var a="before";if(c==this.after){a="after"}}catch(j){ta.util.error.record(j,"availability check - paired cal")}if(this.options.disableInvalidEndDates){if(c==this.before){var k=new Date(this.before.calendar.selectedDate);k.setDate(k.getDate()+1);this.after.calendar.options.firstDate=k;if(h){this.after.show()}}}},updateMinStay:function(a,c){var b=ta.id("minStay");if(b&&a&&c){b.disabled=true;b.selectedIndex=this.getMinStayIndex(a,c)}},getMinStayIndex:function(a,c){var b=ta.util.date.getDaysInRange(a,c)-1;if(b<7){return b}else{if(b<28){return 7}else{return 8}}},isOneWay:function(){return this.form.oneWay&&this.form.oneWay.checked},sameDayEnabled:function(){return this.options.allowSameDay||this.isOneWay()},searchAllEnabled:function(){return this.form.searchAll&&(this.form.searchAll.checked||(this.form.searchAll.type=="hidden"&&this.form.searchAll.value=="true"))},updateFields:function(){this.before.updateFields();this.after.updateFields()},clearFields:function(){this.before.clearDateFields();this.after.clearDateFields()},resetFieldsIfBlank:function(){this.before.resetFieldsIfBlank();this.after.resetFieldsIfBlank()},requireFullLoad:function(){if(!this.before.calendar.selectedDate){this.before.loadFields()}if(!this.after.calendar.selectedDate){this.after.loadFields()}},isBeforeValid:function(){this.requireFullLoad();if(!this.after.calendar.selectedDate){return true}return(this.before.calendar.selectedDate<this.after.calendar.selectedDate)||(this.sameDayEnabled()&&this.before.calendar.selectedDate.getTime()<=this.after.calendar.selectedDate.getTime())},isAfterValid:function(){this.requireFullLoad();if(!this.before.calendar.selectedDate){return true}return(this.after.calendar.selectedDate>this.before.calendar.selectedDate)||(this.sameDayEnabled()&&this.after.calendar.selectedDate.getTime()>=this.before.calendar.selectedDate.getTime())},validateInput:function(a){if(a.key.match(/^[a-zA-Z]$/)){a.preventDefault()}},validate:function(g){if(this.searchAllEnabled()){return true}var a=this.before.validate();var b=this.after.validate();var d=true;if(this.isOneWay()){if(a!=null){d=false;this.setError(a)}}else{if(a!=null||b!=null){d=false;this.setError(a||b)}else{if(!this.isAfterValid()){d=false;this.setError(sInvalidDates)}}}if(!d&&g){new Event(g).stop()}if(this.options.showCalIfInvalid){var f;if(a!=null){f=this.before}else{if(b!=null||!d){f=this.after}}if(f){f.input.value="";f.selectedDate=new Date();f.updateFields();f.show()}}if(d&&this.options.validateFun&&typeof this.options.validateFun==="function"){try{return this.options.validateFun(g)}catch(c){ta.util.error.record(c,"post-validation callback function failed in PairedCalendar",g);return d}}else{return d}},setError:function(a){if(!this.errorDiv){return}this.errorDiv.setContent(a).show()},toggleSearchAll:function(){if(this.searchAllEnabled()){this.before.clearFields();this.after.clearFields()}else{this.requireFullLoad();this.before.updateFields();this.after.updateFields()}}});ta.overlays.createSimplePairedCalendar=function(b,a){new Event(b).stop();new ta.overlays.PairedCalendar(a)};ta.overlays.createPairedCalendar=function(g,c,b){if(!b){b={validate:true}}new Event(g).preventDefault();var f;var d=function(){if(ta.has("hotel.meta2013")){return ta.retrieve("hotel.meta2013")}var i=ta.id("MAIN");var h=i&&(i.hasClass("Hotel_Review")||i.hasClass("ShowUserReviews")||i.hasClass("Hotels")||i.hasClass("HACSearch"));ta.store("hotel.meta2013",h);return h};if(ta.isMetaHomepageIntegration2013()||d()||ta.isMetaHotels2013()||ta.isAirport()){var e=b.inline;var a=typeof b.skipHAC!=="undefined"&&b.skipHAC!=null&&b.skipHAC;b.clearOnRestart=true;b.allowReverse=true;b.overlayOptions={showCloseButton:false,style:"date_picker_calendar paired",noPadding:true,noCpu:true};b.calendarOptions={prevStyle:"sprite-date_picker-btnLeftIdle",nextStyle:"sprite-date_picker-btnRightIdle",showRange:true};b.onUpdate=function(h){ta.widgets.calendar.setPageInDate(h.before.calendar.selectedDate);ta.widgets.calendar.setPageOutDate(h.after.calendar.selectedDate);if(h.before.calendar.selectedDate&&h.after.calendar.selectedDate){if(ta.isMetaHotels2013()&&!a){ta.servlet.HACSearch.doMetaDateSearch()}else{if(e){ta.widgets.calendar.launchInlineMeta(g)}}}};if(b.clearDates){delete b.clearDates;b.calendarOptions.postContent=function(){var h=Elements.from('<div id="SKIP_DATES"><span class="skip_dates_text"><span class="taLnk">'+ta.retrieve("multiDP.skipDates")+"</span></span></div>")[0];h.getElement(".taLnk").addEvent("click",function(){var j=ta.overlays.getCurrent();if(j){j.clearDateFields();j.theOtherCal&&j.theOtherCal.clearDateFields();j.hide()}var i=ta.id("SUBMIT_HOTELS");if(i){i.focus()}ta.widgets.calendar.clearPageDates();ta.widgets.calendar.clearSessionDates();ta.overlays.Factory.trackSkipDatesEvent("Meta_Homepage","Calendar","Skip dates",0)});return h}}f=new ta.overlays.PairedCalendar(c,b);f.before.addEvent("onSelect",function(i,h){f.after.input.focus()})}else{f=new ta.overlays.PairedCalendar(c,b)}return f};ta.overlays.clearFields=function(a){if(a.calendar){a.calendar.clearFields()}};ta.overlays.resetFieldsIfBlank=function(a){if(a.calendar){a.calendar.resetFieldsIfBlank()}};ta.overlays.toggleOffSearchAll=function(a){if(a.calendar&&a.searchAll){if(a.searchAll.type=="checkbox"){a.searchAll.checked=false}else{if(a.searchAll.type=="hidden"){a.searchAll.value="false"}}a.calendar.toggleSearchAll()}};ta.overlays.toggleOnSearchAll=function(a){a=ta.id(a);var b=a.getParent("form");if(!b.calendar){new ta.overlays.PairedCalendar(a,{validate:true,clearDatesId:a})}if(b.calendar&&b.searchAll){if(b.searchAll.type=="checkbox"){b.searchAll.checked=true}else{if(b.searchAll.type=="hidden"){b.searchAll.value="true"}}b.calendar.toggleSearchAll()}};ta.overlays.toggleSearchAll=function(d,b,a){b=ta.id(b);b.onclick="";var c=b.getParent("form");if(!a){a={validate:true}}if(!c.calendar){new ta.overlays.PairedCalendar(b,a)}c.calendar.toggleSearchAll(b);b.addEvent("click",c.calendar.toggleSearchAll.bind(c.calendar))};ta.overlays.clearDates=function(c,a){ta.overlays.toggleOnSearchAll(a);ta.id(a).style.visibility="hidden";var b=ta.id("minStay");if(b!==null){b.disabled=false;b.selectedIndex=0;filtersChanged(c)}};ta.overlays.PermanentOverlay=new Class({Extends:ta.overlays.AbsoluteOverlay,initialize:function(a,b){this.parent(Object.merge({permanent:true},a),b)}});ta.overlays.SkinnyOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,initialize:function(a,b){this.parent(a,b);this.container.setStyle("max-width","120px");if(Browser.ie6){this.shim.setStyle("max-width","120px")}if(this.transparentOverlayPadding){this.transparentOverlayPadding.setStyle("max-width","120px")}}});ta.overlays.Registration=new Class({Implements:[Options,Events],Binds:["response","failure"],options:{flow:null,url:"/Registration",isOverlay:true,pageTarget:null,responseCallback:null,completeCallback:null,customOverlayOptions:{},noreload:false,failureCloseHandler:null},initialize:function(a){this.setOptions(a);if(this.options.isOverlay){this.overlay=new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s4 dg",attachCloseEvent:false},this.options.customOverlayOptions));if(this.overlay.closeBtn){this.overlay.closeBtn.addEvent("click",this.cancel.bind(this))}}},getRequestData:function(){var c={flow:this.options.flow};this.options.pid&&Object.merge(c,{pid:this.options.pid});if(ta.has("registration.data")){c=Object.merge(c,ta.retrieve("registration.data"))}if(ta.has("page.geo")){c.geo=ta.retrieve("page.geo")}c.source=pageServlet;c=[c];Array.from(arguments).each(function(d){c.push(d)});var a=ta.id("token");if(a&&a.hasOwnProperty("value")){c.securityToken=a.value}if(ta.has("rsa")){c.push({encrypted:ta.retrieve("rsaVersion")});var b=ta.retrieve("rsa");c.forEach(function(d){if(d.pass){try{c.push({epass:b.encrypt(d.pass.value)})}catch(f){ta.util.error.record(f,"Encrypted Signin - encrypting sign-in/sign-up form parameters")}}})}return c},_getUrl:function(){var a=ta.util.URL.https(this.options.url);if(0!==a.indexOf("https:")){ta.util.error.record(null,"Post URL must have https protocol.");return""}return a},request:function(c,b){ta.store("registration.method","request");var a={url:this._getUrl(),method:"get",withCredentials:ta.retrieve("access_control_headers"),evalScripts:true,data:this.getRequestData(b,{action:c}),onSuccess:this.response,onFailure:this.failure};if(ta.has("registration.ga_module")){a.trackEvent={module:ta.retrieve("registration.ga_module"),action:c+"_Show",context:this.options.flow}}new Request(a).send();return this},post:function(b){var a=this;if(ta.has("registration.ga_module")){ta.trackEventOnPage(ta.retrieve("registration.ga_module"),b.action.value+"_Submit",a.options.flow,1,false)}ta.util.pending.waitFor(function(){return !ta.has("rsaLoading")},function(){if(ta.has("facebook.authcode.param")){b=Object.merge(b,{FBAuthCode:ta.remove("facebook.authcode.param")})}ta.store("registration.method","post");new Request({url:a._getUrl(),method:"post",withCredentials:ta.retrieve("access_control_headers"),evalScripts:true,data:a.getRequestData(b,{noreload:a.options.noreload}),onSuccess:a.response,onFailure:a.failure}).send()},100);return this},cancel:function(){ta.store("registration.method","cancel");new Request({url:this._getUrl(),method:"get",withCredentials:ta.retrieve("access_control_headers"),evalScripts:true,data:this.getRequestData({CANCEL:"y",action:ta.retrieve("registration.action"),noreload:this.options.noreload}),onSuccess:this.response,onFailure:this.failure}).send();return this},log:function(a){new Request({url:this._getUrl(),method:"get",withCredentials:ta.retrieve("access_control_headers"),evalScripts:false,data:this.getRequestData({action:"LOG",pageAction:a})}).send();return this},response:function(a){if(!ta.remove("registration.noop")){if(this.options.isOverlay){this.overlay.loadRemoteSuccess(a);if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{if(this.options.pageTarget){this.options.pageTarget.setContent(a)}}}if(this.options.responseCallback){setTimeout(this.options.responseCallback,1)}if(ta.has("registration.afterUpdate")){ta.remove("registration.afterUpdate").each(function(b){setTimeout(b,1)})}},close:function(){if(this.options.isOverlay){this.overlay.hide()}this.fireEvent("onComplete");if(this.options.completeCallback){this.options.completeCallback()}},failure:function(c){var a=0;var d=ta.remove("registration.method");try{a=c.status}catch(b){}if(a==503){this.overlay.loadRemoteSuccess('<div style="padding:6px;">'+JS_maintenance+"</div>");if(!this.overlay.closeBtn&&this.options.failureCloseHandler){this.overlay.addCloseButton()}if(this.overlay.closeBtn){this.overlay.closeBtn.removeEvents("click");this.overlay.closeBtn.addEvent("click",this.options.failureCloseHandler||ta.overlays.registration.close)}if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{if(d=="cancel"){ta.overlays.registration.close()}ta.util.error.ajaxFailure.partial("Registration:"+d)}}});ta.overlays.registration={getInstance:function(a){var b=ta.retrieve("registration.instance");if(!b){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}b=new ta.overlays.Registration(a);ta.store("registration.instance",b)}return b},connect:function(b,e,d){ta.queueForReady(function(){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}},0,"Pre-redesigned Registration CSS");if(ta.has("facebook.available")&&ta.retrieve("facebook.available")){var f={fbAvailable:true}}else{if(ta.has("registration.forceFBAvailable")){var f={fbAvailableForce:ta.remove("registration.forceFBAvailable")}}}var c="SIGNIN";ta.remove("registration.data");if(typeof(b)=="undefined"){b={}}var a="Deprecated_Registration_connect_"+b.flow;ta.util.error.record(null,a);ta.overlays.registration.addLoadingGeeTestCaptchaOnCallBack(b);ta.overlays.registration.getInstance(b).request(e||c,Object.merge({},d,f))},post:function(b,a){var c=a||window.event;if(c){new Event(c).stop()}ta.overlays.registration.getInstance().post(b)},request:function(c,b,a){if(c=="SIGNUP"||c=="SIGNIN"){b=Object.merge({fbAvailable:ta.has("facebook.available")&&ta.retrieve("facebook.available")},b)}if(typeof(a)=="undefined"){a={}}ta.overlays.registration.addLoadingGeeTestCaptchaOnCallBack(a);ta.overlays.registration.getInstance(a).request(c,b)},deferredRequest:function(d,b,e,c,a){ta.overlays.registration.getInstance(a).request(e,c,a)},cancel:function(a){ta.overlays.registration.getInstance(a).cancel(false)},log:function(a){ta.overlays.registration.getInstance().log(a)},close:function(){var a=ta.remove("registration.instance");if(a){a.close()}},switchFlow:function(a){ta.overlays.registration.getInstance().options.flow=a},logAndPost:function(c,b,a){ta.overlays.registration.getInstance(c).log(b).post(a)},postSignupForm:function(b,a){var c=a||window.event;if(c){new Event(c).stop()}ta.overlays.registration.getInstance().post(b)},addLoadingGeeTestCaptchaOnCallBack:function(b){if(typeof(b.responseCallback)=="function"){var a=b.responseCallback;b.responseCallback=function(){ta.overlays.registration.loadGeeTestCaptcha();a()}}else{b.responseCallback=ta.overlays.registration.loadGeeTestCaptcha}},loadGeeTestCaptcha:function(){if(ta.retrieve("geetest_captcha")){var e=ta.id("geetest_recaptcha_widget");if(e){var c=e.getAttribute("data-captcha-id");var d=e.getAttribute("data-captcha-type");var b=ta.select("#geetest_recaptcha_widget .gt_holder");if(window.Geetest&&b.length==0){var a=new Geetest({gt:c,product:d,https:true}).onReady(function(){var f=ta.select("#geetest_recaptcha_widget .gt_guide_tip");if(f.length>0){f[0].innerHTML=ta.retrieve("geetest_captcha.str_slide_to_verify")}}).appendTo(e);if(ta.trackEventOnPage){ta.trackEventOnPage("reg_captcha","GEETEST","displayed")}}}}}};ta.servlet||(ta.servlet={});ta.servlet.Registration={realNameDone:function(a){if(ta.id("use_real_name")&&ta.id("use_real_name").getProperty("checked")||ta.id("chooseNameFB")||ta.id("chooseNameGoogle")){ta.overlays.registration.post(ta.id("RealName"),a)}else{ta.overlays.registration.cancel()}},screenEdit:function(a){ta.id("screen").set("value","");ta.id("screen").focus();ta.id(a).hide()},displayLoading:function(){if(window.CDNHOST!=null){ta.id("buttonArea").innerHTML='<img class="loadingGif" src="'+CDNHOST+'/img2/generic/site/loading_anim_gry_sml.gif" />'}else{ta.id("submitButton").set("disabled",true)}},trackEmailOpt:function(a,b){if(a){if(!a.checked){ta.trackEventOnPage("register","sign_up_"+b,"email_opt_out")}}},toggleProgressCircle:function(b){var a=ta.id("circleContainer_"+b);if(a){if(a.hasClass("progressCircleChecked")){a.removeClass("progressCircleChecked");a.addClass("progressCircle");a.innerHTML=b}else{a.removeClass("progressCircle");a.addClass("progressCircleChecked")}}},toggleProgressBar:function(a){var b=ta.id("barContainer_"+a);if(b){if(b.hasClass("filled")){b.removeClass("filled")}else{b.addClass("filled")}}},toggleProgressElement:function(a,b,c){if(a&&a<=b){if(c=="Bar"){this.toggleProgressBar(a)}else{if(c=="Circle"){this.toggleProgressCircle(a)}}}},toggleTagged:function(c,b,f,e){if(c&&ta.id("tagContainer_"+c)){var a=ta.select(".tagSelection:checked").length;var d=ta.id("tagContainer_"+c);if(d.hasClass("tagged")){d.removeClass("tagged");this.toggleProgressElement(a,b,e);if(ta.id("tag_"+c).checked){ta.id("tag_"+c).checked=false;this.activateMemberTagSubmit(f)}}else{d.addClass("tagged");this.toggleProgressElement(a+1,b,e);if(!ta.id("tag_"+c).checked){ta.id("tag_"+c).checked=true;this.activateMemberTagSubmit(f)}}}},activateMemberTagSubmit:function(c){var b=1;var a=ta.id("submitBtn");if(c){b=0}if(a&&ta.select(".tagSelection:checked").length>=b){a.addClass("active")}else{if(a){a.removeClass("active")}}},submitMemberTags:function(s,j){var c;var i=(c=ta.select(".tagSelection:checked"))?c.length:0;var n=(c=ta.id("memberTagsPlacementPid"))?c.value:0;var a=(c=ta.id("memberTagsIsSecure"))&&(c.value=="true");var o=(c=ta.id("memberTagsIsEditFlow"))&&(c.value=="true");var l=(c=ta.id("memberTagsForceAjax"))&&(c.value=="true");var g=(c=ta.id("memberTagsOnSuccess"))?c.value:"";var f=ta.servlet.Registration[g];var b=$(s);if(!b||!b.hasClass("active")){return}var r=b.hasClass("skipBtn");var m=ta.id("submitBtn");if(m){m.removeClass("active")}var p=ta.id("skipBtn");if(p){p.removeClass("active")}ta.trackEventOnPage("self_tags",j,n,i);if(o&&r&&("undefined"!==typeof(oxapp))&&oxapp.getSubview("modules.membercenter.MemberTag")){if(m){m.addClass("active")}if(p){p.addClass("active")}var h=oxapp.getSubview("modules.membercenter.MemberTag");if(h.context&&h.context.get("MemberCenter_MemberTags")&&h.context.get("MemberCenter_MemberTags")._items&&h.context.get("MemberCenter_MemberTags")._items.length==0){h.taggedItems=[]}h.taggingOverlay.hide();return}if(o&&r&&("undefined"!==typeof(bbapp))&&bbapp.getView("modules.membercenter.MemberTag")){if(m){m.addClass("active")}if(p){p.addClass("active")}var h=bbapp.getView("modules.membercenter.MemberTag");if(h.context&&h.context.get("MemberCenter_MemberTags")&&h.context.get("MemberCenter_MemberTags").length==0){h.taggedItems=[]}h.taggingOverlay.hide();return}if(r){var d=ta.id("tagCancel");if(d){d.value=true}var k=ta.find(".overlayBG"),t=ta.find(".withBackdrop"),q=ta.id("tagPrompt");if(q&&k&&t&&t.hasClass("taggingOverlay")){q.hide();k.hide();t.hide()}}if(a&&!l){ta.overlays.registration.getInstance().post(ta.id("SELF_TAG_FORM")).response(function(){if(m){m.addClass("active")}if(p){p.addClass("active")}})}else{new Request({url:"/MemberTagsAjax",method:"post",data:ta.id("SELF_TAG_FORM"),onSuccess:function(e){if(m){m.addClass("active")}if(p){p.addClass("active")}if("function"===typeof(f)){f(e)}},onFailure:function(e){if(m){m.addClass("active")}if(p){p.addClass("active")}if(("undefined"!==typeof(oxapp))&&oxapp.getSubview("modules.membercenter.MemberTag")){oxapp.getSubview("modules.membercenter.MemberTag").taggingOverlay.hide()}if(("undefined"!==typeof(bbapp))&&bbapp.getView("modules.membercenter.MemberTag")){bbapp.getView("modules.membercenter.MemberTag").taggingOverlay.hide()}}}).send()}var d=ta.id("tagCancel");if(d){d.value=""}},memberTagsSuccessMemberCenter:function(c){if((typeof oxapp==="undefined"&&typeof bbapp==="undefined")||!c){return}var a,b=(a=ta.id("memberTagsIsEditFlow"))&&(a.value=="true");if(b&&typeof oxapp!=="undefined"&&oxapp.context.get("MemberCenter_MemberTags")){oxapp.context.get("MemberCenter_MemberTags").fetch().always(function(){if(oxapp.getSubview("modules.membercenter.MemberTag")){oxapp.getSubview("modules.membercenter.MemberTag").render()}});if(oxapp.getSubview("modules.membercenter.MemberTag")){oxapp.getSubview("modules.membercenter.MemberTag").taggingOverlay.hide()}}if(b&&typeof bbapp!=="undefined"&&bbapp.context.get("MemberCenter_MemberTags")){bbapp.context.get("MemberCenter_MemberTags").fetch().always(function(){if(bbapp.getView("modules.membercenter.MemberTag")){bbapp.getView("modules.membercenter.MemberTag").render()}});if(bbapp.getView("modules.membercenter.MemberTag")){bbapp.getView("modules.membercenter.MemberTag").taggingOverlay.hide()}}},memberTagsRedirectCompletionUrl:function(b){var a=ta.id("memberTagsCompletionUrl");if(a&&a.value){window.location.href=a.value}}};ta.overlays.PopoutOverlay=new Class({Extends:ta.overlays.Overlay,options:{backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.placeholder.setStyles({marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.source.setStyles({marginBottom:0,marginTop:0});if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(a){this.sourceCoords=this.source.getCoordinates();this.placeholder.setStyles({width:this.sourceCoords.width,height:this.sourceCoords.height});this.inner.adopt(this.source);this.parent(a)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"})},position:function(){var b=parseInt(this.container.getStyle("borderTopWidth").replace(/px/,""));var a=parseInt(this.container.getStyle("borderLeftWidth").replace(/px/,""));this.container.setStyles({left:this.sourceCoords.left-a,top:this.sourceCoords.top-b,width:this.sourceCoords.width,display:"block"});this.parent()}});ta.overlays.PopoutWithOverlay=new Class({Extends:ta.overlays.Overlay,options:{position:"topleft",edge:"topright",offset:{x:-10,y:0},scrollOffset:-20,backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.popout=new Element("div",{styles:{position:"absolute",zIndex:"10002",fontSize:"0.75em",display:"none"}}).inject(document.body);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(b){this.parent(b);var a=this.source.getCoordinates();this.placeholder.setStyles({width:a.width,height:a.height,marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.popout.setStyles({left:a.left,top:a.top,width:a.width,display:"block"}).adopt(this.source)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"});this.popout.setStyle("display","none")},position:function(){var a=this.source.getCoordinates();this.container.setStyles({left:null,top:a.top+this.options.offset.y,right:window.getWidth()-(a.left+this.options.offset.x)});this.parent();window.scrollTo(0,a.top+this.options.offset.y+this.options.scrollOffset)}});ta.overlays.CoverOverlay=new Class({Extends:ta.overlays.Overlay,options:{autoShow:true,xOff:0,yOff:0},initialize:function(a,b){this.parent(a,b);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},position:function(){var b=this.source.getCoordinates();var a=this.container.getCoordinates();this.container.setStyles({left:b.left+(b.width/2-a.width/2)+this.options.xOff,top:b.top+(b.height/2-a.height/2)+this.options.yOff})},updateBackdrop:function(){var a=this.source.getCoordinates();this.backdrop.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.overlays.SpecialDropDownWithRangeOverLay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{onClose:false,onShow:false},initialize:function(a,b){var d=["vrPriceMinDropDown","vrPriceMaxDropDown","vrPricePeriodDropDown"];var c="";if(b.id&&d.contains(b.id)){c="vrPriceDropDown"}this.parent(Object.merge({below:true,innerDivClass:"",style:c,autoShow:false},a),b);this.container.removeClass("relative");if(a.onClose){this.options.onClose=a.onClose}if(a.onShow){this.options.onShow=a.onShow}},show:function(h){if(this.visible){this.hide();return}try{this.options.onShow()}catch(g){}var b=h.srcElement?h.srcElement:h.target;if(b){this.source=b}if(this.options.sourceId){this.source=ta.id(this.options.sourceId);this.source.addClass("selected")}var d=ta.select(".overlay");for(var f=0;f<d.length;f++){var c=d[f];if(c.contains(this.source)){var a=c}}if(a){this.container.setStyle("z-index",a.getStyle("z-index")+1)}document.addEvent("click",this.hide);this.parent(h)},hide:function(b){if(this.options.onClose){try{this.options.onClose()}catch(a){}}if(this.options.rangeInputClass){try{if(this.options.closeOnlyIfClick&&!b){return}if(this.container.getElements("."+this.options.rangeInputClass)[0].contains(b.target)){return}}catch(a){}}this.hideNow()},hideNow:function(a){if(this.options.sourceId){this.source.removeClass("selected")}document.removeEvent("click",this.hide);this.parent()},position:function(){var a=this.source.getPosition();this.container.setStyles({left:a.x+this.options.xOffset?this.options.xOffset:0,top:a.y+this.options.yOffset?this.options.yOffset:0});this.parent()}});ta.overlays.StaticOverlay=new Class({Extends:ta.overlays.RelativeOverlay,initialize:function(a,b){this.parent(Object.merge({autoShow:false},a),b);this.container.removeClass("relative")},position:function(a){this.container.position({position:"center",offset:{x:this.options.offsetX||0,y:this.options.offsetY||0}});this.parent()},hide:function(e){if(e==null){return}var a=e.srcElement?e.srcElement:e.target;if(this.container.contains(a)){return}if(this.options.childrenOverlays){for(var c=0;c<this.options.childrenOverlays.length;c++){var b=this.options.childrenOverlays[c];var d=b.container||ta.select(b)[0];if(d&&d.contains(a)){return}}}this.parent()}});if(!ta.overlays.filters){ta.overlays.filters={}}ta.overlays.filters.CheckboxOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","doOnInit","buildContent"],options:{showCloseButton:false,activate:ta.overlays.ACTIVATE_CLICK,style:"date_picker_calendar",multiSelect:true,autoShow:false,delayShow:true,noPadding:true,keepElementInDocument:true,filterType:"",closeOnSelect:true},initialize:function(c,b){var a=Object.merge(this.options,c);this.input=document.getElement(".hotel_filter_wrap ."+a.filterType);this.parent(a,this.input);this.source.removeEvent("click",this.show);this.setupStandardBehavior();this.doOnInit()},setupStandardBehavior:function(){this.input.overlay=this;if(this.container){this.parentOverlay=this.container.getParent(".overlay");if(this.parentOverlay){this.parentOverlay=this.parentOverlay.overlay;this.options.isChild=true}}},doOnInit:function(){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType)},buildContent:function(b,e){var a=ta.retrieve("hac.data.object");var h=document.createDocumentFragment();if(a&&a.filters){var d=a.filters[e];if(d){var f=document.createElement("ul");var g=d.options.length;f.className="hacFilterItems "+d.hacName;if(g>8){f.className=f.className+" manyItems"}h.appendChild(f);var c=this;Array.each(d.options,function(i){c.addCheckboxItem(d,e,i,f,c,a)})}b.empty().appendChild(h)}},addCheckboxItem:function(g,b,c,e,h,d){var n="";if(h.isItemDisabled(c)){n="disabled"}var p="";if(n!=""){p="disabled=''"}var l=new Element("li");l.className="hacFilterItem";var j="";var a=b=="showUnavailable";if(a){j="showUnavailable"}if(n||a){l.className=l.className+" "+n+" "+j}if(c.value==0&&!a){l.className=l.className+" default"}var i=b;if(!h.isItemDisabled(c)){l.addEvent("click",function(r){(function(){h.dataItemClick.call(h,l,g.hacName,i,ta.hac.filters.getItemValue(c,b))}).delay(10);return false})}if(a){var k=new Element("hr");e.appendChild(k)}e.appendChild(l);var f="";if(a){if(c.value==1){f="checked=checked"}}else{if(h.isCheckboxItemSelected(d.selected,g.hacName,c.value)){f="checked=checked"}}var m=h.getItemDisplayFragment(c,b);var q=g.hacName+"_"+c.value;var o="";if(!a){o="<span class='itemCount'>("+c.count+")</span>"}else{q=g.hacName}l.innerHTML="<input type='checkbox' id='"+q+"' class='"+q+" "+n+"' "+f+" "+n+" /><span class='dataItem "+n+"'>"+m+o+"</span>"},dataItemClick:function(g,b,a,f){var h;if(ta.has("hac.filter.click.timeout")){ta.remove(ta.hac.filters.getHacFilterTimeoutKey());clearTimeout(ta.remove("hac.filter.click.timeout"))}this.fixCheckboxesInFilter(g);h=ta.hac.filters.updateFilterHash(b,this.getFilterSelections(b));var c=ta.has("persistentFilters.showing")?a+"|persistent_bar":a;if(h){try{var d="click";if(g&&g.getElement("input")&&!g.getElement("input").checked){d="unclick"}if(typeof pageServlet!="undefined"&&pageServlet=="Hotels"&&!ta.isMetaHotelsRequest()){ta.setEvtCookie(ta.hac.filters.getModuleString(this.options.filterType),d,c,f,"/HACSearch")}else{ta.trackEventOnPage(ta.hac.filters.getModuleString(this.options.filterType),d,c,f)}}catch(j){}var i=this;ta.store("hac.filter.click.timeout",setTimeout(function(){ta.remove("hac.updates.running");if(window.pageServlet=="Hotels"){ta.hac.filters.closeAllActiveFilters()}i.updateHACResults.call(i);ta.remove(ta.hac.filters.getHacFilterTimeoutKey())},2000));ta.store(ta.hac.filters.getHacFilterTimeoutKey(),ta.retrieve("hac.filter.changed"))}},updateHACResults:function(){if(this.options&&this.options.closeOnSelect){this.hide()}ta.hac.filters.updateResultsFromFilters()},setCloseOnSelect:function(a){if(this.options&&this.options.closeOnSelect){this.options.closeOnSelect=a}},fixCheckboxesInFilter:function(d){var d=ta.id(d);if(!d||d.hasClass("disabled")){return}if(d.hasClass("hacFilterItem")){d.getElement("input").checked=!d.getElement("input").checked}if(d.hasClass("default")){var e=d.getParent(".hacFilterItems");if(e){Array.each(e.getElements(".hacFilterItem"),function(f){f=ta.id(f);if(!f.hasClass("default")){f.getElement("input").checked=false}else{f.getElement("input").checked=true}})}}else{var b=false;var e=d.getParent(".hacFilterItems");if(!d.getElement("input").checked){var a=e&&document.getElements(".hacFilterItems input:checked");if(!a||!a.length){b=true}}if(e){var c=e.getElement(".default");if(c){c.getElement("input").checked=b}}}},getFilterSelections:function(c){var a=[];if(c=="showUnavailable"){a=document.getElements(".hacFilterItem."+c+" input:checked")}else{if(c){a=document.getElements(".hacFilterItems."+c+" input:checked")}else{a=document.getElements(".hacFilterItems input:checked")}}var b=[];Array.each(a,function(d){if(d.id!=c+"_0"){b.push(d.id)}else{if(c=="showUnavailable"){b.push("showUnavailable")}}});return b},addExpandableItem:function(c,d){var g=document.createDocumentFragment();var e=new Element("li");e.className=c+" expandFilterItem";g.appendChild(e);var f=document.createElement("div");f.className="nameItem sprite-filter-expand";if(ta.has("filterNames."+c)){f.innerHTML=ta.retrieve("filterNames."+c)}else{if(ta.has("hotels.currencies")&&"currencies"==c){f.innerHTML=ta.retrieve("hotels.currencies")[0]}else{f.innerHTML=c}}var b=new Element("div");b.className="toggleItem";e.appendChild(f);e.appendChild(b);var a=this;e.addEvent("click",function(){a.expandableClick.call(a,c,e)});d.appendChild(g)},expandableClick:function(){return},getItemDisplayFragment:function(a,b){return ta.hac.filters.getItemDisplayFragment(a,b,this.isItemDisabled(a))},isCheckboxItemSelected:function(c,a,f){if(!c){return false}var d=a+"_"+f;var b=c.cb;if(f!=0){if(b&&b.contains(d)){return true}}else{var e=false;if(b){Array.each(b,function(g){if(g.indexOf(a)!=-1){e=true}})}if(!e){return true}}return false},isItemDisabled:function(a){if(a&&a.count>0){return false}return true},destroy:function(){this.parent();this.input.overlay=null},nonSourceHide:function(a){if(!this.source.containsEvent(a)){this.hide()}},show:function(g){var d=this.visible;this.parent(g);document.removeEvent("click",this.hide);document.addEvent("click",this.nonSourceHide);if(this.options.filterType!="more"){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType)}if(d){return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}if(ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.container){this.container.setStyle("position","fixed")}var c=document.getElement(".hotel_filter."+this.options.filterType);var f=document.getElement(".date_picker_calendar."+this.options.filterType);if(ta.util.i18n.isRtl()){var b=c.getCoordinates().width;var a=f.getCoordinates().width;this.options.offsetLeft=a-b}else{this.options.offsetLeft=0}this.position();return this},hide:function(a){if(!this.visible){return}document.removeEvent("click",this.nonSourceHide);this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}}});ta.overlays.filters.ClassOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"hotel_class"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.RatingOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"traveler_rating"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.PriceOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"price"},initialize:function(b,a){this.parent(b,a)},doOnInit:function(){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType);if(ta.has("hotels.currencies")){this.addExpandableItem("currencies",this.inner.getElement(".hotelFilterContent"))}this.addShowUnavailableCheckbox(this.inner.getElement(".hotelFilterContent"))},expandableClick:function(b,c){var a=c.getElement(".toggleItem");if(a&&a.innerHTML!=""){a.innerHTML="";if(ta.id(c).getElement(".nameItem")){ta.id(c).getElement(".nameItem").removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}}else{this.buildCurrencyContent(c.getElement(".toggleItem"),"currencies");var d=ta.id(c).getParent(".expandFilterItems");if(d){var e=d.getElements("li");if(e){Array.each(e,function(g){g=ta.id(g);var f=g.getElement(".nameItem");if(!g.hasClass("currencies")&&f&&f.hasClass("sprite-filter-collapse")){var h=g.getElement(".toggleItem");if(h){h.innerHTML=""}f.removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}})}}if(ta.id(c).getElement(".nameItem")){ta.id(c).getElement(".nameItem").removeClass("sprite-filter-expand").addClass("sprite-filter-collapse")}}},show:function(){if(ta.has("ta.calendar.isPriceOverlayCalendar")){return}this.parent();if(ta.has("hotels.currencies")){this.addExpandableItem("currencies",this.inner.getElement(".hotelFilterContent"))}this.addShowUnavailableCheckbox(this.inner.getElement(".hotelFilterContent"))},nonSourceHide:function(a){if(!this.source.containsEvent(a)&&!this.inner.containsEvent(a)){this.hide()}},addShowUnavailableCheckbox:function(d){var a=ta.retrieve("hac.data.object");if(a&&a.filters){var f={hacName:"showUnavailable"};var e=this;var g=a.selected.showUnavailable;var c=ta.retrieve("filterNames.showUnavailable");var b={label:c,count:1,value:g?1:0};e.addCheckboxItem(f,"showUnavailable",b,d,e,a)}},buildCurrencyContent:function(a){var d="";var g=document.createDocumentFragment();var e=document.createElement("ul");var c=ta.retrieve("hotels.currencies");if(c){var f=c.length;e.className="hacFilterItems currency";if(f>8){e.className=e.className+" manyItems"}g.appendChild(e);var b=this;Array.each(c,function(j,i){var m=new Element("li");m.className="hacFilterItem";m.addEvent("click",function(n){(function(){b.currencyItemClick.call(b,j)}).delay(10);return false});e.appendChild(m);var l="";var k=b.getItemDisplayFragment(j,"currencies");var h="currency_"+j;m.innerHTML="<span class='dataItem'>"+k+"</span>"})}a.innerHTML="";a.appendChild(g)},currencyItemClick:function(a){ta.commerce.meta.clearStoredMiniData();if(a.test(/[A-Z]{3}/)){ta.store("ta.commerce.MetaHacOverlay.currency",a);new Request({url:"/ActionRecord?action=MetaCurrencyPicker"}).send();ta.trackEventOnPage("MetaCurrencyPicker","selected",a,1);ta.hac.filters.changeCurrency()}if(this.hide){this.hide()}},showCalendarLightbox:function(d){var c=ta.hac.filters.getModuleString(this.options.filterType);var e="open_calendar";var b="price";ta.trackEventOnPage(c,e,b,0,false);var a=ta.retrieve("ta.overlays.filters.PriceOverlay.showCalendarLightbox");if(typeof(a)=="function"){a()}else{this.buildCalendarLightbox(d)}},calendarLightBoxOverlay:null,buildCalendarLightbox:function(e,a){var d;d=ta.id("PriceFilterCalendarOverlayContent");if(!d){return}d.show();var c={style:"priceFilterCalendarOverlay",innerDiv:"skv3",content:d,autoShow:false,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",onShow:function(){ta.remove("ta.calendar.isOutDateTrigger");ta.store("ta.calendar.isPriceOverlayCalendar",true);var h=null;var g=document.getElement("date_picker_in_PriceFilterCalendar");setTimeout(function(){ta.overlays.Factory.loadDatePicker(h,g,"PriceFilterCalendar","",ta.servlet.HACSearch.doMetaDateSearch)},100);if(this.calendar){this.calendar.reposition()}},onClose:function(){ta.remove("ta.calendar.isOutDateTrigger");ta.remove("ta.calendar.isPriceOverlayCalendar")},onHide:function(){ta.remove("ta.calendar.isOutDateTrigger");ta.remove("ta.calendar.isPriceOverlayCalendar")}};var f=ta.id("HEADING");var b=new ta.overlays.CenteredOverlay(c,f);ta.store("ta.overlays.filters.PriceOverlay.showCalendarLightbox",function(){b.show()})},buildContent:function(a,b){if(ta.retrieve("meta.hotels_no_prices")&&!ta.widgets.calendar.hasPageDates()){this.showCalendarLightbox(a)}else{this.parent(a,b)}}});ta.overlays.filters.NeighborhoodOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"neighborhood"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.AmenitiesOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"amenities"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.BrandOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"hotel_brand"},initialize:function(b,a){this.parent(b,a)},getItemDisplayFragment:function(a){if(typeof brandMappings!="undefined"){return"<span class='itemLabel'>"+brandMappings[a.value]+"</span>"}return""}});ta.overlays.filters.MoreOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"more",moreOptions:""},initialize:function(b,a){if(b.moreOptions){this.displayFilters=b.moreOptions.split(" ")}this.parent(b,a)},doOnInit:function(){var b=document.createDocumentFragment();var a=new Element("ul");a.className="expandFilterItems more";b.appendChild(a);this.inner.getElement(".hotelFilterContent").innerHTML="";this.inner.getElement(".hotelFilterContent").appendChild(b);moreOvly=this;Array.each(this.displayFilters,function(c){var d=ta.retrieve("hac.data.object");if(d&&d.filters){var e=d.filters[c];if(e&&e.options.length>0){moreOvly.addExpandableItem.call(moreOvly,c,a)}}})},nonSourceHide:function(a){if(!this.source.containsEvent(a)&&!this.inner.containsEvent(a)){this.hide()}},expandableClick:function(c,b){var f=ta.has("persistentFilters.showing")?c+"|persistent_bar":c;var a=b.getElement(".toggleItem");if(a&&a.innerHTML!=""){a.innerHTML="";if(ta.id(b).getElement(".nameItem")){ta.id(b).getElement(".nameItem").removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}ta.trackEventOnPage(ta.hac.filters.getModuleString(this.options.filterType),"close",f)}else{this.buildContent(b.getElement(".toggleItem"),c);var d=ta.id(b).getParent(".expandFilterItems");if(d){var e=d.getElements("li");if(e){Array.each(e,function(h){h=ta.id(h);var g=h.getElement(".nameItem");if(!h.hasClass(c)&&g&&g.hasClass("sprite-filter-collapse")){var i=h.getElement(".toggleItem");if(i){i.innerHTML=""}g.removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}})}}if(ta.id(b).getElement(".nameItem")){ta.id(b).getElement(".nameItem").removeClass("sprite-filter-expand").addClass("sprite-filter-collapse")}ta.trackEventOnPage(ta.hac.filters.getModuleString(this.options.filterType),"open",f)}}});ta.overlays.filters.SortOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"sort"},initialize:function(b,a){this.parent(b,a)},addCheckboxItem:function(e,a,b,d,f,c){var h=new Element("li");h.className="hacFilterItem";if(b.value==0){h.className=h.className+" default"}var g=this;h.addEvent("click",function(k){if(window.pageServlet=="WidgetEmbed"){ta.hac.filters.changeSort(b.value);ta.trackEventOnPage(ta.hac.filters.getModuleString(g.options.filterType),"click",b.value)}else{ta.pages.hac.hacSortChangedToValue(b.value)}g.hide();return false});d.appendChild(h);var i=f.getItemDisplayFragment(b,a);var j=b.value;h.innerHTML="<span class='dataItem'>"+i+"</span>"}});(function(m,e,f,c){var d="GuestRoomSelector",k="grp-rooms",n="grp-guests",l="grp-update",r="-value",j="singular_room_da",b="plural_rooms_da",a="singular_guest_da",q="plural_guests_da",i="rooms_guests_picker_update_da",o=function(t,s,w){var v=t.replace("grp-",""),u=s+"_"+v;f.trackEventOnPage(d,u,null,w)},h=function(){f.trackEventOnPage(d,"update_click")},p=function(s){var t=s&&s.target&&$(s.target).getParent(".date_picker_calendar");return(t!=null)};f.overlays.GuestsRoomsOverlay=new Class({Extends:f.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","hideByClickOnDocument"],options:{showCloseButton:false,activate:f.overlays.ACTIVATE_CLICK,multiSelect:true,autoShow:false,delayShow:true,noPadding:true,keepElementInDocument:true,closeOnSelect:false},callback:null,selectionModified:false,findTargetFunction:false,initialize:function(u,t){this.callback=u.moreOptions.callback;if(u.guestsRoomsData){this.saveData(u.guestsRoomsData)}this.buildContent(u);this.input=u.moreOptions.input;this.findTargetFunction=u.moreOptions.findTargetFunction;var s=Object.merge(this.options,u);this.parent(s,this.input);this.source.removeEvent("click",this.show);this.setupStandardBehavior()},setupStandardBehavior:function(){if(this.input.getParent(".overlay")){this.parentOverlay=this.input.getParent(".overlay").overlay;this.options.isChild=true}},getData:function(){return f.widgets.calendar.getGuestsRoomsPickerData()},saveData:function(s){f.store("guests.rooms.object",s);f.fireEvent("onLegacyGuestsChanged",s)},resetData:function(){var s={rooms:1,guests:2};this.saveData(s);return s},updateSessionGuestsRooms:function(u){var t;if(f.widgets.calendar.hasPageDates()){t=f.widgets.calendar.getCheckRatesData()}else{var v=this.getData();t={rooms:v.rooms,adults:v.guests}}var s=this;new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(t),method:"post",onSuccess:function(){s.runCallback(u);f.fireEvent("onLegacyGuestsChanged",f.retrieve("guests.rooms.object"))}}).send()},runCallback:function(s){if(this.callback&&typeof(this.callback)==="function"&&f.widgets.calendar.hasPageDates()){this.callback(s)}},resetOverlay:function(){this.resetData();this.updateOverlay(k);this.updateOverlay(n)},getTranslationString:function(t){var u=this.getData();var s;if(t===k){s=u.rooms;if(s===1){return f.retrieve(j)}else{return f.retrieve(b)}}else{if(t===n){s=u.guests;if(s===1){return f.retrieve(a)}else{return f.retrieve(q)}}else{if(t===l){return f.retrieve(i)}}}},getCounter:function(t){var u=this.getData();var s;if(t==k){s=u.rooms}else{if(t===n){s=u.guests}}return s},buildContent:function(t){var u=new Element("ul");u.className="guests_rooms_overlay";var w=this.buildButtonLine(k);u.appendChild(w);var v=this.buildButtonLine(n);u.appendChild(v);var s=this.buildUpdateLine();u.appendChild(s);t.content=u},buildButtonLine:function(y){var u=this.getCounter(y);var w=this.getTranslationString(y);var t=new Element("li");t.className="line";t.id=y;var z=new Element("div");z.className="signButton minusButton";if(u===1){z.className+=" disabled"}z.setContent("-");var v=this;z.addEvent("click",function(A){v.processDecrementCounter(y,true)});var s=new Element("div");s.className="numberLabelText";s.setContent(u+" "+w);var x=new Element("div");x.className="signButton plusButton";if(y===k&&u>7){x.className+=" disabled"}else{if(y===n&&u>31){x.className+=" disabled"}}x.setContent("+");x.addEvent("click",function(A){v.processIncrementCounter(y,true);A.stopPropagation()});t.appendChild(z);t.appendChild(s);t.appendChild(x);return t},processDecrementCounter:function(u,s){var v=this.getData(),w;if(u===k){if(v.rooms<=1){return}v.rooms-=1;w=v.rooms;this.saveData(v);this.updateOverlay(u);while((v.guests/4)>v.rooms){this.processDecrementCounter(n)}}else{if(u===n){if(v.guests<=1){return}v.guests-=1;w=v.guests;this.saveData(v);this.updateOverlay(u);var t=(v.guests<v.rooms);if(t){this.processDecrementCounter(k)}}}if(s){o(u,"subtract",w)}},processIncrementCounter:function(t,s){var v=this.getData(),w;if(t===k){if(v.rooms>7){return}v.rooms+=1;w=v.rooms;this.saveData(v);this.updateOverlay(t);var u=(v.rooms>v.guests);if(u){this.processIncrementCounter(n)}}else{if(t===n){if(v.guests>31){return}v.guests+=1;w=v.guests;this.saveData(v);this.updateOverlay(t);var u=((v.guests/4)>v.rooms);if(u){this.processIncrementCounter(k)}}}if(s){o(t,"add",w)}},updateOverlay:function(s){var u=this.buildButtonLine(s);var t=f.id(s);t.parentNode.replaceChild(u,t);this.selectionModified=true;this.updateCounterElement(s)},updateCounterElement:function(t){var u=this.getCounter(t);var s=$$("."+t+r);s.each(function(v){v.innerHTML=u});if(t===k){f.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".roomsGuestsButton.roomsButton",u);f.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".stayInfoContainer.rooms",u)}else{if(t===n){f.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".roomsGuestsButton.guestsButton",u);f.widgets.calendar.updateGuestsRoomsButtonLabelsPluralization(".stayInfoContainer.guests",u)}}},buildUpdateLine:function(){var w=this.getTranslationString(l);var s=new Element("li");s.className="line update";s.id=l;var u=new Element("div");u.className="updateButton rndBtn rndBtnGreen";var t=this;u.addEvent("click",function(y){t.processUpdate(y);t.hide();h()});var v=new Element("div");v.className="ui-btn-inner";var x=new Element("div");x.className="ui-btn-text";x.setContent(w);v.setContent(x);u.setContent(v);s.setContent(u);return s},processUpdate:function(s){if(!this.selectionModified){if(this&&this.parentOverlay&&this.parentOverlay.visible&&f.widgets.calendar.hasPageDates()){this.parentOverlay.hide()}return}this.selectionModified=false;this.updateSessionGuestsRooms(s)},destroy:function(){this.parent();this.input.overlay=null},nonSourceHide:function(s){if(!this.source.containsEvent(s)&&!(s.target.className.contains("signButton"))){this.hide(s)}},hideByClickOnDocument:function(s){if(this.parentOverlay&&this.parentOverlay.visible){return}else{this.hide(s)}},show:function(t){var u=this.visible,v;this.parent(t);m.removeEvent("click",this.hide);m.addEvent("click",this.nonSourceHide);m.removeEvent("click",this.hideByClickOnDocument);$$(".date_picker_calendar").addEvent("click",this.nonSourceHide);v=this.findTargetFunction(t);if(v){this.source=v}f.widgets.calendar.syncAllDatePickers();if(u){this.hide(t);return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==f.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.position();var s=$$(".roomsGuestsButtonWrap .roomsGuests");if(s){s.addClass("disabled")}return this},hide:function(t){if(!this.visible){return}m.removeEvent("click",this.nonSourceHide);$$(".date_picker_calendar").removeEvent("click",this.nonSourceHide);this.parent(t);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}var s=$$(".roomsGuestsButtonWrap .roomsGuests");if(s){s.removeClass("disabled")}this.processUpdate(t)}});f.overlays.GuestsRoomsOverlay.closeModalAndUpdateCount=function(t){f.trackEventOnPage("PriceFinder_PromptChange",t?"revert":"update");var s=f.find(".ui_modal.increase_rooms_modal");var u=f.find(".ui_backdrop.increase_rooms_modal_backdrop");if(!t){var w={rooms:1,guests:2,child_rm_ages:""};w.rooms=f.overlays.GuestsRoomsOverlay.roomsNew;w.guests=f.overlays.GuestsRoomsOverlay.guestsNew;w.child_rm_ages=f.overlays.GuestsRoomsOverlay.child_rm_ages_old||"";f.store("guests.rooms.object",w);f.overlays.NumberPickerOverlay.updateHeaderMsg(".metaDatePicker",s);var v=f.find(".change_dates_button");v&&f.servlet.HACSearch.doMetaDateSearch(null,v)}};f.overlays.GuestsRoomsOverlay.trackPickerClick=function(s){if(p(s)){f.trackEventOnPage(d,"select_guest_room_calendar")}else{f.trackEventOnPage(d,"select_guest_room")}};var g;f.overlays.GuestsRoomsOverlay.open=function(w,u,v,x){var t=g;if(!t){if(f.has("guests_rooms_picker_3.enabled")){x.input=f.find(".calendar_wrapper .guests_rooms_picker_container")}else{x.input=f.find(".guests_rooms_picker_container")}x.findTargetFunction=function(y){if(f.has("guests_rooms_picker_3.enabled")&&!f.has("guests_rooms_picker_4.enabled")&&!f.has("hotels_rgpicker_outofcalendar")){return f.find(".date_picker_calendar.overlay .wrapper_header .roomsGuests")}else{if(y&&y.target){return f.id(y.target).getParent(".roomsGuests")}}};var s={style:"date_picker_calendar guests_rooms_overlay",moreOptions:x};t=new f.overlays.GuestsRoomsOverlay(s,u);g=t}t.show(w)}})(document,window,ta);(function(k,i,h,d){var e={rooms:{max:8,translationKey:"rgPicker.nRooms",tracking:"RoomSelector"},guests:{max:32,translationKey:"rgPicker.nGuests",tracking:"GuestSelector"}},a=4,j=function(n,p){p=h.id(p);if(p){var o=p.getWidth();if(n&&n.container&&o>n.container.getWidth()){n.container.setStyle("width",o-2)}}},c=function(s,t,o){var r=e[o],q={type:o,labels:h.retrieve(r.translationKey),maxValue:r.max,target:t,tracking:r.tracking},n=l(o),p=h.retrieve(n)||new h.overlays.NumberPickerOverlay(q,t);h.store(n,p);if(t&&(t.getParent("#hotels_lf_header_bar")||t.getAttribute("data-matchwidth"))&&p){p.addEvent("onShow",j.bind(this,p,t))}p.show(s);h.fireEvent("showRoomGuestPicker");return p},l=function(n){return"numberPickerOverlay_"+n},m=function(n,o){return o[n]},g=function(){return h.widgets.calendar.getGuestsRoomsPickerData()},f=function(n){h.store("guests.rooms.object",n);h.fireEvent("onLegacyGuestsChanged",n)},b=function(p,r){var q=g(),n=function(v){var x=v.guests/Math.max(v.rooms,1);if(x>a){h.trackEventOnPage("PriceFinder","guest_per_room_exceeded",v.guests,v.rooms);var u=Math.ceil(v.guests/a);if(h.retrieve("priceFinder.noAutoRefresh")){h.overlays.GuestsRoomsOverlay.roomsNew=u;h.overlays.GuestsRoomsOverlay.guestsNew=v.guests;var s=h.find(".roomsAdultsModalLnk");var z=s.getAttribute("data-subheader");var w="";z&&(w=z.replace(/%ROOMS%/g,u));s.setAttribute("data-subheader",w);s.click();var A=h.find(".increase_rooms_modal .yesUpdate");var y=h.find("#STATIC_DATE_PICKER_BAR .yesTxt");A&&y&&(A.innerHTML=y.innerHTML.replace(/%ROOM%/g,u));var t=h.find(".increase_rooms_modal .subheader_text");t&&(t.innerHTML=(s.getAttribute("data-subheader")));s.setAttribute("data-subheader",z);v.rooms=h.overlays.GuestsRoomsOverlay.roomsOld;v.guests=h.overlays.GuestsRoomsOverlay.guestsOld;v.child_rm_ages=h.overlays.GuestsRoomsOverlay.child_rm_agesOld||"";h.store("guests.rooms.object",v);h.overlays.NumberPickerOverlay.updateHeaderMsg(".metaDatePicker");return}v.rooms=u}else{if(v.rooms>v.guests){v.rooms=v.guests}}},o=function(t){var s=t.guests/Math.max(t.rooms,1);if(s>a){t.guests=t.rooms*a}else{if(t.rooms>t.guests){t.guests=t.rooms}}};if(q[p]===r){return false}q[p]=r;if(p==="rooms"){o(q)}else{if(p==="guests"){n(q)}}f(q);return true};h.overlays.NumberPickerOverlay=new Class({Extends:h.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","hideByClickOnDocument"],options:{activate:h.overlays.ACTIVATE_CLICK,style:"numberPickerOverlay",multiSelect:false,autoShow:false,delayShow:false,noPadding:true,keepElementInDocument:true,closeOnSelect:true,waitForCss:true},callback:function(){if(h.find(".HotelHighlight .hh_server_render")){h.commerce.metajson.refetchAll();h.fireEvent("guestsRoomsPickerUpdate")}else{if(h.retrieve("hh_short_cell.enabled")){if(this.source&&this.source.className&&this.source.className.indexOf("placement_hh")!=-1&&h.commerce.metajson){h.commerce.metajson.refetchAll()}}else{if(i.pageServlet=="Hotels"){h.widgets.calendar.checkDatesMakeHacCallHotels()}else{var n=h.retrieve("meta.baseLocationId");h.widgets.calendar.checkDatesMakeHacCallHR(n)}}}h.retrieve("priceFinder.noAutoRefresh")&&this.source&&this.source.addClass("ready_for_update")},initialize:function(o,p){this.input=o.target;this.buildContent(o);if(p.getParent("#hotels_lf_header_bar")){this.options.style+=" hotels_lf"}if(p.getAttribute("data-style")){this.options.style+=" "+p.getAttribute("data-style")}var n=Object.merge(this.options,o);this.parent(n,this.input);i.addEvent("date_bar_docked",this.position.bind(this));i.addEvent("date_bar_undocked",this.position.bind(this));i.addEvent("resize",this.position.bind(this))},buildContent:function(n){var o=new Element("div");o.appendChild(this.buildSelectorRows(n));n.content=o},buildSelectorRows:function(o){var n=this,p=new Element("ul"),r,q,s=function(u,t){u.addEvent("click",function(w){if(h.retrieve("priceFinder.noAutoRefresh")){var x=g();h.overlays.GuestsRoomsOverlay.roomsOld=x.rooms;h.overlays.GuestsRoomsOverlay.guestsOld=x.guests;h.overlays.GuestsRoomsOverlay.child_rm_ages_old=x.child_rm_ages}var v=b(o.type,t);n.hide();h.trackEventOnPage(o.tracking,"Select",null,t);if(v){n.callback()}})};p.className="list";for(q=1;q<=o.maxValue;q++){r=new Element("li");r.setContent(m(q,o.labels));r.className="item";s(r,q);p.appendChild(r)}return p},resetOverlays:function(){h.remove(l("rooms"));h.remove(l("guests"))},show:function(n){if(this.visible){this.hide(n)}else{if(this.parent){this.parent(n);this.position();h.trackEventOnPage(this.options.tracking,"Open")}}return this},position:function(){var q=h.id(this.source);var n=q.getParent("#hotels_lf_header_bar_wrap");if(q&&(q.getParent("#PERSISTENT_DATE_PICKER")||(n&&n.hasClass("fixed")))){var p=q.getCoordinates().left-i.getScrollLeft()-3;var o=q.getCoordinates().top-i.getScrollTop()+33;if(n){var p=q.getCoordinates().left-(i.isTabletOnFullSite?0:i.getScrollLeft());var o=q.getCoordinates().bottom-(i.isTabletOnFullSite?0:i.getScrollTop())}h.id(this.container).setStyles({position:"fixed",left:p+"px",top:o+"px","z-index":9991})}else{if(n){h.id(this.container).setStyle("position","absolute")}this.parent()}},hide:function(n){this.resetOverlays();this.parent(n)}});h.overlays.NumberPickerOverlay.roomsPicker=function(n,o){return c(n,o,"rooms")};h.overlays.NumberPickerOverlay.guestsPicker=function(n,o){return c(n,o,"guests")};h.overlays.NumberPickerOverlay.updateHeaderMsg=function(n){var s=g(),u=$$(n+" .roomsChange"),p=m(s.rooms,h.retrieve("rgPicker.nRooms")),t=$$(n+" .guestsChange"),r=m(s.guests,h.retrieve("rgPicker.nGuests")),o=u.getElement("img"),q=(o&&o[0]&&o[0].outerHTML)||"";u.set("html",p+" "+q);t.set("html",r+" "+q)};h.overlays.NumberPickerOverlay.unhideDropdowns=function(n){var o=$$(n);if(o&&h.widgets.calendar.hasPageDates()){o.removeClass("hidden")}}})(document,window,ta);require(["ta/rollupAmdShim"],function(a){a.install(["pages/inappropriate_vote_stub","ta/util/xpath","answers/question_overlay_stub"],["ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-overlays",files:{js3:{src:{pages:{inappropriate_vote_stub:1},answers:{question_overlay_stub:1},ta:{util:{xpath:1}}}}},_:{baseUrl:"/"}})};define("ta/util/xpath",["vanillajs"],function(b){var a={};a.nodePath=function(d){if(!d){return""}var c=[d];while(typeof d!="undefined"&&d&&typeof d.parentNode!="undefined"){c.push(d=d.parentNode)}c=c.map(function(f){if(f&&f.tagName){var e=f.tagName;if(f.id){e+="#"+f.id}if(f.className){e+="."+f.className}return e}return""});return c.reverse().join(">").replace(/\s+/g,".")};return a});define("answers/question_overlay_stub",["vanillajs","api-mod","ta/util/Error","ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax"],function(k,j,e,g,b,l,d,m,a,f,c){var h={};var i={};h.open=function(p,n){if(!n){e.record(new TypeError("pid required for questionForm overlay"),"Question and Answers - questionForm",null,null,"WARN")}var o=new b(null,[l(null,"center","answersOverlay"),d.center([0,0]),m,a,f(),c("/AnswersAjax",{reqParams:{act:"saqo",lcid:p,altsessid:g.retrieve("altsessid")||""}})]);o.on("show",g.store.bind(g,"answers.pid.overlayType",n));o.on("hide",function(){g.remove("answers.pid.overlayType");o.destroy();o=null});o.show()};h.confirmDlg=function(p){var t=p.data.type;var s=i[t];if(s){s.options=p;s.overlay.show()}else{var o=new b(null,[l(null,"center","confirmationPrompt small"),d.center([0,0]),a,f(),c("/AnswersAjax",{reqParams:p.data})]);i[t]={overlay:o,options:p,attached:false};var n=function(){var v=i[t];v.options.onConfirm&&v.options.onConfirm();v.overlay.hide();return true};var u=function(){var v=i[t];v.options.onCancel&&v.options.onCancel();v.overlay.hide();return false};var r=false;var q=(function(){if(!r){var w=j.find(".cancelBtn",this.inner),v=j.find(".confirmBtn",this.inner);if(w){j.addEvent(w,"click",u);j.addEvent(v,"click",n);r=true}}}).bind(o);o.on("contentLoaded",q).on("show",q).on("hide",function(){j.removeEvent(j.find(".cancelBtn",this.inner),"click",u);j.removeEvent(j.find(".confirmBtn",this.inner),"click",n);r=false});o.show()}};return h});require(["ta/rollupAmdShim"],function(a){a.install(["ta/registration/RegOverlay"],["ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-registration-RegOverlay",files:{js3:{src:{ta:{registration:{RegOverlay:1}}}}},_:{baseUrl:"/"}})};(function(a,e,d,f){var c=(function(j){var i=function(){return typeof(dd)!=="undefined"&&dd.commerce&&dd.commerce.checkrates},h=function(r,o,s){var p="sprite-",n=p+o,q=p+s;if(r.hasClass(n)){r.removeClass(n);r.addClass(q)}},k=function(){var n=j.retrieve("meta.chevronTracking"),p=j.retrieve("meta.chevronAction"),o=j.retrieve("meta.chevronLabel");if(n&&p){if(!o){j.trackEventOnPage(n,p)}else{j.trackEventOnPage(n,p,o)}}j.remove("meta.chevronTracking");j.remove("meta.chevronAction");j.remove("meta.chevronLabel")},g=function(r,n){var o,q,p,s;if(n!==null&&r!==null){j.commerce.meta.suppressCRArea(r);o=r.getElement(".metaDatesNotChosen");q=r.getElement(".metaDatesChosen");if(q){if(o){o.addClass("miniMetaHideHdr");o.removeClass("miniMetaShowHdr")}q.addClass("miniMetaShowHdr");q.removeClass("miniMetaHideHdr")}r.getElements(".minimalist_datepicker_wrap.hidden").each(function(t){t.removeClass("hidden")});p=r.getElement(".postShowMetaCR");if(p!=null){p.destroy()}p=r.getElement(".postShowMetaCRLB");if(p!=null){p.destroy()}p=r.getElement(".postShowMetaCRLBPCR");if(p!=null){p.destroy()}s=r.getElement("fieldset");j.commerce.meta.adoptMiniMetaElem(s,n);j.fireEvent("refreshedDOMContent",r)}},m=function(n){if(!n){return}if(n.getElement(".hacMiniComplete")&&!n.getElement(".anyOfferCompletedSuccessfully")){n.getElements(".photos_lb_update_avail").each(function(o){o.addClass("hidden")});n.getElements(".photos_lb_update_no_avail").each(function(o){o.removeClass("hidden")})}else{n.getElements(".photos_lb_update_avail").each(function(o){o.removeClass("hidden")});n.getElements(".photos_lb_update_no_avail").each(function(o){o.addClass("hidden")})}},l=function(n){n.getElements(".textLinks").each(function(o){o.addClass("hidden")});n.getElements(".maybeCheck").each(function(o){o.addClass("hidden")});n.getElements(".disclaimer").each(function(o){o.addClass("hidden")});n.getElements(".photos_lb_update_links").each(function(o){o.removeClass("hidden")});n.getElements(".taxesAndFees").each(function(o){o.addClass("hidden")});m(n)};return{updateInlineMeta:function(p,o){if(!j.widgets.calendar.hasPageDates()){j.commerce.meta.popInlineDatePicker(o,p);return}var n=j.id("CHECK_RATE");if(!n){return}},popInlineDatePicker:function(p,q){if(!q){return}var n;var o="_inm";if(p&&p.target&&p.target.getParent("#CHECK_RATES_CONT")){n=j.id("date_picker_"+q)}n=n||j.id("date_picker_"+q+o);if(n){var r=n.getParent(".date_picker_calendar_wrap");if(r&&r.onclick){r.onclick(p,r,q,o);r.fireEvent("click",p,r,q,o);(function(){try{j.retrieve("avail.data."+q+o).calendar.calendarOverlay.position()}catch(s){}}).delay(200)}}},clickMetaShowPrices:function(o){var n;o=new Event(o);if(j.page&&j.page.usingUnifiedDates){j.page.gatherDatesNear(o.target);o.stop();return}if(!j.widgets.calendar.hasPageDates()){j.widgets.calendar.setErrorStyling(o.target);return}n=a.getElement(".cr_lb_overlay");if(n&&n.overlay){n.overlay.hide()}},showLowestPriceCTA:function(t){var o=(t)?"metaLowestPriceCTAInline":"metaLowestPriceCTA";if(j.has(o)){var s=true;if(t){var w=a.getElement(".meta_rates_content");s=w&&w.style.display=="block"}if(s){var p=j.retrieve(o);if(p.hasOwnProperty("idx")){var u=(t)?"Meta_LP_CTA_Display_Inline":"Meta_LP_CTA_Display";var r=(p.idx===0)?"Not_Displayed":"Displayed";var v=p.idx+"";j.trackEventOnPage(u,r,v)}var q=(t)?"LP_CTA_INLINE":"LP_CTA";var n=j.id(q);if(n){(function(){n.fade("in")}).delay(1000)}}}},chevronHover:function(r,p,o,q){if(p&&o&&q){var n=j.id(p).getElement("."+q);if(n){n.removeClass(q);n.addClass(o)}}},chevronBlur:function(r,p,o,q){if(p&&o&&q){var n=j.id(p).getElement("."+o);if(n){n.removeClass(o);n.addClass(q)}}},hoverTopOffer:function(){var n=a.getElement(".rgba_gray_arrow_up");if(n){n.removeClass("rgba_gray_arrow_up");n.addClass("rgba_yellow_arrow_up")}},blurTopOffer:function(){var n=a.getElement(".rgba_yellow_arrow_up");if(n){n.removeClass("rgba_yellow_arrow_up");n.addClass("rgba_gray_arrow_up")}},hoverBookBtn:function(n){var o=j.id(n);h(o,"bookBtnOrangeIdle","bookBtnOrangeOver");h(o,"bookBtnGreyIdle","bookBtnGreyOver");h(o,"bookIdle","bookOver");h(o,"goIdle","goOver");h(o,"selectIdle","selectOver");h(o,"bookSmallIdle","bookSmallOver");h(o,"goSmallIdle","goSmallOver");h(o,"selectSmallIdle","selectSmallOver");h(o,"goBtnGrey","goBtnGreyOver");h(o,"goBtnOrange","goBtnOrangeOver");h(o,"chevronOrangeIdle35","chevronOrangeOver35");h(o,"chevronGreyIdle27","chevronGreyOver27");h(o,"chevronIdle_ylw","chevronHover_ylw")},blurBookBtn:function(n){var o=j.id(n);h(o,"bookBtnOrangeOver","bookBtnOrangeIdle");h(o,"bookBtnGreyOver","bookBtnGreyIdle");h(o,"bookOver","bookIdle");h(o,"goOver","goIdle");h(o,"selectOver","selectIdle");h(o,"bookSmallOver","bookSmallIdle");h(o,"goSmallOver","goSmallIdle");h(o,"selectSmallOver","selectSmallIdle");h(o,"goBtnGreyOver","goBtnGrey");h(o,"goBtnOrangeOver","goBtnOrange");h(o,"chevronOrangeOver35","chevronOrangeIdle35");h(o,"chevronGreyOver27","chevronGreyIdle27");h(o,"chevronHover_ylw","chevronIdle_ylw")},hoverSmallBookBtn:function(o){var n=j.id(o).getElement(".bookBtn");if(n==null){return}h(n,"bookBtnOrangeIdleSmall","bookBtnOrangeIdleSmallOver");h(n,"bookSmallIdle","bookSmallOver");h(n,"goSmallIdle","goSmallOver");h(n,"selectSmallIdle","selectSmallOver")},blurSmallBookBtn:function(o){var n=j.id(o).getElement(".bookBtn");if(n==null){return}h(n,"bookBtnOrangeIdleSmallOver","bookBtnOrangeIdleSmall");h(n,"bookSmallOver","bookSmallIdle");h(n,"goSmallOver","goSmallIdle");h(n,"selectSmallOver","selectSmallIdle")},providerHoverOn:function(o,u,t){var s=j.id(o);s.addClass("partnerHvr");var n=s.getElement(".price_overlay");if(n){var r=s.getElement(".perNight");var q=r.getCoordinates().width+29;n.addClass("show");if(j.util.i18n.isRtl()){n.setStyles({position:"absolute",left:q,zindex:"101"})}else{n.setStyles({position:"absolute",right:q,zindex:"101"})}}var p=o.getElement(".bookBtn");if(p){j.commerce.meta.hoverBookBtn(p)}j.store("meta.hoverProvider",u);j.store("meta.hoverProviderPosn",t)},providerHoverOff:function(o){var q=j.id(o);q.removeClass("partnerHvr");var n=q.getElement(".price_overlay");if(n){n.removeClass("show")}var p=o.getElement(".bookBtn");if(p){j.commerce.meta.blurBookBtn(p)}j.remove("meta.hoverProvider")},restoreProviderHover:function(){var n=j.retrieve("meta.hoverProvider");var r=j.retrieve("meta.hoverProviderPosn");if(n&&r){var q=j.id("PROVIDER_BLOCK");if(q){var p=q.getElements(".metaProvider");var o=q.getElement(".provider_"+n);if(p&&o&&o.hasClass("order_"+r)){p.each(function(s){j.commerce.meta.providerHoverOff(s)});j.commerce.meta.providerHoverOn(o,n,r)}}}},updateNavArea:function(n){var o=j.retrieve("ta.meta.navArea");if(!o||o.indexOf(n)<0){j.store("ta.meta.navArea",n)}},loadBestPriceXsell:function(D,G,r,q){try{if(j.retrieve("checkrates.one_second_xsell")!==true){return}var F=r&&r.isInline;var z="";var s="";var L=r&&r.isMetaLighboxV3;if(j.isHRTabs2014()&&F){return}if(L){z="meta_lightbox_v3"}var E=1000;var n="loadBestPriceXsell_numTries";var t="loadBestPriceXsell_curCancelKey";if(F){n="loadBestPriceXsellInline_numTries";t="loadBestPriceXsellInline_curCancelKey"}var K="meta.xsellTravelData";if(F){K="meta.xsellTravelDataInline"}var v=j.retrieve(K);if(q==null){q=new Date().getTime();j.store(n,0);v=j.widgets.calendar.getCheckRatesData();j.store(K,v);var w=j.id(G);if(w){w.innerHTML="";w.setStyle("height",0);w.setStyle("opacity","0");var B=j.retrieve("metaCheckRatesOverlay");B=j.id(B);if(!F&&B&&B.container&&B.container.getPosition){e.scrollTo(0,B.container.getPosition().y)}}if(F){j.commerce.meta.metaInYourMeta_resetInline()}else{j.commerce.meta.metaInYourMeta_resetLB()}}var u="loadBestPriceXsell_"+q+"_cancel";if(F){u="loadBestPriceXsellInline_"+q+"_cancel"}if(j.retrieve(u)){return}if(j.has(t)){var J=j.retrieve(t);if(J!=u){j.store(J,true)}}if(!j.has(u)){j.store(u,false);j.store(t,u)}var x=j.retrieve(n);var N=x+1;j.store(n,N);if(!v){return}var M="";if(typeof(pageServlet)!==f&&pageServlet){M=pageServlet}var C={};if(j.meta&&j.meta.update){C=j.commerce.meta.getMetaParams()}var y=Object.merge(v,{detail:D,"try":j.retrieve(n),reqNum:r.secondTry?"2":"1",type:z,isInlineRequest:F?"1":"0",openedVendors:s,origServlet:M},C);var p=Object.toQueryString(y);if(!p||!p.trim()){j.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell  - toQueryString failure",null,y);return}var o=j.retrieve("ta.meta.navArea");var A;try{A=j.commerce.meta.tracking.setTimingForNavArea(o)}catch(I){j.util.error.record(I,"problem locking timing in ta.commerce.meta.loadBestPriceXsell")}if(A){y.metaRequestTiming=A}if(j.commerce.meta.tracking.hasAnySuppressedAreas()){var H=j.commerce.meta.tracking.getSuppressedAreasAsString();if(H){y.suppressImpressionsOnComplete=H}}new Request({url:"/MetaBestPriceCrossSellAjax?"+p,evalScripts:true,onSuccess:function(P){if(j.retrieve(u)){return}var O=P.contains("xsellHacStatusReady")||P.contains("xsellHacStatusSOL")||r.secondTry;if(!O){setTimeout(function(){var R={secondTry:true,xsell:true,isInline:F,isHrRedesignTest:false,openedVendors:s};j.commerce.meta.loadBestPriceXsell(D,G,R,q)},E)}else{var Q=j.id(G);if(Q){Q.setStyle("height",0);Q.setStyle("opacity","0");Q.setContent(P);j.commerce.meta.metaInYourMeta(G,{xsell:true,inline:F})}j.store(n,0)}},onFailure:function(){j.store(n,0);j.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(I){j.util.error.record(I,"ta.commerce.meta.loadBestPriceXsell")}},loadGeoCrAutoBroadenContents:function(s,u){var A=5;var q=1000;var p="QC_Meta_Mini|GeoCheckRatesLightBox";try{var n=function(){v=false};var y=function(){s.fireEvent("close",s);s.hide()};var v=true;var x=j.id(s.inner);if(!x){throw new Error("Cannot find parent: "+s)}var r=function(E){var D=0;E.each(function(G){var F=G.getHeight();if(F>D){D=F}});E.each(function(F){F.setStyle("height",D)})};var B=j.commerce.meta.tracking.setTimingForNavArea(p);s.addEvent("close",n);var z={d:u,area:p,metaRequestTiming:B};var C=j.widgets.calendar.getCheckRatesData();if(!C){throw new Error("Cannot find dates and/or adults")}Object.merge(z,C);if(j.meta&&j.meta.update){Object.merge(z,j.commerce.meta.getMetaParams())}var t=0;var o=function(){if(!v){return}++t;z.attempt=t;new Request({url:"/GeoCrAutoBroadenAjax",data:z,method:"get",evalScripts:true,onSuccess:function(D){try{if(!v){return}var F=Elements.from(D,true);var G=F.getElement(".progress").filter(function(J){return J})[0];if(!G){j.util.error.record(null,"geo check rate malform response missing progress",null,z);y()}else{if(/\bfallbackUrl-(\S+)\b/.exec(G.className)){var I=RegExp.$1;var E=j.util.URL.getServletNameFromUrl(I);if(!E){j.util.error.record(null,"geo check rate cannot get servlet name from "+I,null,z);E="UNKNOWN"}j.setEvtCookie("MetaGeoLightBox","unload","Redirect",0,"/"+E);a.location.href=I}else{x.setStyles({overflow:"hidden",height:"auto"});x.innerHTML="";x.adopt(F);r(x.getElements("#GEO_CR_AUTO_BROADEN .recs .rec .info .distance"));r(x.getElements("#GEO_CR_AUTO_BROADEN .recs .rec .info .amenity"));if(!G.hasClass("isHacComplete")&&t<A){setTimeout(o,q)}else{x.getElements(".showUntilLast").dispose();x.getElements(".hideUntilLast").removeClass("hidden")}}}}catch(H){j.util.error.record(H,"cannot process geo check rate response",null,z);y()}},onFailure:function(D){j.util.error.record(null,"geo check rate request failed: status="+(D&&D.status),null,z);y()}}).send()};o()}catch(w){j.util.error.record(w,"cannot send geo check rate initial request");if(y){y()}}},xSellResponses:{lb_hac:false,lb_xsell:false,inline_hac:false,inline_xsell:false},metaInYourMeta_resetLB:function(){j.commerce.meta.xSellResponses.lb_hac=false;j.commerce.meta.xSellResponses.lb_xsell=false},metaInYourMeta_resetInline:function(){j.commerce.meta.xSellResponses.inline_hac=false;j.commerce.meta.xSellResponses.inline_xsell=false},hacIsBlockingXSell:function(n){var o=j.commerce.meta.xSellResponses;if(n){return o.inline_xsell}else{return o.lb_xsell}},metaInYourMeta:function(q,y){var p=y&&y.inline;var o=y&&y.xsell;var t=j.commerce.meta.xSellResponses;if(p){if(o){t.inline_xsell=true}else{t.inline_hac=true}}else{if(o){t.lb_xsell=true}else{t.lb_hac=true}}if((p&&t.inline_xsell)||(!p&&t.lb_xsell&&t.lb_hac)){var w=j.id("META_PRICE_XSELL");var v=j.id("STATE_OPT_RESPONSE");if(p){w=j.id("META_PRICE_XSELL_INLINE");v=j.id("STATE_OPT_RESPONSE_INLINE")}if(w&&w.hasClass&&!w.hasClass("hidden")){return}if(v&&v.hasClass&&!v.hasClass("hidden")){return}var x=w;var s=0;if(j.meta&&j.meta.update){s=j.meta.update.getMetaPricesCount(p)}else{if(i()){s=dd.commerce.checkrates.getMetaPricesCount(p)}}if(s==null){s=0}if(s<1&&v){x=v}var u=j.id(q);if(u){if(x){j.commerce.meta.revealBestPriceXsell(u,x,p,false)}else{var n="lA";if(p){n=n+"_Inline"}var r=j.id(n);if(r&&r.removeClass){r.removeClass("hidden")}}}}},revealBestPriceXsell:function(t,y,o,B){if(t){t=j.id(t)}if(y){y=j.id(y)}if(!t||!y){j.util.error.record(null,"revealBestPriceXsell - required elements missing");return}if(y.removeClass){y.removeClass("hidden")}var s=new Fx.Tween(t,{property:"opacity"});if(B){var q=j.retrieve("metaLeaveBehindOverlay");if(q&&q.container){var n=q.container;if(n.hasClass&&n.hasClass("hidden")&&n.removeClass){n.removeClass("hidden")}if(j.meta&&j.meta.cr){j.meta.cr.removePCR()}else{if(i()){dd.commerce.checkrates.removePCR()}}}}else{var u="META_MINI_META_MAYBE";if(o){u="META_MINI_META_MAYBE_INLINE"}var A=j.id(u);var x=true;if(A){x=false}var w="Displayed_Lightbox";if(o){w="Displayed_Inline"}var v=y.getElements(".hotelListing").length;if(v===0){v="0";w="Not_"+w}j.trackEventOnPage("Meta_State-Optimized_XSell",w,v)}var r=y.getSize().y;var z=new Fx.Tween(t,{property:"height",onComplete:function(){if(!B){s.start(0,1)}}});z.start(r);var p=j.retrieve("metaCheckRatesOverlay");if(p&&p.container&&p.closeBtn&&j.id(e).getScroll().y>p.container.getPosition().y){j.util.element.scrollIntoView(p.closeBtn)}},hideBestPriceXsell:function(r){var q=j.id(r);var o=j.id("META_PRICE_XSELL");if(!q||!o){return}var n=new Fx.Tween(q,{property:"height"});var p=new Fx.Tween(q,{property:"opacity",onComplete:function(){n.start(0);if(o.addClass){o.addClass("hidden")}}});p.start(1,0)},loadMetaAF:function(r,s,t){try{if(j.retrieve("checkrates.meta_af")!==true||j.retrieve("ta.redirectingPage")||j.retrieve("hist_price_cross_sell_hr.enabled")){return}var p="meta_af_last_request";var o=new Date().getTime();j.store(p,o);var q=1000;var x=false;var v=false;if(j.page&&j.page.usingUnifiedDates&&!j.page.hasDates("STAYDATES")){return}if((j.meta&&j.meta.update)||(e.pageServlet==="Hotel_Review")){x=j.widgets.calendar.getCheckRatesData();if(!x){return}var w={};if(j.meta&&j.meta.update){w=j.commerce.meta.getMetaParams()}v=Object.merge(x,{detail:r,reqNum:t?"2":"1",type:"af"},w,require("amdloaders").getLoadedFilesParams())}else{if(i()){return dd.commerce.checkrates.loadMetaAF(r,s,t)}else{return}}var n=Object.toQueryString(v);if(!n||!n.trim()){j.util.error.record(null,"ta.commerce.meta.loadMetaAF - toQueryString failure",null,v);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:v,evalScripts:true,onSuccess:function(D){if(j.retrieve(p)!=o){return}var E=D.contains("xsellHacStatusReady")||D.contains("xsellHacStatusSOL")||t;if(!E){setTimeout(function(){j.commerce.meta.loadMetaAF(r,s,true)},q)}else{var B=j.id(s);var y=a.getElement(".clearDates");if(B){B.show();B.setStyle("height",0);B.setStyle("opacity","0");B.setContent(D);j.prwidgets.initWidgets(B);var C=a.getElement(".tablet_desktop .mapsv2-more .clearDates");if(y&&y!=C){y.style.display="none"}var F=B.getElement(".mainList");if(F){var z=new Fx.Tween(B,{property:"opacity",onComplete:function(){j.fireEvent("refreshedDOMContent",F)}});var A=F.getSize().y;var G=new Fx.Tween(B,{property:"height",onComplete:function(){B.setStyle("height","auto");z.start(0,1)}});G.start(0,A);j.fireEvent("avaf.loaded")}}}},onFailure:function(){if(j.retrieve("ta.redirectingPage")){return}j.util.error.record(null,"ta.commerce.meta.loadMetaAF - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(u){j.util.error.record(u,"ta.commerce.meta.loadMetaAF")}},updateProvAreaFromLightBox:function(r){var o=j.retrieve("meta.baseLocationId");if(o&&r==o){var q=j.retrieve("meta.postShowMetaCR");var p=j.retrieve("meta.postShowMetaCRLB");var n=j.retrieve("meta.postShowMetaCRLBPCR");if(q&&p&&n){j.commerce.meta.updateProvArea(q,p,n);return}}if(j.widgets.calendar.datesExist()){if(j.meta&&j.meta.update){j.meta.update.request(o)}else{if(i()){dd.commerce.checkrates.checkRatesMiniMeta(null,a.getElementById("CHECK_RATE"),o,"checkrates")}}}},updateProvArea:function(x){var r=a.getElement("#CHECK_RATES_CONT.chkRates");var z=a.getElement(".ShowUserReviews #CHECK_RATES_CONT.chkRates");var q=a.getElement("#LOC_PHOTO_ALBUMS.photos_lb_update .metaCrosssell .chkRates");var v=a.getElement("#LOC_PHOTO_ALBUMS.photos_lb_update .sidebar .chkRates");var s=a.getElement("#AMENITY_LIGHTBOX.photos_lb_update .chkRates");var B=a.getElement(".similarCarousel");var A=a.getElement(".premiumTimeout");if(B&&A){var n=r.getElement("div.bc_text_content");if(n){var o=x.getChildren()[1];if(o){var w=o.clone(false);w.innerHTML=o.innerHTML;n.innerHTML="";n.adopt(w)}}}else{g(z,x)}if(q){g(q,x);l(q);var y=a.getElement(".featuredImageWrap.metaCrosssell");if(y){var t=y.getElement(".premium_offers_area");if(t){var p=t.getElements(".offer.wrap.premium");var u=y.getElement(".chkRates");if(p&&u){u.toggleClass("noOffers",p.length===0)}}}}if(v){g(v,x);l(v)}if(s){g(s,x);m(s)}if(j.has("meta.isHackathonBC")){j.commerce.meta.alignPriceBlocks();if(j.has("meta.bc.isRevisedUnavailability")){j.commerce.meta.truncateProviderNames()}}e.fireEvent("postAjaxMetaUpdate");if(x&&x.getElement(".hacMiniComplete")){k(x)}},updatePCRAreaWithMiniMeta:function(p,n){if(n==null||p==null){return}var s=p.inner;if(!s){return}j.commerce.meta.suppressCRArea(s);var q=s.getElement(".postShowMetaCRLBPCR");if(q!=null){q.destroy()}var r=s.getElement("fieldset.miniMetaContainer");var o=n.getElement(".disclaimer");if(o!=null){o.destroy()}j.commerce.meta.adoptMiniMetaElem(r,n);if(!j.widgets.calendar.datesInRange()){j.commerce.meta.showCRArea(s)}},adoptMiniMetaElem:function(p,n){if(p!=null){var q=p.getElement(".disclaimer");if(q!=null&&!q.getParentBySelector("#hover_table_display_area")){q.destroy()}var o=n.clone(false);o.innerHTML=n.innerHTML;p.adopt(o)}},miniMetaAjax:function(n,o){if(i()){dd.commerce.checkrates.miniMetaAjax(n,o)}},suppressCRArea:function(n){var o=n.getElements(".miniMetaShow");Array.each(o,function(p){p.removeClass("miniMetaShow");p.addClass("miniMetaHide")})},showCRArea:function(n){var p=n.getElement(".postShowMetaCR");if(p!=null){p.destroy()}var o=n.getElements(".miniMetaHide");Array.each(o,function(q){q.removeClass("miniMetaHide");q.addClass("miniMetaShow")})},showCurrencyPicker:function(){},selectCurrency:function(){},clearStoredMiniData:function(){if(j.retrieve("checkrates.meta_ui_post_click_prices")){j.store("meta.postShowMetaCRLBPCR",null);j.store("meta.postShowMetaCR",null);j.store("meta.postShowMetaCRLB",null)}},storeMiniData:function(o){if(j.retrieve("checkrates.meta_ui_post_click_prices")){var q=o.getElement(".postShowMetaCR");var n=o.getElement(".postShowMetaCRLBPCR");var p=o.getElement(".postShowMetaCRLB");if(q&&p&&n){j.store("meta.postShowMetaCRLBPCR",n);j.store("meta.postShowMetaCR",q);j.store("meta.postShowMetaCRLB",p)}}},providerButtonClicked:function(o){if(o&&!j.has("hotels.hasTimeoutDates")){var n="CheckIn|provider_logo";j.trackEventOnPage("DATEPICKER","OPEN",n,o);j.store("meta.datepicker_tracked",true)}},moreSitesLinkClicked:function(n){if(n&&!j.has("hotels.hasTimeoutDates")){j.trackEventOnPage("DATEPICKER","OPEN","more_sites_link",n);j.store("meta.datepicker_tracked",true)}},buildMetaHacParamObj:function(){var o={};try{var n=a.getElement("#HAC_FORM input[name=geo]");if(n&&n.value){o.geo=n.value}if(!o.geo){var t=a.getElement("#SEARCH_LHN input[name=geo]");if(t){o.geo=t.value}}var u=a.getElementById("searchAll");if(u&&u.value!="true"){var r=j.widgets.calendar.getPageInDate();if(r){o.inDay=r.getDate();o.inMonth=(r.getMonth()+1)+"/"+r.getFullYear()}var q=j.widgets.calendar.getPageOutDate();if(q){o.outDay=q.getDate();o.outMonth=(q.getMonth()+1)+"/"+q.getFullYear()}var p=j.widgets.calendar.getPageAdultsCount();if(p!=2){o.adults=p}o.searchAll="false"}}catch(s){j.util.error.record(s,"buildHACUrlParams")}return Object.toQueryString(o)},getHACCategory:function(){var o=a.getElements(".tab.selected");var p="1";if(o&&o.length&&o.length>0){var n=o[0].className.match(/cat_(\d+)/);if(n){p=n[1]}}return p},buildHACSearchData:function(){var r=j.widgets.calendar.getPageInDate();var v=j.widgets.calendar.getPageOutDate();var w=j.widgets.calendar.getPageAdultsCount();var x=a.getElementById("geo");var o;if(x==null){o=a.getElementsByName("geo");if(o&&o.length>0){x=o[0]}}var u;if(x&&x.value){u=x.value}else{if(e.modelGeoId){u=e.modelGeoId}}var q=false;var y=j.commerce.meta._padZero;var t=r?y(r.getDate()):null;var p=v?y(v.getDate()):null;var s=r?y(r.getMonth()+1)+"/"+r.getFullYear():null;var z=v?y(v.getMonth()+1)+"/"+v.getFullYear():null;var n={};n.adults=w;n.geo=u;n.searchAll=q;n.inDateOfMonth=t;n.outDateOfMonth=p;n.inMonthYear=s;n.outMonthYear=z;n.category=j.commerce.meta.getHACCategory();return n},buildMetaHACUrl:function(){var n=j.commerce.meta.buildHACSearchData();var o="/HACSearch?adults="+n.adults+"&geo="+n.geo+"&searchAll="+n.searchAll;if(n.category){o=o+"&cat="+n.category}if(n.inDateOfMonth){o=o+"&inDay="+n.inDateOfMonth}if(n.outDateOfMonth){o=o+"&outDay="+n.outDateOfMonth}if(n.inMonthYear){o=o+"&inMonth="+n.inMonthYear}if(n.outMonthYear){o=o+"&outMonth="+n.outMonthYear}var p=o+e.location.hash;return p},redirectHACSearch:function(){j.setEvtCookie("Mini_meta_LP_chevron_display","Clicked","Unavailable","","/HACSearch");e.location=j.commerce.meta.buildMetaHACUrl()},_padZero:function(n){return String("0"+n).slice(-2)},anchorToOpenTab:function(){var o=j.id("ReviewsTab");var n=j.id("MetaPricesTab");if(o&&o.hasClass("selected")){j.commerce.meta.scrollToReviews()}else{if(n&&n.hasClass("selected")){o.click();j.commerce.meta.scrollToReviews()}}},scrollToReviews:function(){var n=j.id("REVIEWS");if(n!=null){j.util.element.scrollIntoView(n)}else{j.util.error.record(null,"couldn't find reviews element on page!")}},scrollToId:function(n){if(n&&j.id(n)){j.util.element.scrollIntoView(j.id(n))}},initNoAvailCarousel:function(){try{var n=j.id("ALSO_VIEWED_LIST"),u;if(!n){return}var r=n.getElement("ul");if(!r){return}var x=r.getElements("li").length;var v=new Fx.Tween(r,{property:"left"});var o=353;var s=1;var w=n.getElement(".prev");var p=n.getElement(".next");if(!p||!w){return}var t=function(y){var B,z,A,C;if((s===1&&y<0)||(s===x&&y>0)){return}if(y<0){j.trackEventOnPage("Pager_Arrows","Scroll_Left","Mini_Carousel_Xsell")}else{if(y>0){j.trackEventOnPage("Pager_Arrows","Scroll_Right","Mini_Carousel_Xsell")}}s+=y;B=parseInt(r.getStyle("left"),10);z=o*y*-1;A=B+z;v.start(A);C=n.getElement(".paginator");if(C){if(s===1&&y<0){u="front"}else{if(s===x&&y>0){u="end"}else{u="middle"}}C.className="paginator "+u}};w.addEvent("click",function(){t(-1)});p.addEvent("click",function(){t(1)})}catch(q){j.util.error.record(q,"ta.commerce.meta.initNoAvailCarousel")}},showRemainingProviders:function(o,n){n=j.id(n);if(n){n.destroy()}j.store("checkrates.hr_bc_see_all_click",true);if(j.retrieve("ibdm_impression_tracking")){j.trk("n_more_sites",false,a.getElement(".premium_offers_area"))}a.getElements(".remaining").removeClass("remaining");j.fireEvent("remainingMetaProvidersShown")},showRemainingProviders_Flyout:function(o,n){n=j.id(n);var r=j.find(".show_remaining_providers_flyout",n)||j.find(".show_remaining_providers_flyout");var q=n.getParent(".chkRates")||a;var s=j.select(".remaining",q);try{if(r&&s.length){a.body.addEvent("click",function(t){if(n&&!t.target||!t.target.getParents().contains(n)||r.isDisplayed()){r.hide();a.body.removeEvents("click");j.select(".remaining",r).destroy()}else{s.forEach(function(u){r.adopt(u.clone())});r.show()}})}}catch(p){j.util.error.record(p,"showRemainingProviders_Flyout")}},alignPriceBlocks:function(){j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceBlock .price",true);j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceBlock .featuredText",true);j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceOutsideChevron .price",true);j.util.element.makeTextFitOneLine(".chevron_redesign .offer.premium .priceOutsideChevron .featuredText",true);j.util.element.makeTextFitOneLine(".offer.premium .priceBlock.flag_bump .price",true);j.util.element.fitToContentsHorizontally(".offer.premium .lowest_price_folded .text",0,65);j.select(".chevron_redesign .offer.premium.unsized .loading").setStyle("display","none");j.select(".chevron_redesign .offer.premium.unsized").removeClass("unsized");j.util.element.makeSameWidth("#HR_HACKATHON_CONTENT > #HotelDateSearch .postShowMetaCR .priceBlock")},toggleBlueChevronLowestPriceCTA:function(o){if(j.retrieve("meta_guests_field_v2.CTAActivated")&&!a.getElements(".overlay").length){if(j.has("meta_guests_field_v2.CTATimer")){clearTimeout(j.remove("meta_guests_field_v2.CTATimer"))}var n=j.id("BC_LP_CTA");if(n&&n.fade){if(o){n.fade("in")}else{n.fade("out")}}}},displayBlueChevronLowestPriceCTA:function(){var p="bcMetaLowestPriceCTA",x,v,z,o,w,u,n,y,s;if(j.has(p)&&!j.has("hr_chevron_redesign")){x=j.retrieve(p);if(x.hasOwnProperty("idx")){v=(x.idx===0)?"Not_Displayed":"Displayed";z=x.idx+"";j.trackEventOnPage("BlueChevron_LP_CTA_Display",v,z)}o=j.id("BC_LP_CTA");if(o&&o.fade){(function(){o.fade("in");if(j.retrieve("meta_guests_field_v2.enabled")){j.store("meta_guests_field_v2.CTATimer",(function(){o.fade("out")}).delay(5000));j.store("meta_guests_field_v2.CTAActivated",true)}}).delay(700)}w=j.id("bc_lp_cta_text");if(w){u=w.getSize().y;if(u==12){while(w.getSize().y<=u){w.style.width=""+(w.getSize().x-1)+"px"}w.style.width=""+(w.getSize().x+1)+"px"}if(x.displayTop){n=o.parentNode.getElement(".priceBlock");o.style.position="relative";o.style.left=(345-w.getSize().x)+"px";o.style.top=""+(-n.getSize().y-22)+"px"}else{y=o.getElement(".bc_lp_cta_triangle");o.style.left="-"+(w.getSize().x+20)+"px";y.style.left=""+(w.getSize().x+10)+"px"}w.style.marginTop=""+Math.round((25-w.getSize().y)/2)+"px"}s=5800;if(j.retrieve("check_width_for_CTA_fade")){var B=a.getElement(".bc_lp_cta");var q=a.getElement(".priceBlock");if(B&&q){var r=B.getSize().x+q.getSize().x;var t=250;if((r>t)&&!x.displayTop){(function(){o.fade("out")}).delay(s)}}}else{var A=j.retrieve("fadeBcLpCTAout");if(A&&A==1&&!x.displayTop){(function(){o.fade("out")}).delay(s)}}}},truncateProviderNames:function(){var q=a.getElement(".textLink");if(!q){return}var o=q.getSize().x;var p=Math.max.apply(null,a.getElements(".textLink .price").map(function(r){return r.getParent(".moreLink")?0:r.getSize().x}));var n=o-p-28;if(j.retrieve("meta.paymentsTipText")){n=n-20}if(n>0){$$(".textLinks .providerName").each(function(r){if(r.getNext(".price")){r.setStyle("width",n)}})}},expandProvidersInline:function(p){p=j.id(p);if(!p){return}var o=p.getParent(".metaPriceInfo");if(!o){return}var q=o.getElements(".provider");if(!q){return}q.show();p.hide();if(j.retrieve("assisted_booking_desktop_entry")){var n=p.getParents();n.forEach(function(r){if(r.hasClass("metaPriceInfo")){if(j.meta&&j.meta.treeTrack&&j.meta.treeTrack.hasTrackingTree(r)){j.trk("n_more_sites",false,r)}}})}},flipHoverClass:function(o,n){if(o){o=j.id(o);var p=n+"Idle";var q=n+"Over";o&&o.toggleClass(p).toggleClass(q)}},trackHotelRatingsInfoClickInHR:function(n){n.target=n.target||n.srcElement;if(n.target&&n.target.href){j.setEvtCookie("Ratings_Info","all_hotels","",0,n.target.href)}},updateHeaderMsg:function(o,p){var n=a.getElement(o);if(p&&n){if(n.hasClass("unifiedPickers")){}else{n.innerHTML=p}}},updateHeaderDates:function(){try{if(j.widgets.calendar.hasPageDates()){var p=$$(".dateHeader.inDate");var o=$$(".dateHeader.outDate");var n=j.widgets.calendar.getDatePickerFormat("short");var s=j.widgets.calendar.getDatePickerFormat("classic");if(p){var r=j.widgets.calendar.dateToString(j.widgets.calendar.getPageInDate(),n);Array.each(p,function(u){var v=j.id(u);if(v.getParent("#meta_on_photo_viewer")){return}if(v){v.innerHTML=r}})}if(o){var q=j.widgets.calendar.dateToString(j.widgets.calendar.getPageOutDate(),s);Array.each(o,function(u){var v=j.id(u);if(v){v.innerHTML=q}})}}}catch(t){j.util.error.record(t,"ta.commerce.meta.updateHeaderDates")}},enableAdultsPicker:function(){var q=a.getElement(".adultsText");if(q){q.addClass("hide")}var o=a.getElement(".changeAdults");if(o){o.addClass("hide")}var p=a.getElement(".overlay .date_picker_adults_wrap");if(p){p.removeClass("hide")}var n=a.getElement(".overlay .showPriceButtonHide");if(n){n.removeClass("showPriceButtonHide")}j.store("meta_guests_field_v2.originalAdults",j.retrieve("date.picker.adultsCount"))},disableAdultsPicker:function(o){if(!(o&&o.container)){return}var r=o.container.getElement(".adultsText");if(r){r.removeClass("hide")}var p=o.container.getElement(".changeAdults");if(p){p.removeClass("hide")}var q=o.container.getElement(".date_picker_adults_wrap");if(q){q.addClass("hide")}var n=o.container.getElement(".showPriceButton");if(n){n.addClass("showPriceButtonHide")}},adultsGoButtonClick:function(n,q,t,p,v){var r=j.widgets.calendar.getPageInDate();var w=j.widgets.calendar.getPageOutDate();var o=r&&r.getDate&&w&&w.getDate;if(o){var x=j.widgets.calendar.getCalendarObjectKey(t,p,"out");var u=j.retrieve(x);if(u){var s=u.calendar;if(s){s.onCalendarOverlayHide();s.fireEvent("onRangeSelect",[s.crId,s.options.ext]);s.fireEvent("onSelect",[s,n])}}}else{j.overlays.Factory.simulateDatePickerClick(n,q,t,p,v)}},_hhRedirectIfNoOffers:function(){var n=a.getElements("#HotelDateSearch .offer");if(n&&!j.commerce.meta._overlayOnPage()){j.store("ta.redirectingPage",true);j.setEvtCookie("NoOffersHH","redirect","",0,"/HotelHighlight");var o=/-r\d+-/;e.location.href=e.location.href.replace("Hotel_Review-","Hotel_Review-s1-").replace("ShowUserReviews-","Hotel_Review-s1-").replace(o,"-")}},getResponseAvailability:function(n){if(!n){return false}return{anyAvailable:!!n.match(/\shacComplete\s.*\sanyOfferCompletedSuccessfully\s/g),allUnavailable:!!n.match(/\shacComplete\s.*\shacMiniOfferNotAvailable\s/g),maybeAvailable:!!n.match(/\shacComplete\s.*\shasDisplayUnavailability\s/g)}},_overlayOnPage:function(){return j.overlays&&j.overlays.getCurrent&&j.overlays.getCurrent()},hhRemoveDatePickerForErrorMessaging:function(p){if(!j.widgets.calendar.hasPageDates()){j.commerce.meta.clickMetaShowPrices(p);return}var o=j.id("GEO_CHECK_RATES_BALANCE");if(o){o.hide()}var n=a.getElement("#HLBASE .unavailHdr");if(n){n.removeClass("hidden")}},setupMiniMetaOnAccomPolling:function(n){if(!j.pages.hac.updateHACData||!j.hac.filters.updateResults){j.util.error.record(null,"setupMiniMetaOnAccomPolling bad linkage")}j.pages.hac.startHACUpdate();if(n){j.hac.filters.updateResults()}},checkRatesCreateGeoCrAutoBroadenLb:function(p,o,n){try{if(j.has("hr_to_hh_redirect_no_offers")&&e.pageServlet&&e.pageServlet!=="HotelHighlight"){if(j.widgets.calendar.hasPageDates()){j.widgets.calendar.justUpdateSessionDates(function(){j.commerce.meta._hhRedirectIfNoOffers&&j.commerce.meta._hhRedirectIfNoOffers.delay(300)})}else{j.widgets.calendar.setErrorStyling(new Event(p).target)}return}if(!j.widgets.calendar.hasPageDates()){j.commerce.meta.clickMetaShowPrices(p);return}if(o.getParent(".meta_date_wrapper")){j.trackEventOnPage("MetaGeoLightBox","open","DatePicker",0,false)}else{j.trackEventOnPage("MetaGeoLightBox","open","ShowPrices",0,false)}j.run("ta.overlays.Factory.loadGeoCrAutoBroadenOverlay",{},o,n)}catch(q){j.util.error.record(q,"ta.commerce.meta.checkRatesCreateGeoCrAutoBroadenLb cannot track/create lightbox")}},metaListingClickReporting:function(n){if(!n||!n.target){return}if(n.target.hasClass("photo_image")){j.trackEventOnPage("PRICE_SAVER","CLICK","THUMBNAIL")}else{if(n.target.nodeName==="A"&&n.target.parentNode.hasClass("review_stubs_item")){j.trackEventOnPage("PRICE_SAVER","CLICK","REVIEW")}else{if(n.target.hasClass("property_title")){j.trackEventOnPage("PRICE_SAVER","CLICK","PROPERTY_TITLE")}else{if(n.target.getParent(".metaPriceInfo")!=null){j.trackEventOnPage("PRICE_SAVER","CLICK","META")}}}}},getMetaParams:function(){return{metaReferer:e.pageServlet}},updateSessionDatesRedirect:function(n){if(j.widgets.calendar.hasPageDates()){j.widgets.calendar.justUpdateSessionDates(function(){e.location.href=n},false,true)}else{e.location.href=n}}}}(d));if(!d.commerce.meta){d.commerce.meta={}}for(var b in c){if(c.hasOwnProperty(b)){d.commerce.meta[b]=c[b]}}}(document,window,ta));ta.commerce.minimeta={ajax:{MAX_POLL_ATTEMPT:13,ALL_HAC_COMPLETE:"hotelsMeta.allHacComplete",LOCS_ON_PAGE:"hotelsMeta.locsOnPage",ATTEMPT_STORE_KEY:"hotelsMeta.ajaxNum",TIME_EXPIRED:"hotelsMeta.timeExpired",MINI_META_APPEAR_LOADING_TIMEOUT:5000,MINI_META_STOP_LOADING_TIMEOUT:60000,send:function(c,a){var b=ta.commerce.minimeta.ajax;setTimeout(function(){new Request({method:"post",url:b.getUrl(),data:b.buildPostData(a),onSuccess:function(d){var e=new Element("div",{html:d});b.updateDOM(e);if(!c&&b.shouldResubmit()){ta.commerce.minimeta.ajax.send()}b.updateAttemptNum()}}).send()},ta.commerce.meta.polling.getPollWaitTimeForPollingAttempt(ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY)))},getUrl:function(){return"/BulkMiniMetaCRAjax"},buildPostData:function(b){var a={};a.area="QC_Meta_Mini";a.returnAllOffers=true;a.detail=ta.commerce.minimeta.ajax._getLocOnPageString(b);a.action="getMiniMetaForLocations";return a},updateDOM:function(d){var a=d.getElement(".isAllHacComplete");if(a||ta.retrieve(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE)){ta.store(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE,true);var c=$$(".metaDisclaimer");if(c&&c.hasClass("hidden")){c.removeClass("hidden")}}var b=document.getElements(".listing");b.each(function(j){var i=j.id;var h=i.substring(i.indexOf("_")+1);var g=d.getElement("."+h);ta.commerce.minimeta.ajax.updateLoadingState(d);if(g){var e=g.getElement(".metaPriceInfo");var f=j.getElement(".metaPriceInfo");ta.commerce.minimeta.ajax._setPrice(e,h);ta.commerce.minimeta.ajax._setAccomType(e,h);e.replaces(f)}})},resetAjaxCall:function(){ta.remove(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE);ta.remove(ta.commerce.minimeta.ajax.LOCS_ON_PAGE);ta.remove(ta.commerce.minimeta.ajax.ATTEMPT_STORE_KEY);ta.remove(ta.commerce.minimeta.ajax.TIME_EXPIRED)},shouldResubmit:function(){if(ta.retrieve(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE)){return false}else{var a=ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY);if(!a||a<ta.commerce.minimeta.ajax.MAX_POLL_ATTEMPT-1){return true}else{return false}}},updateAttemptNum:function(){var a=ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY);if(!a){ta.store(ta.commerce.minimeta.ATTEMPT_STORE_KEY,1)}else{ta.store(ta.commerce.minimeta.ATTEMPT_STORE_KEY,a+1)}},_getLocOnPageString:function(b){var c=document.getElements(".listing");var a="";c.each(function(f){var d,e;if(ta.commerce.minimeta.ajax._isHacComplete(f)&&!b){return}e=f.id;d=e.substring(e.indexOf("_")+1);a=a+d+","});if(a===""){ta.store(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE,true)}return a},_isHacComplete:function(a){return a.getElement(".metaPriceInfo.hacComplete")},_setPrice:function(b,f){var a=b.getElement(".classicPrice");if(a){var d="classicPrice_"+f;var c=ta.retrieve(d);if(ta.retrieve("hotels.shouldHideClassicPrices")){a.hide()}else{if(c&&c!==0){var e=a.getElement(".price");e.set("html",c);a.toggleClass("hidden",false)}else{a.hide()}}}},_setAccomType:function(a,d){var c=a.getElement(".contactStr");if(c){var b="accomType_"+d;var e=ta.retrieve(b);if(!e||e=="T_HOTEL"){c.set("html",ta.retrieve("hotels.contactHotel"))}else{c.set("html",ta.retrieve("hotels.contactAccom"))}}},updateLoadingState:function(b){if(ta.retrieve(ta.commerce.minimeta.ajax.TIME_EXPIRED)){var d=b.getElements(".loading_bubbles_gry");var c=new Element("span",{"class":"sprite-visitSite"});d.each(function(f){c.clone().replaces(f)});var a=b.getElements(".loadingHeader");var e=ta.retrieve("hotels.checkSites");a.each(function(f){f.set("html",e)})}}},storeAccomDetails:function(){var b=document.getElements(".classicPrices");b.each(function(d){ta.store(d.id,d.value)});var a=document.getElements(".accomTypes");a.each(function(d){ta.store(d.id,d.value)});var c=$$(".metaDisclaimer");if(c){c.addClass("hidden")}},doMetaDateSearch:function(){if(!ta.widgets.calendar.hasPageDates()){var c=document.getElement(".metaDatePicker .date_picker_calendar_wrap");c.fireEvent("click")}else{if(ta.has("hac.filter.changed")||ta.has("meta.mini_meta_on_accommodations")){ta.hac.filters.updateResults()}else{if(!ta.retrieve("hotels.datesChanged")){ta.hac.filters.updateResults();ta.servlet.HACSearch.destroyAnimatedDateCTA()}else{var b=ta.hac.filters.buildHACUrlParamString();var a="/HACSearch?"+b+window.location.hash;window.location=a}}}},lowestPriceBookBtnHover:function(b){try{var a=document.getElement(".LowestPrice .bookBtn");if(!a){ta.util.error.record(null,"lowestPriceBookBtnHover - no button for .LowestPrice .bookBtn",null,{out:b});return}if(b){a.className=a.className.replace(/Over\b/,"Idle")}else{a.className=a.className.replace(/Idle\b/,"Over")}}catch(c){ta.util.error.record(c,"lowestPriceBookBtnHover - cannot change button hover appearance",null,{out:b})}}};ta.commerce.AvailDataWidget=new Class({Implements:[Options],options:{calendarOptions:{},argArray:[]},initialize:function(h,d,c,b,e,k){this.setOptions(k);if(h||window.event){h=new Event(h||window.event);if(h){h.stop()}}this.locId=d;this.ext=b;var j=null;if(this.ext){j="date_picker_adults_"+this.locId+this.ext}else{j="date_picker_adults_"+this.locId}this.adultField=ta.id(j);this.options.calendarOptions=Object.merge(this.options.calendarOptions,{ext:this.ext?this.ext:"",creatorElem:h&&h.target});var i=true;if(h){var g=ta.id(h.target);if(g&&(g.hasClass("out_date")||(ta.has("guests_rooms_picker_3.enabled")&&g.hasClass("outDateTrigger")))){i=false}}if(!(ta.page&&ta.page.usingUnifiedDates&&c==="adults")){this.calendar=new ta.widgets.SingleDateCalendar(this.options.calendarOptions,this.locId,e,this.options.argArray,i)}var a=ta.retrieve("adultFieldsMap");if(!a){a={}}if(this.adultField){this.adultsField=a[j];var f=this.adultField.getParent(".overlay");if(!this.adultsField||(f&&this.adultsField.parentOverlay!=f.overlay)){this.adultsField=new ta.widgets.AdultsField(this.adultField,this.locId,e,h);a[j]=this.adultsField;ta.store("adultFieldsMap",a)}}this.show(c);if(ta.widgets.calendar.trackCalendarObject){ta.widgets.calendar.trackCalendarObject(this)}},show:function(a){if(a=="calendar"&&this.calendar&&this.calendar.calendarOverlay){this.calendar.showCalendarOverlay()}else{if(a=="adults"&&this.adultsField){this.adultsField.adultsOverlay.show()}}if(ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.calendar.calendarOverlay.container){this.calendar.calendarOverlay.container.setStyle("position","fixed")}},clear:function(){if(this.adultField){if(!ta.retrieve("meta_guests_field_v2.enabled")){ta.widgets.calendar.setPageAdultsCount(2)}ta.widgets.calendar.syncAllDatePickers()}this.calendar.clear()},getState:function(d){var b=this.calendar.getState();var a={adults:"2"};if(this.adultsField){a=this.adultsField.getState()}else{if(ta.widgets.calendar.getPageAdultsCount()){a={adults:ta.widgets.calendar.getPageAdultsCount()+""}}}var c=Object.merge(b,a);if(d){return c}return Object.toQueryString(c)}});ta.widgets.AdultsField=new Class({adultsSelRegex:/.*_(\d)\s*$/,adultsExRegex:/.*_\d+_(.*)$/,initialize:function(j,c,f){this.adultsField=j;this.crId=c;this.selectionFunction=f;var k=this.adultsField.getParent(".overlay");if(k){this.parentOverlay=k.overlay}var g=ta.overlays.ACTIVATE_CLICK;if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")){g=ta.overlays.ACTIVATE_NEVER}this.guestFieldLabel=this.generateGuestFieldLabel(this.adultsField.id);this.adultsOverlay=new ta.overlays.RelativeOverlayBelow({style:"dp",showCloseButton:false,noPadding:true,autoShow:false,offsetLeft:1,activate:g,onShow:this.onAdultsShow.bind(this),onHide:this.onAdultsHide.bind(this)},this.adultsField);this.adultsField.onclick=function(){};ta.id(this.adultsField).addEvent("click",this.adultsOverlay.show);var i=ta.id(this.adultsOverlay.container).getElement(".adults_pre_selected");try{this.count=ta.retrieve("date.picker.adultsCount");if(!this.count){this.count=this.adultsSelRegex.exec(i.id)[1]}}catch(h){}if(!this.count){this.count="2"}ta.widgets.calendar.setPageAdultsCount(this.count);var a=ta.id(this.adultsOverlay.container).getElements(".option");var d=this.adultSelect.bind(this);a.each(function(m,e){var l=function(n){d.pass([e+1,m,n.event])()};ta.id(m).addEvent("click",l)});var b=this.adultsField.clientWidth;b=b+"px";ta.id(this.adultsOverlay.container).setStyles({width:b});this.optionElems=a},generateGuestFieldLabel:function(c){var b=this.adultsExRegex.exec(c);var a=ta.retrieve("open_guest_field.servletName");if(!a){a=window.pageServlet}if(!b){if(!a){return""}else{if(a=="Hotel_Review"){return"Guest_HR"}else{if(a=="Hotels"){return"Guest_Hotels"}else{if(a=="ShowUserReviews"){return"Guest_Hotels"}else{return""}}}}return"Guests"}else{if(b[1]=="pop"){return"Guest_Flyout"}else{if(b[1]=="met"){return"Guest_MetaLightbox"}else{if(b[1]=="pto"){return"Guest_HR_PhotoLightbox"}else{if(b[1]=="amo"){return"Guest_HR_AmenitiesLightbox"}else{return""}}}}}},trackGuestFieldEvent:function(b,a){try{ta.trackEventOnPage("GuestPicker",b,a)}catch(c){ta.util.error.record(c,"ta.widgets.AdultsField.trackGuestFieldEvent")}},onAdultsShow:function(){try{if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}if(ta.id("PERSISTENT_DATE_PICKER")&&this.optionElems[0]&&this.optionElems[0].getParent("div.relative")){this.optionElems[0].getParent("div.relative").setStyles({"z-index":10001})}this.keyEventListener=this.onAdultsOverlayKeyDown.bind(this);document.addEvent("keydown",this.keyEventListener);this.adultsField.blur();var a=document.getElements(".date_picker_adults_option");if(a){Array.each(a,function(d){ta.id(d).removeClass("adults_selected");ta.id(d).removeClass("adults_pre_selected")})}if(ta.id(this.adultsField).getParent("#PERSISTENT_CHECK_RATES")){var b=ta.id(this.adultsField).getCoordinates().top;if(typeof(isIPad)=="undefined"||!isIPad){b=b-window.getScrollTop()}ta.id(this.adultsOverlay.container).setStyles({position:"fixed",top:b+29,zindex:9997})}this.count=ta.retrieve("date.picker.adultsCount");if(ta.retrieve("meta_guests_field_v2.enabled")){this.optionElems[this.count-1].addClass("adults_pre_selected");this.preSelectElem=this.optionElems[this.count-1]}if(ta.retrieve("meta_guests_field_v2.trackingEnabled")){this.trackGuestFieldEvent("Open",this.guestFieldLabel)}}catch(c){ta.util.error.record(c,"ta.widgets.AdultsField.onAdultsShow")}},onAdultsHide:function(){try{if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}if(this.keyEventListener){document.removeEvent("keydown",this.keyEventListener)}}catch(a){}},onAdultsOverlayKeyDown:function(a){if(a.key=="esc"){this.adultsOverlay.hide()}},adultSelect:function(e,d,c){ta.commerce.meta.tracking.resetAllTimingLocks();ta.commerce.meta.tracking.clearSuppressedAreas();ta.commerce.meta.polling.clearAllPollingInfo();this.updateValue(e,d.innerHTML);this.adultsOverlay.hide();var b=this.guestFieldLabel+"|"+this.count;if(ta.retrieve("meta_guests_field_v2.trackingEnabled")){this.trackGuestFieldEvent("Select",b)}if(!ta.widgets.calendar.hasPageDates()){return}if(this.selectionFunction){if(this.selectionFunction===ta.widgets.calendar.launchInlineMeta){this.selectionFunction.call(this,c)}else{this.selectionFunction.call(this,this.crId,this.adultsField)}}if(ta.commerce.metajson){ta.commerce.metajson.refetchAll()}if(typeof oxapp!="undefined"&&oxapp&&oxapp.context){var a=oxapp.context.get("TravelDates");if(a){a.save()}}ta.commerce.meta.loadMetaAF(this.crId,"AV_ABOVE_FOLD_META",false);ta.widgets.calendar.trackCalendarEvent("DATEPICKER","CHANGE","GUESTS",e)},updateValue:function(a,b){this.count=a;this.adultsField.innerHTML=b;ta.widgets.calendar.setPageAdultsCount(this.count);ta.widgets.calendar.syncAllDatePickers();ta.widgets.calendar.justUpdateSessionAdults();var c=document.getElements(".adults");c.each(function(d){d.innerHTML=b})},getAdultsCount:function(){return this.count},getState:function(){return{adults:this.count+""}}});ta.commerce.meta.tracking={getTimingForNavArea:function(a){if(!a){return}var b=ta.commerce.meta.tracking.processNavArea(a);return ta.retrieve(b)},setTimingLockForNavArea:function(b,a){ta.store(b+"-LOCK",a)},isTimingLocked:function(b){var c=ta.commerce.meta.tracking.processNavArea(b);var d=ta.retrieve(c);if(!d){return false}var a=Date.now();if(a-d>=2000){ta.commerce.meta.tracking.resetTimingLockForNavArea(c);return false}return true},resetTimingLockForNavArea:function(a){var b=ta.commerce.meta.tracking.processNavArea(a);if(ta.retrieve(b+"-LOCK")){ta.remove(b+"-LOCK")}},resetAllTimingLocks:function(){var a=["QC_Meta_Inline","QC_Meta_Mini","QC_Meta_Metro","QC_Meta_Micro","QC_Meta_Lightbox"];for(var b=0;b<a.length;b++){ta.commerce.meta.tracking.resetTimingLockForNavArea(a[b])}},processNavArea:function(a){if(!a){return}if(a.indexOf("QC_Meta_Inline")===0){return"QC_Meta_Inline"}if(a.indexOf("QC_Meta_Mini")===0){return"QC_Meta_Mini"}if(a.indexOf("QC_Meta_Metro")===0){return"QC_Meta_Metro"}if(a.indexOf("QC_Meta_Micro")===0){return"QC_Meta_Micro"}if(a.indexOf("QC_Meta_Lightbox")===0){return"QC_Meta_Lightbox"}},setTimingForNavArea:function(c,b){if(!c){return}if(!b){b=Date.now()}var a=ta.commerce.meta.tracking.processNavArea(c);if(ta.commerce.meta.tracking.isTimingLocked(a)){return ta.commerce.meta.tracking.getTimingForNavArea(a)}ta.store(a,b);ta.commerce.meta.tracking.setTimingLockForNavArea(a,b);if(a=="QC_Meta_Inline"&&!ta.commerce.meta.tracking.containsSuppressedArea("QC_Meta_Mini")){ta.commerce.meta.tracking.setTimingLockForNavArea("QC_Meta_Mini",b)}return b},updateUrlWithTiming:function(b,a){if(!b||!a){return b}var c=ta.commerce.meta.tracking.setTimingForNavArea(a);if(!c){return b}if(b.contains("&metaRequestTiming=")){var d=new RegExp("(&|\\?)metaRequestTiming=[^&]*");b=b.replace(d,"&metaRequestTiming="+c)}else{b+="&metaRequestTiming="+c}return b},suppressImpressionsForArea:function(c){if(!c){return}var b=ta.commerce.meta.tracking.processNavArea(c);if(ta.commerce.meta.tracking.containsSuppressedArea(b)){return}var a=ta.retrieve("suppressed.areas");a.push(b);ta.store("suppressed.areas",a)},getSuppressedAreas:function(){var a=ta.retrieve("suppressed.areas");if(!a){a=[];ta.store("suppressed.areas",a)}return a},getSuppressedAreasAsString:function(){var b=ta.commerce.meta.tracking.getSuppressedAreas();var a="";if(b.length>0){for(var c=0;c<b.length;c++){a+=b[c]+";"}}return a},hasAnySuppressedAreas:function(){var a=ta.commerce.meta.tracking.getSuppressedAreas();return a.length>0},containsSuppressedArea:function(d){if(!d){return false}var b=ta.commerce.meta.tracking.processNavArea(d);var a=ta.commerce.meta.tracking.getSuppressedAreas();for(var c=0;c<a.length;c++){if(a[c]==b){return true}}return false},removeSuppressedArea:function(e){if(!e){return}var b=ta.commerce.meta.tracking.processNavArea(e);var f;var c;if(ta.commerce.meta.tracking.containsSuppressedArea(b)){var a=ta.commerce.meta.tracking.getSuppressedAreas();for(var d=0;d<a.length;d++){if(a[d]==b){c=d;f=true}if(f){a=ta.commerce.meta.tracking.removeElementByIndex(a,c);ta.store("suppressed.areas",a)}}}},removeElementByIndex:function(b,a){if(b&&a>=0&&a<b.length){b.splice(a,1)}return b},clearSuppressedAreas:function(){ta.store("suppressed.areas",[])},getTrackFunctionForSuggestedAccommodations:function(){var a=function(){var g=ta.widgets.calendar.getPageOutDate();var c="hotelsAccommodationGroupTracking";var f=ta.id(c);if(f){var e=f.getBoundingClientRect();if(e&&e.top>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)){var d="Hotels on Tourism";var h="Impression";var b="dated";if(g===false){b="undated"}var i=ta.has("suggestedAccommodationsIsDmoSponsored")?1:0;ta.trackEventOnPage(d,h,b,i);window.removeEvent("scroll",a)}}};return a},getTrackFunctionForSuggestedVRs:function(){var a=function(){var g=ta.widgets.calendar.getPageOutDate();var c="vrsAccommodationGroupTracking";var f=ta.id(c);if(f){var e=f.getBoundingClientRect();if(e&&e.top>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)){var d="VRs on Tourism";var h="Impression";var b="dated";if(g===false){b="undated"}var i=ta.has("suggestedAccommodationsIsDmoSponsored")?1:0;ta.trackEventOnPage(d,h,b,i);window.removeEvent("scroll",a)}}};return a}};require(["ta/rollupAmdShim"],function(a){a.install(["ta/commerce/MetaPolling","ta/meta/LinkTracking","ta/sales/metaImpressionComScoreTag","ta/sales/bwIBImpressionComscoreTag","ta/sales/metaClickComScoreTag"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-commerce-meta",files:{js3:{src:{ta:{meta:{LinkTracking:1},commerce:{MetaPolling:1},sales:{metaImpressionComScoreTag:1,bwIBImpressionComscoreTag:1,metaClickComScoreTag:1}}}}},_:{baseUrl:"/"}})};define("ta/commerce/MetaPolling",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(b,c,d){var a={setPollingAttemptForRequest:function(e,f){var g=a.getPollingMap();if(!f){f=1}g[e]=f;a.setPollingMap(g)},getPollingAttemptForRequest:function(e){if(a.isRequestBeingPolled(e)){var g=a.getPollingMap();var f=g[e];if(f){return f}}},getPollingWaitTimeForRequest:function(e){var f=a.getPollingAttemptForRequest(e);return a.getPollWaitTimeForPollingAttempt(f)},isRequestBeingPolled:function(e){var g=a.getPollingMap();var f=e&&g[e];if(f){return true}return false},incrementPollingAttemptForRequest:function(e){var g=a.getPollingMap();var f=g[e];if(f){f=f+1;g[e]=f}a.setPollingMap(g);return f},clearAllPollingInfo:function(){d.store("ta.meta.polling.map")},removePollingInfoForRequest:function(e){if(a.isRequestBeingPolled(e)){var f=a.getPollingMap();delete f[e];a.setPollingMap(f)}},getPollingMap:function(){var e=d.retrieve("ta.meta.polling.map");if(!e){e={};d.store("ta.meta.polling.map",e)}return e},setPollingMap:function(e){if(e){d.store("ta.meta.polling.map",e)}},getPollWaitTimeForPollingAttempt:function(e){if(typeOf(e)!=="number"||e<0){return 1000}switch(e){case 1:case 2:case 3:case 4:return 1000;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2000;case 11:return 5000;case 12:return 15000;default:return 30000}},getMaxPollingAttemptNumber:function(){return 13}};c.exportTo(a,"ta.commerce.meta.polling");return a});ta.commerce.meta.horizontalXSell=(function(){var k=10;var g=1000;var h=false;var c=null;var n=null;var l=null;var p=0;var f=function(q){if(q.contains("hacComplete")&&(q.contains("hacMiniOfferNotAvailable")||q.contains("hacMiniOfferUnavailable"))){return true}return false};var j=function(q){if(!a()){return false}if(!q.contains("hacMiniOfferUnavailable")){return true}return false};var e=function(t,w){try{if(ta.retrieve("ta.redirectingPage")||ta.retrieve("non_comm_hr_xsell_2014")){return}if(!w){p=0}c=new Date().getTime();var v=c;var u=ta.widgets.calendar.getCheckRatesData();if(!u){return}var r={metaReferer:window.pageServlet};var q=Object.merge(u,{detail:t,reqNum:w?"2":"1",type:"horizontal_hr"},r);var x=Object.toQueryString(q);if(!x||!x.trim()){ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - toQueryString failure",null,q);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:q,evalScripts:true,onSuccess:function(D){if(v!=c){return}var A=new Element("div",{html:D});var C=A.getElement(".xsellHacStatusReady")||A.getElement(".xsellHacStatusSOL")||w;if(ta.has("meta.full_meta_photos_v3")){D+='<div class="gap_spacer"></div>'}if(!C&&p<k){setTimeout(function(){p=p+1;e(t,true)},g)}else{var F=ta.id("HORIZONTAL_CROSS_SELL");var z=A.getElement(".metaMicro");if(F&&z){if(F.getElement(".metaMicro")){F.setContent(D)}else{F.setStyle("opacity","0");var E=new Fx.Tween(F,{property:"opacity"});F.setStyle("height",0);var B=122;var y=new Fx.Tween(F,{property:"height",onComplete:function(){F.setStyle("height","auto");F.setContent(D);E.start(0,1)}});y.start(0,B)}if(n){n()}d(true)}}},onFailure:function(){if(ta.retrieve("ta.redirectingPage")){return}ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(s){ta.util.error.record(s,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell")}};var i=function(q,r){if(!q||!q.getElement(".bc_flags")){return}var s=q.getElement(".bc_flags").className;if(j(s)){m()}else{if(f(s)){e(r,false)}}};var m=function(){var q=ta.id("HORIZONTAL_CROSS_SELL");var s=ta.id("HORIZONTAL_CROSS_SELL_LIST");var t=document.getElement("#HORIZONTAL_CROSS_SELL_LIST .lodging");if(q&&s&&t){var u=s.getSize().y;q.setStyle("height",u);var v=new Fx.Tween(s,{duration:200,property:"opacity",onComplete:function(){s.addClass("hidden");r.start(u,0).chain(function(){q.setStyle("height",0);q.innerHTML=""})}});v.start(1,0);var r=new Fx.Tween(q,{duration:"long",property:"height"});if(l){l()}d(false)}};var a=function(){return h};var d=function(q){h=q};var o=function(q){n=q};var b=function(q){l=q};return{updateHorizontalXSell:i,removeHorizontalXSell:m,isLoaded:a,setLoaded:d,setOnloadFunction:o,setOnRemoveFunction:b}}());ta.commerce.meta.horizontalXSellExtensions={putAvafBelowMap:function(){if(ta.commerce.meta.horizontalXSell.isLoaded()){return}var d=ta.id("AV_ABOVE_FOLD_META");var c=ta.id("RHS_MAP");var b=d.parentNode;if(d&&c&&b){var a=b.getElement(".bxDivider.map");if(a){b.insertBefore(a,d);b.insertBefore(c,a)}else{b.insertBefore(c,d)}}},putAvafAboveMap:function(){if(!ta.commerce.meta.horizontalXSell.isLoaded()){return}var c=ta.id("AV_ABOVE_FOLD_META"),b=ta.id("RHS_MAP"),a=c.parentNode;if(c&&b&&a){a.insertBefore(c,b)}}};if(!ta.meta){ta.meta={}}if(!ta.meta.link){ta.meta.link={}}(function(b){if(b.click){return}b.OPEN_IN_NEW_TAB="new_tab";b.OPEN_IN_SAME_TAB="same_tab";b.OPEN_IN_NEW_WINDOW="new_window";b.getUrlFromClickElem=function(s){if(!s){return null}var u=s.get("data-commerceClickData");if(!u||!u.trim||u.trim()===""||typeof asdf!=="function"){return null}u=asdf(u).replace(/&amp;/g,"&");var t=ta.retrieve("tracking.impression.key");if(s.hasClass("inlineOffer")&&t){var r=/ik=[a-zA-Z0-9]*/;u=u.replace(r,"ik="+t)}return u};b.getPartnerFromClickElem=function(s){if(!s){return null}var r=s.get("data-offerauthor");if(!r||!r.trim||r.trim()===""){return null}return r.trim()};b.animateAndClick=function(t,r){var s=r.hasClass("bookableOffer"),u=function(){b.click(t,r);var v=function(){j();ta.off("commerceClickAnimated",v)};ta.on("commerceClickAnimated",v)};ta.CommerceClickAnimation.addAnimation(u,{animateOnFocus:!s,squelchAnimation:true})};b.addToCartAndClick=function(s,r){b.click(s,r);j()};function p(){if(ta.localStorage&&ta.localStorage.enabled){ta.localStorage.set("pcb_branding_interstitial_rollout_p1.show_date",new Date())}}b.click=function(s,x){var y=ta.id(x),u,v,B,w,z,r,E,D,t,C;try{y=h(y);u=b.getUrlFromClickElem(y);if(!u){return}v=y.get("data-vendorName");B=y.get("data-offerauthor");w=y.get("data-locationId");z=b.getNavAreaFromClickElem(y);r=y.get("data-contentId");E=y.get("data-openBehavior");D=y.get("data-imageUrl");t=y.get("data-mcid");C=y.get("data-pernight");if(u&&v&&w){i(u,z,v,w,E,y,D,t,C,B)}else{m(null,"Invalid commerce click",u,z)}}catch(A){m(A,"Invalid commerce click",u,z)}setTimeout(function(){try{ta.fireEvent("metaLinkClick",y,v,z,w,r,E,ta.popups.PopUtil.extractSlotFromCommerceUrl(u))}catch(F){m(F,"Commerce click tracking failed",u,z)}},300)};b.getNavAreaFromClickElem=function(v){var u=ta.id(v),r=u.get("data-navArea"),w,s;if(!r){w=u.get("data-navAreaPre");s=u.get("data-navAreaPost");r=q(w,v,s)}if(r){r=r.replace("+","|")}if(ta.browser.isIE10Metro()){r="QC_Meta_Metro_Lightbox"}if(v.getParent("#LOC_PHOTO_ALBUMS")){if(v.getParent(".featuredImageWrap")){r=r+"|PHOTOS_LB|Featured_Reel"}else{r=r+"|PHOTOS_LB"}}else{if(v.getParent("#AMENITY_LIGHTBOX")){r=r+"|AMENITIES_LB"}}a(r);var t=r;r=k(u);if(r==null||r.indexOf("null")!=-1||r.indexOf("Unknown")!=-1){r=t}return r};b.extractPageLocId=function(r){return b.urlArgNumeric(r,"d","detail")||b.urlArgNumeric(r,"g","geo")};b.urlArgNumeric=function(t,r,u){var s=new RegExp("(-"+r+"([0-9]+))|([?&]"+u+"=([0-9]+))");var v=s.exec(t);if(v){if(typeof v[2]!="undefined"){return v[2]}if(typeof v[4]!="undefined"){return v[4]}}return null};b.photoClick=function(s,v,t,r,u){if(t.hasOwnProperty("area")){t.area=b.getPhotoNavArea(s)}require("ta/util/Doer").aimdoit(v,t,r,u)};b.getPhotoNavArea=function(r){return k(r,{"data-navArea-metaType":"Pro_Photo","data-navArea-availability":"NA"})};b.updateNavAreaInCommerceUrl=function(u,r){if(r){var s=b.getNavAreaFromClickElem(r);var t=new RegExp("(&|\\?)area=[^&]*");u=u.replace(t,"$1area="+s)}return u};function i(x,v,D,C,y,t,H,B,E,G){if(D&&D==="TripAdvisor"){p()}var J=x;var K=new RegExp("(&|\\?)area=[^&]*");J=J.replace(K,"$1area="+v);if(crPageServlet){var w=new RegExp("(&|\\?)from=[^&]*");J=J.replace(w,"$1from=HotelDateSearch_"+crPageServlet)}var s=ta.commerce.meta.tracking.setTimingForNavArea(v);if(s&&t&&!t.hasClass("bookableOffer")){if(J.contains("&metaRequestTiming=")){var u=new RegExp("(&|\\?)metaRequestTiming=[^&]*");J=J.replace(u,"&metaRequestTiming="+s)}else{J+="&metaRequestTiming="+s}}if(B){J+="&m="+B}if(E){J+="&priceShown="+E}if(G){J+="&cpn="+G}if(document.location&&document.location.href){var I=b.extractPageLocId(document.location.href);if(I){J+="&pageLocId="+I}}var A;if(J.indexOf("&tp=")<0){var z=ta.analytics.getCommentTrackingPath(t);if(z&&z.length>0){A=z.getLast();if(A&&A.indexOf(":")===-1){J+="&tp="+A;var r=d(z,J,v);if(r){J+="&gn="+r}}else{m(null,"ibdm_cc: no placement found",J,v,"WARN")}}else{m(null,"ibdm_cc: no tracking path found",J,v,"WARN")}}var F=J.indexOf("/StartBooking")>=0;if(F){l();if(crPageServlet){J=J+"&from="+crPageServlet}}if(ta.retrieve("commerce_history_injection_v2")&&!F){J="/NewWindowRedirect?url="+encodeURIComponent(J)}if(ta.has("assisted_booking_clicks_new_tab")&&y===b.OPEN_IN_NEW_TAB&&F&&ta.browser&&ta.browser.isIE10Metro()){y=b.OPEN_IN_SAME_TAB}if(ta.has("tablet_google_search_app_open_same_tab")&&/GSA\/[0-9]{2}/.test(window.navigator.userAgent)){y=b.OPEN_IN_SAME_TAB}if(F&&ta.page&&ta.page.maybeOpenInlineBooking&&ta.page.maybeOpenInlineBooking(A,C,t,null,J)){return}if(y===b.OPEN_IN_NEW_TAB){e(J,H,D,t)}else{if(y===b.OPEN_IN_SAME_TAB){c(J,t)}else{n(D,J,H)}}if(window.IS_DEBUG){ta.store("ta.lastCommerceClickUrl",J)}}function o(){try{document.domain=document.domain}catch(r){return true}return false}function d(s,v,B){var r="groups";var F="_NavCart";var D="MyCartTab";var t="V:HG-1.1";var E=-1;var A=0;var u;var z;var x=s.getLast();var C=s[s.length-2];var w;var y;if(!s){return}if(s.length<5){return}if((x.indexOf(F)!==(x.length-F.length))&&x!==D){return}if(C.indexOf(t)!==0){return}for(z=s.length-1;z>=0;z--){if(!s[z]){continue}A=0;u=s[z];if(u===r&&E===-1){w=z;for(w=z-1;w>=0;w--){u=s[w];if(u.indexOf("N:")===0){A++;if(E===-1){E=w}}}}if(E!==-1){break}}if(A>=3&&E>0){u=s[E];y=u.split(":");if(y.length===2){return y[1]}else{m(null,"ibdm_cc: no group node found",v,B,"WARN")}}}function l(){if(!ta.has("ib_qualaroo_surveys")||(window.pageServlet!=="Hotels"&&window.pageServlet!=="Hotel_Review")||!ta.qualaroo){return}try{var r=window.pageServlet!=="Hotels"?"HOTEL_REVIEW":"HOTELS",s="IB_QUALAROO_SURVEYS_"+r;ta.qualaroo.forceDisplaySurvey("force",s,false)}catch(t){ta.util.error.record(t,"Unable to display Qualaroo survey")}}b.showQualarooSurvey=l;function e(w,s,v,t){var u=o(),r=window.open(u?w:"","_blank");if(!r&&typeof(Browser)!=="undefined"&&Browser.ie&&ta.has("ta.ie_commerce_popup_block_fix")&&ta.has("assisted_booking_clicks_new_tab")&&w.indexOf("/StartBooking")>=0){if(ta.util&&ta.util.cookie){ta.util.cookie.setPIDCookie(38822)}c(w,t);return}!u&&ta.popups.PopUtil.redirectToUrl(r,w);ta.popups.PopUtil.pollForPartnerLoad(r,new Date(),v,ta.popups.PopUtil.extractSlotFromCommerceUrl(w),crPageServlet)}function c(u,s){ta.meta.treeTrack.logTrackingTreeClickEvtCookie(u,s);if(ta.meta&&ta.meta.treeTrack){var t=function(){f(u)};if(s&&s.getParentBySelector(".metaCheckRatesOverlay")!=null){ta.meta.treeTrack.logLightboxTreeImpression(t)}else{if(ta.meta.treeTrack.isInitialized()){try{ta.meta.treeTrack.logTreeImpression(t)}catch(r){ta.util.error.record(r," Error in openMetaProviderSameTab");f(u)}}else{if(ta.retrieve("allowSamePageClickWithoutTrackingTree")===true){f(u)}}}}else{f(u)}}function f(r){if(ta.retrieve("ta.isIE11orHigher")){window.open(r,"_self",null,false)}else{window.location.href=r}}function n(x,w,t){var r=x,v=ta.popups.PopUtil.getProviderWindowDims(r,true),s=1,u;if(window&&window.chrome){s=0}u={customWidth:v.customWidth,customHeight:v.customHeight,widthOffset:v.widthOffset,heightOffset:v.heightOffset,name:r,url:w,scrollbars:s,providerLogo:t};ta.popups.PopUtil.createCheckRatesWindow(u)}function a(r){var s=ta.retrieve("ta.meta.navArea");if(!s||s.indexOf(r)<0){ta.store("ta.meta.navArea",r)}}function q(r,v,s,u){var w="";if(v.getParent(".persistentCR")){w=(u)?"|PCR":"PCR"}else{if(v.getParent(".photosOverlay")||v.getParent("#LOC_PHOTO_ALBUMS")){w=(u)?"|Photo_Lightbox":"Photo_Lightbox"}else{if(v.getParent(".amenities_lightbox")){w=(u)?"|Amenities_Lightbox":"Amenities_Lightbox"}else{if(v.getParent("#CHECK_RATES_LB")){w=(u)?"|Photo_LB":"Photo_LB"}}}}w=w?"|"+w:"";r=r?r:"";w=w?w:"";s=s?s:"";var t=[r,w,s].join("|").replace("||","|").replace(/(\|$)/g,"");return t}function m(u,t,v,s,r){ta.util.error.record(u,t,null,{servlet:window.pageServlet,url:v,area:s},r)}function k(s,t){var w;var v={"data-navArea-metaType":null,"data-navArea-linkType":null,"data-navArea-availability":null,"data-navArea-placement":null};var u=4;if(t){for(w in v){if(t.hasOwnProperty(w)){v[w]=t[w];u--}}}var x=null;while(s&&u>0){for(w in v){if(v[w]===null){v[w]=s.get(w);if(v[w]!==null){if(v[w]==="@trigger"){x=s}u--}}}s=s.getParent()}while(v["data-navArea-placement"]==="@trigger"&&x){while(x&&!x.overlay){x=x.getParent()}if(x&&x.overlay.options&&x.overlay.options.trigger){x=x.overlay.options.trigger}else{x=null;v["data-navArea-placement"]="null"}while(x){v["data-navArea-placement"]=x.get&&x.get("data-navArea-placement");if(v["data-navArea-placement"]!==null){break}x=x.getParent()}}var r=[];for(w in v){r.push(v[w]?v[w]:"null")}if(window.isTabletOnFullSite){r.push(g()?"Portrait":"Landscape")}else{r.push("Desktop")}return r.join("|")}function g(){if(ta.common&&ta.common.tablet){return ta.common.tablet.isPortrait()}return window.matchMedia&&window.matchMedia("(orientation: portrait)")&&window.matchMedia("(orientation: portrait)").matches}function h(s){if(!s||s.isVisible()){return s}var u=s.get("data-locationid");var v=s.get("data-contentid");var r=".offer";if(s.hasClass("bookableOffer")){r=r+'.bookableOffer[data-locationid="'+u+'"]'}else{r=r+'[data-locationid="'+u+'"][data-contentid="'+v+'"]'}var t=document.getElement(r);if(t){return t}return s}function j(){if(!ta.NavAbandonedCart){return}ta.NavAbandonedCart.udpate()}})(ta.meta.link);define("ta/meta/LinkTracking",["vanillajs","api-mod","ns-exporter","ta/Core/TA.Event","ta/util/Error","utils/ajax","ta/Core/TA.Store","ta/Core/TA.Record"],function(i,h,n,j,b,m,e,f){var d={};d.setup=function(){try{j.on("metaLinkClick",l)}catch(o){b.record(o,"trouble building event - metaLinkClick")}};d.actionRecord=function(o){m("/ActionRecord?action="+o)};d.restoreCRPageServlet=function(){var o=e.retrieve("crPageServlet_orig");if(o){window.crPageServlet=o}};function l(p,q,s,r,o,x){try{g(q,s,r,x)}catch(t){try{b.record(t,"trackMetaClick failure")}catch(w){}}try{if(!p||!(p.className||"").match(/\bbookableOffer\b/)){var v=(p&&p.getAttribute("data-pernight"))||"";a(r,true,o,v)}}catch(t){try{b.record(t,"trouble loading click-out pixels")}catch(w){}}try{if(p&&e.retrieve("hotels_lists_engagement_tracking.enabled")){var u=(p.className||"").match(/\bbookableOffer\b/)?"Sherpa":"Meta";j.fireEvent("hotels_lists_engagement_tracking.fired",{type:u,element:p})}}catch(t){try{b.record(t,"problem in hotel lists engagement tracking")}catch(w){}}try{if(x!=ta.meta.link.OPEN_IN_SAME_TAB){k(p)}}catch(t){try{b.record(t,"problem in ibdmImpressionTracking")}catch(w){}}try{c(p)}catch(t){b.record(t,"problem in mapSponsorCheckRateTracking")}}function k(o){if(ta.meta&&ta.meta.treeTrack){if(h.getParent(o,"metaCheckRatesOverlay")){ta.meta.treeTrack.logLightboxTreeImpression()}else{if(ta.meta.treeTrack.isInitialized()){ta.meta.treeTrack.logTreeImpression()}}ta.meta.treeTrack.logTrackingTreeClickTrk(o)}}function a(s,q,t,o){try{var p={locId:s,isMetaCheckRates:q,contentId:t,selectedPrice:o};ta.common.ads.loadClickoutMonikers(p)}catch(r){b.record(r,"click out monikers failure (meta="+q+")")}}function g(t,p,s,r){var q="CheckRates";var u=1;f.trackPhysicalCommerce(q,p,u,s);f.trackAttemptedCommerce(q,p,t,u);var o=r?(r===ta.meta.link.OPEN_IN_NEW_TAB?"TAB_OPENED":(r===ta.meta.link.OPEN_IN_NEW_WINDOW?"WINDOW_OPENED":"SAME_TAB")):"";f.trackEventOnPage("COMMERCE_CLICK",o,(t||""))}function c(p){if(window.pageServlet&&p&&p.hasAttribute("data-provider")){var t=p.get("data-provider");var q=h.find("#mapsv2-sponsordetail");var s=(window.pageServlet=="Hotels")?"HACMap":"FloatingMap";if(window.pageServlet=="LocalMapsRedesign"){q=h.find(".overlay .skv3");s="LocalMap"}if(q&&q.hasAttribute("data-sponsor-provider")&&q.hasAttribute("data-sponsor")){var r=q.get("data-sponsor-provider");var o=q.get("data-sponsor");if(t==r){ta.trackEventOnPage(s,"sponsor_cr_sent",o)}}}}n.exportTo(d,"ta.meta.linkTracking");return d});if(!ta.meta.treeTrack){ta.meta.treeTrack={}}(function(e){var d=false;var b={hotelListSelector:null,singleHotelSelector:null,placementName:null,getImpressionString:null};var c="ibdm_impression_tracking";e.init=function(h){if(d){ta.util.error.record(null,"ta.meta.treeTrack should be initialized only once");return false}b=h;d=true};e.isInitialized=function(){return d};e.hasTrackingTree=function(h){if(!h||typeof h.previousSibling==="undefined"){return false}var i=h.previousSibling||h.nextSibling;if(i){if(f(i)){return true}return f(i.previousSibling)}return false};var f=function(i){if(i){var h=i.nodeValue;return h&&(h.contains("trk")||h.contains("etk"))}return false};e.logImpressionTreeOnPageLoad=function(){if(ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&ta.widgets.calendar.hasPageDates()&&!ta.retrieve("vrTabOnHotels")){var i=1;var k=4;var h;if(!ta.retrieve("treeTrackImpressionInProgess")){ta.store("treeTrackImpressionInProgess",true);var j=setInterval(function(){if(ta.retrieve("isTrackTreeFresh")){h=e.logTreeImpression(null,(i<k))}if(!h&&i<k){i++}else{ta.store("isTrackTreeFresh",false);ta.store("treeTrackImpressionInProgess",false);clearInterval(j)}},2000)}}};e.logTreeImpression=function(k,j){if(!ta.retrieve(c)||ta.retrieve("vrTabOnHotels")){if(k){k()}return false}if(!d){ta.util.error.record(null,"ta.meta.treeTrack.logTreeImpression called before being initialized");if(k){k()}return false}var h=a();var i=b.getImpressionString(h);if(!i&&h<=0){if(k){k()}return false}if(i&&i.indexOf("I:IllegalContext")===-1){ta.recordImpression(i,k);return true}else{if(!j){ta.util.error.record(null,"ta.meta.treeTrack.logTreeImpression called but no tracking tree html found!",null,{},"WARN")}}if(k){k()}return false};e.logLightboxTreeImpression=function(i){if(!ta.retrieve(c)){if(i){i()}return false}var h=g();if(h){ta.recordImpression(h,i);return true}if(i){i()}};var g=function(){var h=$$(".metaCheckRatesOverlay .impressionTrackingTree");if(h){return h[0].innerHTML}};e.getElmtPriceData=function(h){var i=[];if(!h){return i}var j="PP:";if(h.getAttribute("data-pernight")){j+=h.getAttribute("data-pernight")}else{j+="-1"}i.push(j);var k="PN:";if(h.getAttribute("data-offer-author")){k+=h.getAttribute("data-offer-author")}else{k+="None"}i.push(k);return i};e.logTrackingTreeClickTrk=function(h){if(!ta.retrieve(c)){return}if(e.hasTrackingTree(h)){if(h.hasClass("bookableOffer")){ta.trk("sherpa_click",false,h)}else{var i=e.getElmtPriceData(h);ta.trk("meta_click",false,h,i)}}};e.logTrackingTreeClickEvtCookie=function(i,h){if(!ta.retrieve(c)){return}if(e.hasTrackingTree(h)){if(h.hasClass("bookableOffer")){ta.setEvtCookieAndPath("sherpa_click",i,h)}else{ta.setEvtCookieAndPath("meta_click",i,h)}}};e.getElmtHeight=function(h){if(h){return h.offsetHeight}};function a(){if(!b.hotelListSelector||!b.singleHotelSelector){return 0}var i=0;var h=0;var j=document.getElements(b.hotelListSelector);j.each(function(k){k.getElements(b.singleHotelSelector).each(function(l){if(l.match(b.singleHotelSelector)){i++;if(l.isFullyVisible()){h=i}}})});return h}})(ta.meta.treeTrack);if(!ta.meta.update){ta.meta.update={}}ta.on("newInlinePageDates",function(b,a){ta.meta.update.request(b,a)});ta.on("metaOnlyUpdate",function(a){ta.meta.update.request(a,null,true)});(function(n){var b="miniMetaHacRequest_longTimeoutKey";var f="miniMetaHacRequest_appearLoadedTimeoutKey";n.request=function(z,x,y){l(z,null,0,false,y);w(z,x)};n.completeOnInitialPage=function(x){a(true,"",x)};n.buildUrl=function(F,O,M,E,V,K,G,C,D,x,y){var z=e(V),H=ta.widgets.calendar.getCheckRatesData(),W="",N="",Q="",L="",J="";if(H){W=Object.toQueryString(H)}if(E){N="&metaVersion="+E}if(ta.has("meta.baseLocationId")){Q="&baseLocId="+ta.retrieve("meta.baseLocationId")}if(ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")||ta.retrieve("checkrates.hr_bc_see_all_click")||(ta.retrieve("checkrates.hr_bc_see_all_click.lb")&&F==="MetaCheckRatesAjax")){L="&seeAllClick=true"}if(window.pageServlet){J="&imp=true&metaReferer="+window.pageServlet}var R=ta.retrieve("meta.requestFromArea");if(!R){R="";if(document.getElement("#LOC_PHOTO_ALBUMS")){R="&requestFromArea=pal"}else{if(document.getElement("#AMENITY_LIGHTBOX")){R="&requestFromArea=amo"}}ta.store("meta.requestFromArea",R)}var B="/"+F+"?detail="+O+"&"+W+"&area="+z+"&returnAllOffers=true"+J+N+Q+L+R,P=B;try{B=ta.commerce.meta.tracking.updateUrlWithTiming(B,z)}catch(U){ta.util.error.record(U,"problem updating url with timing in CheckRates.buildVarMetaHacUrl");B=P}if(ta.commerce.meta.tracking.hasAnySuppressedAreas()){var S=ta.commerce.meta.tracking.getSuppressedAreasAsString();if(S){B+="&suppressImpressionsOnComplete="+S}}if(ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")){P=B;try{B=m(B,D);if(!B){B=P}}catch(U){ta.util.error.record(U,"problem updating url with isFirstPageLoad in CheckRates.buildVarMetaHacUrl");B=P}}if(M){B+="&finalRequest=true"}if(K){B+="&numTries="+K}if(C){B+="&loadingTimeoutPassed="+C}if(x){B+="&isDateChangedRequest="+x}if(ta.maps&&ta.maps.mapsponsor){var A=ta.maps.mapsponsor.getSponsorForLocation(O);if(A){B+="&mapSponsorship="+A}}var T="ta.commerce.MetaHacOverlay.currency";if(ta.has(T)){B+="&currency="+ta.retrieve(T);ta.remove(T)}var I=ta.retrieve("booking.tracking.context");if(I){B+="&btc="+I}if(y){B+="&isMetaOnly="+y}return B};n.overlayRequest=function(R,T,Z,O,G){var Q,D="metaHacRequest_curCancelKey",I,L,E,X,A,P,M,V,y=13,U,x,C,K,F,N,H;try{if(!R){return}ta.commerce.meta.clearStoredMiniData();I=ta.widgets.calendar.getCheckRatesData();if(T==null){ta.store("meta.travelData",I);T=new Date().getTime();L=false;if(Z){if(ta.has("metaCheckRatesUpdateDivInline")){L=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}}else{if(ta.has("metaCheckRatesUpdateDiv")){L=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}}if(L&&L.removeClass){L.removeClass("hidden")}}E="metaHacRequest_"+T+"_cancel";if(ta.has(D)){X=ta.retrieve(D);if(X!=E){ta.store(X,true);ta.commerce.meta.polling.removePollingInfoForRequest(X)}}if(Z){A=document.getElement(".meta_rates_content .postShowMetaCR");if(ta.has("checkrates.mini_meta_by_percent_cpc")&&ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")){P=A.getElement(".seeMore.threshold");if(P){M=A.getElements(".postClickPrice.hide");M.each(function(aa){aa.removeClass("hide")});P.hide()}}ta.commerce.meta.updateProvArea(A)}if(!ta.has(E)){ta.store(E,false);ta.store(D,E)}if(ta.retrieve(E)===true){return}V=ta.retrieve("metaCheckRatesOverlay");if(!V&&!Z){return}Q=false;if(V){Q=V.inner}if(ta.has("metaCheckRatesUpdateDiv")){Q=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}if(Z&&ta.has("metaCheckRatesUpdateDivInline")){Q=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}}catch(W){ta.util.error.record(W,"overlayRequest setup")}if(!Q){return}try{if(ta.commerce.meta.polling.isRequestBeingPolled(E)){U=ta.commerce.meta.polling.getPollingAttemptForRequest(E);if(!U||U>y){ta.commerce.meta.polling.removePollingInfoForRequest(E);return}}else{U=1;ta.commerce.meta.polling.setPollingAttemptForRequest(E,U)}if(!Q.innerHTML.contains("hacComplete")){x=false;if(Z){x="QC_Meta_Inline"}if(!O){O=1}var J=ta.meta.update.buildUrl("MetaCheckRatesAjax",R,true,G,x,O);setTimeout(function(){new Request({url:J,onSuccess:function(aa){if(ta.retrieve(E)){return}if(ta.retrieve("metaCheckRatesOverlay")||ta.retrieve("metaCheckRatesUpdateDivInline")){Q.innerHTML=aa;ta.fireEvent("refreshedDOMContent",Q);if(ta.retrieve("checkrates.meta_ui_sk_box")){ta.commerce.meta.restoreProviderHover()}}if((ta.meta.update.getMetaPricesCount(Z)>0||U>9)&&ta.commerce.meta.hacIsBlockingXSell(Z)){if(Z){ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:false,inline:true})}else{ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:false,inline:false})}}ta.commerce.meta.polling.incrementPollingAttemptForRequest(E);ta.meta.update.overlayRequest(R,T,Z,O+1,G)},evalScripts:true}).send()},ta.commerce.meta.polling.getPollingWaitTimeForRequest(E))}else{try{ta.commerce.meta.polling.removePollingInfoForRequest(E);C=ta.id("META_HAC_DATE_HEADLINE");if(C){var Y=C.getElements(".headlineLegend");if(Y.length>=2){Y.forEach(function(aa){aa.addClass("hidden")});if(Q.getElement(".anyOfferCompletedSuccessfully")){Y[0].removeClass("hidden");ta.commerce.meta.hideBestPriceXsell("REC_CONT")}else{if(Q.getElement(".partnersAllNotAvailable")&&Y.length>2){Y[2].removeClass("hidden");if(Z){ta.commerce.meta.loadBestPriceXsell(R,"REC_CONT_INLINE",{isInline:true});ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:false,inline:true})}else{var B={isMetaLighboxV3:ta.retrieve("meta_lightbox_v3.enabled")};if(!ta.id("META_PRICE_XSELL")){ta.commerce.meta.loadBestPriceXsell(R,"REC_CONT",Object.merge(B,{isInline:false}))}ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:false,inline:false})}}else{Y[1].removeClass("hidden");ta.commerce.meta.hideBestPriceXsell("REC_CONT")}}}}if(V){ta.commerce.meta.storeMiniData(V.inner)}if(ta.retrieve("assisted_booking_desktop_entry.logTreePoll")&&Q){var S=Q.getElement(".impressionTrackingTree");if(S){ta.trkImpTree(S)}}K=i(Q);N="complete";if(Z){if(ta.id("COMHVY")){F="Mini-Meta";if(ta.find(".NotShowing .postClickPrice")){N+="_may_be_available"}else{if(ta.find("#HotelDateSearch .price .minCost")){if(ta.find(".strikeHigh")){N+="_available_lp_chevron"}else{N+="_available"}}else{N+="_unavailable"}}}else{F="Metainline"}}else{F="meta_lightbox"}if(Q.innerHTML.contains("doneNoAvailability")){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_EMPTY",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount());if((ta.id("MAYBE_BUTTONS_INLINE")&&Z)||(ta.id("MAYBE_BUTTONS")&&!Z)&&F!="Mini-Meta"){N+="|may_be_availabile"}else{if(F!="Mini-Meta"){N+="|unavailable"}}}else{ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_PRESENT",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount())}ta.trackEventOnPage(F,N,K.toString());ta.commerce.meta.showLowestPriceCTA(Z);ta.fireEvent("MetaLightboxHacComplete");H=ta.find(".overlay .skv3");if(H&&H.hasAttribute("data-sponsor")){var z=H.getAttribute("data-sponsor");ta.maps.ads.injectMetaLightBoxAd(z)}}catch(W){ta.util.error.record(W,"overlayRequest - failure in complete results block")}}}catch(W){ta.util.error.record(W,"meta HAC - ajax requests")}};n.displayRemainingProviders=function(A){try{var z=ta.id("CHECK_RATES_CONT");var y=z.getElements("li");for(var x=y.length;x--;){y[x].removeClass("hide")}A.hide();ta.store("checkrates.mini_meta_by_percent_cpc_see_all_click",true)}catch(B){ta.util.error.record(B,"displayRemainingProviders")}};n.updateCRForm=function(x){try{if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers();return}var J=ta.id("HotelDateSearch"+x);var I=ta.id("HotelDateSearch");var B=["select","input[type=checkbox]","input[type=hidden]","input[type=text]"];if(J&&I){for(var E=B.length;E--;){var z=B[E];var L=I.getElements(z);var A=J.getElements(z);for(var D=A.length;D--;){var K=A[D];var H=K.id.split("_")[0];for(var C=L.length;C--;){var G=L[C];if(G.id.contains(H)){if(z=="input[type=checkbox]"){var M=G.getParent("li");if(M&&!M.hasClass("unavailable")){var y=K.getParent("li");if(y){y.removeClass("unavailable")}}}if(z=="select"){K.selectedIndex=G.selectedIndex}else{if(z=="input[type=checkbox]"&&x!="_pop"){K.checked=G.checked}else{if(!K.id.contains("hacPid")){K.value=G.value}}}}}}}}}catch(F){ta.util.error.record(F,"updateCRForm")}};n.getMetaPricesCount=function(x){var z=0,B;var y=ta.retrieve("metaCheckRatesOverlay");var A=false;if(y){A=y.inner}if(ta.has("metaCheckRatesUpdateDiv")){A=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}if(x&&ta.has("metaCheckRatesUpdateDivInline")){A=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}if(!A){return}B=A.getChildren("#HR_HACKATHON_CONTENT .roomPrice");if(B){z=B.length}return z};function c(C){var B=ta.id("PROVIDER_BLOCK");if(!B){return}if(typeof CDNHOST!="undefined"){var A='<img class="provLoading" src="'+CDNHOST+'/img2/meta_sprites/loadingAnim.gif">';B.getElements(".rightBox").each(function(D){D.setContent(A)})}var y=B.get("html");var x=1000;var z="metaHacRequest_"+x+"_cancel";ta.remove(z);new Request({url:ta.meta.update.buildUrl("MetaCheckRatesAjax",C,true),onSuccess:function(D){B.setContent(D);ta.fireEvent("refreshedDOMContent",B);ta.meta.update.overlayRequest(C)},onFailure:function(){B.setContent(y)}}).send()}function w(y,x){if(x=="pop"){ta.store("ta.meta.request.locId",y);ta.store("ta.meta.request.placement",x);ta.run("ta.overlays.Factory.metaCheckRatesOverlay")}else{if(x=="met"||x=="solb"){if(!ta.has("meta.widget")){c(y)}}}}function i(z){var A;var B;var x=0;var y=0;z=ta.id(z);B=z.getChildren("#HR_HACKATHON_CONTENT .roomPrice");A=z.getChildren("#HR_HACKATHON_CONTENT .textLinks .offer .price");if(B){x=B.length}if(A){y=A.length}return x+y}function l(B,F,K,J,D){if(ta.retrieve("tablet_maps_v1")&&ta.retrieve("maps_v2_open")){return}if(!K){K=0}if(!J){J=false}var G="miniMetaHacRequest_curCancelKey";var E=13;if(F==null){F=new Date().getTime()}var C="miniMetaHacRequest_"+F+"_cancel";if(ta.retrieve(C)===true){return}if(ta.has(G)){var M=ta.retrieve(G);if(M!=C){ta.store(M,true);ta.commerce.meta.polling.removePollingInfoForRequest(M)}}if(!ta.has(C)){ta.store(C,false);ta.store(G,C)}var L;if(ta.commerce.meta.polling.isRequestBeingPolled(C)){L=ta.commerce.meta.polling.getPollingAttemptForRequest(C);if(!L||L>E){ta.commerce.meta.polling.removePollingInfoForRequest(C);return}}else{L=1;ta.commerce.meta.polling.setPollingAttemptForRequest(C,L)}var y=[];if(J){var I=$$("#CHECK_RATES_CONT div.premium:not(.tripConnectDemo)");for(var A=0;A<I.length;A++){var z=I[A].get("data-contentid");y.push(parseInt(z,10))}}if(K<1){var H;if(ta.has(b)){H=ta.retrieve(b);clearTimeout(Number.from(H))}if(ta.has(f)){H=ta.retrieve(f);clearTimeout(Number.from(H))}H=setTimeout(function(){u()},ta.commerce.minimeta.ajax.MINI_META_STOP_LOADING_TIMEOUT);ta.store(b,Number.from(H))}var x=ta.retrieve("hotels.datesChanged");if(x&&ta.has("hac_timezone_awareness")){n.clearDatesBumpedMessage()}new Request({url:ta.meta.update.buildUrl("MiniMetaCRAjax",B,true,null,"QC_Meta_Mini",K,y,J,C,x,D),onSuccess:function(N){a(false,N,B,F,K,J,C,x)},evalScripts:true}).send()}n.clearDatesBumpedMessage=function(){var y=ta.id("HAC_DATES_MOVED_FORWARD");var x=document.getElement("#CHECK_RATES_CONT .legend.metaDatesChosen");if(y&&x){y.dispose();x.removeClass("hidden")}};function d(x){x.getChildren().each(function(y){var z=y.getAttribute("data-targetEvent");if(z){ta.fireEvent(z,y)}})}function a(H,I,O,R,K,y,C,x){if(ta.retrieve(C)===true){return}var F,W,M,J,Z;if(H){var U=ta.select("#CHECK_RATES_CONT fieldset")[0];I=U.get("html");F=new Element("div",{html:I});W=true;M=document.getElement(".similarCarousel");J=F.getChildren()}else{F=new Element("div",{html:I});d(F);W=I.contains("hacMiniComplete");M=document.getElement(".similarCarousel");J=Elements.from(I)}if(!M||K<1){ta.commerce.meta.updateProvArea(F.getElement(".postShowMetaCR"));ta.fireEvent("miniMetaOnHRUpdate",I)}if(!document.getElement(".dropdownMiniMeta")){var A=document.getElement(".postShowMetaCR");if(A){h(I,A)}}v(I);if(ta.retrieve("hotel_review_low_price_message")&&F.getElement(".price_alert_update")){var X=document.getElement("#PRICE_ALERT_RIBBON_CONTAINER");if(X){Z=X.getElementById("PRICE_ALERT_RIBBON");if(Z){Z.destroy()}Z=F.getElement(".price_alert_update").getElement(".price_alert_ribbon");if(Z){X.innerHTML=Z.outerHTML;ta.util.element.makeTextFitOneLine("#PRICE_ALERT_RIBBON",false);var L=Z.getElement(".priceAlertText b");if(W&&L&&L.innerHTML&&L.innerHTML.length>0){ta.trackEventOnPage("hotel_review_low_price_message","Display",L.innerHTML)}}}ta.fireEvent("priceAlertRibbonUpdated")}if(W&&!I.contains("bookableOffer")){window.fireEvent("hacComplete_noBookingOffersFound")}if(W||y){if(I.contains("bookableOffer")){ta.fireEvent("hacComplete_bookingOffersFound")}}var N=ta.id("HR_META_INTERSTITIAL");if(N){var T=document.getElement("#HR_HACKATHON_CONTENT fieldset");if(T){if(K<1&&!H){ta.store("show_hr_meta_interstitial",true);window.setTimeout(function(){ta.store("show_hr_meta_interstitial",false);N.addClass("hidden");T.removeClass("hr_meta_loading_hidden")},2000);T.addClass("hr_meta_loading_hidden");var G=document.getElement("#HR_HACKATHON_CONTENT .metaExplanation");if(G){G.addClass("hidden")}N.removeClass("hidden")}else{if(!N.hasClass("hidden")&&(!ta.retrieve("show_hr_meta_interstitial")||W)){N.addClass("hidden");T.removeClass("hr_meta_loading_hidden")}}}}if(ta.has("meta.isHackathonBC")&&!ta.has("hr_unavail_xsell_flyout")){ta.commerce.meta.horizontalXSell.updateHorizontalXSell(F,O)}if(!W&&ta.has("meta.isHackathonBC")&&I.contains("firstRequest")){var D=setTimeout(function(){r(O,R,K)},ta.commerce.minimeta.ajax.MINI_META_APPEAR_LOADING_TIMEOUT);ta.store(f,Number.from(D))}if(W&&ta.has(f)){var B=ta.retrieve(f);clearTimeout(Number.from(B))}var E=".metaDatesChosen",Y=".metaDatesChosen",V=ta.retrieve("meta.bc.bestPricesForYourStay");if(!W){if(ta.has("meta.isHackathonBC")&&I.contains("anyOfferCompletedSuccessfully")){ta.commerce.meta.updateHeaderMsg(Y,V);if(ta.has("guests_rooms_picker_3.enabled")){ta.commerce.meta.updateHeaderDates()}}if(ta.has("guests_rooms_picker_4.enabled")&&ta.overlays&&ta.overlays.NumberPickerOverlay){ta.overlays.NumberPickerOverlay.updateHeaderMsg(E)}ta.commerce.meta.polling.incrementPollingAttemptForRequest(C);setTimeout(function(){l(O,R,K+1,y)},ta.commerce.meta.polling.getPollingWaitTimeForRequest(C))}else{if(ta.has("meta.isHackathonBC")){var S=V;if(I.contains("allNotAvailable")){var P=ta.id("priceNotAvailMsg");if(P){S=P.innerHTML}else{S=ta.retrieve("meta.bc.pricesTravelSitesNotAvailDates")}}ta.commerce.meta.updateHeaderMsg(Y,S);if(ta.has("guests_rooms_picker_3.enabled")){ta.commerce.meta.updateHeaderDates()}if(ta.has("guests_rooms_picker_4.enabled")&&ta.overlays&&ta.overlays.NumberPickerOverlay){ta.overlays.NumberPickerOverlay.updateHeaderMsg(E)}if(ta.retrieve("meta.full_meta_photos")){var z=document.getElement(".metaDatesChosen");if(z){if(I.contains("allNotAvailable")){z.addClass("no_offers_available")}else{z.removeClass("no_offers_available")}}}ta.commerce.meta.polling.removePollingInfoForRequest(C);ta.commerce.meta.displayBlueChevronLowestPriceCTA();ta.fireEvent("HRHacComplete");if(!y){o(R,false)}var Q=document.getElement(".similarCarousel");if(y&&Q){g(I)}if(!H){setTimeout(function(){t()},1000)}}}ta.fireEvent("onHACUpdate",I);if(W&&!ta.retrieve("hotels_to_seo_hotels_redirect")&&x&&!y&&!ta.retrieve("meta.persist.visible")&&!(I.contains("cancelRedirect"))){if(I&&I.match(/\shacComplete\s.*\shacMiniOfferNotAvailable\s/g)){ta.trackEventOnPage("NoAvailability","redirect","",0,"/HotelHighlight")}if(I&&I.match(/\shacComplete\s.*\shasDisplayUnavailability\s/g)){ta.trackEventOnPage("MaybeAvailable","redirect","",0,"/HotelHighlight")}}if(W){ta.fireEvent("HRHacAvailabilityDetermined",{availability:ta.commerce.meta.getResponseAvailability(I),loadingTimeoutPassed:y,cancelRedirect:I.contains("cancelRedirect"),datesChanged:x,hasBookableOffer:I.contains("bookableOffer")})}k(W,F);s(R,W,y)}function h(z,x){var A=new Element("div",{html:z}),y=A.getElement(".dropdownMiniMeta");if(y){y.inject(x)}}function v(z){var x=document.getElement(".rgba_flyout.dropdownMiniMeta"),A,B,y;if(x){A=new Element("div",{html:z});y=A.getElement(".dropdownMiniMeta");if(y){B=x.getElement(".inner");B.innerHTML="";y.set("class","dropdownMiniMeta");B.adopt(y)}p()}}function p(){if(ta.retrieve("dropdownMiniMeta.hover")){ta.commerce.meta.hoverTopOffer()}else{if(ta.retrieve("dropdownMiniMeta.blur")){ta.commerce.meta.blurTopOffer()}}}function r(A,y,x){var z="miniMetaHacRequest_"+y+"_cancel";j();o(y,true);l(A,new Date().getTime(),x+1,true)}function e(x){var y="";if(ta.browser.isIE10Metro()){if(x=="QC_Meta_Book_Inline"){y="QC_Meta_Metro_Inline"}else{y="QC_Meta_Metro_Lightbox"}}else{if(!x){if(ta.has("ta.meta.navArea")){y=ta.retrieve("ta.meta.navArea")}else{if(ta.retrieve("maps_v2_open")){ta.trackEventOnPage("QC_Meta_Map_Detail","map_open")}y="QC_Meta_Lightbox"}}else{y=x}}return y}function u(){var z=document.getElement("#CHECK_RATES_CONT div.hacMiniComplete");var x=document.getElement("#CHECK_RATES_CONT div.hacMiniCompleteTimeOut");if(z||x){return}var y=document.getElement("div.bc_flags");if(y){y.addClass("hacMiniCompleteTimeOut")}j();t()}function j(y){var x=y?"metaHacRequest_curCancelKey":"miniMetaHacRequest_curCancelKey";if(ta.has(x)){var z=ta.retrieve(x);ta.store(z,true);ta.commerce.meta.polling.removePollingInfoForRequest(z)}}n.cancelAllMetaCurrentQuery=function(){j(false);j(true)};function q(){var z=document.getElements("#CHECK_RATES_CONT span.textLinkLoading");var y=document.getElements("#CHECK_RATES_CONT div.loading");var x=0;if(z){x+=z.length}if(y){x+=y.length}return x}function m(x,A){var y,z;if(!x||!A){return}y=A+"_suppressCommerceImpressionState";z=ta.commerce.meta.polling.getPollingAttemptForRequest(A);if(z){if(z===1){if(ta.retrieve("meta.isFromDatesChange")){ta.remove("meta.isFromDatesChange");ta.store(y,true);x+="&isFirstPageLoad=false";return x}}else{if(ta.retrieve(y)){x+="&isFirstPageLoad=false";return x}}}return x}function o(D,G){var z=0;var E="unknown";if(G){z=ta.commerce.minimeta.ajax.MINI_META_APPEAR_LOADING_TIMEOUT;var F=q();var y=document.getElements("#CHECK_RATES_CONT div.premium");var A=document.getElements("#CHECK_RATES_CONT span.textLink");var C=0;if(y){C+=y.length}if(A){C+=A.length}var x=C-F;if(C>0){var B=Math.round((x/C)*10)*10;if(B%10===0&&B>-1&&B<101){E=""+B+"percent"}}}else{z=new Date().getTime()-D;E="100percent"}ta.trackEventOnPage("HAC","HACComplete",E,z,true)}function g(B){var A=Elements.from(B)[0];if(!A){return}var z=A.getElementsByClassName("price");var y=A.getElementsByClassName("priceBlock");var x=0;if(z){x+=z.length}if(y){x+=y.length}ta.trackEventOnPage("HAC","StateCarouselDisplayed","",x,true)}function t(){var x=q();if(x>0){ta.trackEventOnPage("HAC","HACError","LoadingAfterHACComplete",x,true)}}function k(z,x){if(z&&ta.retrieve("ibdm_impression_tracking")){var A=x.getElements(".impressionTrackingTree");if(A){var y;for(y=0;y<A.length;++y){ta.trkImpTree(A[y])}}}}function s(A,z,x){if(z||x){var B="meta.lowestPricePromotionTracking.tracked"+A;if(ta.has("meta.lowestPricePromotionTracking")&&!ta.has(B)){var y=ta.retrieve("meta.lowestPricePromotionTracking");if(y&&y.bidDifference&&y.priceDifference&&y.bidDifference>=0.43&&y.priceDifference>=10){ta.store(B,true);ta.trackEventOnPage("lowest_price_promoted_impression",y.providers,y.bidDifference+"|"+y.priceDifference)}}}}})(ta.meta.update);if(!ta.meta){ta.meta={}}if(!ta.meta.cross_sell){ta.meta.cross_sell={}}(function(e){var f=0;var b=false;var c=0;e.relatedHoverOver=function(i,g){try{if(f!==0){return}if(g===0){a()}else{d((i)?(i.target||i.srcElement):null,g)}}catch(h){ta.util.error.record(h,"also viewed - avafIn")}};e.relatedHoverOut=function(j){try{if(f!=1||!b){return}if(!j){j=window.event}if(!j){return}var g=(j.relatedTarget)?j.relatedTarget:j.toElement;var i=ta.id("ALSO_VIEWED_LIST");while(g&&g!=i&&g.nodeName!="BODY"){g=g.parentNode}if(g==i){return}clearTimeout(b);b=false;f=0}catch(h){ta.util.error.record(h,"also viewed - avafOut")}};e.relatedExpand=function(g,i){var h,k;try{ta.trk("AVAF_EXPAND_"+(i?"MORE":"LESS"),false,(g)?(g.target||g.srcElement):null);if(i){h=ta.id("hideableMore");if(!h){return}h.addClass("hidden");h=ta.id("expand_av_on_more");if(!h){return}h.removeClass("hidden");if(c===0){h.addClass("expanding");c=h.getSize().y;h.removeClass("expanding")}h.addClass("show");new Fx.Tween(h,{duration:"long",property:"height"}).start(0,c)}else{h=ta.id("expand_av_on_more");if(!h){return}new Fx.Tween(h,{duration:"long",property:"height"}).start(h.getSize().y,0).chain(function(){h.removeClass("show");h.addClass("hidden");k=ta.id("hideableMore");if(!k){return}k.removeClass("hidden")})}}catch(j){ta.util.error.record(j,"also viewed - avafMore")}};e.relatedResetStateFlag=function(){f=0};function d(h,g){try{f=1;b=setTimeout(function(){a(h)},g)}catch(i){ta.util.error.record(i,"also viewed - avafWait")}}function a(h){try{ta.trk("AVAF_HOVER_EXPAND",false,h);f=2;var g=ta.id("expand_av_on_hover");if(!g){return}g.removeClass("hidden");g.addClass("expanding");var l=g.getSize().y;g.removeClass("expanding");g.addClass("show");var k=g.getParent("#AV_ABOVE_FOLD_META");if(k){k.setStyle("height","auto")}var j=new Fx.Tween(g,{duration:"long",property:"height"});j.start(0,l)}catch(i){ta.util.error.record(i,"also viewed - avafExpand")}}})(ta.meta.cross_sell);if(!ta.meta.cr){ta.meta.cr={}}(function(b){b.updateCRCalendar=function(c){if(c.form){a(c.form)}b.updateCRFormElement(this);if(ta.id("META_UI_INLINE")){ta.meta.update.updateCRForm("_imt")}};b.findInlineCRLocationId=function(){var g=null;var h=ta.id("HotelDateSearch");if(h){var c=h.getElements("input[type=text]");for(var f=c.length;f--;){var d=c[f];var e=d.id.match(/_(\d+)/);if(e.length){g=e[1];break}}}return g};b.updateCRFormElement=function(g){try{g=ta.id(g);var o=g.get("tag").toLowerCase();if(o=="li"){g=g.getElement("input[type=checkbox]")}var h=g.id.split("_")[0],k=this.findInlineCRLocationId(),n=h+"_"+k,f=g.id,c=f.substring(f.length-4),r=[n,n+"_icr",n+"_per",n+"_imt"],j,q,d,m,p;if(this.crSyncExtensions.contains(c)){for(j=r.length;j--;){n=r[j];if(n!=f){p=ta.id(n);if(p){if(o=="li"&&c!="_pop"){p.checked=g.checked;q=g.getParent("li");if(q&&!q.hasClass("unavailable")){d=p.getParent("li");if(d){d.removeClass("unavailable")}}}else{if(o=="select"){p.selectedIndex=g.selectedIndex}else{if(o=="input"){m=n.substring(n.length-4);if(!this.crSyncExtensions.contains(m)){m=""}this.updateCRFormElement_In(k,g,c,m)}}}}}}}}catch(l){ta.util.error.record(l,"updateCRFormElement")}};b.getPropIdFromCRElement=function(d){if(d){var c=null;if(c=d.className.match(/id_(\d+)/)){return c[1]}}return null};b.removePCR=function(){var c=ta.retrieve("pcr.overlay");if(c){c.hide()}};b.availCheck=function(d){var c=ta.id("availability")&&ta.id("availability").value=="1";var f=ta.id(d).getElement(".overlaySrc");if(c&&f){var e=f.innerHTML;f.innerHTML=e.replace(/cid=(\w+_)?&amp;/,"")}};b.crSyncExtensions=["_pop","_icr","_pto","_per","_amo","_cro","_met","_imt","_pal","_inm"];function a(c){if(ta.retrieve("checkrates.datesChanged")){return}try{var d=ta.id(c);d.getElements(".unavailable").each(function(e){e.removeClass("unavailable");if(e.hasClass("js_ua_checked")){e.getElements("input").set("checked",true)}ta.meta.update.updateCRFormElement(e)});ta.store("checkrates.datesChanged",true)}catch(g){ta.util.error.record(g,"_showSuppressedProviders")}}})(ta.meta.cr);define("ta/sales/metaImpressionComScoreTag",["vanillajs","api-mod","ta/Core/TA.Event"],function(g,f,h){var e=function(m,n,o){this.providerName=m;this.vendorName=n;this.trackingPixel=o;this.alreadyTracked=false};var a=[];var i=function(n){var m=document.querySelectorAll(n);if(m.length>0){[].slice.call(m).forEach(function(o){a.forEach(function(p){k(o,p)})});a=a.filter(function(o){return !o.alreadyTracked});if(!j()){b()}}return false};var j=function(){return a.length>0};var k=function(m,n){if(((n.providerName&&m.getAttribute("data-provider")===n.providerName)||(n.providerName&&m.getAttribute("data-offer-author")===n.providerName)||(n.vendorName&&m.getAttribute("data-vendorname")===n.vendorName))&&!f.hasClass(m,"hidden")){c(n.trackingPixel);n.alreadyTracked=true}};var c=function(n){var o=n+Math.floor(Math.random()*100000);var m=document.createElement("img");m.className="tracking";m.src=o;m.height=m.width=0;document.body.appendChild(m)};var l=function(){h.on("HotelsHacComplete",d.chkHotels);h.on("HRHacComplete",d.chkHR);h.on("MicroMetaHacComplete",d.chkMicroMeta);h.on("MetaLightboxHacComplete",d.chkLightbox);h.on("MetaFetchComplete",d.chkMapDetailCard);h.on("MetaFetchComplete",d.chkSmartDeals);h.on("MapListMetaComplete",d.chkMapListCard)};var b=function(){h.off("HotelsHacComplete",d.chkHotels);h.off("HRHacComplete",d.chkHR);h.off("MicroMetaHacComplete",d.chkMicroMeta);h.off("MetaLightboxHacComplete",d.chkLightbox);h.off("MetaFetchComplete",d.chkMapDetailCard);h.off("MetaFetchComplete",d.chkSmartDeals);h.off("MapListMetaComplete",d.chkMapListCard)};var d={chkLightbox:function(){if(!j()){return}i(".overlay #PROVIDER_BLOCK .metaLbOffers .offer.premium")},chkMicroMeta:function(){if(!j()){return}i("#micro_meta_ajax .provider")},chkHotels:function(){if(!j()){return}i("#PAGE .metaPriceInfo .header")},chkMapDetailCard:function(){if(!j()){return}i(".mapsv2-detail-info .mapsv2-chevron")},chkMapListCard:function(){if(!j()){return}i(".mapsv2-listcard .mapsv2-listitem .mapsv2-dropdownfirstitem")},chkSmartDeals:function(){if(!j()){return}i("#AVAILABLEHOTELDEALS .lpContainer .offer")},chkHR:function(){if(!j()){return}i("#CHECK_RATES_CONT .offer.premium:not(.remaining):not(.noLink)")},addTrackingProvider:function(m,n,o){if(m&&m.length>0&&n&&n.length>0&&o&&o.length>0){a.push(new e(m,n,o))}},registerEvents:function(){if(a.length===0){return}l()}};return d});define("ta/sales/bwIBImpressionComscoreTag",["vanillajs","ta/Core/TA.Event"],function(k,l){var b="https://sb.scorecardresearch.com/",p="http://b.scorecardresearch.com/",a=(("https:"===document.location.protocol?b:p)+"p?c1=3&c2=6036461&c3=ALBwesternAgst15&c4=ibimpressions&c5=ibimpression&c6=&c10=1&c11=&c13=1x1&c16=gen&cj=1&ax_fwd=1&rn="),o="BestWestern",e="TripAdvisor";var f=function(){var q=a+Math.floor(Math.random()*100000);document.body.appendChild(new Element("img",{"class":"tracking",src:q,height:"0",width:"0"}))};var m=function(){f();h()};var j=function(){var q=document.querySelector(".hacComplete #META_SBS_TRACKING_DUMMY[data-provider="+o+"]");if(q){m()}};var i=function(q){if(document.querySelector(q)){m()}};var g=function(){i(".metaContent .offer.bookableOffer[data-vendorname="+e+"][data-offer-author="+o+"]")};var d=function(){i(".metaPriceInfo .header.bookableOffer[data-provider="+o+"]")};var n=function(){i("#AVAILABLEHOTELDEALS .sdBlueChevron:not(.hidden) .offer.bookableOffer[data-ibpartner="+o+"]")};var c=function(){l.on("hacComplete_bookingOffersFound",j);l.on("hacComplete_bookingOffersFound",g);l.on("HotelsHacComplete",d);l.on("BlenderHacComplete",d);l.on("MetaFetchComplete",n)};var h=function(){l.off("hacComplete_bookingOffersFound",j);l.off("hacComplete_bookingOffersFound",g);l.off("HotelsHacComplete",d);l.off("BlenderHacComplete",d);l.off("MetaFetchComplete",n)};return{registerIBImpressionTrackingEvents:c}});define("ta/sales/metaClickComScoreTag",["vanillajs","ta/util/Error","ta/Core/TA.Event"],function(h,c,i){var j=["vendorname","provider","locationid"];var g=function(p){if(!window||!window.IS_DEBUG){return}var r=document&&document.location&&document.location.pathname;if(!p){throw new Error("Click attributes are empty, pathname="+r)}for(var q=0;q<j.length;q++){if(!p[j[q]]){c.record(null,"Missing click attribute: "+j[q]+". Pathname="+r)}}};function k(p){if(p){this.providerName=p.providerName;this.vendorName=p.vendorName;this.trackingPixel=p.trackingPixel;this.brandName=p.brandName;this.locationIds=p.locationIds}if(this.vendorName&&this.trackingPixel){this.valid=true}else{this.valid=false}}var b="TripAdvisor",l="All",a=[],e=new RegExp(/\[timestamp\]/);var n=function(t){if(t&&t.dataset){g(t.dataset);for(var r=0;r<a.length;r++){var u=a[r].providerName;var w=a[r].vendorName;var v=a[r].brandName;var q=a[r].trackingPixel.replace(e,new Date().getTime());var s=a[r].locationIds;if(b===t.dataset.vendorname&&b===w){if(u===t.dataset.provider||u===l){if(!v){d(q,u,"IB")}if(v&&v===t.dataset.brandname){var p=t.dataset.locationid;if(!s||s&&p&&s.includes(p)){d(q,v,"IB")}}}}else{if(b!==t.dataset.vendorname&&b!==w&&w===t.dataset.vendorname){d(q,w,"meta")}}}}};var m=function(){return a.length};var d=function(t,q,s){var p=document.createComment("Activity name for this tag: "+q+" "+s+" click page view tag");var r=document.createElement("img");r.src=t;r.height="1";r.width="1";r.border="0";r.setAttribute("style","display:none");document.body.appendChild(p);document.body.appendChild(r)};var o=function(){i.on("metaLinkClick",f.chkMetaClick)};var f={};f.chkMetaClick=function(p){if(!m()){return}n(p)};f.addTrackingProvider=function(p){var q=new k(p);if(q&&q.valid){a.push(q)}else{throw new Error("ta.sales.metaClickTag :: Tracker invalid : "+p.trackingPixel?p.trackingPixel:"missing tracking pixel")}};f.registerEvents=function(){if(!m()){return}o()};return f});require(["ta/rollupAmdShim"],function(a){a.install(["ta/util/Object"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"ta-core-without-lite",files:{js3:{src:{ta:{util:{Object:1}}}}},_:{baseUrl:"/"}})};(function(a,b){var c=function(e){var d=false;new Request({url:"/AuthCheck",data:{product:e},async:false,method:"get",onSuccess:function(f){if("true"===f.trim()){d=true}}}).send();return d};b.isAuthorized=function(d){return c(d)};b.register=function(g,f){var e="Deprecated_registration_register_";if(g&&g.hasOwnProperty("product")){e=e+g.product}a.util.error.record(null,e);if(g.popup){return a.registration.popup.open(g,f)}var h={servlet:"Register",action:"SIGNIN",data:function(){return{}}};var d=a.retrieve("ta.registration.currentUrlDefaults");g=a.util.merge(h,d,g||{},f||{});if(!g.product){return false}if(c(g.product)){return true}if(g.successAction){a.registration.setSuccessActionCookie(g.successAction)}require(["utils/post"],function(i){i({url:"/"+g.servlet,https:true,data:{product:g.product,action:g.action,url:g.url,urlKey:g.urlKey,partnerKey:g.partnerKey,data:JSON.encode(g.data())}})});return false};b.popup={defaultWidth:547,defaultHeight:435,options:null,urloptions:null,isPopup:null,open:function(o,p){a.registration.popup.options=o;a.registration.popup.urloptions=p;var i={servlet:"Register",action:"SIGNIN",data:function(){return{}}};var f=a.retrieve("ta.registration.currentUrlDefaults");o=a.util.merge(i,f,o||{},p||{});if(!o.product){return false}if(c(o.product)){return true}var l=document.location;var k=l.protocol+"//"+l.host;if(l.port){k+=":"+l.port}var e=k.replace("http://","https://")+"/"+o.servlet;var m=[];m.push("popup=true");m.push("product="+o.product);m.push("action="+o.action);m.push("url="+o.url);m.push("urlKey="+o.urlKey);m.push("partnerKey="+o.partnerKey);m.push("data="+JSON.encode(o.data()));e=e+"?"+m.join("&");var g=a.registration.popup.defaultWidth;var n=a.registration.popup.defaultHeight;var h=(screen.width-g)/2;var j=(screen.height-n)/2;var d=window.open(e.toString(),"registration","width="+g+", height="+n+", top="+j+", left="+h+", resizable=yes, scrollbars=yes");if(!d&&!isTabletOnFullSite){a.registration.popup.fallback()}return false},init:function(){if(a.registration.popup.isPopup==null){a.registration.popup.isPopup=isTabletOnFullSite||(window.opener&&window.getSize().x<(a.registration.popup.defaultWidth+150))}if(a.registration.popup.isPopup){var f=a.id("REG_CON");if(f){var e=f.getElement("div.regDlg");if(!e){e=f.getElement("div.whyDlg")}if(e){a.registration.popup.resize(e)}}var d=a.id("SS_SSO");if(d){var g=d.getElement("input[type=button]");if(g){g.addEvent("click",function(){a.registration.popup.resizeTo(980,560,true)})}}}else{window.location="/RegisterDone?fallback=true"}},done:function(e,g){if(window.opener){var f=window.opener;if(f.ta){if(g){a.registration.popup.fallback(true)}else{var d;if(f.ta.registration&&f.ta.registration.popup.options){d=f.ta.registration.popup.options.successAction}if(d){f.ta.registration.runSuccessAction(d)}else{if(e){f.location=e}}a.registration.popup.updateMasthead(a.registration.popup.close)}}else{a.registration.popup.close()}}else{if(e){a.registration.returnTo(e)}}},close:function(){if(window.opener&&window.opener!=window){window.opener=window;window.close()}},updateMasthead:function(i){var f=0;var h=setInterval(function(){f++;var j=a.id("avatarImage");if(h>20||!j||j.get("src")){clearInterval(h);try{if(window.opener&&window.opener.ta){e();g()}}catch(k){a.util.error.record(k,"secure popup - unable to update masthead",null,{},"WARN")}if(i){i()}}},250);var d=function(k){if(k&&window.opener){var j=new Element("div").adopt(k).innerHTML;if(j){k=window.opener.Elements.from(j)}}return k};var e=function(){var k=window.opener.document.getElement("head");var j=a.id("IP_HEADER_CSS");if(k&&j){j=d(j);if(j){k.adopt(j)}}};var g=function(){var j=a.id("USER_PREFS");var k=window.opener.ta.id("USER_PREFS");if(j&&k){j=d(j);if(j){j.replaces(k)}}}},fallback:function(e){var f=window;if(e&&window.opener){f=window.opener}f.focus();if(f.ta&&f.ta.registration){var d=f.ta.registration.popup;if(d.options){d.options.popup=false;f.ta.registration.register(d.options,d.urloptions)}}if(e){a.registration.popup.close()}},resize:function(f){if(f){a.registration.popup.disableScrollBars();var e=f.getScrollSize().x;var d=f.getScrollSize().y;window.onresize=function(){window.onresize=null;var h=e-window.getSize().x+1;var g=d-window.getSize().y+1;if(h!=0||g!=0){window.onresize=function(){window.onresize=null;a.registration.popup.center(e+h,d+g);a.registration.popup.enableScrollBars()};a.registration.popup.resizeBy(h,g)}else{a.registration.popup.enableScrollBars();a.registration.popup.center()}};a.registration.popup.resizeTo(e,d)}},resizeTo:function(f,e,d){if(d){window.onresize=function(){window.onresize=null;a.registration.popup.center()}}window.resizeTo(f,e)},resizeBy:function(f,e,d){if(d){window.onresize=function(){window.onresize=null;a.registration.popup.center()}}window.resizeBy(f,e)},center:function(g,d){if(!g){g=window.getSize().x}if(!d){window.getSize().y}var f=(screen.width-g)/2;var e=(screen.height-d)/2;window.moveTo(f,e);window.focus()},disableScrollBars:function(){window.document.getElement("body").setStyle("overflow","hidden")},enableScrollBars:function(){window.document.getElement("body").setStyle("overflow")}};(function(e,g){var j="1070328450902.apps.googleusercontent.com";var d={cookiepolicy:"single_host_origin",requestvisibleactions:"http://schemas.google.com/AddActivity",clientid:j,client_id:j,immediate:false,apppackagename:"com.tripadvisor.tripadvisor"};var f=0;function i(){e.store("registration.google.avail",true);var k=e.remove("registration.google.onAvail");k&&k.each(function(l){l()})}function h(){if(typeof d.scope==="undefined"){var k=["https://www.googleapis.com/auth/plus.login","https://www.googleapis.com/auth/userinfo.email"];if(e.retrieve("google_wallet_permission_desktop_signin.enabled")){k.push("https://www.googleapis.com/auth/payments.make_payments")}d.scope=k.join(" ")}return d}g.google={init:function(k){if(k){g.google.onAvail(k)}new Asset.javascript("https://plus.google.com/js/client:plusone.js",{onLoad:function(){if(gapi&&gapi.auth){gapi.auth.init(i)}else{var l=setInterval(function(){if(gapi&&gapi.auth){clearInterval(l);gapi.auth.init(i)}},100)}}})},onAvail:function(k){if(e.retrieve("registration.google.avail")){k()}else{e.keep("registration.google.onAvail",k)}},connect:function(l,k,n){k=k||"MASTHEAD";var m={flow:k};if(0===k.indexOf("EMAIL_ONLY_SIGNUP")){Object.merge(m,{isOverlay:false});if(typeof n==="function"){Object.merge(m,{responseCallback:n})}}if(l){f=l}if(typeof gapi=="undefined"){e.registration.google.init(e.registration.google.connect)}else{if(!e.has("google.sso.sending")){e.store("google.sso.sending",true);gapi.auth.signIn(Object.merge({callback:function(p){if(p&&p.status&&p.status.signed_in&&p.access_token){if(!e.has("google.sso.receiving")){e.remove("google.sso.sending");e.store("google.sso.receiving",true);var o="/GoogleRegistration?google_token="+p.access_token+"&pid="+f;new Request.JSON({url:o,method:"get",onSuccess:function(q){e.remove("google.sso.receiving");if(q.success){if(q.created){e.overlays.registration.connect(m,"GOOGLE_SIGNUP")}else{if(q.connected){e.overlays.registration.request("GOOGLE_THANKS",{google_token:p.access_token},m)}else{e.overlays.registration.cancel(m)}}}},onError:function(){e.remove("google.sso.receiving")},onFailure:function(){e.remove("google.sso.receiving")}}).send()}}}},h()))}}},ifConnected:function(l,k){if(gapi&&gapi.auth){gapi.auth.authorize({client_id:j,immediate:true,scope:h().scope.split(" ")},function(n){if(n&&n.status&&n.status.signed_in){var m="/GoogleRegistration?google_token="+n.access_token+"&verify=true";var o=e.retrieve("google.sso.returnTo");if(o){m+="&returnTo="+o}new Request.JSON({url:m,method:"get",onSuccess:function(p){if(p.success&&l){l()}else{if(k){k()}}},onFailure:k}).send()}else{if(k){k()}}})}else{k()}},ifLoggedIn:function(m,k){if(typeof gapi!="undefined"&&gapi.auth){var l={client_id:j,session_state:null};gapi.auth.checkSessionState(l,function(n){if(n===false){m()}else{if(k){k()}}})}},disconnect:function(){if(typeof gapi=="undefined"){e.registration.google.init(e.registration.google.disconnect)}else{gapi.auth.authorize(h(),function(k){if(k&&k.access_token){new Request.JSONP({url:"https://accounts.google.com/o/oauth2/revoke?token="+k.access_token,method:"get",onSuccess:function(){e.overlays.registration.post({action:"GOOGLE_DISCONNECT"})}}).send()}})}}}})(a,b);(function(f,h){var e=4194307;var i=656;var g=382;var d=null;h.vkontakte={connect:function(k,p,l){if(k){new Request({url:"/ActionRecord?action=vkAuthAttempt&pid="+k}).send()}if(f.retrieve("vk.sso.clicked")&&d&&d.window){d.window.close();f.store("vk.sso.clicked",false)}if(!f.retrieve("vk.sso.clicked")){f.store("vk.sso.clicked",true);var o=(screen.height-g)/2;var j=(screen.width-i)/2;var n="https://oauth.vk.com/authorize?client_id="+l+"&scope="+e+"&redirect_uri=https%3A%2F%2F"+location.hostname+"%2FVKRegistration";if(p){n+="Masthead"}d=window.open(n,"registration","width="+i+", height="+g+", top="+o+", left="+j+", resizable=yes, scrollbars=yes");if(!d){f.store("vk.sso.clicked",false);new Request({url:"/Actionrecord?action=vkAuthPopupBlocked&pid=39094"}).send();if(!p){this.showSSOError(f.retrieve("popupBlockerSSOError"))}}else{var m=setInterval(function(){if(d.closed){clearInterval(m);if(p){document.window.location.reload()}f.store("vk.sso.clicked",false)}},500)}}},registrationSuccess:function(){f.overlays.registration.connect({flow:"MASTHEAD"},"VK_SIGNUP")},loginSuccess:function(){f.overlays.registration.request("SIGNIN")},showSSOError:function(j){f.store("vk.sso.clicked",false);var k=f.id("ssoErrorMessage");if(k){k.removeClass("hidden");k.set("html",j)}},done:function(k,j){try{if(window.opener.ta&&window.opener.ta.retrieve("vk.sso.clicked")){this.performPostAuthAction(k,j)}}catch(l){window.close()}window.close()},doneMasthead:function(){window.close()},performPostAuthAction:function(j,k){var l=window.opener;l.ta.store("vk.sso.clicked",false);if(j){if(l.ta.registration.vkontakte){if(j==="vkLogin"){l.ta.registration.vkontakte.loginSuccess()}else{if(j==="vkSignup"){l.ta.registration.vkontakte.registrationSuccess()}else{if(j==="error"){if(k){l.ta.registration.vkontakte.showSSOError(k)}}}}}}},disconnect:function(){f.overlays.registration.post({action:"VK_DISCONNECT"})}}})(a,b);b.done=function(d,e){if(window.opener){a.registration.popup.done(d,e)}else{a.registration.returnTo(d)}};b.returnTo=function(d){if(window.opener){window.opener.location=d;a.registration.popup.close()}else{window.location=d}};b.runSuccessAction=function(f,h){var i=f.split("|");try{var d=i.slice(1);d.unshift({});d.unshift(i[0]);if(h){d.push(h)}a.run.apply(null,d)}catch(g){a.util.error.record(g,"successAction",null,{funcName:i[0]})}};b.runSuccessActionCookie=function(){var d=a.registration.getSuccessActionCookie();if(d){a.registration.runSuccessAction(d,true)}};b.setSuccessActionCookie=function(d){Cookie.write("successAction",window.pageServlet+"|"+d,{domain:cookieDomain,path:"/"})};b.getSuccessActionCookie=function(){if(window==window.top){var f=Cookie.read("successAction");if(f){var d=f.split("|");var e=d[0];d=d.slice(1);if(window.pageServlet==e){Cookie.dispose("successAction",{domain:cookieDomain,path:"/"});return d.join("|")}}}return};a.queueForLoad(function(){a.registration.runSuccessActionCookie()},"registration.runSuccessActionCookie")}(ta,ta.registration));require(["ta/rollupAmdShim"],function(a){a.install(["utils/post","ta/util/Keys"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"registration",files:{"js-amd":{src:{utils:{post:1}}},js3:{src:{ta:{util:{Keys:1}}}}},_:{baseUrl:"/"}})};define("utils/post",["vanillajs","utils/urlutils"],function(b,a){return function(d){if(!d||!d.url||!d.data){return false}d.url=d.https?a.https(d.url):a.getAbsoluteUrl(d.url);var f=document.createElement("form");f.setAttribute("method","post");f.setAttribute("action",d.url);for(var e in d.data){if(d.data.hasOwnProperty(e)){var c=document.createElement("input");c.setAttribute("type","hidden");c.setAttribute("name",e);c.setAttribute("value",d.data[e]);f.appendChild(c)}}document.body.appendChild(f);f.submit()}});define("ta/util/Keys",["lib/jquery-amd","ns-exporter"],function(b,c){var a={onEnterKey:function(h,f,g){var d;if(window.event){d=window.event.keyCode}else{if(h){d=h.which}}if(d==13){if(typeof(f)==="function"){f()}return false}else{if(typeof(g)==="function"){g()}return true}},onEnterKeyClickSibling:function(f,d){return a.onEnterKey(f,function(){if(f.target){var e=b(f.target).siblings(d);if(e.length){e[0].click()}}})}};c.exportTo(a,"ta.util.keys");return a});ta.common.flyout=ta.common.flyout||{};ta.common.flyout.memberOverlay=ta.overlays.Factory.memberOverlay;ta.common.flyout.showRecentLocationEmailOverlay=ta.overlays.Factory.showRecentLocationEmailOverlay;ta.common.sendmessage.showSendMessage=ta.overlays.Factory.showSendMessage;ta.servlet.Hotel.showReviewSummary=ta.overlays.Factory.showReviewSummary;ta.servlet.Hotel.showTranslationReviewSummary=ta.overlays.Factory.showTranslationReviewSummary;tamgShowLightbox=ta.overlays.Factory.tamgShowLightbox;var StringBuffer=new Class({initialize:function(a){this.strings=new Array();if(a){this.append(a)}},append:function(a){this.strings.push(a);return this},toString:function(){return this.strings.join("")},isEmpty:function(){return this.strings.length==0}});var Table=new Class({Implements:[Options],options:{properties:{cellpadding:0,cellspacing:0,border:0},rows:[]},initialize:function(a){this.setOptions(a);this.table=new Element("table").setProperties(this.options.properties);this.tbody=new Element("tbody").inject(this.table);this.options.rows.each(this.push.bind(this))},push:function(d,c,a){var b=new Element("tr").inject(c||this.tbody);d.each(function(e){var f=new Element(a?"th":"td").inject(b);if(e.properties){f.setProperties(e.properties)}if(e.content){f.setContent(e.content)}else{f.setContent(e)}});return this},pushHead:function(a){if(!this.thead){this.thead=new Element("thead").inject(this.table,"top")}this.push(a,this.thead,true);return this},pushFoot:function(a){if(!this.tfoot){this.tfoot=new Element("tfoot").inject(this.table)}this.push(a,this.tfoot);return this},pushCaption:function(a){new Element("caption").setContent(a).inject(this.table,"top");return this}});var TabSet=new Class({Implements:[Options,Events],options:{onActive:function(){},onBackground:function(){},show:0,collapsable:false},initialize:function(){var a,b,c;Array.each(arguments,function(f,e){switch(typeOf(f)){case"object":a=f;break;default:var d=$$(f);if(!b){b=d}else{c=d}}});this.togglers=b||[];this.elements=c||[];this.setOptions(a);this.elements.each(function(e,d){this.togglers[d].addEvent("click",this.display.bind(this).partial(Function._,d));if(this.options.show===d){e.show();this.previous=d;this.fireEvent("onActive",[null,this.togglers[d],e])}else{e.hide()}},this)},display:function(b,a){if(this.options.collapsable&&a==this.previous){if(this.elements[a].isHidden()){this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);this.elements[a].show()}else{this.fireEvent("onBackground",[b,this.togglers[a],this.elements[a]]);this.elements[a].hide()}return this}if(this.previous||this.previous===0){this.elements[this.previous].hide();this.fireEvent("onBackground",[b,this.togglers[this.previous],this.elements[this.previous]])}this.previous=a;this.elements[a].show();this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);return this}});var ToggleSet=new Class({initialize:function(b,c,a){this.index=a||0;this.togglers=b||[];this.elements=c||[];this.togglers.each(function(e,d){this.togglers[d].addEvent("click",this.display.bind(this,d));this.elements[d].hide()},this)},add:function(c,b){var a=this.togglers.length;this.togglers.push(c);this.elements.push(b);c.addEvent("click",this.display.bind(this,a));b.hide()},expand:function(a){this.togglers[a].addClass("open");this.elements[a].show();return this},collapse:function(a){this.elements[a].hide();this.togglers[a].removeClass("open");return this},display:function(a){if(this.previous==a){if(this.elements[a].isHidden()){this.expand(a)}else{this.collapse(a)}}else{if(this.previous||this.previous===0){this.collapse(this.previous)}this.previous=a;this.expand(a)}return this}});var Slider=new Class({Implements:[Options,Events],Binds:["clickedElement","draggedKnob"],options:{onChange:function(){},onComplete:function(){},onTick:function(a){this.knob.setStyle(this.p,a)},mode:"horizontal",steps:100,offset:0},initialize:function(d,a,b){this.element=$(d);this.knob=$(a);this.setOptions(b);this.previousChange=-1;this.previousEnd=-1;this.step=-1;this.element.addEvent("mousedown",this.clickedElement);var c,f;switch(this.options.mode){case"horizontal":this.z="x";this.p="left";c={x:"left",y:false};f="offsetWidth";break;case"vertical":this.z="y";this.p="top";c={x:false,y:"top"};f="offsetHeight"}this.max=this.element[f]-this.knob[f]+(this.options.offset*2);this.half=this.knob[f]/2;this.getPos=this.element["get"+this.p.capitalize()].bind(this.element);this.knob.setStyle("position","relative").setStyle(this.p,-this.options.offset);var e={};e[this.z]=[-this.options.offset,this.max-this.options.offset];this.drag=new Drag(this.knob,{limit:e,modifiers:c,snap:0,onStart:this.draggedKnob(),onDrag:this.draggedKnob(),onComplete:function(){this.draggedKnob();this.end()}.bind(this)});if(this.options.initialize){this.options.initialize.call(this)}},set:function(a){this.step=a.limit(0,this.options.steps);this.checkStep();this.end();this.fireEvent("onTick",this.toPosition(this.step));return this},setDefault:function(a){if(a>this.options.steps){a=this.options.steps}else{if(a<0){a=0}}this.step=a;this.end();this.knob.setStyle(this.p,this.toPosition(this.step)+"px");return this},scrolledElement:function(a){if(a.wheel<0){this.set(this.step+1)}else{if(a.wheel>0){this.set(this.step-1)}}a.stop()},clickedElement:function(b){var a=b.page[this.z]-this.getPos()-this.half;a=a.limit(-this.options.offset,this.max-this.options.offset);this.step=this.toStep(a);this.checkStep();this.end();this.set(this.step)},draggedKnob:function(){if(!this.drag){return}this.step=this.toStep(this.drag.value.now[this.z]);this.checkStep();this.setDefault(this.step)},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent("onChange",this.step)}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent("onComplete",this.step+"")}},toStep:function(a){return Math.round((a+this.options.offset)/this.max*this.options.steps)},toPosition:function(a){return this.max*a/this.options.steps}});var rules={};var rulesN={};var ajaxRules={};var Behavior=new Class({register:function(b){this.rules=b;for(var a in this.rules){this.reload(a)}for(var c in rulesN){this.reloadN(c)}return this},reload:function(c){var a=$$(c);for(var d=0;d<a.length;d++){try{this.rules[c](a[d])}catch(b){if(require.defined("ta/util/xpath")){ta.util.error.record(b,"rules",null,{element:require("ta/util/xpath").nodePath(a[d]),ruleCount:d})}}}return a.length},reloadN:function(b){var a=0;while(n=ta.id(b+(a++))){rulesN[b](n)}return a-1},apply:function(a){processLinks(a);for(var b in this.rules){window.applyLastRule=b;a.getElements(b).each(function(c){this.rules[b](c)},this)}for(var b in ajaxRules){window.applyLastRule=b;a.getElements(b).each(function(c){ajaxRules[b](c)},this)}}});window.behavior=new Behavior();TAReadyEvent=window.TAReadyEvent||"domready";if(Browser.ie&&(typeof semHotelBoxFocus!="undefined")&&semHotelBoxFocus){ta.queueForLoad(behaviorFunction,"Behavior")}else{window.addEvent(TAReadyEvent,behaviorFunction)}var bfCount=0;function behaviorFunction(){if(Browser.ie&&(!$("FOOT")||!$("FOOT").readyState||$("FOOT").readyState!="complete")&&bfCount<10){bfCount++;behaviorFunction.delay(30);return}if(window.hideOnLoad){Array.from(hideOnLoad).each(function(c){var b=$(c);if(b){b.hide()}})}if(!Browser.ie6){searchFocus()}processLinks(document);behavior.register(rules);var a=$("MAIN");if((window.location.hash=="#Calculator")&&($("HOMEPAGE")||(a&&a.hasClass("VacationRentals"))||$("HOTEL_LANDER"))){showDHTMLOverlayOnLoad=function(){};if(typeof vrCalculator!="undefined"){vrCalculator()}}}function searchFocus(){var a=ta.id("mainSearch");if(a&&a.className.match(/\b(focusOnLoad)\b/)){try{a.focus()}catch(b){}}}rulesN.EOBF=function(a){var b=a.innerHTML+"@tripadvisor"+a.title;new Element("a",{href:"mailto:"+b}).setContent(b).replaces(a)};var linkMap={};var popupIndex=0;function popup(r,t,o,l,h,g,b,d,c,q){try{new Event(r).preventDefault();var a="",k=this.className.match(/sz(\d+)x(\d+)/),j=ta.id(document.body),i,s,f;if(k){o=k[1];l=k[2]}if(this.href.indexOf("p=HotelsCom")>-1){o=Math.max(o,960);l=Math.max(l,window.getHeight(),600)}if(o){a+=",width="+o}if(l){a+=",height="+l}if(h){a+=",screenX="+h+",left="+h}if(g){a+=",screenY="+g+",top="+g}if(a!==""){if(c){a="toolbar=1,resizable=1,menubar=1,location=1,status=1,scrollbars=1"+a}else{a="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+(b?0:1)+a}}if(!d){d=this.href}s=t||("p"+(popupIndex++));if(q&&Browser.ie){f=new Element("a",{target:s,href:d});f.inject(j,"bottom");i=window.open("",s,a);f.click();f.destroy()}else{i=window.open(d,s,a)}if(i!==null){try{i.opener=self}catch(m){}i.focus()}}catch(p){ta.util.error.record(p,"behavior popup",r);throw p}}linkMap.js_popup=function(a,b){popup.attempt(b,a)};linkMap.js_popComm=function(a,b){popup.attempt([b,null,950,610,null,null,null,null,true],a)};linkMap.js_popMap=function(a,b){Cookie.write("mapPopup","1",{domain:cookieDomain});popup.attempt([b,"map",820,960],a)};linkMap.js_popNoScroll=function(a,b){popup.attempt([b,null,null,null,null,null,true],a)};linkMap.js_popCR=function(a,b){popup.attempt([b,"cr",245,610,5,5],a)};linkMap.js_email=function(a,b){popup.attempt([b,"email",580,460,30,25],a)};linkMap.js_popReview=function(a,b){popup.attempt([b,"review",550,395,30,25],a)};linkMap.js_popPhoto=function(a,b){popup.attempt([b,"photo",650,350],a)};linkMap.js_popGallery=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",782,820],a)};linkMap.js_popGalleryComm=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",780,950],a)};linkMap.js_popDMO=function(a,b){popup.attempt([b,"dmo",400,400],a)};linkMap.js_popNxTall=function(a,b){popup.attempt([b,330,680],a)};linkMap.js_popNxWide=function(a,b){popup.attempt([b,730,380],a)};linkMap.js_popNxLogin=function(a,b){popup.attempt([b,"login",795,645],a)};linkMap.js_popFraud=function(a,b){popup.attempt([b,"fraud",640,460],a)};linkMap.js_popDestGd=function(a,b){popup.attempt([b,"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2],a)};linkMap.js_popSmall=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,600,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,500,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popProfPhoto=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,450,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popPartner=function(a,b){if(screen.width>1024){popup.attempt([b,null,980,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{popup.attempt([b,null,620,450,210,5,false,false,true],a)}}return a};linkMap.js_noTAPD=function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})};rules["a#TERMS"]=function(a){a.addEvent("click",popup.bind(a).partial(Function._,"terms",300,300,30,25))};linkMap.js_ajaxSubmit=function(a,f){if(!a.className.match(/\bform_(\w+)\b/)){return}var d=$(RegExp.$1);var c={url:a.href,data:d,onFailure:function(e){if(d){d.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("behavior:js_ajaxSubmit",e)}};var g=window["callback"+d.id];if(a.className.match(/method_(\w+)\b/)){c.method=RegExp["$1"]}if(a.className.match(/\btgt_(\w+)\b/)){c.update=RegExp["$1"]}else{c.onSuccess=function(e){if(d){d.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(e);if(g&&typeOf(g)=="function"){g()}}}new Event(f).preventDefault();var b=window["validate"+d.id];if(b&&typeOf(b)=="function"&&b.apply(d)==false){return}d.addClass("ajaxInFlight");if(a.className.match(/\bevalScripts\b/)){c.evalScripts=true}(c.update?new Request.HTML(c):new Request(c)).send()};linkMap.js_ajax=function(a,b){new Event(b).preventDefault();if(!(tgt=a.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:a.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajax")}).send()};linkMap.js_ajaxlogin=function(b,c){new Event(c).preventDefault();if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}var a=b.href;tgt=$(tgt[1]);new Request({url:b.href,onSuccess:function(d,f){var e=(d.indexOf("<!--nologin-->")<0);if(!e){login(["tt","ajax","returnTo",a+"&rd=1","greeting","showuserreviews_vote_25ee"])}else{tgt.innerHTML=d}},onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajaxLogin")}).send()};linkMap.js_ajaxReport=function(a,b){ajaxReport.attempt(b,a)};var ajaxReport=function(a){new Event(a).preventDefault();ta.overlays.loadInLightbox(this.href)};function toggle(a){new Event(a).preventDefault();this.toggleClass("off")}var toggleMeRule=function(a){if(false==a.hasClass("defaultOpen")){a.addClass("off")}a.getElements(".show").addEvent("click",toggle.bind(a));a.getElements(".hide").addEvent("click",toggle.bind(a))};rules["#TOGGLEME"]=toggleMeRule;rules["#TOGGLEME2"]=toggleMeRule;ajaxRules["div.js_swapBlocks"]=function(b){var a=b.getElement(".js_swapOut");var c=b.getElement(".js_swapIn");var d=b.getElement("a.js_swapTrigger");var e=b.getElement("a.js_swapBackTrigger");if(a&&c&&d){d.addEvent("click",function(f){new Event(f).preventDefault();window.removedBit=a.dispose();c.show()});d.removeClass("js_swapTrigger")}if(a&&c&&e){e.addEvent("click",function(f){new Event(f).preventDefault();c.hide();$("parentOfSwapOut").appendChild(window.removedBit)});e.removeClass("js_swapBackTrigger")}};ajaxRules["#PM_UNBLOCK"]=function(a){a.addEvent("submit",function(c){new Event(c).stop();var b=$("PM_UNBLOCK");if(b.unblock.value=="1"){new Request({url:"/SendMessageRD",data:b,onSuccess:ta.overlays.showInLightbox,onFailure:ta.util.error.ajaxFailure.partial("behavior:#PM_UNBLOCK")}).request()}else{$("unblock-intercept").hide();$("blockedreply").show();b.unblock.value="1"}})};function enableCommunity(c,a){var b=c;if(!a){b=function(d){enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("behavior:enableCommunity")}).send()}function enableCommunityResponse(res,callback){var isf=document.getElementById("inviteStatusField");if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){isf.innerHTML=data.ERROR;isf.style.display="block"}}else{isf.innerHTML=JS_community_on;isf.style.display="block"}}function getRelativeURL(){return window.location.pathname+window.location.search+window.location.hash}var follow=function(a){return function(){window.location=$(a).href}};function showToggleBlock(a){$$(".js_toggleBlocks .js_toggleBlock").each(function(c,b){c.hide();if(c.hasClass(a)){c.show()}})}linkMap.js_toggleBlockTrigger=function(b,c){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(d){a=d});showToggleBlock(a)};rules["#SWAPBLOCK .js_toggleBlock"]=function(b){if(b.hasClass("js_toggleBlockSelected")){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(c){a=c});showToggleBlock(a)}};var showLastSavesRD=function(){var a=$("LAST_SAVES_PLACEHOLDER");if(typeof savesIncluded!="undefined"){if(!a){return renderLastSaves(SAVES_RECENT_SAVES)}else{a.innerHTML=renderLastSaves(SAVES_RECENT_SAVES);flyout.positionCorners()}}else{if(!a){new Asset.javascript(savesJS);showLastSavesRD.delay(125);return new Element("div",{id:"LAST_SAVES_PLACEHOLDER"})}}};var showSavesWidget=function(d,f,c,b,g,e,a){if(typeof savesIncluded!="undefined"){showSavesWidget2(d,f,c,b,g,e,a)}else{new Asset.javascript(savesJS);showSavesWidget.delay(125,null,[d,f,c,b,g,e,a])}};var savesInlineLoginOnClickHandler=function(c,a,b){if(typeof savesIncluded!="undefined"){savesInlineLoginOnClickHandler2(c,a,b)}else{new Asset.javascript(savesJS);savesInlineLoginOnClickHandler.delay(125,null,[c,a,b])}};linkMap.js_trackDirPop=function(a,b){if(actionToRecord=a.className.match(/ar_(\w+)/)){actionToRecord=actionToRecord[1];new Request({url:"/ActionRecord?action="+actionToRecord}).send()}};function clearPopupForm(){$$("#POPUP_FORM #pass").setProperty("value","");$$("#DHTMLPOPUP .error-message").empty()}linkMap.js_clearPopupForm=function(a,b){clearPopupForm()};function setPopupFormAction(a){$$("#POPUP_FORM #action").setProperty("value",a)}linkMap.js_popupFormAction1=function(a,b){setPopupFormAction("1")};linkMap.js_popupFormAction2=function(a,b){setPopupFormAction("2")};var replaceContent=ta.util.element.replaceContent;linkMap.js_replaceContent=function(d,f){var b=d.className.match(/id_([^\s"]*)?/);if(!b||b.length!=2){throw new Error("Links with behavior js_replaceContent must also have a style class id_??? to indicate which element's contents should be replaced")}b=b[1];var c=$(b);var a=d.href;if(a){replaceContent(f,c,a)}f.stop()};require(["ta/rollupAmdShim"],function(a){a.install(["ta/common/behavior/Popups","ta/common/behavior/globalSideEffects","ta/common/behavior/Ads-pagemoniker","ta/util/xpath","ta/maps/trackpixel"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"behavior_set",files:{js3_secure:{ssl:{ta:{common:{behavior:{"Ads-pagemoniker":1}}}}},js3:{src:{ta:{common:{behavior:{Popups:1,globalSideEffects:1}},maps:{trackpixel:1},util:{xpath:1}}}}},_:{baseUrl:"/"}})};define("ta/common/behavior/Popups",["vanillajs","ns-exporter","api-mod","ta/util/Error","utils/ajax","ta/Core/TA.Record","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade"],function(j,o,h,d,n,g,b,k,c,m,f,a,e){var p={};var l=false;window.popupConfig=window.popupConfig||{};p.checkDHTMLPopupShown=function(){return l};p.DHTMLOverlayRequest=function(u,t,r,s){var q=popupConfig.servletUrl+(popupConfig.servletUrl.indexOf("?")>=0?"&":"?")+"Action="+u;if(q.indexOf("fromServlet=")<0){q+="&fromServlet="+pageServlet}n({url:q,success:t||function(v){i(v,popupConfig)},error:r,data:s?h.getFormData(s):null,evalScripts:true})};p.showDHTMLPopup=function(s,w,u,r,v){try{popupConfig.servlet=s;popupConfig.servletUrl=w;popupConfig.lightbox=u||(r&&r.lightbox)||false;popupConfig.options=r;if(r&&r.loading&&v){var q=r.loading.substr?document.getElementById(r.loading):r.loading;q.style.left=v.pageX+20;q.style.top=v.pageY;q.style.display="block";document.body.appendChild(q)}p.DHTMLOverlayRequest("Open",null,null,r?r.data:null);if(r&&r.trackInterrupt&&require.defined("ta/util/RecordInterruption")){require("ta/util/RecordInterruption").record("popup",r.popupName)}}catch(t){d.record(t,"showDHTMLPopup - "+s,v)}};function i(D,E){if(!D){return}var v=E.options||{};if(v.forward&&window.popupForward){window.location=window.popupForward}h.select("#FLYOUT").forEach(function(J){J.dispose()});window.lightbox&&window.lightbox.deactivate();h.select(".overlay, .ui_overlay").forEach(function(J){if(J.overlay&&J.overlay.hide){J.overlay.hide()}});if(v.loading){var t=v.loading.substr?document.getElementById(v.loading):v.loading;t.style.display="none"}var r=[f,m,a];if(E.lightbox){r.push(e)}if(v.center){r.unshift(c.center([0,0]));r.unshift(k(null,"center","small"))}else{var u=v.daodaoPopup||!v.permanent?240:100;var x=document.getElementById("PAGE");r.unshift(c.absolute([x.offsetLeft+u,x.offsetTop+220]));r.unshift(k(null,"absolute",""))}var F=new b(null,r);F.inner.innerHTML=D;F.container.style.padding="0px";F.show();l=true;if(E.servletUrl){try{var s="DHTMLOverlay";var z=E.servletUrl.match(/RuleBasedPopup/);if(z){var A=E.servletUrl.match(/Rule=\d+/);if(A){var y=A[0].match(/\d+/);s="RuleBasedPopup_"+y[0]}}g.trackEventOnPage("Popup","OpenPopup",s,1,true)}catch(G){d.record(G,"Popup - trackPopup")}}var C=function(){if(h.find(".refreshOnClose",this.inner)){document.location.reload()}};F.on("hide",C);if(E.servlet){h.addClass(F.container,E.servlet);h.addClass(F.container,"np");if(E.servlet=="RuleBasedPopup"&&v.cmsDisplayName){h.addClass(F.container,v.cmsDisplayName)}var B=function(L,J){var K=(L.charCode)?L.charCode:((L.which)?L.which:L.keyCode);if(K==13||K==10){J(L)}};var q=function(J){B(J,H)};var w=function(J){B(J,h.stopEvent.bind(h,J))};var I=function(J){h.select("#POPUP_FORM #sendpass").forEach(function(K){K.value="true"});H(J)};var H=function(K){h.stopEvent(K);h.removeEvent(h.select(F.inner,".popupSubmit"),"click",H);h.removeEvent(h.select(F.inner,".popupSendForgotEmail"),"click",I);var J=h.select(F.inner,".popupSubmitOnEnter");h.removeEvent(J,"keydown",q);h.addEvent(J,"keydown",w);h.select(F.inner,".focusClear").forEach(function(L){L.value=""});if(v.disableOnHideForSubmit){F.off("hide",C)}p.DHTMLOverlayRequest("Submit",null,null,h.find(F.inner,"#POPUP_FORM"))};h.addEvent(h.select(F.inner,".dhtmlclose"),"click",F.hide.bind(F));h.addEvent(h.select(F.inner,".popupSubmitOnEnter"),"keydown",q);h.addEvent(h.select(F.inner,".popupSendForgotEmail"),"click",I);h.addEvent(h.select(F.inner,".popupSubmit"),"click",H)}if(v.callback){v.callback(F.container)}}p.DHTMLOverlayResponse=function(q){i(q,popupConfig)};o.exportTo(p,window);return p});define("ta/common/behavior/globalSideEffects",["vanillajs","ns-exporter","api-mod","ta/util/Cookie","ta/util/Error","ta/Core/TA.Event","utils/browserutils","utils/resourceLoader","utils/ajax"],function(g,k,f,b,c,h,n,o,j){var m={processLinks:function(p){f.select("a",p).forEach(function q(r){if(r.className.match(/js_|pid/)){f.addEvent(r,"click",a);if(window.noPopClass&&r.className.match(/\bjs_pop/)){f.addClass(r,window.noPopClass)}}})}};function a(q){var p=q?q.target:null;while(p&&p.tagName!="A"&&p.tagName!="HTML"){p=p.parentNode}if(p&&p.tagName=="A"){if(/pid(\d+)/.test(p.className)){b.setPIDCookie(RegExp.$1)}if(window.linkMap){(p.className.match(/(js_\w+)/g)||[]).forEach(function(r){if(typeof linkMap[r]=="function"){linkMap[r](p,q)}})}}}function e(){if(window==window.top){var u=b.readRaw("ajaxAction");if(u){u=decodeURIComponent(u).split("|");if(/^target:(\/[\w\d_-]+)/.test(u[0])){if(window.location.pathname.indexOf(RegExp.$1)!==0){return}u=u.slice(1)}else{if(window.opener){return}}b.remove("ajaxAction","/",window.cookieDomain);if((u[0]=="focus"||u[0]=="click")&&u.length>1){for(var r=0;r<u.length;r+=2){var q=f.select(u[r+1]);if(q.length){try{q[0][u[r]]()}catch(s){c.record(s,"ajaxAction",null,{funcName:u[r],elmt:u[r+1]})}}}}else{try{var p=u.slice(1);p.unshift({});p.unshift(u[0]);h.run.apply(null,p)}catch(t){c.record(t,"ajaxAction",null,{funcName:u[0]})}}}}}function d(){if(n.firefox||n.safari||n.chrome){var p=f.find(location.hash);if(p&&p.offsetTop!=document.body.scrollTop){window.scrollTo(0,p.offsetTop)}}}function l(){if(/^#save/.test(location.hash)){var p=window.handleSavesPostLoginPopup;if(p){p()}else{if(window.savesJS){o.load(window.savesJS,l)}}}}function i(){if(window.freshVSTrackingCookie){var p=b.readRaw("v1st");if(p){j("/VSCookieRequest")}}}h.queueForLoad(function(){if(typeof behavior=="undefined"){m.processLinks(document)}b.remove("TATypeAhead");e();d();l();setTimeout(i,200)},1,"On_Load_Popups");if(window.showPopup){showPopup()}k.exportTo(m,window);return m});function expandIframe(c,a,b){if(document.getElementById(c)){document.getElementById(c).width=a;document.getElementById(c).height=b}}function collapseAd(c){var a=ta.id(c);if(a==null){return}var b=ta.id(a.parentNode);if(b&&b.hasClass&&b.hasClass("adServer")){b.addClass("taEmpty")}else{ta.util.error.record(null,"ta.common.ads.collapseAd:fail",null,{},"WARN")}}function injectAdsTargeted(a,b){if(!ta.has("p13n.requestAds")||ta.retrieve("p13n.requestAds")){ta.common.ads.injectAdsTargeted(a,b)}}function getIncrementedAdsAjaxCount(){return ta.common.ads.getIncrementedAdsAjaxCount()}window.addEvent("load",function(){if(ta.has("ads.gptEnabled")){if(window.isTabletOnFullSite){window.addEvent("orientationchange",function(){ta.common.ads.orientationChange()})}ta.on("onPopunderBlur",function(){ta.common.ads.resetAdRefreshFlag();ta.common.ads.setLocalStorageTargeting()});if(window.pageServlet==="Hotels"){ta.on("onUpdateHACAds",ta.common.ads.updateHotelHacAds);if(!ta.widgets.calendar.hasPageDates()){googletag.cmd.push(function(){ta.common.ads.refreshAjaxAds("#HAC_RESULTS .gptAd")})}}if(window.pageServlet==="Attractions"){window.addEvent("onAttractionFilterChange",function(){ta.common.ads.refreshAllAdsPolitely(true)})}if(window.pageServlet==="Restaurants"){window.addEvent("onRestaurantFilterChange",function(){googletag.pubads().updateCorrelator();ta.common.ads.injectAjaxAds("RestaurantSearch","#EATERY_OVERVIEW .gptAd",false);ta.common.ads.updateAdsFromAjaxTargeting("RestaurantSearch","#EATERY_OVERVIEW",["cuisine"])})}if(window.pageServlet==="Restaurant_Review"){ta.on("review_filters.filter_changed",function(){ta.common.ads.refreshAllAdsPolitely(true)});ta.on("review_keyword_search.tag_toggled",function(){ta.common.ads.refreshAllAdsPolitely(true)})}if((window.pageServlet==="HotelsList"&&ta.retrieve("ta.p13n.blender_with_category_xsells.enabled"))||(window.pageServlet==="ThemePark")){ta.on("onHACUpdateComplete",function(){ta.common.ads.refreshAllAdsPolitely(true)})}if(window.pageServlet==="VRACSearch"&&ta.retrieve("vrDblClickAdCallsEnabled")){ta.on("onVRACSearchFilterChange",function(){ta.common.ads.refreshAllAdsPolitely(true)})}if(window.pageServlet==="Search"){window.addEvent("onUpdateSearchResults",ta.common.ads.queueForInjection);window.addEvent("srp_hac_update_complete",ta.common.ads.queueForInjection)}if(!ta.has("ads.disableEventRefresh")){window.addEvent("focus",function(){ta.common.ads.refreshAllAdsPolitely(false)});ta.on("onOverlayClose",ta.common.ads.refreshAllAdsPolitely);if(ta.has("ads.calendarSelectRefresh")){ta.on("onCalendarSelect",function(){if(ta.common.ads.noOverlaysDisplayed()){ta.common.ads.refreshAllAdsPolitely()}})}}if(window.pageServlet==="Hotel_Review"||window.pageServlet==="Attraction_Review"||window.pageServlet==="Restaurant_Review"||window.pageServlet==="Tourism"){window.addEvent("scrollingTabs_Start",ta.common.ads.pauseOnScrollInjection);window.addEvent("scrollingTabs_End",ta.common.ads.resumeOnScrollInjection);ta.on("tabExpand_Start",ta.common.ads.roomListExpandStart);ta.on("tabExpand_End",ta.common.ads.refreshWhenRoomListExpand)}if(ta.has("ads.gptEnabled")&&(window.pageServlet==="Hotel_Review"||window.pageServlet==="Attraction_Review"||window.pageServlet==="Restaurant_Review")){window.addEvent("ReviewExpanded",ta.common.ads.refreshAllAdsPolitely)}if(window.pageServlet==="Airlines"){ta.on("airlinesPlacementLoad",function(){ta.common.ads.refreshAllAdsPolitely(true)})}}});ta.common.ads=(function(j,U,k,x){var f=0,K=false,v="ads.forceAdMode",J="test",ah="live",S=(U.screen&&U.screen.orientation)?U.screen.orientation.type:null,y=true,Q=true,d="#photos",N="gpt-ad-2x1",D="gpt-ad-2x1-b",W=1237,q=0,u=new Date().getTime(),L=10000,ab=true,ac=true,ae=U.pageServlet,c=29867505611,C=function(){ac=true;U.removeEvent("scroll",C)},ad=false,X=false,O=k.util&&k.util.localstorage&&k.util.localstorage.canUseLocalStore(),s=false,I=91472856971,E="gpt-ad-4x4-a-locationphotoalbum",M=function(ai){return typeof ai=="string"||typeof ai=="number"||typeof ai=="boolean"},l=null,G=null,w=function(ai){return(ai&&ai.id.replace(/-ref\d+/,"")==l)},i=function(){var am=U.getWidth,aj=U.getHeight,al=100;var ai=(typeof am==="function")?Math.floor(am()/al)*al:0;var ak=(typeof aj==="function")?Math.floor(aj()/al)*al:0;ai=(ai>2000)?9999:ai;ak=(ak>1500)?9999:ak;return"w"+ai+"_h"+ak},n=function(ak){var aj="WIN_SIZE";if(ak&&ak.win_size&&ak.report){var al=ak.report;for(var ai=0;ai<al.length;ai++){if(al[ai].indexOf(aj)>-1){al[ai]=al[ai].replace(aj,ak.win_size);break}}}},V=function(aj){var an=[],al=[];al.top="a";al.bottom="b";if(aj.constructor===Array){for(var ak=0,ai=aj.length;ak<ai;ak++){var am=aj[ak];if(al[am]){an.push(am);an.push(al[am])}}}else{if(al[aj]){an.push(aj);an.push(al[aj])}}return(an.length)?an:aj},ag=function(){k.common&&k.common.scrollAd&&k.common.scrollAd.resetScrollAd()},p=function(){k.common&&k.common.scrollAd&&k.common.scrollAd.addScrollHandler()},a=function(aj){if(!ad||!X&&aj&&aj.tab&&aj.tab.id==="TABS_ROOMS"){return}k.remove("deferAds.ads");var ap=U.getScroll().y;var ai=k.retrieve("ads.adStubs");if(ai){try{for(var ak=0,am=ai.length;ak<am;ak++){var ao=ai[ak];var aq=k.id(ao.tgt);var al=k.common.ads.getAd(ao);if(aq&&al){if(k.has("scrollAd.enableScroll")&&w(al)){ag()}al.injectOnScrollUp=aq.getCoordinates().bottom<ap;al.injectWhenViewable(false)}}}catch(an){k.util.error.record(an,"error resetting ads after autoScroll")}ad=false;if(k.has("scrollAd.enableScroll")){U.fireEvent("scroll")}}},z=function(ai){var ak=false;try{var am=ai.adStub.tgt;if(am.match(/ref\d+/)){var aj=parseInt(am.match(/ref(\d+)/)[1],10)+1;ak=am.replace(/ref\d+/,"ref"+aj)}else{ak=am+"-ref1"}}catch(al){k.util.error.record(al,"error building refresh ad id")}return ak},A=function(am){try{var an=am.adStub;var ai=z(am);if(!ai){var aj=(am&&am.adElem&&am.adElem.id)?am.adElem.id:null;throw new Error("unable to build refresh ad id for "+aj)}an.tgt=ai;var aq=k.id(am.adElem.cloneNode(false));aq.id=an.tgt;aq.removeClass("taEmpty");if(aq.className.toLowerCase().indexOf("gutterad")==-1){aq.set("style","")}var ap=k.id(am.adId);var ao=ap.parentNode;ao.replaceChild(aq,ap);var ak=new k.common.ads.TripAd(an);ak.addTargeting(am.slotTargeting);ak.injectWhenViewable()}catch(al){k.util.error.record(al,"error cloning ad for refresh")}},H=function(aj){if(!ab){return false}if(aj){return true}var ai=new Date().getTime();if(ai-u>L){u=ai;return true}else{return false}},m=function(ai,al,aj){var ak=false;if(ai){ak=true;if(ai.getParent(".ad.inactive")){return false}if(!aj&&al&&al.slotTargeting&&al.slotTargeting.disable_event_refresh){return false}if(al.gutterAd&&k.common.behavior&&k.common.behavior.gutterAd&&!k.common.behavior.gutterAd.shouldDisplay()){return false}}return ak},af=function(){var ak=0;if(!k.has("ads.reverseScroll")){return ak}if(U.location.hash){var ai=j.getElement(U.location.hash);if(ai&&ai.isVisible()){if(k.has("scrollingTabs.scrollOnPageLoad")){ak=k.retrieve("scrollingTabs.scrollOnPageLoad")}else{ak=ai.getCoordinates().top}if(ak>0){var aj=U.getScroll().y;if(aj==0){ac=false;U.addEvent("scroll",C)}}}}return ak},Y=function(ai,ap,ak,at,an){try{if(ai&&ap&&ap.requestStart&&ak&&at){var aq=50,ao=ak-ap.requestStart,au=Math.floor(ao/aq)*aq,al=new Date().getTime()-ap.requestStart,am=Math.floor(al/aq)*aq,aw=ap.adId.replace("gpt-ad-","").replace(/-ref\d+/g,""),av=[aw,((an)?"ad:y":"ad:n"),ai.creativeId],aj="recvd_"+au;k.trackEventOnPage("ad_latency",av.join("|"),aj,am,true);ap.requestStart=null}}catch(ar){}},F=function(al){if(al){try{var aj=al.slot.getSlotId().getDomId();var ai=k.id(aj);if(aj&&ai){var ap=k.retrieve("tripads."+aj);if(ap&&ap.requestStart){var ak=new Date().getTime();var ao=!al.isEmpty&&!ai.hasClass("taEmpty");var am=ai.getElement("div iframe");if(ao&&am){am.addEvent("load",function(){Y(al,ap,ak,new Date().getTime(),ao)})}else{Y(al,ap,ak,ak,ao)}}}}catch(an){}}},r=["PageType","platform","pool","rd","sess","slice","win_size","drs"],h=function(ak){var ai={};if(ak){for(var aj in ak){if(!r.contains(aj)){ai[aj]=ak[aj]}}}return ai},Z=function(aj){try{if(aj&&aj.slot&&aj.creativeId){var ai=k.id(aj.slot.getSlotId().getDomId());if(ai){ai.setAttribute("data-creative-id",aj.creativeId)}}}catch(ak){}},g=function(ai){if(ai&&!s&&k.photos&&k.photos.sponsoredVideo&&E==ai.slot.getSlotId().getDomId()){s=true;if(ai.creativeId&&ai.creativeId!=I){k.photos.sponsoredVideo.setSponsoredContentAvailable(true)}}},e=function(ai){if("VacationRentalReview"==U.pageServlet&&ai&&ai.creativeId!=(c)){k.fireEvent("VRGalleryAdContentReceived")}},R=function(ap,al){al=al||N;try{if(k.retrieve("ads.attributionPixel")!==true){y=false;Q=false;return}var aj=k.id(ap);if(aj&&!aj.hasClass("taEmpty")&&aj.style.display!=="none"){if(N===al){y=false}else{if(D===al){Q=false}}var ao=new Element("div",{id:al,"class":"gptAd hidden"});aj.parentNode.insertBefore(ao,aj.nextSibling);var ak=k.retrieve("ads.gptBase");if(ak){var am={base:ak,size:[[2,1]],tgt:al,custom_targeting:{disable_event_refresh:true}};var ai=new k.common.ads.TripAd(am);if(ai){ai.inject();k.store("tripads."+al,ai)}else{throw new Error("TripAd is null")}}else{throw new Error("adBase not found")}}}catch(an){k.util.error.record(an,"error rendering CPM attribution pixel")}},P=function(an){try{Z(an);var al=an&&an.slot&&an.slot.getSlotId&&an.slot.getSlotId();var ap=al&&al.getDomId?al.getDomId():null;var ak=U.location.hash.indexOf(d)>=0;if(Q&&ak){R(ap,D)}else{if(y&&!ak){R(ap,N)}}g(an);if(k.has("ads.requestTracking")){F(an)}e(an);var am=k.id(ap);if(am){var ai=am.hasClass("taEmpty");if(!ai){var aj=am.getParent(".ad");if(aj){aj.addClass("loaded")}}}U.fireEvent("onAdRender",{domId:ap})}catch(ao){k.util.error.record(ao,"post render processing error")}},B=function(){localStorage.removeItem(v);U.location.reload()},T=function(){var ai=K===J?ah:J;localStorage.setItem(v,ai);U.location.reload()},b=function(an){if(k.id("FRC_AD_MODE")){return}var aj=new Element("div",{id:"FRC_AD_MODE",style:"position:fixed;z-index:12000;top:0;right:0;background:#c00;color:#fff;font-size:16px;padding:5px;margin:5px;border-radius:5px",text:an});var al=new Element("span",{style:"float:left;width:27px;height:15px;border-radius:5px;margin:3px 5px 0 0;background:#ccc;cursor:pointer;"});al.onclick=T;var ak=an.indexOf("TEST")>-1?"right":"left";var ai=new Element("span",{style:"height:14px;width:14px;border-radius:50%;border:2px solid #555;background:#fff;margin:-2px -1px 0 -1px;float:"+ak+";"});al.appendChild(ai);aj.appendChild(al);var am=new Element("span",{style:"padding-left:5px;font-size:18px;cursor:pointer;",html:"&times;"});am.onclick=B;aj.appendChild(am);j.body.appendChild(aj)},t=function(ai){try{if(K){var ak=ai.split("/");if(K===J){ak[2]="ta.ta.com.test.s";b("TEST ADS")}else{ak[2]=ak[2].replace(/\.test\.s$/,".s");b("LIVE ADS")}return ak.join("/")}else{return ai}}catch(aj){return ai}},aa=function(aj){if(k.has("scrollAd.enableScroll")){if(aj&&aj.id&&w(aj)){try{p()}catch(ai){k.util.error.record(ai,"error checking for scrolling ad")}}}},o=function(ai){if(ai){if(k.has("scrollAd.enableScroll")&&w(ai)){ag();ai.injectWhenViewable(false)}else{if(ai.adElem.getCoordinates().bottom<U.getScroll().y){ai.injectOnScrollUp=true}else{ai.injectOnScrollUp=false}ai.injectWhenViewable(false)}}};return{TripAd:new Class({adBase:null,adElem:null,adId:null,adSizes:[],adInjected:false,refreshWithNewContext:true,requestStart:null,adStub:null,adSlot:null,slotTargeting:{},id:null,type:null,options:{debug:false,collapse:true},Implements:[Options],initialize:function(am,al){try{this.setOptions(al);this.adStub=am;this.adBase=am.base;this.adSizes=am.size;this.adId=am.tgt;this.id=am.tgt;this.type=am.type;this.errorKey="ads.fail."+am.tgt;this.adElem=k.id(this.adId);this.injectOnScrollUp=false;this.reservedHeight=0;if(!this.adElem){throw new Error("element for ad slot does not exist")}var ak=this.adElem.getParent(".ad");this.reservedHeight=ak?ak.offsetHeight:0;var aj;if(ae==="PricefinderPopunder"){var ao=k.common.ads.getLocalStorageTargeting();if(ao.gptBase){am.base=ao.gptBase}if(ao.pageTargeting){aj=h(ao.pageTargeting)}}if(!k.has("tripads."+this.adId)){var ai=am.size;if((am.tgt.indexOf("4x4")==-1)&&(am.tgt.indexOf("1x1")==-1)){ai.push("fluid")}this.adSlot=googletag.defineSlot(t(am.base),ai,am.tgt).addService(googletag.pubads()).setCollapseEmptyDiv(this.options.collapse,!this.adStub.isExpanded);if(am.custom_targeting&&am.custom_targeting.companion){this.adSlot.addService(googletag.companionAds())}}else{throw new Error("ad slot has already been created")}if(am.custom_targeting){this.addTargeting(am.custom_targeting)}if(aj){this.addTargeting(aj)}this.addElementTargeting();k.store("tripads."+this.adId,this)}catch(an){throw new Error("Unable to create TripAd for target "+this.adId+": "+an.message)}},inject:function(aj){if(aj==false){this.refreshWithNewContext=false}try{var ai=k.id(this.adId);if(ai&&(ai.hasClass("inactive")||ai.getParent(".ad.inactive"))){return}if(this.adInjected){if(ai){this.adStub.isExpanded=!ai.hasClass("taEmpty")&&ai.getStyle("display")!="none";ai.removeClass("taEmpty");if(this.refreshWithNewContext){googletag.pubads().refresh([this.adSlot]);aa(this)}else{this.refresh()}}else{throw new Error("ad refresh fail, elem does not exist: "+this.adId)}}else{googletag.display(this.adId);this.adInjected=true;if(k.has("ads.requestTracking")){this.requestStart=new Date().getTime()}aa(this)}}catch(ak){if(!k.has(this.errorKey)){k.util.error.record(ak,"unable to inject TripAd for target: "+this.adId);k.store(this.errorKey,true)}}},refresh:function(){A(this)},injectWhenViewable:function(ai){if(ai==false){this.refreshWithNewContext=false}try{if(this.isInView()){this.inject(this.refreshWithNewContext)}else{this.defer()}}catch(aj){k.util.error.record(aj,"unable to inject/defer TripAd")}},defer:function(){var ak=k.retrieve("deferAds.ads")||[];var ai=ak.length>0;var am=false;if(ai){for(var al=0;al<ak.length;al++){var aj=ak[al];if(aj&&this.adId==aj.adId){am=true;break}}if(!am){ak.push(this);k.store("deferAds.ads",ak)}}else{ak.push(this);k.store("deferAds.ads",ak);if(k.has("throttle_ads_position_check")&&!k.has("ads.no_ads_during_scroll")&&require.defined("utils/throttle")){U.ta_handleAdDefer=require("utils/throttle")(k.common.ads.deferAds,150)}else{U.ta_handleAdDefer=k.common.ads.deferAds}U.addEvent("scroll",U.ta_handleAdDefer)}},getPosY:function(){var ai=this.adElem;return ai.getCoordinates().top},isInView:function(){if(ad){return false}if(!k.has("ads.deferEnabled")){return true}var ak=U.getScroll().y;var al=0;if(k.has("ads_early_injection")){al=k.retrieve("ads_early_injection")}if(k.has("ads.no_ads_during_scroll")){var aj=this.getPosY();var ai=aj+this.reservedHeight+al;return(aj<ak+U.getHeight()+al)&&(ai>ak)}else{if(this.injectOnScrollUp){return ac&&this.getPosY()+this.reservedHeight+al>ak}else{return this.getPosY()<ak+U.getHeight()+al}}},isLeaderboard:function(){return this.adId.indexOf("gpt-ad-728x90")>-1},addElementTargeting:function(){if(this.adElem&&this.adElem.getAttribute("data-targeting")){var aj=this.adElem.getAttribute("data-targeting");if(U.JSON&&JSON.parse){try{var ai=JSON.parse(aj.replace(/'/g,'"'));this.addTargeting(ai)}catch(ak){k.util.error.record(ak,"error applying element ad targeting")}}}},addTargeting:function(aj){try{aj=this.mergeTargeting(aj);if(aj.pos){aj.pos=V(aj.pos)}if(U.isTabletOnFullSite&&S){aj.oriented=S.test(/portrait/)?"p":"l"}this.slotTargeting=aj;for(var ai in aj){this.adSlot.setTargeting(ai,aj[ai])}}catch(ak){k.util.error.record(ak,"error applying ad slot targeting")}},mergeTargeting:function(ao){var ak=this.slotTargeting;for(var aj in ao){if(ak[aj]==ao[aj]){continue}if(aj=="kw"){ak.kw=ao.kw;continue}if(aj=="proptype"){ak.proptype=ao.proptype;continue}if(!ak[aj]){ak[aj]=ao[aj]}else{if(M(ak[aj])){ak[aj]=[ak[aj]]}if(M(ao[aj])){ao[aj]=[ao[aj]]}var an=ak[aj].concat(ao[aj]);var am=[];for(var ai=an.length-1;ai>-1;ai--){var al=an.pop();if(!am.contains(al)){am.push(al)}}ak[aj]=am.reverse()}}return ak},clearTargeting:function(){this.adSlot.clearTargeting();this.slotTargeting={}},updateHotelStyle:function(aj){if(aj&&this.adSlot){aj=aj.toLowerCase();var ai={};ai.triptype=aj;var ak=k.common.ads.SEGMENT_MAP[aj];if(ak){ai.seg=ak}this.addTargeting(ai)}},updateHotelType:function(ai){if(ai&&this.adSlot){ai=ai.toLowerCase();var aj={};aj.proptype=ai;var ak=k.common.ads.SEGMENT_MAP[ai];if(ak){aj.seg=ak}this.addTargeting(aj)}},isVisible:function(){return this.adElem.isVisible()}}),injectAjaxAds:function(ak,ai,aj){if(!(U.googletag&&U.googletag.cmd)){k.util.error.record(null,"googletag not defined, unable to inject ads for servlet: "+ak+","+ai);return}googletag.cmd.push(function(){if(typeof ak=="string"){var an="ads."+ak.toLowerCase();var ao=k.retrieve(an+".adStubs");var am=k.retrieve(an+".pageTargeting");var al=j.getElements(ai);if(ao&&ao.length&&al.length){al.each(function(ap){var au=false;for(var at=0;at<ao.length;at++){var aw=ao[at];if(aw&&aw.tgt){var ax=aw.tgt.split("-");var ar=ax.slice(0,ax.length-1).join("-");if(ap.id.indexOf(ar)>-1){aw.tgt=ap.id;au=aw;break}}}if(au){try{var aq=k.common.ads.getAd(au);if(aq){if(am){aq.addTargeting(am)}aq.injectWhenViewable(aj)}}catch(av){k.util.error.record(av,"unable to inject ajax ad for: "+au.tgt)}}})}}})},getSidebarElem:function(){function ai(){return j.getElement(".Restaurants #BODYCON #LHR")}if(k.retrieve("hr_below_the_fold_redesign.enabled")){return j.getElement(".accommodation_card_wrap")}if(k.retrieve("persistent_sidebar")){return j.getElements("#BODYCON .gridA .sidebar").getLast()}return j.getElement(".scrollAdSidebar")||j.getElement("#BODYCON .gridA .sidebar")||ai()},setAdIdThatEnablesScrolling:function(ai){if(ai){l=ai.replace(/-ref\d+/,"");return}G=k.common.ads.getSidebarElem();if(G){var ak=G.getElements(".gptAd");for(var aj=ak.length-1;aj>=0;aj--){if(!ak[aj].hasClass("inactive")){l=ak[aj].id.replace(/-ref\d+/,"");break}}}},getAd:function(ar,ak){var ao=null;if(ar){try{if(ar.tgt){var av="tripads."+ar.tgt;if(k.has(av)){ao=k.retrieve(av);var at=k.id(ao.adId);if(at){ao.adElem=at}else{var aw=k.id(ar.tgt.replace(/-ref\d+/,""));if(aw){ao.adElem=aw;ao.adId=ao.id=aw.id}else{ao=null}}}else{try{ao=new k.common.ads.TripAd(ar)}catch(aq){return null}}}else{var ap=ar;var aj=ak?k.retrieve("ads."+ak+".adStubs"):k.retrieve("ads.adStubs");if(aj){for(var an=0;an<aj.length;an++){var am=aj[an];if(am.tgt&&am.tgt.test(/-ref\d+/)&&!ap.test(/-ref\d+/)&&am.tgt.replace(/-ref\d+/,"")==ap){var ai=k.id(ap);if(ai){ai.id=ap=am.tgt}}if(am.tgt==ap){try{var au="tripads."+am.tgt;if(k.has(au)){ao=k.retrieve(au);break}else{ao=new k.common.ads.TripAd(am);break}}catch(aq){return null}}}}}if(k.common.behavior&&k.common.behavior.gutterAd){var ax=k.id(ar.tgt);if(ax&&ax.hasClass(k.common.behavior.gutterAd.adElemClass)&&ao){ao.gutterAd=true}}}catch(aq){var al=(typeof ar=="string")?ar:ar.tgt;k.util.error.record(aq,"unable to get ad for id: "+al)}}return ao},getIncrementedAdsAjaxCount:function(){return ++f},checkForSponsoredVideo:function(){if(k.id(E)){var ai="#"+E;k.common.ads.injectAjaxAds("locationphotoalbum",ai,false)}else{k.util.error.record(null,"sponsored video 4x4 ad target not found, sponsored video skipped")}},disableRefresh:function(){ab=false},initDoubleClick:function(){if(O&&localStorage.getItem(v)){K=localStorage.getItem(v)}var ai=j.createElement("script");ai.async=true;ai.type="text/javascript";var ak="https:"==j.location.protocol;ai.src=(ak?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var aj=j.getElementsByTagName("script")[0];aj.parentNode.insertBefore(ai,aj);googletag.cmd.push(function(){k.common.ads.addPageTargeting();if(k.has("jwplayerHelper.adUrl")){googletag.pubads().enableVideoAds()}k.common.ads.setAdIdThatEnablesScrolling();googletag.enableServices();k.common.ads.injectViewable();if(k.has("ads.peelbackEnabled")&&k.id("gpt-peelback")&&k.has("ads.gptBase")){if(j.body.offsetWidth>=W){googletag.defineOutOfPageSlot(k.retrieve("ads.gptBase"),"gpt-peelback").addService(googletag.pubads()).setCollapseEmptyDiv(true);googletag.display("gpt-peelback")}else{k.store("ads.pbSuppress",true)}}googletag.pubads().addEventListener("slotRenderEnded",P);if(U.pageServlet==="PageNotFound"){googletag.pubads().addEventListener("slotRenderEnded",k.servlet.PageNotFound.positionFooter)}})},addPageTargeting:function(){try{var aj=k.retrieve("ads.pageTargeting")||{};aj.win_size=i();n(aj);for(var ai in aj){googletag.pubads().setTargeting(ai,aj[ai])}}catch(ak){k.util.error.record(ak,"GPT init: unable to add page targetiing")}},orientationChange:function(){S=U.screen.orientation.type;k.common.ads.refreshAllAdsPolitely(true)},injectViewable:function(){q=af();var am=k.retrieve("ads.adStubs");if(am&&am.length){for(var al=0;al<am.length;al++){var ak=am[al];if(ak.tgt){var aj=k.id(ak.tgt);if(aj&&aj.hasClass&&!aj.hasClass("delayAd")){try{var ai=new k.common.ads.TripAd(ak);if(k.has("ads.reverseScroll")&&ai.getPosY()<q){ai.injectOnScrollUp=true}if(ai.isInView()){ai.inject()}else{ai.defer()}}catch(an){k.util.error.record(an,"unable to create TripAd object for "+ak.tgt)}}}}}},collapseAd:function(ai){if(k.has("ads.gptEnabled")&&ai&&ai.parentNode){var aj=ai.parentNode;do{if(aj.className&&aj.className.indexOf("gptAd")>-1){aj.className+=" taEmpty";break}}while(aj=aj.parentNode)}},injectAdsTargeted:function(aj,ak){if(aj==null||typeof aj!="object"){k.util.error.record("ad injection requires target element, element passed is "+typeof aj);return}var ai=aj;ai.inject(ai.refreshWithNewContext);if(!ak){ak=null}},SEGMENT_MAP:{"family-friendly":"fam",trendy:"trendy_hotel",business:"biz",on_the_beach:"beach",ski_in_out:"ski",luxury:"luxury",spa:"spa",casino:"casino"},deferAds:(function(){var aj;var al=300;var ak;return function ai(ar){if(ak===x){ak=k.has("ads.no_ads_during_scroll")}if(ak&&!ar){aj&&clearTimeout(aj);aj=setTimeout(ai.bind(null,true),al);return}var ax=k.retrieve("deferAds.ads"),at,au;if(!ax){return}try{var aw=false;for(at=0,au=ax.length;at<au;at++){var ap=ax[at];if(ap&&ap.isVisible()&&ap.isInView()){injectAdsTargeted(ap);if(k.eateries){k.eateries.pushXsellToBottom.delay(1000)}if(k.attractions){k.attractions.pushXsellToBottom.delay(1000)}aw=true;delete ax[at]}}if(aw){var am=[];for(at=0,au=ax.length;at<au;at++){if(typeof ax[at]!="undefined"){am.push(ax[at])}}if(am.length>0){k.store("deferAds.ads",am)}else{k.remove("deferAds.ads");U.removeEvent("scroll",U.ta_handleAdDefer)}}}catch(av){try{U.removeEvent("scroll",U.ta_handleAdDefer)}catch(aq){}var an=(ap&&ap.id)?ap.id:"undefined";var ao="ta.common.Ads.deferAds: Error with defer. ad ID: "+an;k.util.error.record(av,ao)}}})(),queueForInjection:function(ai){if(!(U.googletag&&U.googletag.cmd)){k.util.error.record(null,"googletag not defined, unable to queue ad for injection");return}if(ai&&ai.each){googletag.cmd.push(function(){ai.each(function(aj){var ak=k.common.ads.getAd(aj);if(ak){ak.injectWhenViewable(false)}})})}},resetAdRefreshFlag:function(){u=new Date().getTime()},setLocalStorageTargeting:function(){if(O){if(k.has("ads.gptBase")){localStorage.setItem("ads.storage.gptBase",k.retrieve("ads.gptBase"))}if(k.has("ads.pageTargeting")){localStorage.setItem("ads.storage.pageTargeting",JSON.stringify(k.retrieve("ads.pageTargeting")))}}},detectAdBlockers:function(){if(k.trackEventOnPage&&U.Browser){var aj=function(am){U.setTimeout(function(){var ap=true;var ar=k.id("ABCHK");var aq=function(au,at){if(ap){if(!at){au="none"}au+="_"+Browser.name;k.trackEventOnPage("ab_chk",au,at,0,false);ap=false}};if(ar){var ao=ar.style.display=="none"||ar.className!="adInner";if(!ao&&U.getComputedStyle){var an=U.getComputedStyle(ar);ao=an&&an.getPropertyValue("display")=="none"}aq(am,ao)}},500)};var ai=U.CDNHOST||"";var al=ai+"/img2/x.gif?ads=1&rnd="+Math.floor(Math.random()*100000);var ak=new Element("img",{id:"ABCHK","class":"adInner",height:0,width:0,src:al});ak.onload=function(){aj("ab")};ak.onerror=function(){aj("abp")};j.body.appendChild(ak)}},getLocalStorageTargeting:function(){var ai={};if(O){if(localStorage.getItem("ads.storage.gptBase")){ai.gptBase=localStorage.getItem("ads.storage.gptBase")}if(localStorage.getItem("ads.storage.pageTargeting")){ai.pageTargeting=JSON.parse(localStorage.getItem("ads.storage.pageTargeting"))}}return ai},hasStoredGeo:function(){var ai=false;if(O&&localStorage.getItem("ads.storage.pageTargeting")){var aj=JSON.parse(localStorage.getItem("ads.storage.pageTargeting"));ai=!!aj.geo}return ai},refreshWhenRoomListExpand:function(){U.setTimeout(function(){if(k.common.behavior&&k.common.behavior.gutterAd){k.common.behavior.gutterAd.resetTopPosition()}a()},500);X=true},roomListExpandStart:function(){ad=true;X=false;k.common.ads.emptyGutterAd()},emptyGutterAd:function(){ad=true;var ai=k.find(".gptAd.gutterAd");if(ai){ai.empty()}},pauseOnScrollInjection:function(ai){ad=true;if(ai&&ai.tab&&ai.tab.id==="TABS_ROOMS"){k.common.ads.emptyGutterAd()}},resumeOnScrollInjection:function(ai){a(ai)},noOverlaysDisplayed:function(){if(k.overlays&&k.overlays.getCurrent){return typeof k.overlays.getCurrent()==="undefined"}else{return true}},refreshAjaxAds:function(ai){var aj=j.getElements(ai);aj.each(function(ak){var al=k.common.ads.getAd(ak.id);if(al&&al.adElem&&al.adElem.getCoordinates){if(al.adElem.getCoordinates().bottom<U.getScroll().y){al.injectOnScrollUp=true}else{al.injectOnScrollUp=false}al.injectWhenViewable(false)}})},refreshAllAdsPolitely:function(ai){k.common.ads.refreshAllAds.delay(1,null,[ai])},updateAdsFromAjaxTargeting:function(am,ak,al){var aj=k.retrieve("ads."+am.toLowerCase()+".pageTargeting");if(aj){var ai=k.retrieve("ads.adStubs")||[];ai.each(function(ap){var ao=k.id(ap.tgt);if(!ao||!ao.getParent(ak)){var an=k.common.ads.getAd(ap);if(an){if(al){al.each(function(aq){if(aj[aq]){var ar={};ar[aq]=aj[aq];an.addTargeting(ar)}})}o(an)}}})}},refreshAllAds:function(ai){if(!(H(ai)&&U.googletag&&U.googletag.cmd)){return}googletag.cmd.push(function(){try{var am=k.retrieve("ads.adStubs");if(am){googletag.pubads().updateCorrelator();for(var al=0;al<am.length;al++){var ak=am[al];var aj=k.id(ak.tgt)||k.id(ak.tgt.replace(/-ref\d+/,""));var ao=k.common.ads.getAd(ak);if(aj&&ao){if(m(aj,ao,ai)){o(ao)}}}}}catch(an){k.util.error.record(an,"error refreshing all ads")}})},refreshAdsWithStyle:function(ai){k.common.ads.refreshAdsWithStyleOrType(ai)},refreshAdsWithType:function(ai){if(!ai){var aj=k.retrieve("sel.category");if(aj){var ak={cat_1:"hotels",cat_2:"bbs_inns",cat_3:"spec_lodge"};ai=ak[aj]}}if(ai){k.common.ads.refreshAdsWithStyleOrType(null,ai)}},refreshAdsWithStyleOrType:function(ak,aj){var ai=k.id("right_hand_rail")!==null||k.find(".scrollingGutterAd")!==null;if(!ak&&!aj){return}if(ak){ak=ak.toLowerCase()}if(aj){aj=aj.toLowerCase()}if(k.has("ads.gptEnabled")){if(!(U.googletag&&U.googletag.cmd)){k.util.error.record(null,"googletag not defined, unable to refresh ads for style change");return}try{if(k.has("scrollAd.enableScroll")&&ai){ag()}googletag.cmd.push(function(){try{var ap=k.retrieve("ads.adStubs");if(ap&&ap.each){if(ai){ap.each(function(at){if(at.tgt&&k.id(at.tgt)){var ar=k.common.ads.getAd(at);if(ar&&!(ar.slotTargeting&&ar.slotTargeting.kw)){ak&&ar.updateHotelStyle(ak);aj&&ar.updateHotelType(aj);ar.injectWhenViewable(false)}}})}else{for(var ao=0;ao<ap.length;ao++){var an=ap[ao];if(an.type==="leaderboard_top"&&k.id(an.tgt)){var am=k.common.ads.getAd(an);if(am&&!(am.slotTargeting&&am.slotTargeting.kw)){ak&&am.updateHotelStyle(ak);aj&&am.updateHotelType(aj);am.injectWhenViewable(false);break}}}}}}catch(aq){k.util.error.record(aq,"unable to refresh ads for style change via googletag")}})}catch(al){k.util.error.record(al,"unable to refresh ads for style change")}return}else{k.util.error.record(null,"Non GPT call to refresh ads for style change")}},refreshSidebarAds:function(){if(!G){return}var ai=G.getElements(".gptAd");ai.each(function(aj){var ak=k.common.ads.getAd(aj.id);if(ak){ak.injectWhenViewable()}})},refreshSideBarAdsWithRefreshOrdKey:function(){if(k.retrieve("did_ad_refresh")){return}k.store("did_ad_refresh",true);if(k.has("ads.gptEnabled")){var aj=k.select(".sidebar .gptAd");var ai=j.getElement(".iab_leaBoa .gptAd");if(ai){aj.push(ai)}if(aj.length){aj.each(function(ak){var al=k.retrieve("tripads."+ak.id);if(al){al.injectWhenViewable()}})}}else{k.util.error.record(null,"Non GPT call to refresh sidebar ads")}},stringifyTargeting:function(aj){var ak="";for(var ai in aj){if(ak.length){ak+="&"}if(M(aj[ai])||(typeof aj[ai]=="object"&&aj[ai].length)){ak+=ai+"="+aj[ai].toString()}}return encodeURIComponent(ak)},updateHotelHacAds:function(){k.fireEvent("onUpdateAdsChoice");googletag.cmd.push(function(){googletag.pubads().updateCorrelator();k.common.ads.injectAjaxAds("Hotels","#ACCOM_OVERVIEW .gptAd",false);k.common.ads.updateAdsFromAjaxTargeting("Hotels","#ACCOM_OVERVIEW",["proptype","star","brand","subBrand"])})},setMinRefresh:function(ai){L=ai}}}(document,window,ta));define("ta/common/behavior/Ads-pagemoniker",["ns-exporter","ta/util/Error","ta/Core/TA.Store"],function(f,a,g){var b={};b.remarketingOptions={};var d=function(h){return b.remarketingOptions[h]};var e="dates.moniker.fired";var c="dates.enter.moniker.fired";b.loadMonikers=function(h){try{if(!d("pixelsEnabled")){return null}h=h||{};h.pixelType="PAGEVIEW";if(d("pixelContext")&&(d("pixelContext").servlet=="HotelBookingRoomSelectionHtml"||d("pixelContext").servlet=="MobileHotelBookingRoomSelection")){h.pixelType="IB_CLICK";b._addIBPageViewContext(h)}var i=b._loadMonikers(h);if(window.ta&&ta.m&&d("cacheMobileClickoutResponse")){h.pixelType="CLICKOUT";b._cacheClickoutMonikers(h)}return i}catch(j){a.record(j,"ads.loadMonikers",null,{context:h})}return null};b.delayedLoadMonikerForDates=function(){try{if(!g.retrieve(e)){g.store(e,true);setTimeout(b.loadMonikers,2000)}}catch(h){}};b.loadMonikerForEnterDates=function(h){try{if(!d("pixelsEnabled")){return null}if(!g.retrieve(c)){g.store(c,true);h=h||{};h.pixelType="ENTER_DATES";return b._loadMonikers(h)}}catch(i){}};b.loadClickoutMonikers=function(h){try{if(!(d("pixelsEnabled")&&d("clickoutPixelsEnabled"))){return null}if(b._cachedClickoutMonikerText){return b._appendMonikersIFrameText(b._cachedClickoutMonikerText)}h=h||{};h.pixelType="CLICKOUT";return b._loadMonikers(h)}catch(i){a.record(i,"ads.loadClickoutMonikers",null,{context:h})}return null};b.loadLightboxMonikers=function(i,k){try{if(!d("pixelsEnabled")){return null}i=i||{};i.pixelType="LIGHTBOX_CLICK";var h=b._mergeContexts(i,k);var j=b._loadMonikers(h);return j}catch(l){a.record(l,"ads.loadLightboxMonikers",null,{context:i})}return null};b.loadLightboxClickoutMonikers=function(h){try{if(!(d("pixelsEnabled")&&d("clickoutPixelsEnabled"))){return null}h=h||{};h.pixelType="LIGHTBOX_CLICKOUT";return b._loadMonikers(h)}catch(i){a.record(i,"ads.loadLightboxClickoutMonikers",null,{context:h})}return null};b.loadIBClickMonikers=function(h){return b._loadMonikersForPixelType(h,"IB_CLICK")};b.loadIBRoomSelectMonikers=function(h){return b._loadMonikersForPixelType(h,"IB_ROOM_SELECT")};b.loadIBConfirmMonikers=function(h){return b._loadMonikersForPixelType(h,"IB_CONFIRM")};b.loadVRConfirmMonikers=function(h){return b._loadMonikersForPixelType(h,"VR_CONFIRM")};b._loadMonikersForPixelType=function(i,h){try{if(!(d("pixelsEnabled")&&d("ibPixelsEnabled"))){return null}i=i||{};i.pixelType=h;return b._loadMonikers(i)}catch(j){a.record(j,"loadMonikers for pixelType, ",null,{context:i})}return null};b._cacheClickoutMonikers=function(j){var k=d("pixelContext");var h=b._mergeContexts(k,j);var i=b._buildPixelUrl(h);if(!i){return}i+="&reportOnly=true";var l=new XMLHttpRequest();l.open("GET",i,true);l.onreadystatechange=function(){if(this.readyState==4){b._cachedClickoutMonikerText=this.response}};l.send()};b._addIBPageViewContext=function(h){if(document.getElementById("roomList")){h.lowestPrice=document.getElementById("roomList").dataset.lowestPrice}if(document.getElementById("roomInfoContainer")){h.lowestPrice=document.getElementById("roomInfoContainer").dataset.lowestPrice}};b._buildPixelUrl=function(j){if(!d("pixelServlet")){a.record(null,"ads._buildPixelUrl: remarketing.pixelServlet not set");return null}var k=d("pixelList");if(!k){return null}var h="/"+d("pixelServlet")+"?pixelList="+k;for(var i in j){if(j.hasOwnProperty(i)){h+="&"+i+"="+j[i]}}if(ta.uid){h+="&puid="+ta.uid}return h};b._appendMonikersIFrame=function(h){var i=document.createElement("iframe");i.setAttribute("id","Monikers");i.setAttribute("style","border:none; position:absolute; bottom:0; right:0");i.setAttribute("width","1");i.setAttribute("height","1");i.setAttribute("src",h);document.body.appendChild(i);return i};b._appendMonikersIFrameText=function(i){var h=document.createElement("iframe");h.setAttribute("id","Monikers");h.setAttribute("style","border:none; position:absolute; bottom:0; right:0");h.setAttribute("width","1");h.setAttribute("height","1");h.setAttribute("srcdoc",i);document.body.appendChild(h);return h};b._mergeContexts=function(k,j){if(!k){return j}else{if(!j){return k}}var i;var h={};for(i in k){if(k.hasOwnProperty(i)){h[i]=k[i]}}for(i in j){if(j.hasOwnProperty(i)){h[i]=j[i]}}return h};b._loadMonikers=function(j){var l,h;try{l=d("pixelContext");h=b._mergeContexts(l,j);var i=b._buildPixelUrl(h);if(!i){return null}return b._appendMonikersIFrame(i)}catch(k){a.record(k,"ads._loadMonikers",null,{pixelContext:l,extraContext:j})}return null};f.exportTo(b,"ta.common.ads");return b});if(typeof ta.common=="undefined"){ta.common={}}ta.common.dmp=function(l,k,f){var d=null,h=null,e=false,c=false,i=[/^modules\.common\.CityPageRatings/,/^meta_lightbox_open_button/,/^Meta_VP_Submit_Hotels/,/^reviews_travelerphotos/i,/_url_deals/i,/_url_hotel/i,/_url_packages/i,/_url_virtual_tour/i,/abandonedcart/i,/attraction_filter/i,/Attraction_Listing/i,/attraction_multi_click/i,/attraction_sort/i,/attractionbookbutton/i,/attractions_/i,/book_tour_click/,/CertificatOfExcellence/,/commerce_click_/i,/cruisecritic/i,/Eatery_Listing/i,/filters/i,/floatingmap/i,/greenleaders/i,/helpful_vote/i,/helpfulvotegiven/i,/herophotoscrollright/i,/Hotel_Review_EMAIL/i,/keyword_search_num_results/i,/map_/i,/meta_click/i,/meta_style/i,/MobileBusinessListings/i,/more_info_click/i,/multi_click/i,/p13n_tag_select/i,/photos_traveler/i,/rac_result/i,/reservation_button/i,/reserveclick/i,/restaurant_filter/i,/restaurant_sort/i,/restaurant_tag/i,/Reviews_Controls_/i,/reviews_expand/i,/reviews_viewed/i,/reviewstab_vr/i,/saveComplete/i,/self_tags/i,/ShowUserReviews_EMAIL/i,/sliderMoved/i,/special_offer_click/i,/sticky_header_click/i,/tab_button/i,/tab_click/i,/tablecell_click/i,/tag_cloud_click/i,/uber/i,/war_complete/i],g=function(n){if(n){var o=true;o&=b(n,"getName");o&=b(n,"load");o&=b(n,"setUUID");o&=b(n,"setBehaviors");o&=b(n,"addBehavior");o&=b(n,"send");return o}return false},b=function(o,n){if(o){return typeof o[n]=="function"}else{return false}},j=function(n,o){if(typeof o=="undefined"){o="INFO"}if(o=="ERROR"){f.common.dmp.errorRecord(null,n,null,null,o.toUpperCase())}if(c&&console.log){console.log("[ta.common.dmp] ["+o.toUpperCase()+"] "+n)}},m=function(o,n){if(typeof n=="undefined"||n==null||typeof n=="object"){return o}var p=n.toString();if(p.length){if(o==null||o.length<1){o=p}else{o+="_"+p}}return o},a=function(n){try{for(var o=0;o<i.length;o++){if(i[o].test(n)){return true}}if(f.common.dmp.behaviorTracker&&typeof f.common.dmp.behaviorTracker.isValidGABehavior=="function"){return f.common.dmp.behaviorTracker.isValidGABehavior(n)}}catch(p){j("Error evaluating GARecord behavior whitelists","ERROR")}return false};return{isEnabled:function(){if(!h){if(f.common.dmp.store){h=f.common.dmp.store.getValue("dmpEnabled")===true}else{h=false}}return h},errorRecord:function(){if(f&&f.util&&f.util.error&&f.util.error.record){f.util.error.record.apply(this,arguments)}},isValidBehavior:function(n){if(f.common.dmp.behaviorTracker&&typeof f.common.dmp.behaviorTracker.isValidBehavior=="function"){return f.common.dmp.behaviorTracker.isValidBehavior(n)}return true},isNewBehavior:function(n){if(f.common.dmp.behaviorTracker&&typeof f.common.dmp.behaviorTracker.isNewBehavior=="function"){return f.common.dmp.behaviorTracker.isNewBehavior(n)}return true},init:function(){try{if(!f.common.dmp.isEnabled()){j("DMP disabled","INFO");return}if(f.common.dmp.behaviorTracker&&typeof f.common.dmp.behaviorTracker.init=="function"){f.common.dmp.behaviorTracker.init()}var o=f.common.dmp.store.getBehaviors();var p=f.common.dmp.store.getActiveDMP();if(p){if(g(p)){d=p;var s=f.common.dmp.store.getValue("taUUID");if(s){d.setUUID(s)}if(c){for(var r in o){for(var q=0;q<o[r].length;q++){j("setting initial behavior "+r+"="+o[r][q])}}}if(o!=null){d.setBehaviors(o)}f.common.dmp.store.clearBehaviors();d.load()}else{var n=(typeof p.getName=="function")?p.getName():"Unknown DMP";j(n+" failed interface sanity check","ERROR")}}e=true}catch(t){j("init failed. "+t,"ERROR")}},addBehavior:function(o,p){try{if(this.isEnabled()&&this.isValidBehavior(p)&&this.isNewBehavior(o+","+p)){if(e&&d){j("addBehavior "+o+"="+p,"DEBUG");d.addBehavior(o,p)}else{j("addBehavior called, but DMP not yet initialized; adding to stored behaviors: "+o+"="+p,"DEBUG");var n=f.common.dmp.store.getBehaviors();if(!n[o]){n[o]=[p]}else{n[o].push(p)}f.common.dmp.store.setBehaviors(n)}}}catch(q){j("addBehavior failed. "+q,"ERROR")}},addBehaviorBatch:function(n,r){if(this.isEnabled()){for(var q in n){if(n.hasOwnProperty(q)){var o=n[q];if(Object.prototype.toString.call(o)==="[object Array]"){for(var p=0;p<o.length;p++){this.addBehavior(q,o[p])}}else{if(typeof o=="string"||typeof o=="number"){this.addBehavior(q,o)}}}}if(r){f.common.dmp.send()}}},addGABehavior:function(r,s,q,y,x){var n=false;try{var t=f.common.dmp.behaviorTracker&&typeof f.common.dmp.behaviorTracker.addDeviceSpecificGABehaviors=="function"&&f.common.dmp.behaviorTracker.addDeviceSpecificGABehaviors(r,s,q,y);if(t){return true}var p=m(null,r);if(r=="p13n_tag"&&s!=null){p=m(p,s.split(":",1)[0])}else{p=m(p,s)}var o="";if(q){o+=q}var w=o.match(/^\d+$/);if(!(r=="Attractions"&&w)){p=m(p,o)}var z="";if(y){z+=y}var A=z.match(/^\d+$/);var u=((r=="Meta_HAC_Filter"&&q=="neighborhood")||r=="FlashPhotoUploader");if(!(u&&A)){p=m(p,z)}if(p!=null&&p.length&&a(p)){f.common.dmp.addBehavior("GARecord",p);n=true}}catch(v){j("addGABehavior failed. "+v,"ERROR")}return n},sendGABehavior:function(o,s,n,r,q){var p=f.common.dmp.addGABehavior(o,s,n,r,q);if(p){try{f.common.dmp.send()}catch(t){j("Calling ta.common.dmp.send failed in sendGABehavior. "+t,"ERROR")}}},sendEventBehavior:function(q,s,p,r,o){if(f.common.dmp&&typeof f.common.dmp.behaviorTracker.addEventBehavior=="function"){var n=f.common.dmp.behaviorTracker.addEventBehavior(q,s,p,r,o);if(n){f.common.dmp.send()}}},send:function(){try{if(f.common.dmp.isEnabled()&&e&&d){j("send behaviors","DEBUG");d.send()}}catch(n){j("send failed. "+n,"ERROR")}},sendAjaxBehavior:function(n,o){if(typeof n=="string"&&n.length>0&&o!=null){f.common.dmp.addBehavior(n,o);f.common.dmp.send()}},log:j}}(document,window,ta);ta.common.dmp.bluekai=(function(r,n,o){var y="Bluekai",u=n.bluekaiClientId||17576,q=20645,h=4,g={},m=false,l=null,f=false,v=0,d=false,z=("https:"==r.location.protocol?"https":"http")+"://tags.bkrtx.com/js/bk-coretag.js",j=0,k=r.domain,A=false,b="",w=function(){var E=false;try{if(!o.common.dmp){p("Bluekai._addBehaviorsToBlueKai exception: ta.common.dmp not loaded yet","ERROR")}else{b="";for(var C in g){for(var B=0;B<g[C].length;B++){if(o.common.dmp.isValidBehavior(g[C][B])){p("adding behavior "+C+" = "+g[C][B],"DEBUG");l.bk_addPageCtx(C,g[C][B]);E=true;if(A){b+=(b.length>0?"::":"")+C+"="+g[C][B]}}}}}}catch(D){p("Bluekai._addBehaviorsToBlueKai exception. "+D,"ERROR")}return E},t=function(){if(o.common.dmp.store&&o.common.dmp.store.isMobileDevice()){return q}return u},i=function(){try{if(e("_addSendBehaviors")){var C=w();if(C){if("https:"==r.location.protocol){l.bk_pixel_url="https://tags.bluekai.com/"}l.bk_doJSTag(t(),h);s();if(A){A=false;o.trackEventOnPage("DMPBluekai","internal_tracking",b)}}}else{p("Bluekai._addSendBehaviors couldn't send. The API isn't accessible (_hasAPILoaded returned false) even though _loaded = "+d,"WARN")}}catch(D){var B=navigator&&/Trident|MSIE/.test(navigator.userAgent)?"INFO":"ERROR";p("Bluekai._addSendBehaviors general exception: "+D,B)}},c=function(){return m!==false},s=function(){g={}},p=function(C,D){try{if(typeof D=="undefined"){D="DEBUG"}if(console.log&&f){console.log("[ta.common.dmp.bluekai] ["+D+"] "+C)}if(D!="DEBUG"){o.common.dmp.errorRecord(null,C,null,null,D.toUpperCase())}}catch(B){}},e=function(C){if(!l){if(r.getElementById("BK_CONTAINER")&&r.getElementById("BK_CONTAINER").contentWindow){l=r.getElementById("BK_CONTAINER").contentWindow}}var B="";if(C&&typeof C=="string"){B=C+" -> "}B=B+"Bluekai._hasAPILoaded returned false ";if(!r.getElementById("BK_CONTAINER")){p(B+"- iframe element has not created","WARN");return false}else{if(!r.getElementById("BK_CONTAINER").contentWindow){p(B+"- the iframe contentWindow returned null","WARN");return false}else{if(!l){p(B+"- BK iframe container is not yet initialised","WARN");return false}else{if(typeof l.bk_addPageCtx!="function"){p(B+"- BK API bk_addPageCtx function is not found","WARN");return false}else{if(typeof l.bk_doJSTag!="function"){p(B+"- BK API bk_doJSTag function is not found","WARN");return false}else{return true}}}}}},x=function(){try{var C=false;if(n.ta&&o.common.dmp.store){C=o.common.dmp.store.getValue("dmpPerfLoggingEnabled")===true}if(C&&v>0){p("Bluekai loaded in "+(new Date().getTime()-v)+" ms.","INFO")}}catch(B){}},a=function(){return o.common.dmp.store&&o.common.dmp.store.getValue("dmpMeasureTest")};return{getName:function(){return y},load:function(){try{f=o.common.dmp.store&&o.common.dmp.store.getValue("dmpConsoleDebugEnabled");p("loading Bluekai API","DEBUG");var B='<!DOCTYPE HTML><html><head>  <script type="text/javascript" src="'+z+'"><\/script></head><body>  <iframe name="__bkframe" height="0" width="0" frameborder="0" src="javascript:void(0)"></iframe>  <script type="text/javascript">  (function(win) {    function getBluekai(win) {      var obj = win.ta && win.ta.common && win.ta.common.dmp && win.ta.common.dmp.bluekai;      if (!obj && win.parent && win.parent != win) {        return getBluekai(win.parent);      }      return obj;    }    var bluekaiObj = getBluekai(win);    if (bluekaiObj) {      if (bluekaiObj.shouldIframeDomainBeSet()) {        document.domain = bluekaiObj.getParentPageDomain();      }      bluekaiObj.sendAfterLoad();    }  })(window);  <\/script></body></html>';var C=r.createElement("iframe");C.id="BK_CONTAINER";C.src="javascript:'"+B+"'";C.width=1;C.height=1;C.frameBorder=0;C.title="";C.role="presentation";C.style.position="absolute";C.style.bottom=0;C.style.right=0;v=new Date().getTime();r.body.appendChild(C);l=C.contentWindow}catch(D){p("Bluekai.load general exception. Failed to load API. "+D,"ERROR")}},shouldIframeDomainBeSet:function(){try{l.document&&typeof l.bk_addPageCtx=="function"}catch(B){return true}return false},getParentPageDomain:function(){return k},setUUID:function(B){m=B},setBehaviors:function(B){g=B||{}},addBehavior:function(B,C){if(!g[B]){g[B]=[C]}else{g[B].push(C)}},sendAfterLoad:function(){try{if(e("sendAfterLoad")){x();d=true;if(j>0){p("Bluekai API successfully loaded after "+j+" retries.","WARN")}p("sending initial behaviors","DEBUG");l.bk_addPageCtx("__bk_l",r.location.href);if(c()){p("sending UUID: "+m,"DEBUG");l.bk_addPageCtx("uuid",m)}l.bk_allow_multiple_calls=true;if(o.common.dmp.store&&o.common.dmp.store.getValue("dmpBlueKaiEnableMultipleIframes")){l.bk_use_multiple_iframes=true}l.bk_ignore_meta=true;A=a();i()}else{j++;if(j<=3){n.setTimeout(o.common.dmp.bluekai.sendAfterLoad,(200*j))}else{p("Bluekai API failed to load after 3 retries. Giving up.","WARN")}}}catch(B){p("Bluekai.sendAfterLoad general exception: "+B,"ERROR")}A=false},send:function(){if(d){i()}}}}(document,window,ta));ta.common.dmp.store=(function(){var a={};var b={};var d=null;var c=false;return{setBehaviors:function(e){a=e||{}},clearBehaviors:function(){a={}},getBehaviors:function(){return a},storeValue:function(e,f){b[e]=f},hasValue:function(e){return typeof b[e]!="undefined"},getValue:function(e){return b[e]},getActiveDMP:function(){return d},setMobileDevice:function(){c=true},isMobileDevice:function(){return c},setActiveDMP:function(e){d=e}}}());ta.common.dmp.behaviorTracker=(function(r,j,k){var h=[];var w=[];var g=[/^attraction_deep_link/,/hotel_review/i,/datepicker_select/i,/dmo_content_click/i,/dmo_unit_visible/i];var s=[/^thirty_days$/i,/^review$/i,/^vrpi$/i,/^attrpi$/i,/^flightspi$/i,/^bookingpi$/i,/^travelocitypi$/i,/^expediapi$/i,/^hotelscompi$/i,/^pricelinepi$/i,/^cheaptixpi$/i,/^venerepi$/i,/^splendiapi$/i,/^agodapi$/i,/^olotelspi$/i,/^hrspi$/i,/^ebookerspi$/i,/^edreamspi$/i,/^hotelclubpi$/i,/^tcookukpi$/i,/^wotifaupi$/i,/^despegarpi$/i,/^beach_b$/i,/^budget_b$/i,/^luxury_b$/i,/^natparks_b$/i,/^romance_b$/i,/^spa_b$/i];var e=false,u=false;var o=/^\/((Hotel|Restaurant|Attraction)_Review|VacationRentalReview)/i,a=/reviews/i,p=null;var t=function(x){try{for(var y=0;y<g.length;y++){if(g[y].test(x)){return true}}}catch(z){n("Error evaluating GARecord behavior blacklists","ERROR")}return false},v=function(x){for(var y=0;y<g.length;y++){if(g[y].test(x)){return true}}return false},b=function(){try{if(j.ta&&k.widgets&&k.widgets.calendar&&k.util&&k.util.date){var x=k.widgets.calendar.getPageInDate();if(x){var z=k.util.date.getDaysInRange(new Date(),x)-1;k.common.dmp.addBehavior("Calendar","days_to_trip_"+z);var E=m(x);if(E){k.common.dmp.addBehavior("Calendar","start_"+E)}var F=q(x);if(F){k.common.dmp.addBehavior("Calendar_Month",F)}var C=k.widgets.calendar.getPageOutDate();if(C){var y=k.util.date.getDaysInRange(x,C)-1;k.common.dmp.addBehavior("Calendar","stay_duration_"+y);var A=m(C);if(A){k.common.dmp.addBehavior("Calendar","end_"+A)}var D=q(C);if(D&&D!=F){k.common.dmp.addBehavior("Calendar_Month",D)}}}}}catch(B){n("Error adding calendar behaviors","ERROR")}},q=function(x){var y=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];try{if(x&&x.getMonth()>=0&&x.getMonth()<y.length){return y[x.getMonth()]}}catch(z){n("Error getting month from date "+x,"ERROR")}return"unknown"},m=function(x){var z=["sun","mon","tue","wed","thu","fri","sat"];try{if(x&&x.getDay()>=0&&x.getDay()<z.length){return z[x.getDay()]}}catch(y){n("Error getting day of week from date "+x,"ERROR")}return"unknown"},d=function(y,x){u=y||u;e=x||e;if(u&&e){k.common.dmp.addBehavior("Meta_Click",u+"_rank_"+e);u=false;e=false}},n=function(x,y){if(k.common.dmp&&typeof k.common.dmp.log=="function"){k.common.dmp.log(x,y)}},i=function(){var z=k.find("#REVIEWS .reviewSelector");if(z){var x=z.getCoordinates().top||0;var y=j.getScroll().y;var A=j.getHeight();if(x>0&&(y+(A/2))>=(x)){f("reviews_scrolled",true);j.clearInterval(p)}}},f=function(A,z){if(!A||!j.location){return}var y=o.exec(j.location.pathname);var x="";if(y&&y.length>=2){x=y[1]}if(x&&x.length>0){k.common.dmp.addBehavior(A,x)}if(z){k.common.dmp.send()}},l=function(){if(j.location){var x=j.location.pathname;var y=j.location.hash;if(x&&o.test(x)){if(y&&a.test(y)){f("reviews_viewed")}else{if(k.common.dmp.store&&k.common.dmp.store.getValue("dmpReviewReadTest")){p=i.periodical(30000)}}}}},c=function(x,y){if(x&&y&&y.length){x.push(y)}};return{init:function(){var x=["CheapFlightsHome","FlightsTo","Flights"];if(x.indexOf&&x.indexOf(j.pageServlet)===-1){b()}l();if(k.common.dmp.store&&k.common.dmp.store.getValue("dmpMetaExposedEnabled")){this.sendMetaExposedTags();k.on("HRHacComplete",this.sendMetaExposedTags)}},isNewBehavior:function(x){try{if(x&&!h.contains(x)){h.push(x);return true}return false}catch(y){n("Error evaluating whether to send interval behavior to DMP","ERROR")}return true},isValidBehavior:function(x){try{for(var y=0;y<s.length;y++){if(s[y].test(x)){n("Blacklisted behavior: "+x,"DEBUG");return false}}}catch(z){n("Error evaluating behavior blacklists","ERROR")}return true},isValidGABehavior:function(x){return t(x)},addDeviceSpecificGABehaviors:function(y,A,x,z){if(A=="meta_click"){d(false,z);return true}if(y=="CheckRates"){d(x,false);return true}if(y=="DATEPICKER"&&A=="SELECT"){b()}return false},addEventBehavior:function(z,B,y,A){if(v(z)){var x=[z];c(x,B);c(x,y);c(x,A);k.common.dmp.addBehavior("GARecord",x.join("_"));return true}return false},sendMetaExposedTags:function(){if(k.common.dmp.store&&k.common.dmp.store.getValue("dmpMetaExposedEnabled")){var y=/MainCommerce.*\\N:(\d+).*?\\PN:(BookingCom).*?\\F:(\w+)/;try{k.select(".impressionTrackingTree").each(function(B){if(B){var A=B.innerHTML;var z=y.exec(A);if(z&&z.length>3){var E=z[2];var C=z[3];var D=z[1];var F=E+"_"+C+"_rank_"+D;if(!w.contains(F)){k.common.dmp.sendAjaxBehavior("Meta_Exposed",F);w.push(F)}}}})}catch(x){n("Error scraping meta exposed data for DMP. "+x,"ERROR")}}}}}(document,window,ta));define("ta/maps/trackpixel",["vanillajs"],function(b){var a=[];return{storeTrackPixleSrc:function(c){if(c){if(c.splice){Array.prototype.push.apply(a,c)}else{a.push(c)}}},loadSponsorTrackingPixel:function(c){a.forEach(function(d){var e=d.trim();var f=new Image();f.className="tracking";f.src=e});if(!c){a=[]}}}});linkMap.js_modifySub=function(a,b){modifySub.apply(a,[b])};rules["#NEWSLETTER_CALLOUT input.memberUpdateEmail[type=text]"]=function(a){$("memberUpdatesEmailDefault").hide();$(a.form).addEvent("submit",function(b){if(a.value==$("memberUpdatesEmailDefault").innerHTML){a.value=""}})};function alertIfEmpty(a){if(a&&a.value==""){if(msg=a.className.match(/\bmsg_([\w\d]+)\b/)){alert(window[msg[1]])}else{alert("The field can not be empty")}return false}return true}function addNonMember(c,b){if(!b){b=this}popupConfig.clickedElement=b;new Event(c).preventDefault();var a="/MemberBenefitsPopup";if(/pid(\d+)/.test(b.className)){a+="?pid="+RegExp.$1}showDHTMLPopup("MemberBenefitsPopup",a,true)}function clickNonMember(){setTimeout("window.lightbox.deactivate()",500);if(popupConfig.clickedElement==null){return}var a=popupConfig.clickedElement;popupConfig.clickedElement=null;$$("#TRAVEL_GUIDES_LANDER .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});$$("#TRAVEL_GUIDES_FLY .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});if(a.className.match(/\bclickPopDestMOGLink\b/)){processPopDestMOGLink(null,a)}else{if(a.get("tag")=="a"){window.location=a.getProperty("href")}else{a.click()}}}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}rules["#TRAVEL_GUIDES_LANDER .clickNonMember"]=rules["#TRAVEL_GUIDES_FLY .clickNonMember"]=function(a){if(a.get("tag")!="a"||!a.className.match(/\bskipATag\b/)){a.addEvent("click",addNonMember)}};rules["#TRAVEL_GUIDES_LANDER .clickPopDestMOGLink"]=function(a){a.addEvent("click",processPopDestMOGLink)};rules["#HELP_CENTER dl.js_toggleset"]=function(a){var c=0;var b=new ToggleSet(a.getElements("dt"),a.getElements("dd"));if(window.location.hash&&(hash=window.location.hash.match(/c(\d+)/))){b.display(parseInt(hash[1]))}};rules["#TAB_CONTAINER"]=ta.widgets.tabContainer;linkMap.js_replaceContentSet=function(c,f){var d=c.className.match(/set_([^\s"]*)?/);if(!d||d.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class set_??? to indicate the set of elements the contents of which should be replaced")}var a=c.className.match(/id_([^\s"]*)?/);if(!a||a.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}a=a[1];var b=$(a);if(!b){throw new Error("Element of id "+a+" does not exist.")}d=d[1];replaceContentSet(d,f,b.id)};var replaceContentSet=function(h,j,f){j=new Event(j);var b=$$("a.set_"+h);for(var c=0;c<b.length;c++){var k=b[c];var g=k.className.match(/id_([^\s"]*)?/);if(!g||g.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}g=g[1];var d=$(g);var a=k.href;if(c==b.length-1&&f){d.addEvent("onContentReplaced",function(){window.setTimeout(function(){window.location.hash=f},200)})}else{if(f){d.removeEvents("onContentReplaced")}}if(a){replaceContent(j,d,a)}}j.stop()};function vrCalculator(c,g){var f=g!=null?new Event(g):null;if(c&&/pid(\d+)/.test(c.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}var b="";var a=$("homePageVRCalcPromo");if(!a){a=$("calculatorOverviewPromo")}if(!a){a=$("calculatorLanderPromo")}if(!a){a=$("expandedHomePageVRCalcPromo")}if(a&&$("vrCalculatorForm")){var d=a.getElement("#geoName");if(d.hasClass("focusClear")){d.value="";d.removeClass("focusClear")}b="&geoName="+a.getElement("#geoName").value;if(a.getElement("#adults")){b+="&adults="+a.getElement("#adults").value}if(a.getElement("#nights")){b+="&nights="+a.getElement("#nights").value}}new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,backdropClickClose:true,onReady:function(){this.inner.getElement("input").focus()}}).loadRemoteContent("/VacationRentalCalculator?restart=true"+b);if(f){f.stop()}return false}linkMap.js_submitVRCalculator=function(b,g){var d=g!=null?new Event(g):null;var h=$("vrCalculator");var c=h.getElement("form");var f=h.getElement(".serverErrorMsg");if(f){f.style.display="none"}if(c.geoName.value==""){h.getElement(".errorMsg").style.display=""}else{var a=c.action+"?"+c.toQueryString();replaceContent(g,h.getParent(),a)}if(d){d.stop()}return false};var SocialHistory=function(){var o={f:["http://www.facebook.com/","https://login.facebook.com/login.php","http://www.facebook.com/home.php"]};var l={};function m(s,r,i){if(s.currentStyle){var t=s.currentStyle[i]}else{if(window.getComputedStyle){var t=r.defaultView.getComputedStyle(s,null).getPropertyValue(i)}}return t}function j(i){i.parentNode.removeChild(i)}function p(){var i=document.createElement("iframe");i.style.position="absolute";i.style.visibility="hidden";document.body.appendChild(i);if(i.contentDocument){i.doc=i.contentDocument}else{if(i.contentWindow){i.doc=i.contentWindow.document}}i.doc.open();i.doc.write("<style>");i.doc.write("a{color: #000000; display:none;}");i.doc.write("a:visited {color: #FF0000; display:inline;}");i.doc.write("</style>");i.doc.close();return i}var g=p();function c(r,s){var i=g.doc.createElement("a");i.href=r;i.innerHTML=a;g.doc.body.appendChild(i)}for(var a in o){var n=o[a];for(var h=0;h<n.length;h++){c(n[h],a);if(n[h].match(/www\./)){var e=n[h].replace(/www\./,"");c(e,a)}else{var d=n[h].indexOf("//")+2;var f=n[h].substring(0,d)+"www."+n[h].substring(d);c(f,a)}}}var q=g.doc.body.childNodes;for(var h=0;h<q.length;h++){var k=m(q[h],g.doc,"display");var b=k!="none";if(b){l[q[h].innerHTML]=true}}j(g);return new (function(){var i=[];for(var r in l){i.push(r)}this.visitedSites=function(){return i};this.doesVisit=function(t){if(typeof(o[t])=="undefined"){return -1}return typeof(l[t])!="undefined"};var s=[];for(var r in o){s.push(r)}this.checkedSites=function(){return s}})()};function sniffFacebook(){var d=false;try{var a=SocialHistory();var b=a.visitedSites();if(b[0]=="f"){d=true}}catch(c){}return d};require(["ta/rollupAmdShim"],function(a){a.install(["trcore","ta/p13n/placements","ta/prwidgets"],["ta/rollupAmdShim","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"tripadvisor",files:{js3:{src:{trcore:1,ta:{prwidgets:1,p13n:{placements:1}}}}},_:{baseUrl:"/"}})};define("overlays/options/closeOnSourceClick",["vanillajs","api-mod"],function(e,d){function b(f){if(d.containsElement(this.sourceElement,f.target)){this.hide("source-click")}}function a(f){return function(){var h=b.bind(this);var g=(function(i){setTimeout(i.bind(this),1)}).bind(this);this.on("show",g.bind(undefined,function(){d.addEvent(this.sourceElement,"click",h);f&&d.addEvent(this.sourceElement,"touchstart",h)})).on("hide",g.bind(undefined,function(){d.removeEvent(this.sourceElement,"click",h);f&&d.removeEvent(this.sourceElement,"touchstart",h)}))}}var c=a(true);c.withoutTouchEvents=a(false);return c});require(["ta/rollupAmdShim"],function(a){a.install(["masthead/header","masthead/NotificationDropdown","masthead/warToDoList","overlays/options/storeOverlayOnElement","overlays/options/matchWidth","overlays/options/closeOnLegacyOverlay","overlays/styles/tooltip","overlays/uiOverlay"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"common-header",files:{"js-amd":{src:{overlays:{uiOverlay:1,options:{matchWidth:1,closeOnLegacyOverlay:1,storeOverlayOnElement:1},styles:{tooltip:1}},masthead:{warToDoList:1,header:1,NotificationDropdown:1}}}},_:{baseUrl:"/"}})};define("masthead/header",["api-mod","lib/jquery-amd","overlays/Overlay","overlays/styles/modal","overlays/styles/dropdown","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/closeOnSourceClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","ta/Core/TA.Event","ta/Core/TA.Record","ta/Core/TA.Store","ta/util/Element"],function(k,e,i,b,o,u,j,g,p,d,s,n,h,m,r,q){var t={};var l;var f;h.queueForReady(function a(){var x=e(".masthead h1");if(x.height()<45){return}var y=x.clone().css({overflow:"hidden",visibility:"hidden",position:"absolute"});x.parent().append(y);var w=y.text();var v=w.length-1;while(v>0&&y.height()>=45){v=w.lastIndexOf(" ");if(v>=0){w=w.substring(0,v)+"...";y.text(w);k.forceReflow(y.get(0))}}y.remove();x.text(w)},0,"truncateLongMasthead");var c=(function(){var w={};var v={};v.open=function(x,D,z,B,y,E){if(x in w){w[x].show();return true}else{y=y||{};E=E||{};var A=y.direction||"below";var F=y.type=="dropdown"?o:b;var C=w[x]=new i(D,[F(D,A,B,""),u[A](y.offset||[0,0]),j,p,g,d,y.windowshade&&s(),y.url?n(y.url,{resources:y.resources}):null]);E.show&&C.on("show",E.show.bind(null,w[x]));E.hide&&C.on("hide",E.hide.bind(null,w[x]));y.url&&E.load&&C.on("contentLoaded",E.load.bind(null,C));C.arrow&&C.arrow.destroy();C.show();if(z){C.contentElement.innerHTML=z;E.load&&E.load(C)}}};v.close=function(x){x in w&&w[x].hide()};v.openSubmenu=function(x,D,B,C,y,F){var K,z=[],J;var G=function(M,L){z[L]=M;if(J){clearTimeout(J);J=0}if(!z[0]&&!z[1]){J=setTimeout(function(){if(!z[0]&&!z[1]){c.close(x)}},300)}};var I=G.bind(null,true,0);var E=G.bind(null,false,0);var A=G.bind(null,true,1);var H=G.bind(null,false,1);c.open(x,D,B,C,y,{show:function(L){K=D.onmouseover;D.onmouseover=null;k.addEvent(D,{mouseover:I,mouseout:E});k.addEvent(L.container,{mouseover:A,mouseout:H});F&&F.show&&F.show();setTimeout(L.reposition.bind(L),1)},hide:function(L){k.removeEvent(D,{mouseover:I,mouseout:E});k.removeEvent(L.container,{mouseover:A,mouseout:H});D.onmouseover=K;F&&F.hide&&F.hide()}})};return v})();t.createNavMenu=function(x,v){v=v||{};var w=false;q.hoverIntent(x,{over:function(){var y=e(this);if((y.hasClass("ownerMenu")||y.hasClass("warLink"))&&f){return}if(v.initFn&&!w){v.initFn();w=true}e(".subNav",this).show();if(v.showFn){v.showFn.call(null,evnt)}h.fireEvent("onOverlayShow")},out:function(y){e(".subNav",this).hide();if(v.hideFn){v.hideFn.call(null,y)}},timeout:v.timeout||500})};t.openAccountMenu=function(v){m.trackEventOnPage("UtilityNav","open","Signed_in_profile_dropdown");var w=e(".bizMenu.overlayContents",v);if(w.length){l=w.html();w.remove()}c.open("profile",v,e(".overlayContents",v).html(),"accountMenuFlyout dropMenu",{type:"dropdown"},{show:function(){f=1;h.fireEvent("mastheadFlyoutOpened")},hide:function(){f=0}});return false};t.openBizListingsMenu=function(v){if(!l){return false}c.openSubmenu("bizListings",v,l,"dropMenu bizListingsMenuFlyout",{direction:"right",type:"dropdown"});return false};t.openCurrencyPicker=function(x,w){var v="global_currency_picker_overlay";if(r.retrieve("currency_format_using_icu4j_cldr.featureEnabled")=="true"){v+=" currency_format_using_icu4j_cldr"}c.open("currency",x,null,v,{type:"dropdown",url:"/StaticVelocityPage?t=currency_picker.vm",resources:[globalCurrencyPickerCSS]},{show:h.fireEvent.bind(null,"mastheadFlyoutOpened"),load:m.trackEventOnPage.bind(null,"CurrencyPicker","Open",w)});return false};t.openPosSelector=function(v){var x={modelGeoId:window.modelGeoId,pageFeature:window.pageFeature,footerFlagFormat:window.footerFlagFormat,flagsSettings:window.flagsSettings||[],localeCodes:window.localeCodes,flagsFlyoutCSS:window.flagsFlyoutCSS};var y=function(z,A){return A?"&"+z+"="+A:""};var w="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+x.footerFlagFormat+"&flagsURL="+encodeURIComponent(document.location.pathname+(document.location.search||"")+(document.location.hash||""))+"&useHreflangs="+(window.pageServlet=="ShowTopic")+y("geo",x.modelGeoId)+y("pageFeature",x.pageFeature)+y("localeCodes",x.localeCodes);x.flagsSettings.forEach(function(z){w+="&"+z+"=true"});c.open("pos",v,null,"flags_flyout_overlay",{showCloseBtn:true,url:w,resources:[x.flagsFlyoutCSS]},{show:h.fireEvent.bind(null,"mastheadFlyoutOpened"),load:function(z){if(r.retrieve("flag_links.useHrefLangs")){e("a.flag_link",z.container).each(function(A,C){C=e(C);var B=e("link[hreflang="+C.attr("hreflang")+"]").prop("href");if(B){C.prop("href",B)}else{C.parent().css("display","none")}});e("li.region",z.container).each(function(A,B){if(!e("li.flag_item",B).is(":visible")){B.hide()}})}}});return false};t.addClearParam=function(v){if(typeof document.cookie!=="undefined"&&document.cookie&&document.cookie.indexOf("TASession")>=0){if(ta.hac&&ta.hac.filters&&ta.hac.filters.cancelAllExistingHAC){ta.hac.filters.cancelAllExistingHAC()}if(v&&v.href&&v.href.indexOf("clearFilters=true")<=-1){v.href+=(v.href.indexOf("?")>-1?"&":"?")+"clearFilters=true"}}};return t});define("masthead/NotificationDropdown",["api-mod","vanillajs","ta/backbone/ModuleLoader"],function(b,d,c){function a(t,v){var u=-10;var o=false;var A=false;var i=false;var k=null;var q=null;var h=null;var r=null;var f=null;var x=null;var z=null;var p="modules.engagement.NotificationDropdown";var l="notification_desktop_deleted";var g=function(B){if(!i||!q||(B&&t.containsElement(f,B.target))||(B&&B.target.className=="notif_close_button")){return}i=false;q.style.left=u+"px";t.addClass(q,"hidden");t.removeClass(x,"masthead_notifctr_active");var C=window.bbapp&&bbapp.getView(p);if(C){C.record("CloseNotifDropdown")}};var s=function(){if(!q||i){return}i=true;t.removeClass(q,"hidden");t.addClass(x,"masthead_notifctr_active");var B=t.getPosition(f).left;var D=t.getCoords(q).width;var C=window.outerWidth;if(B+D>C){q.style.left=(u+(C-B)-D)+"px"}n(0)};var m=function(){if(z){return}z=setTimeout(function(){z=null;r=t.find(".notifdd_list",k);t.removeClass(h,"hidden");r&&t.addClass(r,"hidden");s()},250)};var y=function(){if(z){clearTimeout(z);z=null}t.addClass(h,"hidden");r=t.find(".notifdd_list",k);r&&t.removeClass(r,"hidden");s()};var n=function(C){var B=t.find(".masthead_notifctr_jewel",k);B.innerText=C;if(C==0&&!t.hasClass(B,"hidden")){t.addClass(B,"hidden");t.removeClass(x,"masthead_notifctr_unread")}else{if(C>0&&t.hasClass(B,"hidden")){t.removeClass(B,"hidden");t.addClass(x,"masthead_notifctr_unread")}}};var e={initialize:function(){this.listenTo(this.context.get("Engagement_MemberNotifications.data.notifications"),"reset",this.render);this.listenTo(this,"render",this.onRender);this.onRender()},onRender:function(){this.listEl=t.find(".notifdd_list",this.el);var B=this;require(["underscore"],function(C){var D=[];C.each(t.select(".notifdd_notif_container",B.el),function(E){if(t.hasClass(E,"notifdd_unread")){D.push(+E.getAttribute("data-notif-id"))}});B.record("OpenNotifDropdown",{context:D.length});if(D.length>0){B.context.save("modules.engagement.entity.NotificationStatusUpdate",{set:true,status:["READ"],notifs:D})}})},refreshData:function(){var D=this.context.get("Engagement_MemberNotifications");if(D){return D.fetch()}var C=new ta.util.Deferred();var B=this;setTimeout(function(){C.resolve();B.onRender()},0);return C.promise()},events:{"click a.notifdd_link":function(B,C){C=C||B.currentTarget;this.record("NotifDropdownClick",{context:C.getAttribute("data-notif-type")});var D=this.context.save("modules.engagement.entity.NotificationStatusUpdate",{set:true,status:["USED"],notifs:[+C.getAttribute("data-notif-id")]});var E=function(){window.location.assign(C.href)};D.always(E);setTimeout(E,100);t.stopEvent(B)},mousewheel:function(B){var C;if(B.event){C=B.wheel||B.event.wheelDelta||-B.event.detail}else{C=B.wheel||B.wheelDelta||-B.detail}if((this.listEl.scrollTop<=0&&C>0)||(C<0&&this.listEl.scrollTop>=(this.listEl.scrollHeight-this.listEl.offsetHeight))){t.stopEvent(B)}},"click div.notif_close_button":function(B,F){F=F||B.currentTarget;this.context.save("modules.engagement.entity.NotificationStatusUpdate",{set:true,status:["DELETED"],notifs:[+F.getAttribute("data-notif-id")]});this.record(l,{context:F.getAttribute("data-notif-type")});var C=t.find(".notifdd_list");var E=C.scrollTop;var G=this.context.get("Engagement_MemberNotifications.data.notifications");var D=F.getAttribute("data-notif-index");G.remove(G.at(D));this.render();C=t.find(".notifdd_list");if(C){C.scrollTop=E}}}};var w=function(){require(["backbone/modbone/View"],function(B){B.create(p,e)})};var j=function(){f=t.find(".masthead_notification",k);x=t.find(".masthead_notifctr_btn",k);var B=t.find(".masthead_notifctr_dropdown",f);B.parentNode.removeChild(B);t.append(f,q);var C=i?t.addClass:t.removeClass;C(x,"masthead_notifctr_active")};return{toggleNotifCenter:function(){k=t.find(".masthead_notification_enabled");f=t.find(".masthead_notification",k);q=t.find(".masthead_notifctr_dropdown",f);h=t.find(".notifdd_loading",q);x=t.find(".masthead_notifctr_btn",f);if(!A){A=true;t.addEvent(window,"click",g);ta.on("mastheadFlyoutOpened",g);ta.on("afterIpHeaderInjection",j)}if(!o){o=true;m();v(p,q).success(w).success(y);return}if(t.hasClass(q,"hidden")){var B=window.bbapp&&bbapp.getView(p);if(!B){return}m();B.refreshData().success(y);ta.fireEvent("mastheadFlyoutOpened")}else{g()}}}}return a(b,c)});define("masthead/warToDoList",["api-mod","lib/jquery-amd"],function(e,g){var c={};var a=false;var d=false;c.open=function(i){if(!d){f(i);d=true}if(!a){ta.setEvtCookie("WAR","MASTHEAD_WAR_DROPDOWN","MASTHEAD_WAR_DROPDOWN_OPENED","39392","/UserReviewRedesign")}var h=g(".masthead_war_dropdown").toggleClass("masthead_war_dropdown_active",!a);g(".subNav",h).toggleClass("shown");ta.fireEvent("mastheadFlyoutOpened");a=!a};c.seeMore=function(k,j,i){k=g(k);var h=k.parents(".warSection").find(".warItems");if(i){g(".warLoc",h).slice(j).addClass("hidden")}else{g(".warLoc.hidden",h).slice(0,j).removeClass("hidden")}var l=!i&&g(".warLoc.hidden",h).length==0;g(".warMore",h).toggleClass("hidden",l);g(".warLess",h).toggleClass("hidden",!l)};c.toggleList=function(h){h=g(h);h.parents(".warSection").find(".warItems").toggle();h.find(".toggle_arrow").toggleClass("caret-down caret-right")};function f(h){g(window).on("click",b);ta.on("mastheadFlyoutOpened",b);ta.trackEventOnPageOnce("WAR","GLOBAL_NAV_WAR_HOVER");var j=g("#WAR_TODO_LOADING").removeClass("hidden");if(j.length){var i=h?{d:h}:{};new Request({url:"/UserReviewToDoListAjax",data:i,method:"get",onSuccess:function(n){var m=g("<div>").html(n);j.replaceWith(g("#WAR_MORE_TO_DO_ITEMS",m));var l=g("#WAR_NOTIFICATION_FLAG, #NO_WAR_NOTIFICATION_FLAG").first();if(l.length){var k=g("#WAR_NOTIFICATION_FLAG_NEW",m);if(k.length){l.replaceWith(k);k.prop("id","WAR_NOTIFICATION_FLAG")}else{if(g("#NO_WAR_NOTIFICATION_FLAG",m).length){l.remove()}}}}}).send()}}function b(h){if(!a){return}var i=g(".masthead_war_dropdown");if(h&&i.find(h.target).length){return}g(".subNav",i).removeClass("shown");a=false;i.removeClass("masthead_war_dropdown_active")}return c});define("overlays/options/storeOverlayOnElement",["vanillajs","api-mod"],function(c,b){var a=function(){if(this.sourceElement){b.store(this.sourceElement,"overlay",this)}};return a});define("overlays/options/matchWidth",["vanillajs","api-mod"],function(c,b){var a=function(e){function d(){if(this.container&&e){b.setStyle(this.container,"width",b.getSize(e).x+"px");this.emit("positionDirty")}}return function(){this.on("show",b.bind(d,this))}};return a});define("overlays/options/closeOnLegacyOverlay",["vanillajs","ta/Core/TA.Event"],function(b,a){return function(){a.on("onOverlayShow",this.hide.bind(this))}});define("overlays/uiOverlay",["vanillajs","api-mod"],function(d,b){var c={tooltip:{defaultPosition:"above",defaultFade:"fade_short"},popover:{defaultPosition:"below",defaultFade:"fade_short"},modal:{defaultPosition:"center",defaultFixed:true,defaultFade:"fade_short"},dropdown:{defaultPosition:"below"},notification:{}};var e={};var a=function(s,i){s=s||window.event;i=i||s.target||s.srcElement;var n=s&&s.type;if(n){b.removePropertyEvent(i,n,"uiOverlay")}if(s){b.stopEvent(s)}var j=(i.getAttribute("data-position")||"").split(" ").filter(function(t){return !!t.length});var p=j.shift();var q=["overlays/Overlay","overlays/position"];var k;for(var h in c){if(i.hasAttribute("data-"+h)){p=p||c[h].defaultPosition;q.push("overlays/styles/"+h);k=true;break}}var r=i.getAttribute("data-options")||"";if(!k&&require.defined("ta/util/Error")){var g="uiOverlay: no style. class="+i.className+", id="+i.id;[].forEach.call(i.attributes,function(t){if(/^data-/.test(t.name)){g+=", "+t.name+"="+t.value}});require("ta/util/Error").record(null,g);return}q.push(i.hasAttribute("data-windowshade")?"overlays/styles/windowshade":null);var f=false;if(i.hasAttribute("data-defer")){f=parseInt(i.getAttribute("data-defer"))}q.push(f?"overlays/options/hoverDelay":null);q.push(i.hasAttribute("data-fade")?"overlays/options/fadeInOut":null);q.push(i.getAttribute("data-url")?"overlays/options/ajax":null);q.push(i.hasAttribute("data-close-event")?"overlays/options/closeOnEvent":null);q.push(i.hasAttribute("data-maxWidth")?"overlays/options/maxWidth":null);q.push(i.hasAttribute("data-close-child")?"overlays/options/closeOnTargetChildClick":null);q.push("overlays/options/storeOverlayOnElement");if(r){q=q.concat(r.split(" ").map(function(t){return"overlays/options/"+t}))}if(i.hasAttribute("data-tooltip")){if(n==="click"){q.push("overlays/options/closeOnDocClick")}else{if(n==="mouseover"){if(r.indexOf("closeOnMouseAway")<0){q.push("overlays/options/closeOnMouseOut")}}}}else{if(i.hasAttribute("data-dropdown")){if(n==="click"){q.push("overlays/options/closeOnDocClick");q.push("overlays/options/closeOnSourceClick")}else{if(n==="mouseover"){q.push("overlays/options/closeOnMouseAway")}}}}var m;if(i.hasAttribute("data-unique")){m=i.getAttribute("data-unique");if(m&&(m in e)){var l=e[m];l.sourceElement=i;l.updateContent();!f&&l.show();if(i.hasAttribute("data-callback")){var o=b.fn(i.getAttribute("data-callback"));o&&o(l)}return}}if(require.defined("ta/util/Error")){q.forEach(function(t){if(t&&!require.defined(t)){require("ta/util/Error").record(null,"uiOverlay: ["+t+"] dependency missing")}})}require(q,function(t,v,H,w,G,C,u,B,A,z){var E=[H(i,p),p&&v[p](j,c[h].defaultFixed),w&&w(i.getAttribute("data-windowshade")),G&&G(f,true),C&&C(c[h].defaultFade),u&&u(),B&&B(i.getAttribute("data-close-event")),A&&A(i.getAttribute("data-maxWidth")),z&&z(i.getAttribute("data-close-child"))],x=Array.prototype.slice.call(arguments,9),y=new t(i,E.concat(x));var F=function(){b.select(".ui_tooltip").forEach(function(I){if(I.overlay&&I.overlay!=y){I.overlay.hide()}});y.show()};if(n){!f&&b.addEvent(i,n,function(I){F();b.stopEvent(I)});y.on("destroy",function(){b.removeEvent(i,n,y.show)})}if(m){e[m]=y;y.on("destroy",function(){delete e[m]})}!f&&F();if(i.hasAttribute("data-callback")){var D=b.fn(i.getAttribute("data-callback"));D&&D(y)}});return false};return a});window.uiOverlay=function(){var a=arguments;require(["overlays/uiOverlay"],function(b){b.apply(null,a)})};define("ta/prwidgets",["vanillajs","ns-exporter","purify","amdloaders"],function(i,q,b,j){var t={};var e=define;var l=require;var m={};var s=/\bhandlerLoading *\b/g;var o;t.define=function(z,y,B,v,A){y=y.replace(/\.js$/i,"");if(Object.prototype.toString.call(v)!=="[object Array]"){v=[]}if(B&&B.length){var x=m[z];if(!x){m[z]=x={}}for(var w=0;w<B.length;w++){x[B[w]]=true}}var u="$prw/"+z+"/"+y;if(l.undef){l.undef(u)}e(u,n(z,v),function(){var C=Array.prototype.slice.apply(arguments);return function(D){if(!D[y]){D[y]=A.apply(null,h(D,v,C))}return D[y]}})};function d(u,y){var v,x;var w=this.element._prWidgetContext;if(typeof u==="string"){u=[u];v=n(w.widget.name,u);v=v[0]&&l(v[0]);v=v&&h(w,u,[v]);return v&&v[0]}u=u.slice();l(n(w.widget.name,u),function(){var z=h(w,u,arguments);y&&y.apply(null,z)})}function n(A,z,y){var x=m[A];if(!x){return[]}z=z.slice();for(var w=0;w<z.length;++w){var v=z[w];var B=v.replace(/^[a-z]+!/,"");var u=v.substring(0,v.length-B.length);if(u==="trhtml!"){}else{if(B==="widget"){z[w]=null}else{if(x[u==="trjs!"?B:v]){z[w]=u+"$prw/"+A+"/"+B}}}}return z}function h(x,z,v){var u,w;v=Array.prototype.slice.apply(v);if(z.length===0){return v}var y=m[x.widget.name];if(v.length<z.length){u=n(x.widget.name,z);while((w=v.length)<z.length){if(u[w]){v.push(l(u[w]))}else{v.push(null)}}}for(var w=0;w<z.length;++w){var A=z[w].replace(/^trjs!/,"");if(x[A]){v[w]=x[A]}else{if(y[A]&&(typeof v[w])==="function"){v[w]=v[w].call(null,x)}}}return v}t.getjs=function(v,w){var u=k(v);if(u&&(typeof w==="string")){return u.widget.require(w)}};t.initWidgets=function(u,x){var w,v;if(!u){u=document}if(typeof(u)==="string"){u=document.getElementById(u);if(!u){return}}if(!x){u=b(u,true);if(u.forEach){u.forEach(function(y){t.initWidgets(y,true)});return}}w=u.querySelectorAll(".prw_rup");for(v=0;v<w.length;v++){p(w[v])}w=u.querySelectorAll(".prw_dyn");for(v=0;v<w.length;v++){p(w[v])}};function r(u){u._prWidgetContext=this.element._prWidgetContext}function p(w){var x,C,u,y,v,B;if(!w){return}if(w._prWidgetContext){return}x=w.getAttribute("data-prwidget-init");if(typeof(x)!="string"){return}u=w.getAttribute("data-prwidget-name");if(!u){return}x=c(x);v=c(w.getAttribute("data-scriptFlags")).reduce(function(E,D){E[D]=true;return E},{});var z=x.length;B=w.getAttribute("data-prwidget-deferred");if(B){B=c(B);for(var y=0;y<B.length;y++){x.push(B[y])}}var A=m[u];if(!A){m[u]=A={}}C={};for(y=0;y<x.length;y++){A[x[y]]=true}C.widget={name:u,element:w,modules:x,flags:v,markMine:r,require:d};w._prWidgetContext=C;C.widget.require(x.slice(0,z),function(){if(w._prPendingClick){var D=w._prPendingClick;w._prPendingClick=void (0);if(D.key===o){window.setTimeout(function(){t.call.apply(t,D.args)},0)}}})}function c(u){if(typeof u!=="string"){return[]}return u.match(/[^\s,]+(\s+[^\s,]+)*/g)||[]}function k(v){var u=v._prWidgetContext;if(u){return u}for(v=v.parentNode;v&&v.hasAttribute;v=v.parentNode){u=v._prWidgetContext;if(u){return u}if(v.hasAttribute("data-prwidget-init")){break}}return}function g(v){for(var u=v;u&&u.hasAttribute;u=u.parentNode){if(u.hasAttribute("data-prwidget-init")){return u}}return void (0)}function a(u){if(u&&u.nodeName&&s.test(u.className||"")){u.className=(u.className||"").replace(s,"")}}function f(u){if(u&&u.nodeName&&!s.test(u.className||"")){u.className=(u.className||"")+" handlerLoading"}}t.getWidgetElement=function(v,u){u=u||document.body;return u.querySelector(".prw_"+v)};t.call=function(u,v,z,C){if(typeof(u)!=="string"||!v||!z){throw"ta.prwidgets.call() requires method, event, element"}var y=k(z);var w=(v&&(v.type==="click"||v.type==="submit"));if(w){v.stopPropagation&&v.stopPropagation();v.preventDefault&&v.preventDefault();o=void (0)}if(!y){if(w){var x=g(z);if(x&&!x._prWidgetContext){o={};x._prPendingClick={key:o,args:Array.prototype.slice.call(arguments,0)}}}return false}var E=u.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/);var B=E[1];E=E[2].split(".");var D=Array.prototype.slice.call(arguments,1);var A=function(G){a(z);var F=void (0);while(E.length>0&&G){F=G;G=G[E.shift()]}if(typeof(G)!=="function"){throw"ta.prwidgets.call: '"+u+"' is not a function"}G.apply(F||{},D);return false};if(y[B]){return A(y[B])}else{f(z);y.widget.require(["trjs!"+B],A)}};q.exportTo(t,"ta.prwidgets");return t});define("ta/p13n/placement-store",["vanillajs","ta/rollupAmdShim"],function(e,p){var f=define;var b=require;var c={};var n={};var m=/\bhandlerLoading *\b/g;var a;function h(s,v,x,r,w){v=v.replace(/\.js$/i,"");if(Object.prototype.toString.call(r)!=="[object Array]"){r=[]}if(x&&x.length){var u=n[s];if(!u){n[s]=u={}}for(var t=0;t<x.length;t++){u[x[t]]=true}}var q="$prp/"+s+"/"+v;if(b.undef){b.undef(q)}f(q,d(s,r),function(){var y=Array.prototype.slice.apply(arguments);return function(z){if(!z[v]){z[v]=w.apply(null,k(z,r,y))}return z[v]}})}function j(q,u){var r,t;var s=c[this.id];if(typeof q==="string"){q=[q];r=d(s.placement.dir,q,s.placement);r=r[0]&&b(r[0]);r=r&&k(s,q,[r]);return r&&r[0]}q=q.slice();b(d(s.placement.dir,q,s.placement),function(){var v=k(s,q,arguments);u&&u.apply(null,v)})}function d(s,w,v){var u=n[s];if(!u){if(console&&console.error){console.error(s+" _externalizeDeps - Failed to locate module map")}return[]}w=w.slice();for(var t=0;t<w.length;++t){var r=w[t];var x=r.replace(/^[a-z]+!/,"");var q=r.substring(0,r.length-x.length);if(q==="trhtml!"){if(v){x+=((x.indexOf("?")>=0)?"&occur=":"?occur=")+v.occurrence;w[t]=q+"$prp/"+v.name+"/"+x}}else{if(x==="placement"){w[t]=null}else{if(u&&u[q==="trjs!"?x:r]){w[t]=q+"$prp/"+s+"/"+x}}}}return w}function k(t,v,r){var q,s;r=Array.prototype.slice.apply(r);if(v.length===0){return r}var u=n[t.placement.dir];if(r.length<v.length){q=d(t.placement.dir,v);while((s=r.length)<v.length){if(q[s]){r.push(b(q[s]))}else{r.push(null)}}}for(var s=0;s<v.length;++s){var w=v[s].replace(/^trjs!/,"");if(t[w]){r[s]=t[w]}else{if(u[w]&&(typeof r[s])==="function"){r[s]=r[s].call(null,t)}}}return r}function i(q){if(q&&q.nodeName&&m.test(q.className||"")){q.className=(q.className||"").replace(m,"")}}function g(q){if(q&&q.nodeName&&!m.test(q.className||"")){q.className=(q.className||"")+" handlerLoading"}}function o(u,q,r,w,z){if(typeof(u)!=="string"||typeof(q)!=="string"||!r||!w){throw"placements.evCall() requires id, method, event, element"}var v=c[u];var s=(r&&(r.type==="click"||r.type==="submit"));if(s){r.preventDefault&&r.preventDefault();a=void (0)}if(!v){if(s){var t=document.getElementById(u);if(t){a={};t._prPendingClick={key:a,args:Array.prototype.slice.call(arguments)}}}return false}var B=q.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/);var y=B[1];B=B[2].split(".");var A=Array.prototype.slice.call(arguments,2);var x=function(D){i(w);var C=void (0);while(B.length>0&&D){C=D;D=D[B.shift()]}if(typeof(D)!=="function"){throw"placements.evCall: '"+q+"' is not a function"}D.apply(C||{},A);return false};if(v[y]){return x(v[y])}else{g(w);v.placement.require(["trjs!"+y],x)}}function l(q){return{load:function(u,v,t){v=v.replace(/\.js$/i,"");var r=t.id;var s=c[r];if(!s){s=q(t);c[r]=s;t=s.placement||t;s.placement=t;t.dir=u;t.require=j}return s[v]||(s[v]=null,s.placement.require(v))},define:h,evCall:o}}return l});define("ta/p13n/placements",["vanillajs","ns-exporter","api-mod","utils/ajax","ta/util/Error","ta/Core/TA.Store","ta/Core/TA.Event","ta/prwidgets","ta/p13n/placement-store"],function(e,i,d,h,a,b,f,g,j){var c=(function(){var l={};var p={};var m=new j(function(t){function s(){return{detail:""+t.location_id,placementName:t.name,servletClass:t.servletClass,servletName:t.servletName}}return{placement:d.merge({requestAJAXPlacement:function(x,u,w,y){var v=s();if(w){v=d.merge(v,w)}h({url:"/MetaPlacementAjax",data:v,method:y||"GET",evalScripts:true,success:x,error:function(){a.record(null,t.name+" load - MetaPlacementAjax request failed");if(u){u()}}})}},t)}});function k(v,y,w){var x,u,t={},s;if(!v){return}p[v]=p[v]||1000;w=w||{};x={};if(ta.widgets&&ta.widgets.calendar){u=ta.widgets.calendar.getCheckRatesData();if(u){x=u}}t={};if(window.pageServlet){t={metaReferer:window.pageServlet}}s=d.merge(x,w,{placementName:v,assets:!n(v),wrap:true,occ:p[v]},t);h({url:"/MetaPlacementAjax",data:s,evalScripts:true,success:function(z){p[v]++;z=o(v,z);y&&y(z)},error:function(){a.record(null,v+" load - MetaPlacementAjax request failed")}})}function r(v,x,B){if(b.retrieve("ta.redirectingPage")){return}var u=false;var A=ta.widgets.calendar.getCheckRatesData();if(!A){A={}}else{u=true}var w={};if(window.pageServlet){w={metaReferer:window.pageServlet}}var t=d.merge(A,w,{reqNum:x});if(B.customRequestParams){t=d.merge(t,B.customRequestParams)}var y=B.displayableRequestNumber||1;var s=B.maxRequestNumber||5;var z=B.pollWaitTime||2000;v.requestAJAXPlacement(function(E){v.latestCrossSellResponseText=E;var H=B.readyStrings||["xsellHacStatusReady","xsellHacStatusSOL"];var D=x>=s||H.some(function(I){return E.contains(I)})||!u;var C=x>=y||D;var G=document.getElementById(v.id);if(!G){return}function F(J){if(J&&J.target){d.removeEvent(J.target,"mouseout",F);d.removeEvent(J.target,"blur",F)}var I=G.querySelector&&G.querySelector(":hover");if(I){d.addEvent(I,"mouseout",F);return}var K=G.querySelector&&G.querySelector(":focus");if(K){d.addEvent(K,"blur",F);return}G.setContent(v.latestCrossSellResponseText);delete v.latestCrossSellResponseText;g.initWidgets(G);if(B.onSuccess){B.onSuccess()}}if(C){F()}if(!D){setTimeout(r.pass([v,x+1,B]),z)}},B.onFailure,t)}function q(t,s){if(t.autoRefreshEnabled){return}s=s||{};f.queueForLoad(function(){var v=s.customRequestParams||{};if(s.includePackagePrivateAssetsOnDateChange){v=d.merge({},v,{packagePrivateAssets:true})}var y=d.merge({},s,{displayableRequestNumber:(s.onCalendarRangeSelectDisplayableRequestNumber||2),customRequestParams:v});f.on("onCalendarRangeSelect",r.pass([t,1,y]));var x=d.merge({},s,{customRequestParams:v});f.on("clearDates",r.pass([t,1,x]));var w=s.initialRequestNumber||1;var u=s.pollWaitTime||2000;if(ta.widgets.calendar.hasPageDates()){setTimeout(r.pass([t,w,s]),u)}},"initialize "+t.id);t.autoRefreshEnabled=true}function o(v,u){var w=document.createElement("div"),t,s;w.innerHTML=u;t=w.getElementsByTagName("style");while(t.length>0){s=w.removeChild(t[0]);if(!n(v)){document.head.appendChild(s)}}l[v]=true;return w.innerHTML}function n(s){return !!l[s]}return{define:m.define,load:m.load,evCall:m.evCall,loadDynamicPlacement:k,enableAutoRefresh:q}})();i.exportTo(c,"ta.p13n.placements");return c});define("mixins/page-dates/DateTypeStore",[],function(){var d="zu";var e={CHECKIN:{queryString:null,pathString:null},CHECKOUT:{queryString:null,pathString:null},STAYDATES:{children:["CHECKIN","CHECKOUT"],queryString:"staydates",pathString:d+"s"},EATERY:{queryString:"eaterydate",pathString:d+"r"},DEPARTURE:{queryString:null,pathString:null},RETURN:{queryString:null,pathString:null},ROUNDTRIP:{children:["DEPARTURE","RETURN"],queryString:"roundtrip",pathString:d+"t"},ONEWAYFLIGHT:{queryString:"oneway",pathString:d+"o"},LEG_1:{queryString:"leg1date",pathString:d+"1"},LEG_2:{queryString:"leg2date",pathString:d+"2"},LEG_3:{queryString:"leg3date",pathString:d+"3"},ATTRACTION:{queryString:"attrdate",pathString:d+"a"}};function c(g){var f=b(g);if(f.length==0){return g}return e[f[0]].children[0]}function a(g){var f=b(g);if(f.length==0){return g}var h=e[f[0]];return h.children[h.children.length-1]}function b(g){var f=[];for(var h in e){if(!e.hasOwnProperty(h)){continue}if(e[h].children&&e[h].children.indexOf(g)>=0){f.push(h)}}return f}e.isChildDateType=function(f){return b(f).length>0};e.getParents=b;e.isHotelDateType=function(f){return b(f).indexOf("STAYDATES")>=0};e.isRoundTripDateType=function(f){return b(f).indexOf("ROUNDTRIP")>=0};e.isStartDateType=function(g){var f=b(g);if(f.length==0){return false}return e[f[0]].children.indexOf(g)==0};e.isEndDateType=function(g){var f=b(g);if(f.length==0){return false}var h=e[f[0]];return h.children.indexOf(g)==h.children.length-1};e.getStartDate=function(g){var f=c(g);if(f==null){return ta.page.getDates(g)[0]}return ta.page.getDates(f)[0]};e.getEndDate=function(f){var g=a(f);if(g==null){return ta.page.getDates(f)[0]}return ta.page.getDates(g)[0]};e.flattenType=function(f){var g=e[f];if(!g){return[]}if(!g.children){return[f]}return g.children.slice(0)};e.getCorrespondingDateType=function(f){switch(f){case"CHECKIN":return"CHECKOUT";case"CHECKOUT":return"CHECKIN";case"DEPARTURE":return"RETURN";case"RETURN":return"DEPARTURE";default:return null}};return e});define("mixins/page-dates/picker-autopopper",["ta","mixins/page-dates/DateTypeStore","vanillajs"],function(c,d){function a(e){while(e){if(e===document){return true}e=e.parentNode}return false}function b(e){c.page.on("dateSelected",function f(j,i,h){if(!a(e)){c.page.off("dateSelected",f);return}if(!e.contains(j)){return}var g=d.getCorrespondingDateType(i);if(!g){return}if(!c.page.hasDates(g)){setTimeout(c.page.gatherDates.bind(c.page,e.querySelector('[data-datetype="'+g+'"]')))}})}return{apply:b}});require(["ta/rollupAmdShim"],function(a){a.install(["typeahead/TypeAhead.views"],[])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"dual_search",files:{js3:{src:{typeahead:{"TypeAhead.views":1}}}},_:{baseUrl:"/"}})};require(["ta/p13n/placements"],function(a){var b=a.define.bind(a,"dual_search_dust","handlers",["deferred/lateHandlers","handlers"]);b(["placement","lib/jquery-amd","ta","ta/Core/TA.Store","ta/Core/TA.Event"],function(f,g,h,e,i){if(f.params&&"typeahead_to_store" in f.params){var d=f.params.typeahead_to_store;if(d){for(var j in d){if(d.hasOwnProperty(j)){e.store(j,d[j])}}}}c("GEO_SCOPE_CONTAINER","GEO_SCOPED_SEARCH_INPUT");c("MAIN_SEARCH_CONTAINER","mainSearch");function c(n,m){g("#"+n).on("click",function(o){if(g(o.target).closest("#"+m).length==0){g("#"+m).focus()}})}var l=e.retrieve("typeahead_dual_search_options");function k(){if(!l.autoTooltip||!e.retrieve("isFirstSessionPageView")||!window.require){return}var m=["trjs!overlays/Overlay","trjs!overlays/position","trjs!overlays/styles/popover","trjs!overlays/options/maxWidth","trjs!overlays/options/repositionOnEvent"];require(m,function(q,p,n,t,u){var r=document.getElementById("SEARCH_BUTTON");var o=[p&&p.below&&p.below([],false),n&&n(r,"below","dark small"," ",l.autoTooltip),t&&t(220),u&&u(window,"showingCookieConsentBanner")];var s=new q(r,o);if(s){s.show()}})}if(document.activeElement===g("#GEO_SCOPED_SEARCH_INPUT")[0]){f.require(["trjs!deferred/lateHandlers"],function(m){m.whereFocused({type:"dummy"},document.activeElement)})}else{if(document.activeElement===g("#mainSearch")[0]){f.require(["trjs!deferred/lateHandlers"],function(m){m.whatFocused({type:"dummy"},document.activeElement)})}else{if(l&&l.autoTooltip){i.queueForLoad(k,"dual_search auto tooltip")}}}return{getOptions:function(){return l}}})});require(["ta/prwidgets"],function(a){var b=a.define.bind(a,"datepickers_desktop_horizontal_styleguide_icon","handlers",["handlers"]);b(["widget","vanillajs","api-mod","ta/Core/TA.Event","mixins/page-dates/picker-autopopper"],function(e,j,h,k,i){var d=h.find("[data-datetype=CHECKIN]",e.element),g=h.find("[data-datetype=CHECKOUT]",e.element);function f(p,o){var n,m=p.getAttribute("data-dateFormat")||ta.widgets.calendar.getDatePickerFormat("classic");if(!o){n=p.getAttribute("data-emptyText")}else{n=ta.widgets.calendar.dateToString(o,m)}h.find(".picker-inner .picker-label",p).firstChild.nodeValue=n}function l(o,n,m){if(!h.inDocument(e.element)){ta.page.removeListener("dateSelected",l);d=null;g=null;return}if(n==="CHECKIN"){f(d,m[0])}else{if(n==="CHECKOUT"){f(g,m[0])}else{if(n==="STAYDATES"){f(d,m[0]);f(g,m[1])}}}}function c(p,o){if(!p){return}var m=p.getParent(".calendarFlyout");if(m){var n=m.deferred,q=m.getElement(".calendarWrapper");if(n&&q){n.reject();ta.page.gatherDates(p,q,o);return}}ta.page.gatherDates(p,null,o)}k.queueForLoad(function(){ta.page.on("dateSelected",l);i.apply(e.element)},"datepicker widget handlers");return{onDatePickerClick:c}})});require(["ta/p13n/placements"],function(a){var b=a.define.bind(a,"dual_search","handlers",["deferred/lateHandlers","handlers"]);b(["placement","lib/jquery-amd","ta","ta/Core/TA.Store","ta/Core/TA.Event"],function(e,g,h,d,i){f("GEO_SCOPED_SEARCH_INPUT");f("mainSearch");c("GEO_SCOPE_CONTAINER","GEO_SCOPED_SEARCH_INPUT");c("MAIN_SEARCH_CONTAINER","mainSearch");function c(m,l){g("#"+m).on("click",function(n){if(g(n.target).closest("#"+l).length==0){g("#"+l).focus()}})}function f(n){var m=g("#"+n);var p=m.parent();var r=p.children(".findNearLabel");if(r.length){var o=parseInt(p.css("width"));if(o){var l=0;r.each(function(s,t){l+=g(t).outerWidth(true)});var q=o-l-parseInt(m.css("marginLeft"))-parseInt(m.css("marginRight"))-8;m.css("width",q)}}}var k=d.retrieve("typeahead_dual_search_options");function j(){if(!k.autoTooltip||!d.retrieve("isFirstSessionPageView")||!window.require){return}var l=["trjs!overlays/Overlay","trjs!overlays/position","trjs!overlays/styles/popover","trjs!overlays/options/maxWidth","trjs!overlays/options/repositionOnEvent"];require(l,function(p,o,m,s,t){var q=document.getElementById("SEARCH_BUTTON");var n=[o&&o.below&&o.below([],false),m&&m(q,"below","dark small"," ",k.autoTooltip),s&&s(220),t&&t(window,"showingCookieConsentBanner")];var r=new p(q,n);if(r){r.show()}})}if(document.activeElement===g("#GEO_SCOPED_SEARCH_INPUT")[0]){e.require(["trjs!deferred/lateHandlers"],function(l){l.whereFocused({type:"dummy"},document.activeElement)})}else{if(document.activeElement===g("#mainSearch")[0]){e.require(["trjs!deferred/lateHandlers"],function(l){l.whatFocused({type:"dummy"},document.activeElement)})}else{if(k&&k.autoTooltip){i.queueForLoad(j,"dual_search auto tooltip")}}}return{getOptions:function(){return k}}})});(function(a){a.util.escaping={escapeHTMLSafe:function(b){if((typeof b==="string")||(b instanceof String)){return b.replace(/&/ig,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/"/ig,"&quot;").replace(/'/ig,"&#x27;").replace(/\//ig,"&#x2F;")}return""},unescapeHTMLSafe:function(b){if((typeof b==="string")||(b instanceof String)){return b.replace(/&amp;/ig,"&").replace(/&lt;/ig,"<").replace(/&gt;/ig,">").replace(/&quot;/ig,'"').replace(/&#x27;/ig,"'").replace(/&#x2F;/ig,"/")}return""}}})(ta);